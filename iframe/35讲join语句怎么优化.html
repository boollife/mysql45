<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <style type="text/css">

#watermark {

  position: relative;
  overflow: hidden;
}

#watermark .x {
  position: absolute;
  top: 800;
  left: 400;
  color: #3300ff;
  font-size: 50px;
  pointer-events: none;
  opacity:0.3;
  filter:Alpha(opacity=50);
  
  
}
    </style>


    <style type="text/css">
 html{color:#333;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;text-rendering:optimizelegibility;font-family:Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif}html.borderbox *,html.borderbox :after,html.borderbox :before{box-sizing:border-box}article,aside,blockquote,body,button,code,dd,details,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hr,input,legend,li,menu,nav,ol,p,pre,section,td,textarea,th,ul{margin:0;padding:0}article,aside,details,figcaption,figure,footer,header,menu,nav,section{display:block}audio,canvas,video{display:inline-block}body,button,input,select,textarea{font:300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}table{border-collapse:collapse;border-spacing:0}fieldset,img{border:0}blockquote{position:relative;color:#999;font-weight:400;border-left:1px solid #1abc9c;padding-left:1em;margin:1em 3em 1em 2em}@media only screen and (max-width:640px){blockquote{margin:1em 0}}abbr,acronym{border-bottom:1px dotted;font-variant:normal}abbr{cursor:help}del{text-decoration:line-through}address,caption,cite,code,dfn,em,th,var{font-style:normal;font-weight:400}ol,ul{list-style:none}caption,th{text-align:left}q:after,q:before{content:""}sub,sup{font-size:75%;line-height:0;position:relative}:root sub,:root sup{vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}a{color:#1abc9c}a:hover{text-decoration:underline}.typo a{border-bottom:1px solid #1abc9c}.typo a:hover{border-bottom-color:#555;color:#555}.typo a:hover,a,ins{text-decoration:none}.typo-u,u{text-decoration:underline}mark{background:#fffdd1;border-bottom:1px solid #ffedce;padding:2px;margin:0 5px}code,pre,pre tt{font-family:Courier,Courier New,monospace}pre{background:hsla(0,0%,97%,.7);border:1px solid #ddd;padding:1em 1.5em;display:block;-webkit-overflow-scrolling:touch}hr{border:none;border-bottom:1px solid #cfcfcf;margin-bottom:.8em;height:10px}.typo-small,figcaption,small{font-size:.9em;color:#888}b,strong{font-weight:700;color:#000}[draggable]{cursor:move}.clearfix:after,.clearfix:before{content:"";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.textwrap,.textwrap td,.textwrap th{word-wrap:break-word;word-break:break-all}.textwrap-table{table-layout:fixed}.serif{font-family:Palatino,Optima,Georgia,serif}.typo-dl,.typo-form,.typo-hr,.typo-ol,.typo-p,.typo-pre,.typo-table,.typo-ul,.typo dl,.typo form,.typo hr,.typo ol,.typo p,.typo pre,.typo table,.typo ul,blockquote{margin-bottom:1rem}h1,h2,h3,h4,h5,h6{font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;line-height:1.35}.typo-h1,.typo-h2,.typo-h3,.typo-h4,.typo-h5,.typo-h6,.typo h1,.typo h2,.typo h3,.typo h4,.typo h5,.typo h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}.typo-h1,.typo h1{font-size:2em}.typo-h2,.typo h2{font-size:1.8em}.typo-h3,.typo h3{font-size:1.6em}.typo-h4,.typo h4{font-size:1.4em}.typo-h5,.typo-h6,.typo h5,.typo h6{font-size:1.2em}.typo-ul,.typo ul{margin-left:1.3em;list-style:disc}.typo-ol,.typo ol{list-style:decimal;margin-left:1.9em}.typo-ol ol,.typo-ol ul,.typo-ul ol,.typo-ul ul,.typo li ol,.typo li ul{margin-bottom:.8em;margin-left:2em}.typo-ol ul,.typo-ul ul,.typo li ul{list-style:circle}.typo-table td,.typo-table th,.typo table caption,.typo table td,.typo table th{border:1px solid #ddd;padding:.5em 1em;color:#666}.typo-table th,.typo table th{background:#fbfbfb}.typo-table thead th,.typo table thead th{background:hsla(0,0%,95%,.7)}.typo table caption{border-bottom:none}.typo-input,.typo-textarea{-webkit-appearance:none;border-radius:0}.typo-em,.typo em,caption,legend{color:#000;font-weight:inherit}.typo-em{position:relative}.typo-em:after{position:absolute;top:.65em;left:0;width:100%;overflow:hidden;white-space:nowrap;content:"\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"}.typo img{max-width:100%}.common-content{font-weight:400;color:#353535;line-height:1.75rem;white-space:normal;word-break:normal;font-size:1rem}.common-content img{display:block;max-width:100%;background-color:#eee}.common-content audio,.common-content video{width:100%;background-color:#eee}.common-content center,.common-content font{margin-top:1rem;display:inline-block}.common-content center{width:100%}.common-content pre{margin-top:1rem;padding-left:0;padding-right:0;position:relative;overflow:hidden}.common-content pre code{font-size:.8rem;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;display:block;width:100%;box-sizing:border-box;padding-left:1rem;padding-right:1rem;overflow-x:auto}.common-content hr{border:none;margin-top:1.5rem;margin-bottom:1.5rem;border-top:1px solid #f5f5f5;height:1px;background:none}.common-content b,.common-content h1,.common-content h2,.common-content h3,.common-content h4,.common-content h5,.common-content strong{font-weight:700}.common-content h1,.common-content h2{font-size:1.125rem;margin-bottom:.45rem}.common-content h3,.common-content h4,.common-content h5{font-size:1rem;margin-bottom:.45rem}.common-content p{font-weight:400;color:#353535;margin-top:.15rem}.common-content .orange{color:#ff5a05}.common-content .reference{font-size:1rem;color:#888}.custom-rich-content h1{margin-top:0;font-weight:400;font-size:15.25px;border-bottom:1px solid #eee;line-height:2.8}.custom-rich-content li,.custom-rich-content p{font-size:14px;color:#888;line-height:1.6}table.hljs-ln{margin-bottom:0;border-spacing:0;border-collapse:collapse}table.hljs-ln,table.hljs-ln tbody,table.hljs-ln td,table.hljs-ln tr{box-sizing:border-box}table.hljs-ln td{padding:0;border:0}table.hljs-ln td.hljs-ln-numbers{min-width:15px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;cursor:pointer;user-select:none}table.hljs-ln td.hljs-ln-code,table.hljs-ln td.hljs-ln-numbers{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;line-height:20px;vertical-align:top}table.hljs-ln td.hljs-ln-code{position:relative;padding-right:10px;padding-left:10px;overflow:visible;color:#24292e;word-wrap:normal;white-space:pre}video::-webkit-media-controls{overflow:hidden!important}video::-webkit-media-controls-enclosure{width:calc(100% + 32px);margin-left:auto}.button-cancel{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel,.button-primary{-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary{color:#fff;background-color:#ff5a05;border-radius:3px}@font-face{font-family:iconfont;src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot);src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.woff) format("woff"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.ttf) format("truetype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.svg#iconfont) format("svg")}@font-face{font-family:player-font;src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot);src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.woff) format("woff"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.ttf) format("truetype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.svg#player-font) format("svg")}.iconfont{font-family:iconfont!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;-moz-osx-font-smoothing:grayscale}html{background:#fff;min-height:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{width:100%}body.fixed{overflow:hidden;position:fixed;width:100vw;height:100vh}i{font-style:normal}a{word-wrap:break-word;-webkit-tap-highlight-color:rgba(0,0,0,0)}a:hover{text-decoration:none}.fade-enter-active,.fade-leave-active{transition:opacity .3s}.fade-enter,.fade-leave-to{opacity:0}.MathJax,.MathJax_CHTML,.MathJax_MathContainer,.MathJax_MathML,.MathJax_PHTML,.MathJax_PlainSource,.MathJax_SVG{outline:0}.ios-app-switch .js-audit{display:none}._loading_wrap_{position:fixed;width:100vw;height:100vh;top:50%;left:50%;transform:translate(-50%,-50%);z-index:999}._loading_div_class_,._loading_wrap_{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._loading_div_class_{word-wrap:break-word;padding:.5rem .75rem;text-align:center;z-index:9999;font-size:.6rem;max-width:60%;color:#fff;border-radius:.25rem;-ms-flex-direction:column;flex-direction:column}._loading_div_class_ .message{color:#353535;font-size:16px;line-height:3}.spinner{animation:circle-rotator 1.4s linear infinite}.spinner *{line-height:0;box-sizing:border-box}@keyframes circle-rotator{0%{transform:rotate(0deg)}to{transform:rotate(270deg)}}.path{stroke-dasharray:187;stroke-dashoffset:0;transform-origin:center;animation:circle-dash 1.4s ease-in-out infinite,circle-colors 5.6s ease-in-out infinite}@keyframes circle-colors{0%{stroke:#ff5a05}to{stroke:#ff5a05}}@keyframes circle-dash{0%{stroke-dashoffset:187}50%{stroke-dashoffset:46.75;transform:rotate(135deg)}to{stroke-dashoffset:187;transform:rotate(450deg)}}.confirm-box-wrapper,.confirm-box-wrapper .mask{position:absolute;top:0;left:0;right:0;bottom:0}.confirm-box-wrapper .mask{background:rgba(0,0,0,.6)}.confirm-box-wrapper .confirm-box{position:fixed;top:50%;left:50%;width:267px;background:#fff;transform:translate(-50%,-50%);border-radius:7px}.confirm-box-wrapper .confirm-box .head{margin:0 18px;font-size:18px;text-align:center;line-height:65px;border-bottom:1px solid #d9d9d9}.confirm-box-wrapper .confirm-box .body{padding:18px;padding-bottom:0;color:#353535;font-size:12.5px;max-height:150px;overflow:auto}.confirm-box-wrapper .confirm-box .foot{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;padding:18px}.confirm-box-wrapper .confirm-box .foot .button-cancel{border:1px solid #d9d9d9}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}




    </style>
    <style type="text/css">
        .button-cancel[data-v-87ffcada]{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel[data-v-87ffcada],.button-primary[data-v-87ffcada]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary[data-v-87ffcada]{color:#fff;background-color:#ff5a05;border-radius:3px}.pd[data-v-87ffcada]{padding-left:1.375rem;padding-right:1.375rem}.article[data-v-87ffcada]{max-width:70rem;margin:0 auto}.article .article-unavailable[data-v-87ffcada]{color:#fa8919;font-size:15px;font-weight:600;line-height:24px;border-radius:5px;padding:12px;background-color:#f6f7fb;margin-top:20px}.article .article-unavailable .iconfont[data-v-87ffcada]{font-size:12px}.article .main[data-v-87ffcada]{padding:1.25rem 0;margin-bottom:52px}.article-title[data-v-87ffcada]{color:#353535;font-weight:400;line-height:1.65rem;font-size:1.34375rem}.article-info[data-v-87ffcada]{color:#888;font-size:.9375rem;margin-top:1.0625rem}.article-content[data-v-87ffcada]{margin-top:1.0625rem}.article-content.android video[data-v-87ffcada]::-webkit-media-controls-fullscreen-button{display:none}.copyright[data-v-87ffcada]{color:#b2b2b2;padding-bottom:20px;margin-top:20px;font-size:13px}.audio-player[data-v-87ffcada]{width:100%;margin:20px 0}.to-comment[data-v-87ffcada]{overflow:hidden;padding-top:10px;margin-bottom:-30px}.to-comment a.button-primary[data-v-87ffcada]{float:right;height:20px;font-size:12px;line-height:20px;padding:4px 8px;cursor:pointer}.article-comments[data-v-87ffcada]{margin-top:2rem}.article-comments h2[data-v-87ffcada]{text-align:center;color:#888;position:relative;z-index:1;margin-bottom:1rem}.article-comments h2[data-v-87ffcada]:before{border-top:1px dotted #888;content:"";position:absolute;top:56%;left:0;width:100%;z-index:-1}.article-comments h2 span[data-v-87ffcada]{font-size:15.25px;font-weight:400;padding:0 1rem;background:#fff;display:inline-block}.article-sub-bottom[data-v-87ffcada]{z-index:10;cursor:pointer}.switch-btns[data-v-87ffcada]{height:76px;cursor:pointer;padding-top:24px;padding-bottom:24px;border-bottom:10px solid #f6f7fb;position:relative}.switch-btns[data-v-87ffcada]:before{content:" ";height:1px;background:#e8e8e8;position:absolute;top:0;left:0;-webkit-box-sizing:border-box;box-sizing:border-box;left:1.375rem;right:1.375rem}.switch-btns .btn[data-v-87ffcada]{height:38px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.switch-btns .btn .tag[data-v-87ffcada]{-webkit-box-flex:0;-ms-flex:0 0 62px;flex:0 0 62px;text-align:center;color:#888;font-size:14px;border-radius:10px;height:22px;line-height:22px;background:#f6f7fb;font-weight:400}.switch-btns .btn .txt[data-v-87ffcada]{margin-left:10px;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:#888;font-size:15px;height:22px;line-height:22px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400}@media (max-width:769px){.article .breadcrumb[data-v-87ffcada]{padding-top:10px;padding-bottom:10px}}





    </style>

    <style type="text/css">
        .comment-item{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:1rem}.comment-item a{border-bottom:none}.comment-item .avatar{width:2.625rem;height:2.625rem;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}.comment-item .info{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.comment-item .info .hd{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .username{color:#888;font-size:15.25px;font-weight:400;line-height:1.2}.comment-item .info .hd .control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .control .btn-share{color:#888;font-size:.75rem;margin-right:1rem}.comment-item .info .hd .control .btn-praise{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:15.25px;text-decoration:none}.comment-item .info .hd .control .btn-praise i{color:#888;display:inline-block;font-size:.75rem;margin-right:.3rem;margin-top:-.01rem}.comment-item .info .hd .control .btn-praise i.on,.comment-item .info .hd .control .btn-praise span{color:#ff5a05}.comment-item .info .bd{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6}.comment-item .info .time{color:#888;font-size:9px;line-height:1}.comment-item .info .reply .reply-hd{font-size:15.25px}.comment-item .info .reply .reply-hd span{margin-left:-12px;color:#888;font-weight:400}.comment-item .info .reply .reply-hd i{color:#ff5a05;font-size:15.25px}.comment-item .info .reply .reply-content{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all}.comment-item .info .reply .reply-time{color:#888;font-size:9px}




    </style>
</head>
<body>
<div id="app">


    <div data-v-87ffcada="" class="article" id="watermark">
        <div data-v-87ffcada="" class="main main-app">
            <h1 data-v-87ffcada="" class="article-title pd">
                35è®²joinè¯­å¥æ€ä¹ˆä¼˜åŒ–
            </h1>
            <div data-v-87ffcada="" class="article-content typo common-content pd"><img data-v-87ffcada=""
                                                                                        src="https://static001.geekbang.org/resource/image/16/ca/16479caaf957faffa36a2db09f9899ca.jpg">

                <div>
                    <audio controls="controls" height="100" width="100">
                        <source src="35è®²joinè¯­å¥æ€ä¹ˆä¼˜åŒ–.mp3" type="audio/mp3" />
                        <embed height="100" width="100" src="35è®²joinè¯­å¥æ€ä¹ˆä¼˜åŒ–.mp3" />
                    </audio>
                </div>
                <div data-v-87ffcada="" id="article-content" class="">
                    <div class="text">
                        <p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å’Œä½ ä»‹ç»äº†joinè¯­å¥çš„ä¸¤ç§ç®—æ³•ï¼Œåˆ†åˆ«æ˜¯Index Nested-Loop Join(NLJ)å’ŒBlock Nested-Loop Join(BNL)ã€‚</p><p>æˆ‘ä»¬å‘ç°åœ¨ä½¿ç”¨NLJç®—æ³•çš„æ—¶å€™ï¼Œå…¶å®æ•ˆæœè¿˜æ˜¯ä¸é”™çš„ï¼Œæ¯”é€šè¿‡åº”ç”¨å±‚æ‹†åˆ†æˆå¤šä¸ªè¯­å¥ç„¶åå†æ‹¼æ¥æŸ¥è¯¢ç»“æœæ›´æ–¹ä¾¿ï¼Œè€Œä¸”æ€§èƒ½ä¹Ÿä¸ä¼šå·®ã€‚</p><p>ä½†æ˜¯ï¼ŒBNLç®—æ³•åœ¨å¤§è¡¨joinçš„æ—¶å€™æ€§èƒ½å°±å·®å¤šäº†ï¼Œæ¯”è¾ƒæ¬¡æ•°ç­‰äºä¸¤ä¸ªè¡¨å‚ä¸joinçš„è¡Œæ•°çš„ä¹˜ç§¯ï¼Œå¾ˆæ¶ˆè€—CPUèµ„æºã€‚</p><p>å½“ç„¶äº†ï¼Œè¿™ä¸¤ä¸ªç®—æ³•éƒ½è¿˜æœ‰ç»§ç»­ä¼˜åŒ–çš„ç©ºé—´ï¼Œæˆ‘ä»¬ä»Šå¤©å°±æ¥èŠèŠè¿™ä¸ªè¯é¢˜ã€‚</p><p>ä¸ºäº†ä¾¿äºåˆ†æï¼Œæˆ‘è¿˜æ˜¯åˆ›å»ºä¸¤ä¸ªè¡¨t1ã€t2æ¥å’Œä½ å±•å¼€ä»Šå¤©çš„é—®é¢˜ã€‚</p><pre><code>create table t1(id int primary key, a int, b int, index(a));
create table t2 like t1;
drop procedure idata;
delimiter ;;
create procedure idata()
begin
  declare i int;
  set i=1;
  while(i&lt;=1000)do
    insert into t1 values(i, 1001-i, i);
    set i=i+1;
  end while;
  
  set i=1;
  while(i&lt;=1000000)do
    insert into t2 values(i, i, i);
    set i=i+1;
  end while;

end;;
delimiter ;
call idata();
</code></pre><p>ä¸ºäº†ä¾¿äºåé¢é‡åŒ–è¯´æ˜ï¼Œæˆ‘åœ¨è¡¨t1é‡Œï¼Œæ’å…¥äº†1000è¡Œæ•°æ®ï¼Œæ¯ä¸€è¡Œçš„a=1001-idçš„å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¡¨t1ä¸­å­—æ®µaæ˜¯é€†åºçš„ã€‚åŒæ—¶ï¼Œæˆ‘åœ¨è¡¨t2ä¸­æ’å…¥äº†100ä¸‡è¡Œæ•°æ®ã€‚</p><h1>Multi-Range Readä¼˜åŒ–</h1><p>åœ¨ä»‹ç»joinè¯­å¥çš„ä¼˜åŒ–æ–¹æ¡ˆä¹‹å‰ï¼Œæˆ‘éœ€è¦å…ˆå’Œä½ ä»‹ç»ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œå³ï¼šMulti-Range Readä¼˜åŒ–(MRR)ã€‚è¿™ä¸ªä¼˜åŒ–çš„ä¸»è¦ç›®çš„æ˜¯å°½é‡ä½¿ç”¨é¡ºåºè¯»ç›˜ã€‚</p><p>åœ¨<a href="https://time.geekbang.org/column/article/69236">ç¬¬4ç¯‡æ–‡ç« </a>ä¸­ï¼Œæˆ‘å’Œä½ ä»‹ç»InnoDBçš„ç´¢å¼•ç»“æ„æ—¶ï¼Œæåˆ°äº†â€œå›è¡¨â€çš„æ¦‚å¿µã€‚æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹è¿™ä¸ªæ¦‚å¿µã€‚å›è¡¨æ˜¯æŒ‡ï¼ŒInnoDBåœ¨æ™®é€šç´¢å¼•aä¸ŠæŸ¥åˆ°ä¸»é”®idçš„å€¼åï¼Œå†æ ¹æ®ä¸€ä¸ªä¸ªä¸»é”®idçš„å€¼åˆ°ä¸»é”®ç´¢å¼•ä¸Šå»æŸ¥æ•´è¡Œæ•°æ®çš„è¿‡ç¨‹ã€‚</p><!-- [[[read_end]]] --><p>ç„¶åï¼Œæœ‰åŒå­¦åœ¨ç•™è¨€åŒºé—®åˆ°ï¼Œå›è¡¨è¿‡ç¨‹æ˜¯ä¸€è¡Œè¡Œåœ°æŸ¥æ•°æ®ï¼Œè¿˜æ˜¯æ‰¹é‡åœ°æŸ¥æ•°æ®ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¿™ä¸ªé—®é¢˜ã€‚å‡è®¾ï¼Œæˆ‘æ‰§è¡Œè¿™ä¸ªè¯­å¥ï¼š</p><pre><code>select * from t1 where a&gt;=1 and a&lt;=100;
</code></pre><p>ä¸»é”®ç´¢å¼•æ˜¯ä¸€æ£µB+æ ‘ï¼Œåœ¨è¿™æ£µæ ‘ä¸Šï¼Œæ¯æ¬¡åªèƒ½æ ¹æ®ä¸€ä¸ªä¸»é”®idæŸ¥åˆ°ä¸€è¡Œæ•°æ®ã€‚å› æ­¤ï¼Œå›è¡¨è‚¯å®šæ˜¯ä¸€è¡Œè¡Œæœç´¢ä¸»é”®ç´¢å¼•çš„ï¼ŒåŸºæœ¬æµç¨‹å¦‚å›¾1æ‰€ç¤ºã€‚</p><p><img src="https://static001.geekbang.org/resource/image/17/11/1761edbd7734276ae0a213af3cdd3311.jpg" alt=""></p><center><span class="reference">å›¾1 åŸºæœ¬å›è¡¨æµç¨‹</span></center><p>å¦‚æœéšç€açš„å€¼é€’å¢é¡ºåºæŸ¥è¯¢çš„è¯ï¼Œidçš„å€¼å°±å˜æˆéšæœºçš„ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°éšæœºè®¿é—®ï¼Œæ€§èƒ½ç›¸å¯¹è¾ƒå·®ã€‚è™½ç„¶â€œæŒ‰è¡ŒæŸ¥â€è¿™ä¸ªæœºåˆ¶ä¸èƒ½æ”¹ï¼Œä½†æ˜¯è°ƒæ•´æŸ¥è¯¢çš„é¡ºåºï¼Œè¿˜æ˜¯èƒ½å¤ŸåŠ é€Ÿçš„ã€‚</p><p><strong>å› ä¸ºå¤§å¤šæ•°çš„æ•°æ®éƒ½æ˜¯æŒ‰ç…§ä¸»é”®é€’å¢é¡ºåºæ’å…¥å¾—åˆ°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼Œå¦‚æœæŒ‰ç…§ä¸»é”®çš„é€’å¢é¡ºåºæŸ¥è¯¢çš„è¯ï¼Œå¯¹ç£ç›˜çš„è¯»æ¯”è¾ƒæ¥è¿‘é¡ºåºè¯»ï¼Œèƒ½å¤Ÿæå‡è¯»æ€§èƒ½ã€‚</strong></p><p>è¿™ï¼Œå°±æ˜¯MRRä¼˜åŒ–çš„è®¾è®¡æ€è·¯ã€‚æ­¤æ—¶ï¼Œè¯­å¥çš„æ‰§è¡Œæµç¨‹å˜æˆäº†è¿™æ ·ï¼š</p><ol>
<li>
<p>æ ¹æ®ç´¢å¼•aï¼Œå®šä½åˆ°æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œå°†idå€¼æ”¾å…¥read_rnd_bufferä¸­;</p>
</li>
<li>
<p>å°†read_rnd_bufferä¸­çš„idè¿›è¡Œé€’å¢æ’åºï¼›</p>
</li>
<li>
<p>æ’åºåçš„idæ•°ç»„ï¼Œä¾æ¬¡åˆ°ä¸»é”®idç´¢å¼•ä¸­æŸ¥è®°å½•ï¼Œå¹¶ä½œä¸ºç»“æœè¿”å›ã€‚</p>
</li>
</ol><p>è¿™é‡Œï¼Œread_rnd_bufferçš„å¤§å°æ˜¯ç”±read_rnd_buffer_sizeå‚æ•°æ§åˆ¶çš„ã€‚å¦‚æœæ­¥éª¤1ä¸­ï¼Œread_rnd_bufferæ”¾æ»¡äº†ï¼Œå°±ä¼šå…ˆæ‰§è¡Œå®Œæ­¥éª¤2å’Œ3ï¼Œç„¶åæ¸…ç©ºread_rnd_bufferã€‚ä¹‹åç»§ç»­æ‰¾ç´¢å¼•açš„ä¸‹ä¸ªè®°å½•ï¼Œå¹¶ç»§ç»­å¾ªç¯ã€‚</p><p>å¦å¤–éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¦‚æœä½ æƒ³è¦ç¨³å®šåœ°ä½¿ç”¨MRRä¼˜åŒ–çš„è¯ï¼Œéœ€è¦è®¾ç½®<code>set optimizer_switch="mrr_cost_based=off"</code>ã€‚ï¼ˆå®˜æ–¹æ–‡æ¡£çš„è¯´æ³•ï¼Œæ˜¯ç°åœ¨çš„ä¼˜åŒ–å™¨ç­–ç•¥ï¼Œåˆ¤æ–­æ¶ˆè€—çš„æ—¶å€™ï¼Œä¼šæ›´å€¾å‘äºä¸ä½¿ç”¨MRRï¼ŒæŠŠmrr_cost_basedè®¾ç½®ä¸ºoffï¼Œå°±æ˜¯å›ºå®šä½¿ç”¨MRRäº†ã€‚ï¼‰</p><p>ä¸‹é¢ä¸¤å¹…å›¾å°±æ˜¯ä½¿ç”¨äº†MRRä¼˜åŒ–åçš„æ‰§è¡Œæµç¨‹å’Œexplainç»“æœã€‚</p><p><img src="https://static001.geekbang.org/resource/image/d5/c7/d502fbaea7cac6f815c626b078da86c7.jpg" alt=""></p><center><span class="reference">å›¾2 MRRæ‰§è¡Œæµç¨‹</span></center><p><img src="https://static001.geekbang.org/resource/image/a5/32/a513d07ebaf1ae044d44391c89bc6432.png" alt=""></p><center><span class="reference">å›¾3 MRRæ‰§è¡Œæµç¨‹çš„explainç»“æœ</span></center><p>ä»å›¾3çš„explainç»“æœä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Extraå­—æ®µå¤šäº†Using MRRï¼Œè¡¨ç¤ºçš„æ˜¯ç”¨ä¸Šäº†MRRä¼˜åŒ–ã€‚è€Œä¸”ï¼Œç”±äºæˆ‘ä»¬åœ¨read_rnd_bufferä¸­æŒ‰ç…§idåšäº†æ’åºï¼Œæ‰€ä»¥æœ€åå¾—åˆ°çš„ç»“æœé›†ä¹Ÿæ˜¯æŒ‰ç…§ä¸»é”®idé€’å¢é¡ºåºçš„ï¼Œä¹Ÿå°±æ˜¯ä¸å›¾1ç»“æœé›†ä¸­è¡Œçš„é¡ºåºç›¸åã€‚</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°ç»“ä¸€ä¸‹ã€‚</p><p><strong>MRRèƒ½å¤Ÿæå‡æ€§èƒ½çš„æ ¸å¿ƒ</strong>åœ¨äºï¼Œè¿™æ¡æŸ¥è¯¢è¯­å¥åœ¨ç´¢å¼•aä¸Šåšçš„æ˜¯ä¸€ä¸ªèŒƒå›´æŸ¥è¯¢ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤šå€¼æŸ¥è¯¢ï¼‰ï¼Œå¯ä»¥å¾—åˆ°è¶³å¤Ÿå¤šçš„ä¸»é”®idã€‚è¿™æ ·é€šè¿‡æ’åºä»¥åï¼Œå†å»ä¸»é”®ç´¢å¼•æŸ¥æ•°æ®ï¼Œæ‰èƒ½ä½“ç°å‡ºâ€œé¡ºåºæ€§â€çš„ä¼˜åŠ¿ã€‚</p><h1>Batched Key Access</h1><p>ç†è§£äº†MRRæ€§èƒ½æå‡çš„åŸç†ï¼Œæˆ‘ä»¬å°±èƒ½ç†è§£MySQLåœ¨5.6ç‰ˆæœ¬åå¼€å§‹å¼•å…¥çš„Batched Key Acess(BKA)ç®—æ³•äº†ã€‚è¿™ä¸ªBKAç®—æ³•ï¼Œå…¶å®å°±æ˜¯å¯¹NLJç®—æ³•çš„ä¼˜åŒ–ã€‚</p><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ç”¨åˆ°çš„NLJç®—æ³•çš„æµç¨‹å›¾ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/10/3d/10e14e8b9691ac6337d457172b641a3d.jpg" alt=""></p><center><span class="reference">å›¾4 Index Nested-Loop Joinæµç¨‹å›¾</span></center><p>NLJç®—æ³•æ‰§è¡Œçš„é€»è¾‘æ˜¯ï¼šä»é©±åŠ¨è¡¨t1ï¼Œä¸€è¡Œè¡Œåœ°å–å‡ºaçš„å€¼ï¼Œå†åˆ°è¢«é©±åŠ¨è¡¨t2å»åšjoinã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºè¡¨t2æ¥è¯´ï¼Œæ¯æ¬¡éƒ½æ˜¯åŒ¹é…ä¸€ä¸ªå€¼ã€‚è¿™æ—¶ï¼ŒMRRçš„ä¼˜åŠ¿å°±ç”¨ä¸ä¸Šäº†ã€‚</p><p>é‚£æ€ä¹ˆæ‰èƒ½ä¸€æ¬¡æ€§åœ°å¤šä¼ äº›å€¼ç»™è¡¨t2å‘¢ï¼Ÿæ–¹æ³•å°±æ˜¯ï¼Œä»è¡¨t1é‡Œä¸€æ¬¡æ€§åœ°å¤šæ‹¿äº›è¡Œå‡ºæ¥ï¼Œä¸€èµ·ä¼ ç»™è¡¨t2ã€‚</p><p>æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬å°±æŠŠè¡¨t1çš„æ•°æ®å–å‡ºæ¥ä¸€éƒ¨åˆ†ï¼Œå…ˆæ”¾åˆ°ä¸€ä¸ªä¸´æ—¶å†…å­˜ã€‚è¿™ä¸ªä¸´æ—¶å†…å­˜ä¸æ˜¯åˆ«äººï¼Œå°±æ˜¯join_bufferã€‚</p><p>é€šè¿‡ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬çŸ¥é“join_buffer åœ¨BNLç®—æ³•é‡Œçš„ä½œç”¨ï¼Œæ˜¯æš‚å­˜é©±åŠ¨è¡¨çš„æ•°æ®ã€‚ä½†æ˜¯åœ¨NLJç®—æ³•é‡Œå¹¶æ²¡æœ‰ç”¨ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬åˆšå¥½å°±å¯ä»¥å¤ç”¨join_bufferåˆ°BKAç®—æ³•ä¸­ã€‚</p><p>å¦‚å›¾5æ‰€ç¤ºï¼Œæ˜¯ä¸Šé¢çš„NLJç®—æ³•ä¼˜åŒ–åçš„BKAç®—æ³•çš„æµç¨‹ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/31/7e/31d85666542b9cb0b47a447a8593a47e.jpg" alt=""></p><center><span class="reference">å›¾5 Batched Key Acessæµç¨‹</span></center><p>å›¾ä¸­ï¼Œæˆ‘åœ¨join_bufferä¸­æ”¾å…¥çš„æ•°æ®æ˜¯P1~P100ï¼Œè¡¨ç¤ºçš„æ˜¯åªä¼šå–æŸ¥è¯¢éœ€è¦çš„å­—æ®µã€‚å½“ç„¶ï¼Œå¦‚æœjoin bufferæ”¾ä¸ä¸‹P1~P100çš„æ‰€æœ‰æ•°æ®ï¼Œå°±ä¼šæŠŠè¿™100è¡Œæ•°æ®åˆ†æˆå¤šæ®µæ‰§è¡Œä¸Šå›¾çš„æµç¨‹ã€‚</p><p>é‚£ä¹ˆï¼Œè¿™ä¸ªBKAç®—æ³•åˆ°åº•è¦æ€ä¹ˆå¯ç”¨å‘¢ï¼Ÿ</p><p>å¦‚æœè¦ä½¿ç”¨BKAä¼˜åŒ–ç®—æ³•çš„è¯ï¼Œä½ éœ€è¦åœ¨æ‰§è¡ŒSQLè¯­å¥ä¹‹å‰ï¼Œå…ˆè®¾ç½®</p><pre><code>set optimizer_switch='mrr=on,mrr_cost_based=off,batched_key_access=on';
</code></pre><p>å…¶ä¸­ï¼Œå‰ä¸¤ä¸ªå‚æ•°çš„ä½œç”¨æ˜¯è¦å¯ç”¨MRRã€‚è¿™ä¹ˆåšçš„åŸå› æ˜¯ï¼ŒBKAç®—æ³•çš„ä¼˜åŒ–è¦ä¾èµ–äºMRRã€‚</p><h1>BNLç®—æ³•çš„æ€§èƒ½é—®é¢˜</h1><p>è¯´å®Œäº†NLJç®—æ³•çš„ä¼˜åŒ–ï¼Œæˆ‘ä»¬å†æ¥çœ‹BNLç®—æ³•çš„ä¼˜åŒ–ã€‚</p><p>æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« æœ«å°¾ï¼Œç»™ä½ ç•™ä¸‹çš„æ€è€ƒé¢˜æ˜¯ï¼Œä½¿ç”¨Block Nested-Loop Join(BNL)ç®—æ³•æ—¶ï¼Œå¯èƒ½ä¼šå¯¹è¢«é©±åŠ¨è¡¨åšå¤šæ¬¡æ‰«æã€‚å¦‚æœè¿™ä¸ªè¢«é©±åŠ¨è¡¨æ˜¯ä¸€ä¸ªå¤§çš„å†·æ•°æ®è¡¨ï¼Œé™¤äº†ä¼šå¯¼è‡´IOå‹åŠ›å¤§ä»¥å¤–ï¼Œè¿˜ä¼šå¯¹ç³»ç»Ÿæœ‰ä»€ä¹ˆå½±å“å‘¢ï¼Ÿ</p><p>åœ¨<a href="https://time.geekbang.org/column/article/79407">ç¬¬33ç¯‡æ–‡ç« </a>ä¸­ï¼Œæˆ‘ä»¬è¯´åˆ°InnoDBçš„LRUç®—æ³•çš„æ—¶å€™æåˆ°ï¼Œç”±äºInnoDBå¯¹Bufffer Poolçš„LRUç®—æ³•åšäº†ä¼˜åŒ–ï¼Œå³ï¼šç¬¬ä¸€æ¬¡ä»ç£ç›˜è¯»å…¥å†…å­˜çš„æ•°æ®é¡µï¼Œä¼šå…ˆæ”¾åœ¨oldåŒºåŸŸã€‚å¦‚æœ1ç§’ä¹‹åè¿™ä¸ªæ•°æ®é¡µä¸å†è¢«è®¿é—®äº†ï¼Œå°±ä¸ä¼šè¢«ç§»åŠ¨åˆ°LRUé“¾è¡¨å¤´éƒ¨ï¼Œè¿™æ ·å¯¹Buffer Poolçš„å‘½ä¸­ç‡å½±å“å°±ä¸å¤§ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœä¸€ä¸ªä½¿ç”¨BNLç®—æ³•çš„joinè¯­å¥ï¼Œå¤šæ¬¡æ‰«æä¸€ä¸ªå†·è¡¨ï¼Œè€Œä¸”è¿™ä¸ªè¯­å¥æ‰§è¡Œæ—¶é—´è¶…è¿‡1ç§’ï¼Œå°±ä¼šåœ¨å†æ¬¡æ‰«æå†·è¡¨çš„æ—¶å€™ï¼ŒæŠŠå†·è¡¨çš„æ•°æ®é¡µç§»åˆ°LRUé“¾è¡¨å¤´éƒ¨ã€‚</p><p>è¿™ç§æƒ…å†µå¯¹åº”çš„ï¼Œæ˜¯å†·è¡¨çš„æ•°æ®é‡å°äºæ•´ä¸ªBuffer Poolçš„3/8ï¼Œèƒ½å¤Ÿå®Œå…¨æ”¾å…¥oldåŒºåŸŸçš„æƒ…å†µã€‚</p><p>å¦‚æœè¿™ä¸ªå†·è¡¨å¾ˆå¤§ï¼Œå°±ä¼šå‡ºç°å¦å¤–ä¸€ç§æƒ…å†µï¼šä¸šåŠ¡æ­£å¸¸è®¿é—®çš„æ•°æ®é¡µï¼Œæ²¡æœ‰æœºä¼šè¿›å…¥youngåŒºåŸŸã€‚</p><p>ç”±äºä¼˜åŒ–æœºåˆ¶çš„å­˜åœ¨ï¼Œä¸€ä¸ªæ­£å¸¸è®¿é—®çš„æ•°æ®é¡µï¼Œè¦è¿›å…¥youngåŒºåŸŸï¼Œéœ€è¦éš”1ç§’åå†æ¬¡è¢«è®¿é—®åˆ°ã€‚ä½†æ˜¯ï¼Œç”±äºæˆ‘ä»¬çš„joinè¯­å¥åœ¨å¾ªç¯è¯»ç£ç›˜å’Œæ·˜æ±°å†…å­˜é¡µï¼Œè¿›å…¥oldåŒºåŸŸçš„æ•°æ®é¡µï¼Œå¾ˆå¯èƒ½åœ¨1ç§’ä¹‹å†…å°±è¢«æ·˜æ±°äº†ã€‚è¿™æ ·ï¼Œå°±ä¼šå¯¼è‡´è¿™ä¸ªMySQLå®ä¾‹çš„Buffer Poolåœ¨è¿™æ®µæ—¶é—´å†…ï¼ŒyoungåŒºåŸŸçš„æ•°æ®é¡µæ²¡æœ‰è¢«åˆç†åœ°æ·˜æ±°ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸¤ç§æƒ…å†µéƒ½ä¼šå½±å“Buffer Poolçš„æ­£å¸¸è¿ä½œã€‚</p><p><strong>å¤§è¡¨joinæ“ä½œè™½ç„¶å¯¹IOæœ‰å½±å“ï¼Œä½†æ˜¯åœ¨è¯­å¥æ‰§è¡Œç»“æŸåï¼Œå¯¹IOçš„å½±å“ä¹Ÿå°±ç»“æŸäº†ã€‚ä½†æ˜¯ï¼Œå¯¹Buffer Poolçš„å½±å“å°±æ˜¯æŒç»­æ€§çš„ï¼Œéœ€è¦ä¾é åç»­çš„æŸ¥è¯¢è¯·æ±‚æ…¢æ…¢æ¢å¤å†…å­˜å‘½ä¸­ç‡ã€‚</strong></p><p>ä¸ºäº†å‡å°‘è¿™ç§å½±å“ï¼Œä½ å¯ä»¥è€ƒè™‘å¢å¤§join_buffer_sizeçš„å€¼ï¼Œå‡å°‘å¯¹è¢«é©±åŠ¨è¡¨çš„æ‰«ææ¬¡æ•°ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒBNLç®—æ³•å¯¹ç³»ç»Ÿçš„å½±å“ä¸»è¦åŒ…æ‹¬ä¸‰ä¸ªæ–¹é¢ï¼š</p><ol>
<li>
<p>å¯èƒ½ä¼šå¤šæ¬¡æ‰«æè¢«é©±åŠ¨è¡¨ï¼Œå ç”¨ç£ç›˜IOèµ„æºï¼›</p>
</li>
<li>
<p>åˆ¤æ–­joinæ¡ä»¶éœ€è¦æ‰§è¡ŒM*Næ¬¡å¯¹æ¯”ï¼ˆMã€Nåˆ†åˆ«æ˜¯ä¸¤å¼ è¡¨çš„è¡Œæ•°ï¼‰ï¼Œå¦‚æœæ˜¯å¤§è¡¨å°±ä¼šå ç”¨éå¸¸å¤šçš„CPUèµ„æºï¼›</p>
</li>
<li>
<p>å¯èƒ½ä¼šå¯¼è‡´Buffer Poolçš„çƒ­æ•°æ®è¢«æ·˜æ±°ï¼Œå½±å“å†…å­˜å‘½ä¸­ç‡ã€‚</p>
</li>
</ol><p>æˆ‘ä»¬æ‰§è¡Œè¯­å¥ä¹‹å‰ï¼Œéœ€è¦é€šè¿‡ç†è®ºåˆ†æå’ŒæŸ¥çœ‹explainç»“æœçš„æ–¹å¼ï¼Œç¡®è®¤æ˜¯å¦è¦ä½¿ç”¨BNLç®—æ³•ã€‚å¦‚æœç¡®è®¤ä¼˜åŒ–å™¨ä¼šä½¿ç”¨BNLç®—æ³•ï¼Œå°±éœ€è¦åšä¼˜åŒ–ã€‚ä¼˜åŒ–çš„å¸¸è§åšæ³•æ˜¯ï¼Œç»™è¢«é©±åŠ¨è¡¨çš„joinå­—æ®µåŠ ä¸Šç´¢å¼•ï¼ŒæŠŠBNLç®—æ³•è½¬æˆBKAç®—æ³•ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å…·ä½“çœ‹çœ‹ï¼Œè¿™ä¸ªä¼˜åŒ–æ€ä¹ˆåšï¼Ÿ</p><h1>BNLè½¬BKA</h1><p>ä¸€äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è¢«é©±åŠ¨è¡¨ä¸Šå»ºç´¢å¼•ï¼Œè¿™æ—¶å°±å¯ä»¥ç›´æ¥è½¬æˆBKAç®—æ³•äº†ã€‚</p><p>ä½†æ˜¯ï¼Œæœ‰æ—¶å€™ä½ ç¡®å®ä¼šç¢°åˆ°ä¸€äº›ä¸é€‚åˆåœ¨è¢«é©±åŠ¨è¡¨ä¸Šå»ºç´¢å¼•çš„æƒ…å†µã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªè¯­å¥ï¼š</p><pre><code>select * from t1 join t2 on (t1.b=t2.b) where t2.b&gt;=1 and t2.b&lt;=2000;
</code></pre><p>æˆ‘ä»¬åœ¨æ–‡ç« å¼€å§‹çš„æ—¶å€™ï¼Œåœ¨è¡¨t2ä¸­æ’å…¥äº†100ä¸‡è¡Œæ•°æ®ï¼Œä½†æ˜¯ç»è¿‡whereæ¡ä»¶è¿‡æ»¤åï¼Œéœ€è¦å‚ä¸joinçš„åªæœ‰2000è¡Œæ•°æ®ã€‚å¦‚æœè¿™æ¡è¯­å¥åŒæ—¶æ˜¯ä¸€ä¸ªä½é¢‘çš„SQLè¯­å¥ï¼Œé‚£ä¹ˆå†ä¸ºè¿™ä¸ªè¯­å¥åœ¨è¡¨t2çš„å­—æ®µbä¸Šåˆ›å»ºä¸€ä¸ªç´¢å¼•å°±å¾ˆæµªè´¹äº†ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœä½¿ç”¨BNLç®—æ³•æ¥joinçš„è¯ï¼Œè¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol>
<li>
<p>æŠŠè¡¨t1çš„æ‰€æœ‰å­—æ®µå–å‡ºæ¥ï¼Œå­˜å…¥join_bufferä¸­ã€‚è¿™ä¸ªè¡¨åªæœ‰1000è¡Œï¼Œjoin_buffer_sizeé»˜è®¤å€¼æ˜¯256kï¼Œå¯ä»¥å®Œå…¨å­˜å…¥ã€‚</p>
</li>
<li>
<p>æ‰«æè¡¨t2ï¼Œå–å‡ºæ¯ä¸€è¡Œæ•°æ®è·Ÿjoin_bufferä¸­çš„æ•°æ®è¿›è¡Œå¯¹æ¯”ï¼Œ</p>
<ul>
<li>å¦‚æœä¸æ»¡è¶³t1.b=t2.bï¼Œåˆ™è·³è¿‡ï¼›</li>
<li>å¦‚æœæ»¡è¶³t1.b=t2.b, å†åˆ¤æ–­å…¶ä»–æ¡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ˜¯å¦æ»¡è¶³t2.bå¤„äº[1,2000]çš„æ¡ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œå°±ä½œä¸ºç»“æœé›†çš„ä¸€éƒ¨åˆ†è¿”å›ï¼Œå¦åˆ™è·³è¿‡ã€‚</li>
</ul>
</li>
</ol><p>æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­è¯´è¿‡ï¼Œå¯¹äºè¡¨t2çš„æ¯ä¸€è¡Œï¼Œåˆ¤æ–­joinæ˜¯å¦æ»¡è¶³çš„æ—¶å€™ï¼Œéƒ½éœ€è¦éå†join_bufferä¸­çš„æ‰€æœ‰è¡Œã€‚å› æ­¤åˆ¤æ–­ç­‰å€¼æ¡ä»¶çš„æ¬¡æ•°æ˜¯1000*100ä¸‡=10äº¿æ¬¡ï¼Œè¿™ä¸ªåˆ¤æ–­çš„å·¥ä½œé‡å¾ˆå¤§ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/92/60/92fbdbfc35da3040396401250cb33f60.png" alt=""></p><center><span class="reference">å›¾6 explainç»“æœ</span></center><p><img src="https://static001.geekbang.org/resource/image/d8/9c/d862bc3e88305688df2c354a4b26809c.png" alt=""></p><center><span class="reference">å›¾7 è¯­å¥æ‰§è¡Œæ—¶é—´</span></center><p>å¯ä»¥çœ‹åˆ°ï¼Œexplainç»“æœé‡ŒExtraå­—æ®µæ˜¾ç¤ºä½¿ç”¨äº†BNLç®—æ³•ã€‚åœ¨æˆ‘çš„æµ‹è¯•ç¯å¢ƒé‡Œï¼Œè¿™æ¡è¯­å¥éœ€è¦æ‰§è¡Œ1åˆ†11ç§’ã€‚</p><p>åœ¨è¡¨t2çš„å­—æ®µbä¸Šåˆ›å»ºç´¢å¼•ä¼šæµªè´¹èµ„æºï¼Œä½†æ˜¯ä¸åˆ›å»ºç´¢å¼•çš„è¯è¿™ä¸ªè¯­å¥çš„ç­‰å€¼æ¡ä»¶è¦åˆ¤æ–­10äº¿æ¬¡ï¼Œæƒ³æƒ³ä¹Ÿæ˜¯æµªè´¹ã€‚é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ä¸¤å…¨å…¶ç¾çš„åŠæ³•å‘¢ï¼Ÿ</p><p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚ä½¿ç”¨ä¸´æ—¶è¡¨çš„å¤§è‡´æ€è·¯æ˜¯ï¼š</p><ol>
<li>
<p>æŠŠè¡¨t2ä¸­æ»¡è¶³æ¡ä»¶çš„æ•°æ®æ”¾åœ¨ä¸´æ—¶è¡¨tmp_tä¸­ï¼›</p>
</li>
<li>
<p>ä¸ºäº†è®©joinä½¿ç”¨BKAç®—æ³•ï¼Œç»™ä¸´æ—¶è¡¨tmp_tçš„å­—æ®µbåŠ ä¸Šç´¢å¼•ï¼›</p>
</li>
<li>
<p>è®©è¡¨t1å’Œtmp_tåšjoinæ“ä½œã€‚</p>
</li>
</ol><p>æ­¤æ—¶ï¼Œå¯¹åº”çš„SQLè¯­å¥çš„å†™æ³•å¦‚ä¸‹ï¼š</p><pre><code>create temporary table temp_t(id int primary key, a int, b int, index(b))engine=innodb;
insert into temp_t select * from t2 where b&gt;=1 and b&lt;=2000;
select * from t1 join temp_t on (t1.b=temp_t.b);
</code></pre><p>å›¾8å°±æ˜¯è¿™ä¸ªè¯­å¥åºåˆ—çš„æ‰§è¡Œæ•ˆæœã€‚</p><p><img src="https://static001.geekbang.org/resource/image/a8/c7/a80cdffe8173fa0fd8969ed976ac6ac7.png" alt=""></p><center> å›¾8 ä½¿ç”¨ä¸´æ—¶è¡¨çš„æ‰§è¡Œæ•ˆæœ</center><p>å¯ä»¥çœ‹åˆ°ï¼Œæ•´ä¸ªè¿‡ç¨‹3ä¸ªè¯­å¥æ‰§è¡Œæ—¶é—´çš„æ€»å’Œè¿˜ä¸åˆ°1ç§’ï¼Œç›¸æ¯”äºå‰é¢çš„1åˆ†11ç§’ï¼Œæ€§èƒ½å¾—åˆ°äº†å¤§å¹…æå‡ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·çœ‹ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹çš„æ¶ˆè€—ï¼š</p><ol>
<li>
<p>æ‰§è¡Œinsertè¯­å¥æ„é€ temp_tè¡¨å¹¶æ’å…¥æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹è¡¨t2åšäº†å…¨è¡¨æ‰«æï¼Œè¿™é‡Œæ‰«æè¡Œæ•°æ˜¯100ä¸‡ã€‚</p>
</li>
<li>
<p>ä¹‹åçš„joinè¯­å¥ï¼Œæ‰«æè¡¨t1ï¼Œè¿™é‡Œçš„æ‰«æè¡Œæ•°æ˜¯1000ï¼›joinæ¯”è¾ƒè¿‡ç¨‹ä¸­ï¼Œåšäº†1000æ¬¡å¸¦ç´¢å¼•çš„æŸ¥è¯¢ã€‚ç›¸æ¯”äºä¼˜åŒ–å‰çš„joinè¯­å¥éœ€è¦åš10äº¿æ¬¡æ¡ä»¶åˆ¤æ–­æ¥è¯´ï¼Œè¿™ä¸ªä¼˜åŒ–æ•ˆæœè¿˜æ˜¯å¾ˆæ˜æ˜¾çš„ã€‚</p>
</li>
</ol><p>æ€»ä½“æ¥çœ‹ï¼Œä¸è®ºæ˜¯åœ¨åŸè¡¨ä¸ŠåŠ ç´¢å¼•ï¼Œè¿˜æ˜¯ç”¨æœ‰ç´¢å¼•çš„ä¸´æ—¶è¡¨ï¼Œæˆ‘ä»¬çš„æ€è·¯éƒ½æ˜¯è®©joinè¯­å¥èƒ½å¤Ÿç”¨ä¸Šè¢«é©±åŠ¨è¡¨ä¸Šçš„ç´¢å¼•ï¼Œæ¥è§¦å‘BKAç®—æ³•ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½ã€‚</p><h1>æ‰©å±•-hash join</h1><p>çœ‹åˆ°è¿™é‡Œä½ å¯èƒ½å‘ç°äº†ï¼Œå…¶å®ä¸Šé¢è®¡ç®—10äº¿æ¬¡é‚£ä¸ªæ“ä½œï¼Œçœ‹ä¸Šå»æœ‰ç‚¹å„¿å‚»ã€‚å¦‚æœjoin_bufferé‡Œé¢ç»´æŠ¤çš„ä¸æ˜¯ä¸€ä¸ªæ— åºæ•°ç»„ï¼Œè€Œæ˜¯ä¸€ä¸ªå“ˆå¸Œè¡¨çš„è¯ï¼Œé‚£ä¹ˆå°±ä¸æ˜¯10äº¿æ¬¡åˆ¤æ–­ï¼Œè€Œæ˜¯100ä¸‡æ¬¡hashæŸ¥æ‰¾ã€‚è¿™æ ·çš„è¯ï¼Œæ•´æ¡è¯­å¥çš„æ‰§è¡Œé€Ÿåº¦å°±å¿«å¤šäº†å§ï¼Ÿ</p><p>ç¡®å®å¦‚æ­¤ã€‚</p><p>è¿™ï¼Œä¹Ÿæ­£æ˜¯MySQLçš„ä¼˜åŒ–å™¨å’Œæ‰§è¡Œå™¨ä¸€ç›´è¢«è¯Ÿç—…çš„ä¸€ä¸ªåŸå› ï¼šä¸æ”¯æŒå“ˆå¸Œjoinã€‚å¹¶ä¸”ï¼ŒMySQLå®˜æ–¹çš„roadmapï¼Œä¹Ÿæ˜¯è¿Ÿè¿Ÿæ²¡æœ‰æŠŠè¿™ä¸ªä¼˜åŒ–æ’ä¸Šè®®ç¨‹ã€‚</p><p>å®é™…ä¸Šï¼Œè¿™ä¸ªä¼˜åŒ–æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®ç°åœ¨ä¸šåŠ¡ç«¯ã€‚å®ç°æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p><ol>
<li>
<p><code>select * from t1;</code>å–å¾—è¡¨t1çš„å…¨éƒ¨1000è¡Œæ•°æ®ï¼Œåœ¨ä¸šåŠ¡ç«¯å­˜å…¥ä¸€ä¸ªhashç»“æ„ï¼Œæ¯”å¦‚C++é‡Œçš„setã€PHPçš„dictè¿™æ ·çš„æ•°æ®ç»“æ„ã€‚</p>
</li>
<li>
<p><code>select * from t2 where b&gt;=1 and b&lt;=2000;</code> è·å–è¡¨t2ä¸­æ»¡è¶³æ¡ä»¶çš„2000è¡Œæ•°æ®ã€‚</p>
</li>
<li>
<p>æŠŠè¿™2000è¡Œæ•°æ®ï¼Œä¸€è¡Œä¸€è¡Œåœ°å–åˆ°ä¸šåŠ¡ç«¯ï¼Œåˆ°hashç»“æ„çš„æ•°æ®è¡¨ä¸­å¯»æ‰¾åŒ¹é…çš„æ•°æ®ã€‚æ»¡è¶³åŒ¹é…çš„æ¡ä»¶çš„è¿™è¡Œæ•°æ®ï¼Œå°±ä½œä¸ºç»“æœé›†çš„ä¸€è¡Œã€‚</p>
</li>
</ol><p>ç†è®ºä¸Šï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šæ¯”ä¸´æ—¶è¡¨æ–¹æ¡ˆçš„æ‰§è¡Œé€Ÿåº¦è¿˜è¦å¿«ä¸€äº›ã€‚å¦‚æœä½ æ„Ÿå…´è¶£çš„è¯ï¼Œå¯ä»¥è‡ªå·±éªŒè¯ä¸€ä¸‹ã€‚</p><h1>å°ç»“</h1><p>ä»Šå¤©ï¼Œæˆ‘å’Œä½ åˆ†äº«äº†Index Nested-Loop Joinï¼ˆNLJï¼‰å’ŒBlock Nested-Loop Joinï¼ˆBNLï¼‰çš„ä¼˜åŒ–æ–¹æ³•ã€‚</p><p>åœ¨è¿™äº›ä¼˜åŒ–æ–¹æ³•ä¸­ï¼š</p><ol>
<li>
<p>BKAä¼˜åŒ–æ˜¯MySQLå·²ç»å†…ç½®æ”¯æŒçš„ï¼Œå»ºè®®ä½ é»˜è®¤ä½¿ç”¨ï¼›</p>
</li>
<li>
<p>BNLç®—æ³•æ•ˆç‡ä½ï¼Œå»ºè®®ä½ éƒ½å°½é‡è½¬æˆBKAç®—æ³•ã€‚ä¼˜åŒ–çš„æ–¹å‘å°±æ˜¯ç»™è¢«é©±åŠ¨è¡¨çš„å…³è”å­—æ®µåŠ ä¸Šç´¢å¼•ï¼›</p>
</li>
<li>
<p>åŸºäºä¸´æ—¶è¡¨çš„æ”¹è¿›æ–¹æ¡ˆï¼Œå¯¹äºèƒ½å¤Ÿæå‰è¿‡æ»¤å‡ºå°æ•°æ®çš„joinè¯­å¥æ¥è¯´ï¼Œæ•ˆæœè¿˜æ˜¯å¾ˆå¥½çš„ï¼›</p>
</li>
<li>
<p>MySQLç›®å‰çš„ç‰ˆæœ¬è¿˜ä¸æ”¯æŒhash joinï¼Œä½†ä½ å¯ä»¥é…åˆåº”ç”¨ç«¯è‡ªå·±æ¨¡æ‹Ÿå‡ºæ¥ï¼Œç†è®ºä¸Šæ•ˆæœè¦å¥½äºä¸´æ—¶è¡¨çš„æ–¹æ¡ˆã€‚</p>
</li>
</ol><p>æœ€åï¼Œæˆ‘ç»™ä½ ç•™ä¸‹ä¸€é“æ€è€ƒé¢˜å§ã€‚</p><p>æˆ‘ä»¬åœ¨è®²joinè¯­å¥çš„è¿™ä¸¤ç¯‡æ–‡ç« ä¸­ï¼Œéƒ½åªæ¶‰åŠåˆ°äº†ä¸¤ä¸ªè¡¨çš„joinã€‚é‚£ä¹ˆï¼Œç°åœ¨æœ‰ä¸€ä¸ªä¸‰ä¸ªè¡¨joinçš„éœ€æ±‚ï¼Œå‡è®¾è¿™ä¸‰ä¸ªè¡¨çš„è¡¨ç»“æ„å¦‚ä¸‹ï¼š</p><pre><code>CREATE TABLE `t1` (
 `id` int(11) NOT NULL,
 `a` int(11) DEFAULT NULL,
 `b` int(11) DEFAULT NULL,
 `c` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB;

create table t2 like t1;
create table t3 like t2;
insert into ... //åˆå§‹åŒ–ä¸‰å¼ è¡¨çš„æ•°æ®
</code></pre><p>è¯­å¥çš„éœ€æ±‚å®ç°å¦‚ä¸‹çš„joiné€»è¾‘ï¼š</p><pre><code>select * from t1 join t2 on(t1.a=t2.a) join t3 on (t2.b=t3.b) where t1.c&gt;=X and t2.c&gt;=Y and t3.c&gt;=Z;
</code></pre><p>ç°åœ¨ä¸ºäº†å¾—åˆ°æœ€å¿«çš„æ‰§è¡Œé€Ÿåº¦ï¼Œå¦‚æœè®©ä½ æ¥è®¾è®¡è¡¨t1ã€t2ã€t3ä¸Šçš„ç´¢å¼•ï¼Œæ¥æ”¯æŒè¿™ä¸ªjoinè¯­å¥ï¼Œä½ ä¼šåŠ å“ªäº›ç´¢å¼•å‘¢ï¼Ÿ</p><p>åŒæ—¶ï¼Œå¦‚æœæˆ‘å¸Œæœ›ä½ ç”¨straight_joinæ¥é‡å†™è¿™ä¸ªè¯­å¥ï¼Œé…åˆä½ åˆ›å»ºçš„ç´¢å¼•ï¼Œä½ å°±éœ€è¦å®‰æ’è¿æ¥é¡ºåºï¼Œä½ ä¸»è¦è€ƒè™‘çš„å› ç´ æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ä½ å¯ä»¥æŠŠä½ çš„æ–¹æ¡ˆå’Œåˆ†æå†™åœ¨ç•™è¨€åŒºï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« çš„æœ«å°¾å’Œä½ è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><h1>ä¸ŠæœŸé—®é¢˜æ—¶é—´</h1><p>æˆ‘åœ¨ä¸Šç¯‡æ–‡ç« æœ€åç•™ç»™ä½ çš„é—®é¢˜ï¼Œå·²ç»åœ¨æœ¬ç¯‡æ–‡ç« ä¸­è§£ç­”äº†ã€‚</p><p>è¿™é‡Œæˆ‘å†æ ¹æ®è¯„è®ºåŒºç•™è¨€çš„æƒ…å†µï¼Œç®€å•æ€»ç»“ä¸‹ã€‚æ ¹æ®æ•°æ®é‡çš„å¤§å°ï¼Œæœ‰è¿™ä¹ˆä¸¤ç§æƒ…å†µï¼š</p><ul>
<li>@é•¿æ° å’Œ @è€æ¨åŒå¿— æåˆ°äº†æ•°æ®é‡å°äºoldåŒºåŸŸå†…å­˜çš„æƒ…å†µï¼›</li>
<li>@Zzz åŒå­¦ï¼Œå¾ˆè®¤çœŸåœ°çœ‹äº†å…¶ä»–åŒå­¦çš„è¯„è®ºï¼Œå¹¶ä¸”æäº†ä¸€ä¸ªå¾ˆæ·±çš„é—®é¢˜ã€‚å¯¹è¢«é©±åŠ¨è¡¨æ•°æ®é‡å¤§äºBuffer Poolçš„åœºæ™¯ï¼Œåšäº†å¾ˆç»†è‡´çš„æ¨æ¼”å’Œåˆ†æã€‚</li>
</ul><p>ç»™è¿™äº›åŒå­¦ç‚¹èµï¼Œéå¸¸å¥½çš„æ€è€ƒå’Œè®¨è®ºã€‚</p><p><img src="https://static001.geekbang.org/resource/image/09/77/09c1073f99cf71d2fb162a716b5fa577.jpg" alt=""></p>
                    </div>
                </div>

            </div>
            <div data-v-87ffcada="" class="article-comments pd"><h2 data-v-87ffcada=""><span
                    data-v-87ffcada="">ç²¾é€‰ç•™è¨€</span></h2>
                <ul data-v-87ffcada="">
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/d1/7c/4639f22c.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">éƒ­å¥</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæœ‰å‡ ä¸ªé—®é¢˜è¿˜éœ€è¦è¯·æ•™ä¸€ä¸‹:<br>1.ä¸Šä¸€ç« t1è¡¨100æ¡æ•°æ®ï¼Œt21000æ¡æ•°æ®ï¼Œmysqlä¼šæ¯æ¬¡éƒ½ä¼šå‡†ç¡®çš„æ‰¾å‡ºå“ªå¼ è¡¨æ˜¯åˆç†çš„é©±åŠ¨è¡¨å—ï¼Ÿè¿˜æ˜¯éœ€è¦äººä¸ºçš„æ·»åŠ straight_joinã€‚<br>2.åƒleft joinè¿™ç§ï¼Œå·¦è¾¹ä¸€å®šæ˜¯é©±åŠ¨è¡¨å§ï¼Ÿä»¥å·¦è¾¹ä¸ºæ ‡å‡†æŸ¥çœ‹å³è¾¹æœ‰ç¬¦åˆçš„æ¡ä»¶ï¼Œæ‹¼æˆä¸€æ¡æ•°æ®ï¼Œçœ‹åˆ°ä½ ç»™å…¶ä»–åŒå­¦çš„è¯„è®ºè¯´å¯èƒ½ä¸æ˜¯ï¼Œè¿™æœ‰äº›ç–‘æƒ‘ã€‚<br>3.åœ¨åšjoinçš„æ—¶å€™ï¼Œæœ‰äº›æ¡ä»¶æ˜¯å¯ä»¥æ”¾åœ¨onä¸­ä¹Ÿå¯ä»¥æ”¾åœ¨whereä¸­ï¼Œæ¯”å¦‚(t1.yn=1 å’Œt2.yn=1)è¿™ç§ç®€å•åˆ¤æ–­æ˜¯å¦åˆ é™¤çš„ã€‚æœ€ä¸»è¦çš„æ˜¯ï¼Œéœ€è¦æ ¹æ®ä¸¤ä¸ªæ¡ä»¶æ‰èƒ½joinçš„(productCodeå’ŒcustCode),éœ€è¦ä¸¤ä¸ªéƒ½åœ¨oné‡Œï¼Œè¿˜æ˜¯ä¸€ä¸ªåœ¨onä¸­ï¼Œä¸€ä¸ªåœ¨whereä¸­æ›´å¥½å‘¢ï¼Ÿ <br></div>
                            <span class="time">2019-02-07 00:05</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1. æ­£å¸¸æ˜¯ä¼šè‡ªå·±æ‰¾åˆ°åˆç†çš„ï¼Œä½†æ˜¯ç”¨å‰explainæ˜¯å¥½ä¹ æƒ¯å“ˆ<br>2. è¿™ä¸ªé—®é¢˜çš„å±•å¼€æˆ‘æ”¾åˆ°ç­”ç–‘æ–‡ç« ä¸­å“ˆ<br>3. è¿™ä¹Ÿæ˜¯å¥½é—®é¢˜ï¼Œéœ€è¦åˆ†ææ˜¯ä½¿ç”¨å“ªç§ç®—æ³•ï¼Œä¹Ÿæ”¾åˆ°ç­”ç–‘æ–‡ç« å±•å¼€å“ˆã€‚<br><br>æ–°å¹´å¿«ä¹~<br></p>
                                <p class="reply-time">2019-02-07 09:32</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/b8/36/542c96bf.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Mr.Strive.Z.H.L</span>
                            </div>
                            <div class="bd">è€å¸ˆä½ å¥½ï¼Œä»Šå¤©åœ¨å›é¡¾è¿™ç¯‡æ–‡ç« åšæ€»ç»“çš„æ—¶å€™ï¼Œçªç„¶æœ‰ä¸€ä¸ªç–‘æƒ‘ï¼š<br><br>æˆ‘ä»¬å‡è®¾t2çš„bä¸Šé¢æœ‰ç´¢å¼•ï¼Œè¯¥è¯­å¥æ˜¯å·¦è¿æ¥<br><br>select * from t1  left join t2 on (t1.b=t2.b) where t2.b&gt;=1 and t2.b&lt;=2000;<br><br>å’Œ<br><br>select * from t1  left join t2 on (t1.b=t2.b) and t2.b&gt;=1 and t2.b&lt;=2000;<br><br>åˆ°åº•åœ¨å†…éƒ¨æ‰§è¡Œæµç¨‹ä¸Šåˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿï¼Ÿ<br>å› ä¸ºå®é™…å·¥ä½œä¸­å·¦è¿æ¥ç”¨å¾—æŒºå¤šçš„ã€‚<br>ï¼ˆè¿™ç¯‡æ–‡ç« éƒ½æ˜¯ç›´è¿ï¼Œæ‰€ä»¥ä½¿ç”¨onå’Œwhereæœ€åçš„ç»“æœéƒ½ä¸€æ ·ï¼Œä½†æ˜¯å·¦è¿æ¥å°±ä¸æ˜¯äº†ï¼‰<br> <br></div>
                            <span class="time">2019-02-13 11:21</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Geek_02538c</span>
                            </div>
                            <div class="bd">è¿‡å¹´äº†ï¼Œè¿˜æœ‰æ–°æ–‡ç« ï¼Œç»™ä¸ªèµã€‚ å¦ï¼Œwhere  å’Œ order  ä¸ç´¢å¼•çš„å…³ç³»ï¼Œéƒ½è®²è¿‡äº†ï¼Œgroup by æ˜¯å¦ä¹Ÿæä¸ªç¯‡ç« è¯´ä¸€ä¸‹ã€‚ <br></div>
                            <span class="time">2019-02-02 21:12</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ä½ è¯´å¾—å¯¹^_^  ç¬¬37ç¯‡å°±æ˜¯ï¼Œæ–°å¹´å¿«ä¹</p>
                                <p class="reply-time">2019-02-03 09:14</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/40/5e/b8fada94.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Ryoma</span>
                            </div>
                            <div class="bd">read_rnd_buffer_length å‚æ•°åº”è¯¥æ˜¯ read_rnd_buffer_sizeï¼Œè§æ–‡æ¡£ï¼šhttps:&#47;&#47;dev.mysql.com&#47;doc&#47;refman&#47;8.0&#47;en&#47;server-system-variables.html#sysvar_read_rnd_buffer_size <br></div>
                            <span class="time">2019-02-02 20:21</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ä½ è¯´å¾—å¯¹ï¼Œå¤šè°¢<br><br>å‘èµ·å‹˜è¯¯äº†<br><br>æ–°å¹´å¿«ä¹</p>
                                <p class="reply-time">2019-02-03 09:13</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/b8/36/542c96bf.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Mr.Strive.Z.H.L</span>
                            </div>
                            <div class="bd">è€å¸ˆæ‚¨å¥½ï¼Œæ–°å¹´å¿«ä¹~~<br><br>å…³äºä¸‰è¡¨joinæœ‰ä¸€ä¸ªç–‘æƒ‘ç‚¹éœ€è¦ç¡®è®¤ï¼š<br><br>è€å¸ˆæ‚¨åœ¨è¯„è®ºä¸­è¯´åˆ°ï¼Œä¸‰è¡¨joinä¸ä¼šæ˜¯å‰ä¸¤ä¸ªè¡¨joinåå¾—åˆ°ç»“æœé›†ï¼Œå†å’Œç¬¬ä¸‰å¼ è¡¨joinã€‚<br>é’ˆå¯¹è¿™å¥è¯ï¼Œæˆ‘çš„ç†è§£æ˜¯ï¼š<br>å‡è®¾æˆ‘ä»¬ä¸è€ƒè™‘BKAï¼Œå°±æŒ‰ç…§ä¸€è¡Œè¡Œæ•°æ®æ¥åˆ¤æ–­çš„è¯ï¼Œæµç¨‹åº”è¯¥å¦‚ä¸‹ï¼ˆæˆ‘ä¼šå°†serverç«¯å’Œinnodbç«¯åˆ†çš„å¾ˆæ¸…æ¥šï¼‰ï¼š<br>è¡¨æ˜¯t1 ,t2 ,t3ã€‚  t1 straight_join t2 straight_join t3ï¼Œè¿™æ ·çš„joiné¡ºåºã€‚<br>1. è°ƒç”¨innodbæ¥å£ï¼Œä»t1ä¸­å–ä¸€è¡Œæ•°æ®ï¼Œæ•°æ®è¿”å›åˆ°serverç«¯ã€‚<br>2. è°ƒç”¨innodbæ¥å£ï¼Œä»t2ä¸­å–æ»¡è¶³æ¡ä»¶çš„æ•°æ®ï¼Œæ•°æ®è¿”å›åˆ°serverç«¯ã€‚<br>3. è°ƒç”¨innodbæ¥å£ï¼Œä»t3ä¸­å–æ»¡è¶³æ¡ä»¶çš„æ•°æ®ï¼Œæ•°æ®è¿”å›åˆ°serverç«¯ã€‚<br>ä¸Šé¢ä¸‰æ­¥ä¹‹åï¼Œé©±åŠ¨è¡¨ t1çš„ä¸€æ¡æ•°æ®å°±å¤„ç†å®Œäº†ï¼Œæ¥ä¸‹æ¥é‡å¤ä¸Šè¿°è¿‡ç¨‹ã€‚<br>ï¼ˆå¦‚æœé‡‡ç”¨BKAè¿›è¡Œä¼˜åŒ–ï¼Œå¯ä»¥ç†è§£ä¸ºä¸æ˜¯ä¸€è¡Œè¡Œæ•°æ®çš„æå–ï¼Œè€Œæ˜¯ä¸€ä¸ªèŒƒå›´å†…æ•°æ®çš„æå–ï¼‰ã€‚<br><br>æŒ‰ç…§æˆ‘ä¸Šé¢çš„æè¿°ï¼Œç¡®å®æ²¡æœ‰å‰ä¸¤è¡¨å…ˆjoinå¾—ç»“æœé›†ï¼Œç„¶åå†joinç¬¬ä¸‰å¼ è¡¨çš„è¿‡ç¨‹ã€‚<br>ä¸çŸ¥é“æˆ‘ä¸Šé¢çš„æè¿°çš„æµç¨‹å¯¹ä¸å¯¹ï¼Ÿï¼ˆæˆ‘ä¸ªäººè§‰å¾—ï¼Œå°†innodbçš„å¤„ç†å’Œserverç«¯çš„å¤„ç†åˆ†éš”æ¸…æ™°ï¼Œå¯¹äºsqlè¯­å¥çš„ç†è§£ï¼Œä¼šé€å½»å¾ˆå¤šï¼‰ <br></div>
                            <span class="time">2019-02-02 13:18</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ–°å¹´å¿«ä¹ï¼Œåˆ†æå¾—å¾ˆå¥½ã€‚<br><br>å¯ä»¥å†è¡¥å……ä¸€å¥ï¼Œä¼šæ›´å¥½ç†è§£ä½ è¯´çš„è¿™ä¸ªè¿‡ç¨‹ ï¼š<br>  å¦‚æœé‡‡ç”¨BKAè¿›è¡Œä¼˜åŒ–,æ¯å¤šä¸€ä¸ªjoinï¼Œå°±å¤šä¸€ä¸ªjoin_buffer</p>
                                <p class="reply-time">2019-02-02 16:59</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/ee/23/bfcfad58.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">LY</span>
                            </div>
                            <div class="bd">åˆšåˆšå‡Œä¹±äº†çš„é‚£ä¸ªé—®é¢˜ï¼Œç»explainéªŒè¯ï¼Œexplain SELECT a.* FROM sys_xxtx a JOIN baq_ryxx r ON a.ryid = r.ID WHERE a.dwbh = &#39;7E0A13A14101D0A8E0430A0F23BCD0A8&#39; ORDER BY txsj DESC LIMIT 0,20;<br>ä½¿ç”¨çš„ç´¢å¼•æ˜¯txsj ï¼›<br>explain SELECT a.* FROM sys_xxtx a JOIN baq_ryxx r ON a.ryid = r.ID WHERE a.dwbh = &#39;7E0A13A14101D0A8E0430A0F23BCD0A8&#39; ORDER BY txsj DESC LIMIT 5000,20;ä½¿ç”¨çš„ç´¢å¼•æ˜¯dwbh ï¼›<br>ç„¶åå›å¿†èµ·äº†ç¬¬10å¼ ï¼šMySQLä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šé€‰é”™ç´¢å¼•ï¼Ÿ<br>ä½†æ˜¯ä»æ‰«æè¡Œæ•°ã€æ˜¯å¦ä½¿ç”¨æ’åºç­‰æ¥çœ‹åœ¨ LIMIT 5000,20æ—¶å€™ä¹Ÿåº”è¯¥ä¼˜é€‰txsj ?å¯æ˜¯è¿™ä¸ªæ—¶å€™é€‰æ‹©çš„ç´¢å¼•æ˜¯dwbh, æŸ¥è¯¢æ—¶é—´ä¹Ÿå¤§å¤§ç¼©çŸ­ <br></div>
                            <span class="time">2019-02-01 16:30</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å—¯ï¼Œè¿™ä¸ªè·Ÿæˆ‘ä»¬ç¬¬åç¯‡é‚£ä¸ªä¾‹å­æŒºåƒçš„<br><br>æˆ‘ä»¬æŠŠlimit 1 æ”¹æˆlimit 100çš„æ—¶å€™ï¼ŒMySQLè®¤ä¸ºï¼Œè¦æ‰«æåˆ°â€œ100è¡Œé‚£ä¹ˆå¤šâ€ï¼Œ<br>ä½ è¿™é‡Œæ˜¯limit 5000ï¼Œ200ï¼Œ è¿™ä¸ª5000ä¼šè®©ä¼˜åŒ–å™¨è®¤ä¸ºï¼Œé€‰txsjä¼šè¦æ‰«â€œå¾ˆå¤šè¡Œï¼Œå¯èƒ½å¾ˆä¹…â€<br><br>è¿™ä¸ªç¡®å®æ˜¯ä¼˜åŒ–å™¨è¿˜ä¸å¤Ÿå®Œå–„çš„åœ°æ–¹ï¼Œæœ‰æ—¶å€™ä¸å¾—ä¸ç”¨force index~</p>
                                <p class="reply-time">2019-02-02 00:49</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/ee/23/bfcfad58.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">LY</span>
                            </div>
                            <div class="bd">order by cjsj desc limit 0,20 explain  Extraåªæ˜¯æ˜¾ç¤º Using where ï¼Œæ‰§è¡Œæ—¶é—´ 7ç§’é’Ÿ<br>order by cjsj desc limit 5000,20 explain  Extraåªæ˜¯æ˜¾ç¤º Using index condition; Using where; Using filesort,  æ‰§è¡Œæ—¶é—´ 0.1 ç§’<br>æœ‰äº›è®¸çš„å‡Œä¹±äº†@^^@ <br></div>
                            <span class="time">2019-02-01 13:32</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¿™æ­£å¸¸çš„ï¼Œä¸€ç§å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š <br>   Using where å°±æ˜¯é¡ºåºæ‰«ï¼Œä½†æ˜¯è¿™ä¸ªä¸Šè¦æ‰«å¾ˆä¹…æ‰èƒ½æ‰«åˆ°æ»¡è¶³æ¡ä»¶çš„20ä¸ªè®°å½•ï¼›<br>   è™½ç„¶æœ‰filesortï¼Œä½†æ˜¯å¦‚æœå‚ä¸æ’åºçš„è¡Œæ•°å°‘ï¼Œå¯èƒ½é€Ÿåº¦å°±æ›´å¿«ï¼Œè€Œä¸”limit æœ‰å †æ’åºä¼˜åŒ–å“¦</p>
                                <p class="reply-time">2019-02-01 16:12</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/18/07/c0a73a52.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ†¶æµ·æ‹¾è²</span>
                            </div>
                            <div class="bd">èŠ‚åå¼€å·¥å®œè¡¥è¯¾.<br><br>æŒ‰ç…§æ–‡ä¸­è¯´æ˜çš„MRRè®¾è®¡æ€è·¯, æ˜¯å¦å¯ä»¥åæ¨å‡º: è¢«é©±åŠ¨è¡¨ä½¿ç”¨éé€’å¢ä¸»é”®(æ¯”å¦‚UUIDä½œä¸ºä¸»é”®),å°±æ²¡æœ‰å¿…è¦å¼€å¯MRR? <br></div>
                            <span class="time">2019-02-13 11:43</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å¦‚æœæ˜¯ééšæœºçš„ä¸»é”®ï¼Œç¡®å®æ²¡å¿…è¦äº†ğŸ˜…<br><br>ä¼˜åŒ–ç¬¬ä¸€æ­¥è¿˜æ˜¯åº”è¯¥æŠŠä¸»é”®å¤„ç†ä¸€ä¸‹<br></p>
                                <p class="reply-time">2019-02-13 16:44</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¤©ç‹</span>
                            </div>
                            <div class="bd">BNLç®—æ³•ä¼˜åŒ–ï¼ŒBNLç®—æ³•ï¼Œå¦‚æœè¯»å–çš„æ˜¯å†·è¡¨ï¼Œè€Œä¸”é‡æ¯”è¾ƒå¤§ï¼Œå¾ªç¯è¯»å–ï¼Œç¬¬ä¸€æ¬¡æ•°æ®ä¼šè¿›å…¥oldåŒºåŸŸï¼Œå¦‚æœä¸€ç§’ä¹‹åæ²¡æœ‰è®¿é—®ï¼Œä¸ä¼šç§»åˆ°LRUå¤´éƒ¨ï¼Œå¤§è¡¨joinå¯¹ioå½±å“æŸ¥è¯¢å®Œå°±ç»“æŸäº†ï¼Œä½†æ˜¯buffer pooléœ€è¦å¤§é‡çš„æŸ¥è¯¢æŠŠå†·æ•°æ®å†²æ‰ã€‚BNLç®—æ³•æœ‰3ä¸ªé—®é¢˜ï¼Œ1 å¤šæ¬¡æ‰«æè¢«é©±åŠ¨è¡¨ï¼Œå ç”¨ç£ç›˜io 2 åˆ¤æ–­joinä¼šè€—è´¹å¤§é‡çš„cpuèµ„æº 3 ä¼šçƒ­æ•°æ®æ·˜æ±°ï¼Œå½±å“buffer poolçš„å‘½ä¸­ç‡ <br></div>
                            <span class="time">2019-02-13 09:19</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘</p>
                                <p class="reply-time">2019-02-13 17:11</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¤©ç‹</span>
                            </div>
                            <div class="bd">joinè¯­å¥çš„ä¼˜åŒ–ï¼ŒNLJç®—æ³•çš„ä¼˜åŒ–ï¼ŒMRRä¼˜åŒ–å™¨ä¼šåœ¨join_bufferè¿›è¡Œä¸»é”®çš„æ’åºï¼Œç„¶åå»ä¸»é”®ç´¢å¼•æ ‘ä¸Šä¸€ä¸ªä¸ªçš„æŸ¥æ‰¾ï¼Œå› ä¸ºæŒ‰ç…§ä¸»é”®é¡ºåºå»ä¸»é”®ç´¢å¼•æ ‘ä¸ŠæŸ¥æ‰¾ï¼Œæ€§èƒ½ä¼šæ¯”è¾ƒé«˜ï¼ŒMRRä¼˜åŒ–æ¥è¿‘é¡ºåºè¯»ï¼Œæ€§èƒ½ä¼šæ¯”è¾ƒé«˜ã€‚BKAç®—æ³•æ˜¯å¯¹NLJç®—æ³•çš„ä¼˜åŒ–ï¼Œä¸€æ¬¡å–å‡ºä¸€æ‰¹æ•°æ®çš„å­—æ®µåˆ°join_bufferä¸­ï¼Œç„¶åæ‰¹é‡joinï¼Œæ€§èƒ½ä¼šæ¯”è¾ƒå¥½ã€‚BKAç®—æ³•ä¾èµ–äºMRRï¼Œå› ä¸ºæ‰¹é‡joinæ‰¾åˆ°è¢«é©±åŠ¨è¡¨çš„éèšé›†ç´¢å¼•å­—æ®µé€šè¿‡MRRå»æŸ¥æ‰¾è¡Œæ•°æ® <br></div>
                            <span class="time">2019-02-13 08:54</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/e9/0b/53bf91d3.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">WL</span>
                            </div>
                            <div class="bd">è¯·æ•™è€å¸ˆä¸¤ä¸ªé—®é¢˜:<br>1. é€šè¿‡ä¸»é”®ç´¢å¼•æ‰¾åˆ°çš„æ•°æ®ä¼šä¼šä¸ä¼šå…ˆåœ¨å†…å­˜ä¸­æŸ¥è¯¢, å¦‚æœæ²¡æœ‰å†å»ç£ç›˜æŸ¥è¯¢?<br>2. ä¸ºä»€ä¹ˆåœ¨é€šè¿‡ä¸»é”®ç´¢å¼•æŸ¥è¯¢æ•°æ®æ—¶, ç¬¦åˆæ¡ä»¶çš„æ•°æ®ä»¥å•æ¡æ•°æ®çš„æ–¹å¼è¯»åˆ°å†…å­˜ä¸­è€Œä¸æ˜¯ä»¥ä¸€æ•´ä¸ªæ•°æ®é¡µçš„æ–¹å¼è¯»åˆ°å†…å­˜ä¸­?  <br></div>
                            <span class="time">2019-02-11 15:00</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1. é€šè¿‡æ™®é€šç´¢å¼•ä¹Ÿä¼šï¼ŒInnoDBçš„è®¿é—®æ¨¡å¼éƒ½æ˜¯å…ˆå†…å­˜ï¼Œä¸åœ¨å†…å­˜ä¸­ï¼Œæ‰åˆ°ç£ç›˜æ‰¾ï¼›<br>2. æ˜¯ä»¥æ•°æ®é¡µçš„æ–¹å¼è¯»åˆ°å†…å­˜çš„ï¼Œç„¶ååœ¨ä»å†…å­˜çš„è¿™ä¸ªæ•°æ®é¡µï¼ˆé»˜è®¤16kï¼‰é‡Œé¢æ‰¾åˆ°æ•°æ®ã€‚</p>
                                <p class="reply-time">2019-02-11 16:30</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/d1/7c/4639f22c.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">éƒ­å¥</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæ–°å¹´å¿«ä¹ï¼ï¼çœ‹åˆ°æ‚¨ç»™æˆ‘æé—®çš„å›ç­”ï¼Œç‰¹åˆ«æœŸå¾…æ‚¨ä¹‹åçš„ç­”ç–‘ï¼Œå› ä¸ºdbaæ€•æˆ‘ä»¬æŸ¥è¯¢æ•°æ®åº“æ—¶è¿æ¥æ—¶é—´è¿‡é•¿ï¼Œå½±å“çº¿ä¸Šå®é™…è¿è¡Œã€‚æ‰€ä»¥å°±å¼€å‘å‡ºä¸€ä¸ªç½‘é¡µï¼Œè®©æˆ‘ä»¬è¿›è¡ŒæŸ¥è¯¢ï¼Œä½†æ˜¯è¶…è¿‡å‡ ç§’(å…·ä½“ä¸çŸ¥é“ï¼ŒæŸ¥è¯¢ä¸€ä¸ª200wçš„æ•°æ®ï¼Œæ¡ä»¶æ²¡æœ‰åŠ ç´¢å¼•æœ‰æ—¶å€™éƒ½ä¼š)å°±ä¼šè¿”å›time outï¼Œæ‰€ä»¥å½“æŸ¥è¯¢å¤§è¡¨å¹¶joinçš„æ—¶å€™ï¼Œå°±ä¼šå¾ˆåƒåŠ›ï¼æƒ³æ³•è®¾æ³•çš„ç¼©å°å•ä½ï¼Œä¸€èˆ¬æˆ‘ä»¬éƒ½ä¸ä¼šä¸ºcreateTimeå»ºä¸€ä¸ªç´¢å¼•ï¼Œæ‰€ä»¥åœ¨æ ¹æ®æ—¶é—´ç¼©å°èŒƒå›´çš„æ—¶å€™æœ‰æ—¶å€™ä¹Ÿå¹¶ä¸æ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚æˆ‘ä»¬çº¿ä¸Šåšç»Ÿè®¡sqlçš„æ—¶å€™ï¼Œå› ä¸ºæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œç­›é€‰æ¡ä»¶ä¹Ÿæ¯”è¾ƒå¤šï¼Œä¸€ä¸ªsqlå¯èƒ½åœ¨0.4så¤šï¼Œè¿™å·²ç»æ˜¯å±äºæ…¢sqläº†ã€‚æ„Ÿè°¢è€å¸ˆå¯¹æˆ‘æé—®çš„å›ç­”ï¼ï¼ <br></div>
                            <span class="time">2019-02-09 21:14</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å—¯ï¼Œé¦–å…ˆDBAå¼€å‘è¿™ä¸ªç•Œé¢å·¥å…·è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œè¿™æ ·å¯ä»¥æ§åˆ¶è¾“å…¥çš„è¯­å¥ï¼Œé¿å…äººå·¥æŸ¥è¯¢å¯¹åº“é€ æˆå¤ªå¤§çš„å½±å“ã€‚<br><br>å¦‚æœè¿™ç±»æŸ¥è¯¢æ¯”è¾ƒå¤šï¼Œå¹¶ä¸”äººå·¥æŸ¥è¯¢çš„æ¡ä»¶å¾ˆå¤æ‚ï¼Œç»å¸¸å®¹æ˜“ç”¨ä¸ä¸Šç´¢å¼•çš„è¯ï¼Œ åœ¨createTimeåˆ›å»ºç´¢å¼•è¿˜æ˜¯æŒºæœ‰å¿…è¦çš„ã€‚ã€‚</p>
                                <p class="reply-time">2019-02-11 16:34</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/56/8c/a8317e23.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">ç£Š</span>
                            </div>
                            <div class="bd">ä¸€ç›´å¯¹å¤šè¡¨çš„joinæœ‰äº›è¿·æƒ‘ï¼Œå¸Œæœ›è€å¸ˆåé¢ä¸“é—¨æŠŠè¿™å—ç»™è®²çš„é€å½»äº› <br></div>
                            <span class="time">2019-02-03 10:40</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¿™ä¸€æœŸ45ç¯‡ joinå·®ä¸å¤šå°±è®²è¿™äº›äº†ğŸ˜†<br><br>æœ‰é—®é¢˜åœ¨è¯„è®ºåŒºæå‡ºæ¥å“ˆ</p>
                                <p class="reply-time">2019-02-03 12:06</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">bluefantasy3</span>
                            </div>
                            <div class="bd">è¯·æ•™è€å¸ˆä¸€ä¸ªé—®é¢˜ï¼šinnodbçš„Buffer Poolçš„å†…å­˜æ˜¯innodbè‡ªå·±ç®¡ç†è¿˜æ˜¯ä½¿ç”¨OSçš„page cache? æˆ‘ç†è§£åº”è¯¥æ˜¯innodbè‡ªå·±ç®¡ç†ã€‚æˆ‘åœ¨å¦ä¸€ä¸ªè¯¾ç¨‹é‡Œçœ‹åˆ°å¦‚æœé¢‘ç¹åœ°æŠŠOSçš„&#47;proc&#47;sys&#47;vm&#47;drop_caches æ”¹æˆ 1ä¼šå½±å“MySQLçš„æ€§èƒ½ï¼Œå¦‚æœbuffer poolæ˜¯MySQLè‡ªå·±ç®¡ç†ï¼Œåº”è¯¥ä¸å—è¿™ä¸ªå‚æ•°å½±å“å‘€ï¼Ÿè¯·è§£ç­”ã€‚ <br></div>
                            <span class="time">2019-02-02 17:05</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1. æ˜¯MySQL è‡ªå·±ç®¡ç†çš„<br>2. ä¸€èˆ¬åªæœ‰æ•°æ®æ–‡ä»¶æ˜¯o_directçš„ï¼Œredo log å’Œ binlog éƒ½æ˜¯æœ‰ç”¨åˆ°æ–‡ä»¶ç³»ç»Ÿçš„page cache, å› æ­¤å¤šå°‘æœ‰å½±å“çš„<br><br>å¥½é—®é¢˜ğŸ‘ğŸ¿ </p>
                                <p class="reply-time">2019-02-03 09:05</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/e5/39/951f89c8.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">ä¿¡ä¿¡</span>
                            </div>
                            <div class="bd">è€å¸ˆå¥½ï¼Œæœ‰ä¸¤ç‚¹ç–‘é—®è¯·è€å¸ˆè§£æƒ‘ï¼š<br>1ã€å›¾8ä¸Šé¢æåˆ°çš„å…³äºä¸´æ—¶è¡¨çš„ç¬¬ä¸‰å¥æ˜¯ä¸æ˜¯è¿˜æ˜¯ä½¿ç”¨straight_joinå¥½ä¸€äº›ï¼Ÿä¸ç„¶æœ‰å¯èƒ½temp_tè¢«é€‰ä¸ºé©±åŠ¨è¡¨ï¼Ÿ<br>2ã€å›¾8ä¸‹é¢æåˆ°joinè¿‡ç¨‹ä¸­åšäº†1000æ¬¡å¸¦ç´¢å¼•çš„æŸ¥è¯¢ï¼Œè¿™é‡Œçš„1000ä¹Ÿæ˜¯åœ¨æ‰“å¼€mrrçš„æƒ…å†µä¸‹çš„å—ï¼Ÿæ˜¯è¿›è¡Œäº†1000æ¬¡æ ‘æœç´¢ï¼Œè¿˜æ˜¯æ‰¾åˆ°ç¬¬ä¸€ä¸ªåï¼Œä¾æ¬¡æŒ¨ç€è¯»å‘¢ï¼Ÿ<br> <br></div>
                            <span class="time">2019-02-02 15:12</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1. å†™straight_joinèƒ½ç¡®å®šé¡ºåºï¼Œä¹Ÿå¯ä»¥çš„ï¼Œè¿™é‡Œå†™join ä¹Ÿokçš„<br><br>2. æ˜¯è¿›è¡Œäº†1000æ¬¡æ ‘æœç´¢<br></p>
                                <p class="reply-time">2019-02-02 16:57</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/11/18/8cee35f9.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">HuaMax</span>
                            </div>
                            <div class="bd">å‰æå‡è®¾ï¼št1.c&gt;=Xå¯ä»¥è®©t1æˆä¸ºå°è¡¨ã€‚åŒæ—¶æ‰“å¼€BKAå’ŒMRRã€‚<br>1ã€t1è¡¨åŠ ï¼ˆc,a)ç´¢å¼•ã€‚ç†ç”±ï¼šAã€t1.c&gt;=Xå¯ä»¥ä½¿ç”¨ç´¢å¼•ï¼›Bã€åŠ ä¸Šaçš„è”åˆç´¢å¼•ï¼Œjoin bufferé‡Œæ”¾å…¥çš„æ˜¯ç´¢å¼•ï¼ˆc,aï¼‰è€Œä¸æ˜¯å»ä¸»é”®è¡¨å–æ•´è¡Œï¼Œç”¨äºä¸è¡¨t2çš„t1.a = t2.açš„joinæŸ¥è¯¢ï¼Œä¸è¿‡è¿”å›SELECT * æœ€ç»ˆè¿˜æ˜¯éœ€è¦å›è¡¨ã€‚<br>2ã€t2è¡¨åŠ (a,b,c)ç´¢å¼•ã€‚ç†ç”±ï¼šAã€åŠ ä¸Šaé¿å…ä¸t1è¡¨joinæŸ¥è¯¢çš„BNLï¼›Bã€ç†ç”±åŒã€1-Bã€‘ï¼›Cã€åŠ ä¸Šcä¸ç”¨å›è¡¨åˆ¤æ–­t2.c&gt;=Yçš„ç­›é€‰æ¡ä»¶<br>3ã€t3è¡¨åŠ ï¼ˆb,cï¼‰ç´¢å¼•ã€‚ç†ç”±ï¼šAã€é¿å…ä¸t2è¡¨joinæŸ¥è¯¢çš„BNL;Cã€ç†ç”±åŒã€2-Cã€‘<br><br>é—®é¢˜ï¼š<br>1ã€ã€1-Bã€‘å’Œã€2-Bã€‘ç”±äºselect *è¦è¿”å›æ‰€æœ‰åˆ—æ•°æ®ï¼Œä¸æ•¢è‚¯å®šjoin bufferé‡Œæ˜¯å›è¡¨çš„æ•´è¡Œæ•°æ®è¿˜æ˜¯ç´¢å¼•ï¼ˆc,a)çš„æ•°æ®ï¼Œéœ€è¦è€å¸ˆè§£ç­”ä¸€ä¸‹ï¼›ä¸è¿‡å€¼å¾—è­¦æƒ•çš„æ˜¯ï¼Œè¿”å›çš„æ•°æ®åˆ—å¯¹sqlçš„æ‰§è¡Œç­–ç•¥æœ‰éå¸¸å¤§çš„å½±å“ã€‚<br>2ã€åœ¨æœ‰joinæŸ¥è¯¢æ—¶ï¼Œè¢«é©±åŠ¨è¡¨æ˜¯å…ˆåšjoinè¿æ¥æŸ¥è¯¢ï¼Œè¿˜æ˜¯å…ˆç­›é€‰æ•°æ®å†ä»ç­›é€‰åçš„ä¸´æ—¶è¡¨åšjoinè¿æ¥ï¼Ÿè¿™å°†å½±å“ä¸Šè¿°çš„ç†ç”±ã€2-Cã€‘å’Œã€3-Cã€‘<br><br>ä½¿ç”¨straight_joinå¼ºåˆ¶æŒ‡å®šé©±åŠ¨è¡¨ï¼Œæˆ‘ä¼šæ”¹å†™æˆè¿™æ ·:select * from t2 STRAIGHT_JOIN t1 on(t1.a=t2.a) STRAIGHT_JOIN t3 on (t2.b=t3.b)  where t1.c&gt;=X and t2.c&gt;=Y and t3.c&gt;=Z;<br>è€ƒè™‘å› ç´ åŒ…æ‹¬ï¼š<br>1ã€é©±åŠ¨è¡¨ä½¿ç”¨è¿‡æ»¤æ¡ä»¶ç­›é€‰åçš„æ•°æ®é‡ï¼Œä½¿å…¶æˆä¸ºå°è¡¨ï¼Œä¸Šé¢çš„æ”¹å†™ä¹Ÿæ˜¯åŸºäºt2æ˜¯å°è¡¨<br>2ã€å› ä¸ºt2æ˜¯è·Ÿt1,t3éƒ½æœ‰å…³è”æŸ¥è¯¢çš„ï¼Œè¿™æ ·çš„è¯æˆ‘çŒœæµ‹å¯¹t1,t3çš„æŸ¥è¯¢æ˜¯ä¸æ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œè€Œå¦‚æœä½¿ç”¨t1,t3ä½œä¸ºä¸»è¡¨çš„è¯ï¼Œæ˜¯å¦ä¼šå…ˆè·Ÿt2ç”Ÿæˆä¸­é—´è¡¨ï¼Œæ˜¯ä¸ªä¸²è¡Œçš„è¿‡ç¨‹ï¼Ÿ<br>3ã€éœ€è¦ç»™t1åŠ ï¼ˆa,c)ç´¢å¼•ï¼Œç»™t2åŠ ï¼ˆc,a,bï¼‰ç´¢å¼•ã€‚ <br></div>
                            <span class="time">2019-02-02 11:42</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘ å¾ˆæ·±å…¥çš„æ€è€ƒå“ˆ<br>1. select * ï¼Œæ‰€ä»¥æ”¾æ•´è¡Œï¼›ä½ è¯´å¾—å¯¹ï¼Œselect * ä¸æ˜¯å¥½ä¹ æƒ¯ï¼›<br>2. ç¬¬ä¸€æ¬¡joinåå°±ç­›é€‰ï¼›ç¬¬äºŒæ¬¡joinå†ç­›é€‰ï¼›<br>æ–°æ˜¥å¿«ä¹~</p>
                                <p class="reply-time">2019-02-04 17:03</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">åº“æ·˜æ·˜</span>
                            </div>
                            <div class="bd">set optimizer_switch=&#39;mrr=on,mrr_cost_based=off,batched_key_access=on&#39;;<br>create index idx_c on t2(c);<br>create index idx_a_c on t1(a,c);<br>create index idx_b_c on t3(b,c);<br>mysql&gt; explain select * from t2 <br>    -&gt; straight_join t1 on(t1.a=t2.a)<br>    -&gt; straight_join t3 on(t2.b=t3.b)   <br>    -&gt; where t1.c&gt; 800 and t2.c&gt;=600 and t3.c&gt;=500;<br>+----+-------------+-------+------------+---------------------------------------<br>| id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra +----------------------------------------<br>| 1 | SIMPLE | t2 | NULL | range | idx_c | idx_c | 5 | NULL | 401 | 100.00 | Using index condition; Using where; Using MRR |<br>| 1 | SIMPLE | t1 | NULL | ref | idx_a_c | idx_a_c | 5 | test.t2.a | 1 | 33.33 | Using index condition; Using join buffer (Batched Key Access) |<br>| 1 | SIMPLE | t3 | NULL | ref | idx_b_c | idx_b_c | 5 | test.t2.b | 1 | 33.33 | Using index condition; Using join buffer (Batched Key Access) |<br>+----+-------------+-------+------------+-----+---------------------------------------<br>3 rows in set, 1 warning (0.00 sec)<br>ä»¥è‡ªå·±ç†è§£å¦‚ä¸‹ï¼Œæœ‰é—®é¢˜è¯·è€å¸ˆèƒ½å¤ŸæŒ‡å‡º<br>1.æ ¹æ®æŸ¥è¯¢å› æ˜¯select * è‚¯å®šå›è¡¨çš„ï¼Œå…¶ä¸­åœ¨è¡¨t2åˆ›å»ºç´¢å¼•idx_c,ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨ICP,MRRï¼Œå¦‚æœcå­—æ®µé‡å¤ç‡é«˜æˆ–å–å€¼è¡Œæ•°å¤šï¼Œå¯ä»¥è€ƒè™‘ä¸å»ºç´¢å¼•<br>2.å·²t2 ä½œä¸ºé©±åŠ¨è¡¨ï¼Œä¸€æ–¹é¢è€ƒè™‘å…¶ä»–ä¸¤è¡¨éƒ½æœ‰å…³è”,t2è¡¨æ”¾å…¥join bufferåå…³è”t1åï¼Œå†å…³è”t2 å¾—å‡ºç»“æœ å†å„å›t2,t3è¡¨å–å‡º å¾—åˆ°ç»“æœé›†ï¼ˆä¹‹å‰ç†è§£éƒ½æ˜¯t1å’Œt2joinå¾—ç»“æœé›†å†ä¸t3joinï¼Œæœ¬æ¬¡ç†è§£å¤ªç¡®å®šï¼‰<br>3.t2ã€t3è¡¨å»ºç«‹è”åˆæŸ¥è¯¢ç›®çš„èƒ½å¤Ÿä½¿ç”¨ICP <br></div>
                            <span class="time">2019-02-01 16:42</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘<br><br>BKAæ˜¯ä»Index Nexted-Loop join ä¼˜åŒ–è€Œæ¥çš„ï¼Œå¹¶ä¸æ˜¯â€œt1å’Œt2joinå¾—ç»“æœé›†å†ä¸t3joinâ€ï¼Œè€Œæ˜¯ç›´æ¥åµŒå¥—å¾ªç¯æ‰§è¡Œä¸‹å»ã€‚<br><br>è¿™ä¸ªæ•ˆæœç›¸å½“ä¸é”™äº†ï¼ŒMRRï¼ŒBKAéƒ½ç”¨ä¸Š</p>
                                <p class="reply-time">2019-02-02 00:51</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/dd/ac/f40bbd15.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">dzkk</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œå¯¹äºå…³è”æŸ¥è¯¢ï¼ˆinner joinï¼‰ï¼Œä¸ªäººæœ‰å‡ ç‚¹ç†è§£ï¼Œè¯·å¸®åŠ©å®¡æ ¸æ˜¯å¦æ­£ç¡®ï¼Œè°¢äº†ã€‚<br>æ­£ç¡®é€‰æ‹©ï¼š<br>    ç»“æœé›†å°çš„ä¸ºé©±åŠ¨è¡¨ï¼Œä¸”è¢«é©±åŠ¨è¡¨æœ‰ç´¢å¼•<br>æœªçŸ¥æ•ˆæœé€‰æ‹©ï¼š<br>    1ï¼‰ç»“æœé›†å°çš„ä¸ºé©±åŠ¨è¡¨ï¼Œä½†æ˜¯è¢«é©±åŠ¨è¡¨æ²¡æœ‰ç´¢å¼•<br>    2ï¼‰ç»“æœé›†å¤§çš„ä¸ºé©±åŠ¨è¡¨ï¼Œä½†æ˜¯è¢«é©±åŠ¨è¡¨æœ‰ç´¢å¼•<br>æœ€å·®é€‰æ‹©ï¼š<br>    ç»“æœé›†å¤§çš„ä¸ºé©±åŠ¨è¡¨ï¼Œä¸”è¢«é©±åŠ¨è¡¨æ²¡æœ‰ç´¢å¼•<br> <br></div>
                            <span class="time">2019-02-01 15:51</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æœªçŸ¥æ•ˆæœé€‰æ‹© æ˜¯å•¥æ„æ€^_^</p>
                                <p class="reply-time">2019-02-02 00:36</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/03/f7/3a493bec.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è€æ¨åŒå¿—</span>
                            </div>
                            <div class="bd">æˆ‘å‡†å¤‡ç»™<br>t1å¢åŠ ç´¢å¼•c<br>t2å¢åŠ ç»„åˆç´¢å¼•b,c<br>t3å¢åŠ ç»„åˆç´¢å¼•b,c<br>select * from t1 straight_join t2 on(t1.a=t2.a)  straight_join  t3 on (t2.b=t3.b) where t1.c&gt;=X and t2.c&gt;=Y and t3.c&gt;=Z;<br><br>å¦å¤–æˆ‘è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œå¼€ç¯‡æåˆ°çš„è¿™å¥sql select * from t1 where a&gt;=1 and a&lt;=100;<br>aæ˜¯ç´¢å¼•åˆ—ï¼Œå¦‚æœè¿™å¥ç´¢å¼•æœ‰order by aï¼Œä¸ä½¿ç”¨MRR ä¼˜åŒ–ï¼ŒæŸ¥è¯¢å‡ºæ¥å°±æ˜¯æŒ‰aæ’åºçš„ï¼Œä½¿ç”¨äº†mrrä¼˜åŒ–ï¼Œæ˜¯ä¸æ˜¯è¦é¢å¤–æ’åº<br><br> <br></div>
                            <span class="time">2019-02-01 15:36</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å¯¹ï¼Œå¥½é—®é¢˜ï¼Œç”¨äº†order byå°±ä¸ç”¨MRRäº†</p>
                                <p class="reply-time">2019-02-02 00:37</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/0c/48/ba59d28d.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">poppy</span>
                            </div>
                            <div class="bd">select * from t1 join t2 on(t1.a=t2.a) join t3 on (t2.b=t3.b) where t1.c&gt;=X and t2.c&gt;=Y and t3.c&gt;=Z;<br>è€å¸ˆï¼Œæˆ‘çš„ç†è§£æ˜¯çœŸæ­£åšjoinçš„ä¸‰å¼ è¡¨çš„å¤§å°å®é™…ä¸Šæ˜¯t1.c&gt;=Xã€t2.c&gt;=Yã€t3.c&gt;=Zå¯¹åº”æ»¡è¶³æ¡ä»¶çš„è¡Œæ•°ï¼Œä¸ºäº†æ–¹ä¾¿å¿«é€Ÿå®šä½åˆ°æ»¡è¶³æ¡ä»¶çš„æ•°æ®ï¼Œt1ã€t2å’Œt3çš„cå­—æ®µæœ€å¥½éƒ½å»ºç´¢å¼•ã€‚å¯¹äºjoinæ“ä½œï¼ŒæŒ‰é“ç†mysqlåº”è¯¥ä¼šä¼˜å…ˆé€‰æ‹©joinä¹‹åæ•°é‡æ¯”è¾ƒå°‘çš„ä¸¤å¼ è¡¨å…ˆæ¥è¿›è¡Œjoinæ“ä½œï¼Œä¾‹å¦‚æ»¡è¶³t1.a=t2.açš„è¡Œæ•°å°äºæ»¡è¶³t2.b=t3.bçš„è¡Œæ•°ï¼Œé‚£ä¹ˆå°±ä¼šä¼˜å…ˆå°†t1å’Œt2è¿›è¡Œjoinï¼Œé€‰æ‹©t1.c&gt;=Xã€t2.c&gt;=Yä¸­è¡Œæ•°å°‘çš„è¡¨ä½œä¸ºé©±åŠ¨è¡¨ï¼Œå¦å¤–ä¸€å¼ ä½œä¸ºè¢«é©±åŠ¨è¡¨ï¼Œåœ¨è¢«é©±åŠ¨è¡¨çš„açš„å­—æ®µä¸Šå»ºç«‹ç´¢å¼•ï¼Œè¿™æ ·å°±å®Œæˆäº†t1å’Œt2çš„joinæ“ä½œå¹¶æŠŠç»“æœæ”¾å…¥join_bufferå‡†å¤‡ä¸t3è¿›è¡Œjoinæ“ä½œï¼Œåˆ™åœ¨ä½œä¸ºè¢«é©±åŠ¨è¡¨çš„t3çš„bå­—æ®µä¸Šå»ºç«‹ç´¢å¼•ã€‚ä¸çŸ¥é“ä¸¾çš„è¿™ä¸ªä¾‹å­åˆ†æå¾—æ˜¯å¦æ­£ç¡®ï¼Œä¸»è¦æ˜¯è¿™é‡Œä¸çŸ¥é“t1ã€t2ã€t3ä¸‰å¼ è¡¨çš„æ•°æ®é‡ï¼Œä»¥åŠæ»¡è¶³t1.c&gt;=X ï¼Œt2.c&gt;=Y ï¼Œt3.c&gt;=Zçš„æ•°æ®é‡ï¼Œè¿˜æœ‰å„ä¸ªå­—æ®µçš„åŒºåˆ†åº¦å¦‚ä½•ï¼Œæ˜¯å¦é€‚åˆå»ºç«‹ç´¢å¼•ç­‰ã€‚ <br></div>
                            <span class="time">2019-02-01 15:24</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å—¯ è¿™ä¸ªé—®é¢˜å°±æ˜¯ç•™ç»™å¤§å®¶è‡ªå·±è®¾å®šæ¡ä»¶ç„¶ååˆ†æçš„ï¼Œåˆ†æå¾—ä¸é”™å“¦</p>
                                <p class="reply-time">2019-02-02 00:52</p>
                            </div>
                            
                        </div>
                    </li>
                    


                </ul>
            </div>
        </div>
    </div>
</div>
</body>
</html>