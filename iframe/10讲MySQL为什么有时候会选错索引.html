<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <style type="text/css">

#watermark {

  position: relative;
  overflow: hidden;
}

#watermark .x {
  position: absolute;
  top: 800;
  left: 400;
  color: #3300ff;
  font-size: 50px;
  pointer-events: none;
  opacity:0.3;
  filter:Alpha(opacity=50);
  
  
}
    </style>


    <style type="text/css">
 html{color:#333;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;text-rendering:optimizelegibility;font-family:Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif}html.borderbox *,html.borderbox :after,html.borderbox :before{box-sizing:border-box}article,aside,blockquote,body,button,code,dd,details,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hr,input,legend,li,menu,nav,ol,p,pre,section,td,textarea,th,ul{margin:0;padding:0}article,aside,details,figcaption,figure,footer,header,menu,nav,section{display:block}audio,canvas,video{display:inline-block}body,button,input,select,textarea{font:300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}table{border-collapse:collapse;border-spacing:0}fieldset,img{border:0}blockquote{position:relative;color:#999;font-weight:400;border-left:1px solid #1abc9c;padding-left:1em;margin:1em 3em 1em 2em}@media only screen and (max-width:640px){blockquote{margin:1em 0}}abbr,acronym{border-bottom:1px dotted;font-variant:normal}abbr{cursor:help}del{text-decoration:line-through}address,caption,cite,code,dfn,em,th,var{font-style:normal;font-weight:400}ol,ul{list-style:none}caption,th{text-align:left}q:after,q:before{content:""}sub,sup{font-size:75%;line-height:0;position:relative}:root sub,:root sup{vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}a{color:#1abc9c}a:hover{text-decoration:underline}.typo a{border-bottom:1px solid #1abc9c}.typo a:hover{border-bottom-color:#555;color:#555}.typo a:hover,a,ins{text-decoration:none}.typo-u,u{text-decoration:underline}mark{background:#fffdd1;border-bottom:1px solid #ffedce;padding:2px;margin:0 5px}code,pre,pre tt{font-family:Courier,Courier New,monospace}pre{background:hsla(0,0%,97%,.7);border:1px solid #ddd;padding:1em 1.5em;display:block;-webkit-overflow-scrolling:touch}hr{border:none;border-bottom:1px solid #cfcfcf;margin-bottom:.8em;height:10px}.typo-small,figcaption,small{font-size:.9em;color:#888}b,strong{font-weight:700;color:#000}[draggable]{cursor:move}.clearfix:after,.clearfix:before{content:"";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.textwrap,.textwrap td,.textwrap th{word-wrap:break-word;word-break:break-all}.textwrap-table{table-layout:fixed}.serif{font-family:Palatino,Optima,Georgia,serif}.typo-dl,.typo-form,.typo-hr,.typo-ol,.typo-p,.typo-pre,.typo-table,.typo-ul,.typo dl,.typo form,.typo hr,.typo ol,.typo p,.typo pre,.typo table,.typo ul,blockquote{margin-bottom:1rem}h1,h2,h3,h4,h5,h6{font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;line-height:1.35}.typo-h1,.typo-h2,.typo-h3,.typo-h4,.typo-h5,.typo-h6,.typo h1,.typo h2,.typo h3,.typo h4,.typo h5,.typo h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}.typo-h1,.typo h1{font-size:2em}.typo-h2,.typo h2{font-size:1.8em}.typo-h3,.typo h3{font-size:1.6em}.typo-h4,.typo h4{font-size:1.4em}.typo-h5,.typo-h6,.typo h5,.typo h6{font-size:1.2em}.typo-ul,.typo ul{margin-left:1.3em;list-style:disc}.typo-ol,.typo ol{list-style:decimal;margin-left:1.9em}.typo-ol ol,.typo-ol ul,.typo-ul ol,.typo-ul ul,.typo li ol,.typo li ul{margin-bottom:.8em;margin-left:2em}.typo-ol ul,.typo-ul ul,.typo li ul{list-style:circle}.typo-table td,.typo-table th,.typo table caption,.typo table td,.typo table th{border:1px solid #ddd;padding:.5em 1em;color:#666}.typo-table th,.typo table th{background:#fbfbfb}.typo-table thead th,.typo table thead th{background:hsla(0,0%,95%,.7)}.typo table caption{border-bottom:none}.typo-input,.typo-textarea{-webkit-appearance:none;border-radius:0}.typo-em,.typo em,caption,legend{color:#000;font-weight:inherit}.typo-em{position:relative}.typo-em:after{position:absolute;top:.65em;left:0;width:100%;overflow:hidden;white-space:nowrap;content:"\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"}.typo img{max-width:100%}.common-content{font-weight:400;color:#353535;line-height:1.75rem;white-space:normal;word-break:normal;font-size:1rem}.common-content img{display:block;max-width:100%;background-color:#eee}.common-content audio,.common-content video{width:100%;background-color:#eee}.common-content center,.common-content font{margin-top:1rem;display:inline-block}.common-content center{width:100%}.common-content pre{margin-top:1rem;padding-left:0;padding-right:0;position:relative;overflow:hidden}.common-content pre code{font-size:.8rem;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;display:block;width:100%;box-sizing:border-box;padding-left:1rem;padding-right:1rem;overflow-x:auto}.common-content hr{border:none;margin-top:1.5rem;margin-bottom:1.5rem;border-top:1px solid #f5f5f5;height:1px;background:none}.common-content b,.common-content h1,.common-content h2,.common-content h3,.common-content h4,.common-content h5,.common-content strong{font-weight:700}.common-content h1,.common-content h2{font-size:1.125rem;margin-bottom:.45rem}.common-content h3,.common-content h4,.common-content h5{font-size:1rem;margin-bottom:.45rem}.common-content p{font-weight:400;color:#353535;margin-top:.15rem}.common-content .orange{color:#ff5a05}.common-content .reference{font-size:1rem;color:#888}.custom-rich-content h1{margin-top:0;font-weight:400;font-size:15.25px;border-bottom:1px solid #eee;line-height:2.8}.custom-rich-content li,.custom-rich-content p{font-size:14px;color:#888;line-height:1.6}table.hljs-ln{margin-bottom:0;border-spacing:0;border-collapse:collapse}table.hljs-ln,table.hljs-ln tbody,table.hljs-ln td,table.hljs-ln tr{box-sizing:border-box}table.hljs-ln td{padding:0;border:0}table.hljs-ln td.hljs-ln-numbers{min-width:15px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;cursor:pointer;user-select:none}table.hljs-ln td.hljs-ln-code,table.hljs-ln td.hljs-ln-numbers{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;line-height:20px;vertical-align:top}table.hljs-ln td.hljs-ln-code{position:relative;padding-right:10px;padding-left:10px;overflow:visible;color:#24292e;word-wrap:normal;white-space:pre}video::-webkit-media-controls{overflow:hidden!important}video::-webkit-media-controls-enclosure{width:calc(100% + 32px);margin-left:auto}.button-cancel{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel,.button-primary{-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary{color:#fff;background-color:#ff5a05;border-radius:3px}@font-face{font-family:iconfont;src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot);src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.woff) format("woff"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.ttf) format("truetype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.svg#iconfont) format("svg")}@font-face{font-family:player-font;src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot);src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.woff) format("woff"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.ttf) format("truetype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.svg#player-font) format("svg")}.iconfont{font-family:iconfont!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;-moz-osx-font-smoothing:grayscale}html{background:#fff;min-height:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{width:100%}body.fixed{overflow:hidden;position:fixed;width:100vw;height:100vh}i{font-style:normal}a{word-wrap:break-word;-webkit-tap-highlight-color:rgba(0,0,0,0)}a:hover{text-decoration:none}.fade-enter-active,.fade-leave-active{transition:opacity .3s}.fade-enter,.fade-leave-to{opacity:0}.MathJax,.MathJax_CHTML,.MathJax_MathContainer,.MathJax_MathML,.MathJax_PHTML,.MathJax_PlainSource,.MathJax_SVG{outline:0}.ios-app-switch .js-audit{display:none}._loading_wrap_{position:fixed;width:100vw;height:100vh;top:50%;left:50%;transform:translate(-50%,-50%);z-index:999}._loading_div_class_,._loading_wrap_{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._loading_div_class_{word-wrap:break-word;padding:.5rem .75rem;text-align:center;z-index:9999;font-size:.6rem;max-width:60%;color:#fff;border-radius:.25rem;-ms-flex-direction:column;flex-direction:column}._loading_div_class_ .message{color:#353535;font-size:16px;line-height:3}.spinner{animation:circle-rotator 1.4s linear infinite}.spinner *{line-height:0;box-sizing:border-box}@keyframes circle-rotator{0%{transform:rotate(0deg)}to{transform:rotate(270deg)}}.path{stroke-dasharray:187;stroke-dashoffset:0;transform-origin:center;animation:circle-dash 1.4s ease-in-out infinite,circle-colors 5.6s ease-in-out infinite}@keyframes circle-colors{0%{stroke:#ff5a05}to{stroke:#ff5a05}}@keyframes circle-dash{0%{stroke-dashoffset:187}50%{stroke-dashoffset:46.75;transform:rotate(135deg)}to{stroke-dashoffset:187;transform:rotate(450deg)}}.confirm-box-wrapper,.confirm-box-wrapper .mask{position:absolute;top:0;left:0;right:0;bottom:0}.confirm-box-wrapper .mask{background:rgba(0,0,0,.6)}.confirm-box-wrapper .confirm-box{position:fixed;top:50%;left:50%;width:267px;background:#fff;transform:translate(-50%,-50%);border-radius:7px}.confirm-box-wrapper .confirm-box .head{margin:0 18px;font-size:18px;text-align:center;line-height:65px;border-bottom:1px solid #d9d9d9}.confirm-box-wrapper .confirm-box .body{padding:18px;padding-bottom:0;color:#353535;font-size:12.5px;max-height:150px;overflow:auto}.confirm-box-wrapper .confirm-box .foot{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;padding:18px}.confirm-box-wrapper .confirm-box .foot .button-cancel{border:1px solid #d9d9d9}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}




    </style>
    <style type="text/css">
        .button-cancel[data-v-87ffcada]{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel[data-v-87ffcada],.button-primary[data-v-87ffcada]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary[data-v-87ffcada]{color:#fff;background-color:#ff5a05;border-radius:3px}.pd[data-v-87ffcada]{padding-left:1.375rem;padding-right:1.375rem}.article[data-v-87ffcada]{max-width:70rem;margin:0 auto}.article .article-unavailable[data-v-87ffcada]{color:#fa8919;font-size:15px;font-weight:600;line-height:24px;border-radius:5px;padding:12px;background-color:#f6f7fb;margin-top:20px}.article .article-unavailable .iconfont[data-v-87ffcada]{font-size:12px}.article .main[data-v-87ffcada]{padding:1.25rem 0;margin-bottom:52px}.article-title[data-v-87ffcada]{color:#353535;font-weight:400;line-height:1.65rem;font-size:1.34375rem}.article-info[data-v-87ffcada]{color:#888;font-size:.9375rem;margin-top:1.0625rem}.article-content[data-v-87ffcada]{margin-top:1.0625rem}.article-content.android video[data-v-87ffcada]::-webkit-media-controls-fullscreen-button{display:none}.copyright[data-v-87ffcada]{color:#b2b2b2;padding-bottom:20px;margin-top:20px;font-size:13px}.audio-player[data-v-87ffcada]{width:100%;margin:20px 0}.to-comment[data-v-87ffcada]{overflow:hidden;padding-top:10px;margin-bottom:-30px}.to-comment a.button-primary[data-v-87ffcada]{float:right;height:20px;font-size:12px;line-height:20px;padding:4px 8px;cursor:pointer}.article-comments[data-v-87ffcada]{margin-top:2rem}.article-comments h2[data-v-87ffcada]{text-align:center;color:#888;position:relative;z-index:1;margin-bottom:1rem}.article-comments h2[data-v-87ffcada]:before{border-top:1px dotted #888;content:"";position:absolute;top:56%;left:0;width:100%;z-index:-1}.article-comments h2 span[data-v-87ffcada]{font-size:15.25px;font-weight:400;padding:0 1rem;background:#fff;display:inline-block}.article-sub-bottom[data-v-87ffcada]{z-index:10;cursor:pointer}.switch-btns[data-v-87ffcada]{height:76px;cursor:pointer;padding-top:24px;padding-bottom:24px;border-bottom:10px solid #f6f7fb;position:relative}.switch-btns[data-v-87ffcada]:before{content:" ";height:1px;background:#e8e8e8;position:absolute;top:0;left:0;-webkit-box-sizing:border-box;box-sizing:border-box;left:1.375rem;right:1.375rem}.switch-btns .btn[data-v-87ffcada]{height:38px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.switch-btns .btn .tag[data-v-87ffcada]{-webkit-box-flex:0;-ms-flex:0 0 62px;flex:0 0 62px;text-align:center;color:#888;font-size:14px;border-radius:10px;height:22px;line-height:22px;background:#f6f7fb;font-weight:400}.switch-btns .btn .txt[data-v-87ffcada]{margin-left:10px;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:#888;font-size:15px;height:22px;line-height:22px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400}@media (max-width:769px){.article .breadcrumb[data-v-87ffcada]{padding-top:10px;padding-bottom:10px}}





    </style>

    <style type="text/css">
        .comment-item{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:1rem}.comment-item a{border-bottom:none}.comment-item .avatar{width:2.625rem;height:2.625rem;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}.comment-item .info{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.comment-item .info .hd{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .username{color:#888;font-size:15.25px;font-weight:400;line-height:1.2}.comment-item .info .hd .control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .control .btn-share{color:#888;font-size:.75rem;margin-right:1rem}.comment-item .info .hd .control .btn-praise{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:15.25px;text-decoration:none}.comment-item .info .hd .control .btn-praise i{color:#888;display:inline-block;font-size:.75rem;margin-right:.3rem;margin-top:-.01rem}.comment-item .info .hd .control .btn-praise i.on,.comment-item .info .hd .control .btn-praise span{color:#ff5a05}.comment-item .info .bd{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6}.comment-item .info .time{color:#888;font-size:9px;line-height:1}.comment-item .info .reply .reply-hd{font-size:15.25px}.comment-item .info .reply .reply-hd span{margin-left:-12px;color:#888;font-weight:400}.comment-item .info .reply .reply-hd i{color:#ff5a05;font-size:15.25px}.comment-item .info .reply .reply-content{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all}.comment-item .info .reply .reply-time{color:#888;font-size:9px}




    </style>
</head>
<body>
<div id="app">


    <div data-v-87ffcada="" class="article" id="watermark">
        <div data-v-87ffcada="" class="main main-app">
            <h1 data-v-87ffcada="" class="article-title pd">
                10è®²MySQLä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šé€‰é”™ç´¢å¼•
            </h1>
            <div data-v-87ffcada="" class="article-content typo common-content pd"><img data-v-87ffcada=""
                                                                                        src="https://static001.geekbang.org/resource/image/ca/ca/cae4d2e76c91c7ed6a8aa2fd30ed40ca.jpg">

                <div>
                    <audio controls="controls" height="100" width="100">
                        <source src="10è®²MySQLä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šé€‰é”™ç´¢å¼•.mp3" type="audio/mp3" />
                        <embed height="100" width="100" src="10è®²MySQLä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šé€‰é”™ç´¢å¼•.mp3" />
                    </audio>
                </div>
                <div data-v-87ffcada="" id="article-content" class="">
                    <div class="text">
                        <p>å‰é¢æˆ‘ä»¬ä»‹ç»è¿‡ç´¢å¼•ï¼Œä½ å·²ç»çŸ¥é“äº†åœ¨MySQLä¸­ä¸€å¼ è¡¨å…¶å®æ˜¯å¯ä»¥æ”¯æŒå¤šä¸ªç´¢å¼•çš„ã€‚ä½†æ˜¯ï¼Œä½ å†™SQLè¯­å¥çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰ä¸»åŠ¨æŒ‡å®šä½¿ç”¨å“ªä¸ªç´¢å¼•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨å“ªä¸ªç´¢å¼•æ˜¯ç”±MySQLæ¥ç¡®å®šçš„ã€‚</p><p>ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰ç¢°åˆ°è¿‡è¿™ç§æƒ…å†µï¼Œä¸€æ¡æœ¬æ¥å¯ä»¥æ‰§è¡Œå¾—å¾ˆå¿«çš„è¯­å¥ï¼Œå´ç”±äºMySQLé€‰é”™äº†ç´¢å¼•ï¼Œè€Œå¯¼è‡´æ‰§è¡Œé€Ÿåº¦å˜å¾—å¾ˆæ…¢ï¼Ÿ</p><p>æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€ä¸ªä¾‹å­å§ã€‚</p><p>æˆ‘ä»¬å…ˆå»ºä¸€ä¸ªç®€å•çš„è¡¨ï¼Œè¡¨é‡Œæœ‰aã€bä¸¤ä¸ªå­—æ®µï¼Œå¹¶åˆ†åˆ«å»ºä¸Šç´¢å¼•ï¼š</p><pre><code>CREATE TABLE `t` (
  `id` int(11) NOT NULL,
  `a` int(11) DEFAULT NULL,
  `b` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `a` (`a`),
  KEY `b` (`b`)
) ENGINE=InnoDBï¼›
</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬å¾€è¡¨tä¸­æ’å…¥10ä¸‡è¡Œè®°å½•ï¼Œå–å€¼æŒ‰æ•´æ•°é€’å¢ï¼Œå³ï¼š(1,1,1)ï¼Œ(2,2,2)ï¼Œ(3,3,3) ç›´åˆ°(100000,100000,100000)ã€‚</p><p>æˆ‘æ˜¯ç”¨å­˜å‚¨è¿‡ç¨‹æ¥æ’å…¥æ•°æ®çš„ï¼Œè¿™é‡Œæˆ‘è´´å‡ºæ¥æ–¹ä¾¿ä½ å¤ç°ï¼š</p><pre><code>delimiter ;;
create procedure idata()
begin
  declare i int;
  set i=1;
  while(i&lt;=100000)do
    insert into t values(i, i, i);
    set i=i+1;
  end while;
end;;
delimiter ;
call idata();
</code></pre><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ†æä¸€æ¡SQLè¯­å¥ï¼š</p><pre><code>mysql&gt; select * from t where a between 10000 and 20000;
</code></pre><p>ä½ ä¸€å®šä¼šè¯´ï¼Œè¿™ä¸ªè¯­å¥è¿˜ç”¨åˆ†æå—ï¼Œå¾ˆç®€å•å‘€ï¼Œaä¸Šæœ‰ç´¢å¼•ï¼Œè‚¯å®šæ˜¯è¦ä½¿ç”¨ç´¢å¼•açš„ã€‚</p><p>ä½ è¯´å¾—æ²¡é”™ï¼Œå›¾1æ˜¾ç¤ºçš„å°±æ˜¯ä½¿ç”¨explainå‘½ä»¤çœ‹åˆ°çš„è¿™æ¡è¯­å¥çš„æ‰§è¡Œæƒ…å†µã€‚</p><p><img src="https://static001.geekbang.org/resource/image/2c/e3/2cfce769551c6eac9bfbee0563d48fe3.png" alt=""></p><center><span class="reference">å›¾1 ä½¿ç”¨explainå‘½ä»¤æŸ¥çœ‹è¯­å¥æ‰§è¡Œæƒ…å†µ</span></center><p>ä»å›¾1çœ‹ä¸Šå»ï¼Œè¿™æ¡æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œä¹Ÿç¡®å®ç¬¦åˆé¢„æœŸï¼Œkeyè¿™ä¸ªå­—æ®µå€¼æ˜¯â€™aâ€™ï¼Œè¡¨ç¤ºä¼˜åŒ–å™¨é€‰æ‹©äº†ç´¢å¼•aã€‚</p><p>ä¸è¿‡åˆ«æ€¥ï¼Œè¿™ä¸ªæ¡ˆä¾‹ä¸ä¼šè¿™ä¹ˆç®€å•ã€‚åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½çš„åŒ…å«äº†10ä¸‡è¡Œæ•°æ®çš„è¡¨ä¸Šï¼Œæˆ‘ä»¬å†åšå¦‚ä¸‹æ“ä½œã€‚</p><!-- [[[read_end]]] --><p><img src="https://static001.geekbang.org/resource/image/1e/1e/1e5ba1c2934d3b2c0d96b210a27e1a1e.png" alt=""></p><center><span class="reference">å›¾2 session Aå’Œsession Bçš„æ‰§è¡Œæµç¨‹</span></center><p>è¿™é‡Œï¼Œsession Açš„æ“ä½œä½ å·²ç»å¾ˆç†Ÿæ‚‰äº†ï¼Œå®ƒå°±æ˜¯å¼€å¯äº†ä¸€ä¸ªäº‹åŠ¡ã€‚éšåï¼Œsession BæŠŠæ•°æ®éƒ½åˆ é™¤åï¼Œåˆè°ƒç”¨äº† idataè¿™ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼Œæ’å…¥äº†10ä¸‡è¡Œæ•°æ®ã€‚</p><p>è¿™æ—¶å€™ï¼Œsession Bçš„æŸ¥è¯¢è¯­å¥select * from t where a between 10000 and 20000å°±ä¸ä¼šå†é€‰æ‹©ç´¢å¼•aäº†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆslow logï¼‰æ¥æŸ¥çœ‹ä¸€ä¸‹å…·ä½“çš„æ‰§è¡Œæƒ…å†µã€‚</p><p>ä¸ºäº†è¯´æ˜ä¼˜åŒ–å™¨é€‰æ‹©çš„ç»“æœæ˜¯å¦æ­£ç¡®ï¼Œæˆ‘å¢åŠ äº†ä¸€ä¸ªå¯¹ç…§ï¼Œå³ï¼šä½¿ç”¨force index(a)æ¥è®©ä¼˜åŒ–å™¨å¼ºåˆ¶ä½¿ç”¨ç´¢å¼•aï¼ˆè¿™éƒ¨åˆ†å†…å®¹ï¼Œæˆ‘è¿˜ä¼šåœ¨è¿™ç¯‡æ–‡ç« çš„ååŠéƒ¨åˆ†ä¸­æåˆ°ï¼‰ã€‚</p><p>ä¸‹é¢çš„ä¸‰æ¡SQLè¯­å¥ï¼Œå°±æ˜¯è¿™ä¸ªå®éªŒè¿‡ç¨‹ã€‚</p><pre><code>set long_query_time=0;
select * from t where a between 10000 and 20000; /*Q1*/
select * from t force index(a) where a between 10000 and 20000;/*Q2*/
</code></pre><ul>
<li>ç¬¬ä¸€å¥ï¼Œæ˜¯å°†æ…¢æŸ¥è¯¢æ—¥å¿—çš„é˜ˆå€¼è®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºè¿™ä¸ªçº¿ç¨‹æ¥ä¸‹æ¥çš„è¯­å¥éƒ½ä¼šè¢«è®°å½•å…¥æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ï¼›</li>
<li>ç¬¬äºŒå¥ï¼ŒQ1æ˜¯session BåŸæ¥çš„æŸ¥è¯¢ï¼›</li>
<li>ç¬¬ä¸‰å¥ï¼ŒQ2æ˜¯åŠ äº†force index(a)æ¥å’Œsession BåŸæ¥çš„æŸ¥è¯¢è¯­å¥æ‰§è¡Œæƒ…å†µå¯¹æ¯”ã€‚</li>
</ul><p>å¦‚å›¾3æ‰€ç¤ºæ˜¯è¿™ä¸‰æ¡SQLè¯­å¥æ‰§è¡Œå®Œæˆåçš„æ…¢æŸ¥è¯¢æ—¥å¿—ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/7c/f6/7c58b9c71853b8bba1a8ad5e926de1f6.png" alt=""></p><center><span class="reference">å›¾3 slow logç»“æœ</span></center><p>å¯ä»¥çœ‹åˆ°ï¼ŒQ1æ‰«æäº†10ä¸‡è¡Œï¼Œæ˜¾ç„¶æ˜¯èµ°äº†å…¨è¡¨æ‰«æï¼Œæ‰§è¡Œæ—¶é—´æ˜¯40æ¯«ç§’ã€‚Q2æ‰«æäº†10001è¡Œï¼Œæ‰§è¡Œäº†21æ¯«ç§’ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨æ²¡æœ‰ä½¿ç”¨force indexçš„æ—¶å€™ï¼ŒMySQLç”¨é”™äº†ç´¢å¼•ï¼Œå¯¼è‡´äº†æ›´é•¿çš„æ‰§è¡Œæ—¶é—´ã€‚</p><p>è¿™ä¸ªä¾‹å­å¯¹åº”çš„æ˜¯æˆ‘ä»¬å¹³å¸¸ä¸æ–­åœ°åˆ é™¤å†å²æ•°æ®å’Œæ–°å¢æ•°æ®çš„åœºæ™¯ã€‚è¿™æ—¶ï¼ŒMySQLç«Ÿç„¶ä¼šé€‰é”™ç´¢å¼•ï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹å¥‡æ€ªå‘¢ï¼Ÿä»Šå¤©ï¼Œæˆ‘ä»¬å°±ä»è¿™ä¸ªå¥‡æ€ªçš„ç»“æœè¯´èµ·å§ã€‚</p><h1>ä¼˜åŒ–å™¨çš„é€»è¾‘</h1><p>åœ¨ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°±æåˆ°è¿‡ï¼Œé€‰æ‹©ç´¢å¼•æ˜¯ä¼˜åŒ–å™¨çš„å·¥ä½œã€‚</p><p>è€Œä¼˜åŒ–å™¨é€‰æ‹©ç´¢å¼•çš„ç›®çš„ï¼Œæ˜¯æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜çš„æ‰§è¡Œæ–¹æ¡ˆï¼Œå¹¶ç”¨æœ€å°çš„ä»£ä»·å»æ‰§è¡Œè¯­å¥ã€‚åœ¨æ•°æ®åº“é‡Œé¢ï¼Œæ‰«æè¡Œæ•°æ˜¯å½±å“æ‰§è¡Œä»£ä»·çš„å› ç´ ä¹‹ä¸€ã€‚æ‰«æçš„è¡Œæ•°è¶Šå°‘ï¼Œæ„å‘³ç€è®¿é—®ç£ç›˜æ•°æ®çš„æ¬¡æ•°è¶Šå°‘ï¼Œæ¶ˆè€—çš„CPUèµ„æºè¶Šå°‘ã€‚</p><p>å½“ç„¶ï¼Œæ‰«æè¡Œæ•°å¹¶ä¸æ˜¯å”¯ä¸€çš„åˆ¤æ–­æ ‡å‡†ï¼Œä¼˜åŒ–å™¨è¿˜ä¼šç»“åˆæ˜¯å¦ä½¿ç”¨ä¸´æ—¶è¡¨ã€æ˜¯å¦æ’åºç­‰å› ç´ è¿›è¡Œç»¼åˆåˆ¤æ–­ã€‚</p><p>æˆ‘ä»¬è¿™ä¸ªç®€å•çš„æŸ¥è¯¢è¯­å¥å¹¶æ²¡æœ‰æ¶‰åŠåˆ°ä¸´æ—¶è¡¨å’Œæ’åºï¼Œæ‰€ä»¥MySQLé€‰é”™ç´¢å¼•è‚¯å®šæ˜¯åœ¨åˆ¤æ–­æ‰«æè¡Œæ•°çš„æ—¶å€™å‡ºé—®é¢˜äº†ã€‚</p><p>é‚£ä¹ˆï¼Œé—®é¢˜å°±æ˜¯ï¼š<strong>æ‰«æè¡Œæ•°æ˜¯æ€ä¹ˆåˆ¤æ–­çš„ï¼Ÿ</strong></p><p>MySQLåœ¨çœŸæ­£å¼€å§‹æ‰§è¡Œè¯­å¥ä¹‹å‰ï¼Œå¹¶ä¸èƒ½ç²¾ç¡®åœ°çŸ¥é“æ»¡è¶³è¿™ä¸ªæ¡ä»¶çš„è®°å½•æœ‰å¤šå°‘æ¡ï¼Œè€Œåªèƒ½æ ¹æ®ç»Ÿè®¡ä¿¡æ¯æ¥ä¼°ç®—è®°å½•æ•°ã€‚</p><p>è¿™ä¸ªç»Ÿè®¡ä¿¡æ¯å°±æ˜¯ç´¢å¼•çš„â€œåŒºåˆ†åº¦â€ã€‚æ˜¾ç„¶ï¼Œä¸€ä¸ªç´¢å¼•ä¸Šä¸åŒçš„å€¼è¶Šå¤šï¼Œè¿™ä¸ªç´¢å¼•çš„åŒºåˆ†åº¦å°±è¶Šå¥½ã€‚è€Œä¸€ä¸ªç´¢å¼•ä¸Šä¸åŒçš„å€¼çš„ä¸ªæ•°ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œåŸºæ•°â€ï¼ˆcardinalityï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªåŸºæ•°è¶Šå¤§ï¼Œç´¢å¼•çš„åŒºåˆ†åº¦è¶Šå¥½ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨show indexæ–¹æ³•ï¼Œçœ‹åˆ°ä¸€ä¸ªç´¢å¼•çš„åŸºæ•°ã€‚å¦‚å›¾4æ‰€ç¤ºï¼Œå°±æ˜¯è¡¨tçš„show index çš„ç»“æœ ã€‚è™½ç„¶è¿™ä¸ªè¡¨çš„æ¯ä¸€è¡Œçš„ä¸‰ä¸ªå­—æ®µå€¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯åœ¨ç»Ÿè®¡ä¿¡æ¯ä¸­ï¼Œè¿™ä¸‰ä¸ªç´¢å¼•çš„åŸºæ•°å€¼å¹¶ä¸åŒï¼Œè€Œä¸”å…¶å®éƒ½ä¸å‡†ç¡®ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/16/d4/16dbf8124ad529fec0066950446079d4.png" alt=""></p><center><span class="reference">å›¾4 è¡¨tçš„show index ç»“æœ</span></center><p>é‚£ä¹ˆï¼Œ<strong>MySQLæ˜¯æ€æ ·å¾—åˆ°ç´¢å¼•çš„åŸºæ•°çš„å‘¢ï¼Ÿ</strong>è¿™é‡Œï¼Œæˆ‘ç»™ä½ ç®€å•ä»‹ç»ä¸€ä¸‹MySQLé‡‡æ ·ç»Ÿè®¡çš„æ–¹æ³•ã€‚</p><p>ä¸ºä»€ä¹ˆè¦é‡‡æ ·ç»Ÿè®¡å‘¢ï¼Ÿå› ä¸ºæŠŠæ•´å¼ è¡¨å–å‡ºæ¥ä¸€è¡Œè¡Œç»Ÿè®¡ï¼Œè™½ç„¶å¯ä»¥å¾—åˆ°ç²¾ç¡®çš„ç»“æœï¼Œä½†æ˜¯ä»£ä»·å¤ªé«˜äº†ï¼Œæ‰€ä»¥åªèƒ½é€‰æ‹©â€œé‡‡æ ·ç»Ÿè®¡â€ã€‚</p><p>é‡‡æ ·ç»Ÿè®¡çš„æ—¶å€™ï¼ŒInnoDBé»˜è®¤ä¼šé€‰æ‹©Nä¸ªæ•°æ®é¡µï¼Œç»Ÿè®¡è¿™äº›é¡µé¢ä¸Šçš„ä¸åŒå€¼ï¼Œå¾—åˆ°ä¸€ä¸ªå¹³å‡å€¼ï¼Œç„¶åä¹˜ä»¥è¿™ä¸ªç´¢å¼•çš„é¡µé¢æ•°ï¼Œå°±å¾—åˆ°äº†è¿™ä¸ªç´¢å¼•çš„åŸºæ•°ã€‚</p><p>è€Œæ•°æ®è¡¨æ˜¯ä¼šæŒç»­æ›´æ–°çš„ï¼Œç´¢å¼•ç»Ÿè®¡ä¿¡æ¯ä¹Ÿä¸ä¼šå›ºå®šä¸å˜ã€‚æ‰€ä»¥ï¼Œå½“å˜æ›´çš„æ•°æ®è¡Œæ•°è¶…è¿‡1/Mçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨è§¦å‘é‡æ–°åšä¸€æ¬¡ç´¢å¼•ç»Ÿè®¡ã€‚</p><p>åœ¨MySQLä¸­ï¼Œæœ‰ä¸¤ç§å­˜å‚¨ç´¢å¼•ç»Ÿè®¡çš„æ–¹å¼ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®å‚æ•°innodb_stats_persistentçš„å€¼æ¥é€‰æ‹©ï¼š</p><ul>
<li>è®¾ç½®ä¸ºonçš„æ—¶å€™ï¼Œè¡¨ç¤ºç»Ÿè®¡ä¿¡æ¯ä¼šæŒä¹…åŒ–å­˜å‚¨ã€‚è¿™æ—¶ï¼Œé»˜è®¤çš„Næ˜¯20ï¼ŒMæ˜¯10ã€‚</li>
<li>è®¾ç½®ä¸ºoffçš„æ—¶å€™ï¼Œè¡¨ç¤ºç»Ÿè®¡ä¿¡æ¯åªå­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚è¿™æ—¶ï¼Œé»˜è®¤çš„Næ˜¯8ï¼ŒMæ˜¯16ã€‚</li>
</ul><p>ç”±äºæ˜¯é‡‡æ ·ç»Ÿè®¡ï¼Œæ‰€ä»¥ä¸ç®¡Næ˜¯20è¿˜æ˜¯8ï¼Œè¿™ä¸ªåŸºæ•°éƒ½æ˜¯å¾ˆå®¹æ˜“ä¸å‡†çš„ã€‚</p><p>ä½†ï¼Œè¿™è¿˜ä¸æ˜¯å…¨éƒ¨ã€‚</p><p>ä½ å¯ä»¥ä»å›¾4ä¸­çœ‹åˆ°ï¼Œè¿™æ¬¡çš„ç´¢å¼•ç»Ÿè®¡å€¼ï¼ˆcardinalityåˆ—ï¼‰è™½ç„¶ä¸å¤Ÿç²¾ç¡®ï¼Œä½†å¤§ä½“ä¸Šè¿˜æ˜¯å·®ä¸å¤šçš„ï¼Œé€‰é”™ç´¢å¼•ä¸€å®šè¿˜æœ‰åˆ«çš„åŸå› ã€‚</p><p>å…¶å®ç´¢å¼•ç»Ÿè®¡åªæ˜¯ä¸€ä¸ªè¾“å…¥ï¼Œå¯¹äºä¸€ä¸ªå…·ä½“çš„è¯­å¥æ¥è¯´ï¼Œä¼˜åŒ–å™¨è¿˜è¦åˆ¤æ–­ï¼Œæ‰§è¡Œè¿™ä¸ªè¯­å¥æœ¬èº«è¦æ‰«æå¤šå°‘è¡Œã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†ä¸€èµ·çœ‹çœ‹ä¼˜åŒ–å™¨é¢„ä¼°çš„ï¼Œè¿™ä¸¤ä¸ªè¯­å¥çš„æ‰«æè¡Œæ•°æ˜¯å¤šå°‘ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/e2/89/e2bc5f120858391d4accff05573e1289.png" alt=""></p><center><span class="reference">å›¾5 æ„å¤–çš„explainç»“æœ</span></center><p>rowsè¿™ä¸ªå­—æ®µè¡¨ç¤ºçš„æ˜¯é¢„è®¡æ‰«æè¡Œæ•°ã€‚</p><p>å…¶ä¸­ï¼ŒQ1çš„ç»“æœè¿˜æ˜¯ç¬¦åˆé¢„æœŸçš„ï¼Œrowsçš„å€¼æ˜¯104620ï¼›ä½†æ˜¯Q2çš„rowså€¼æ˜¯37116ï¼Œåå·®å°±å¤§äº†ã€‚è€Œå›¾1ä¸­æˆ‘ä»¬ç”¨explainå‘½ä»¤çœ‹åˆ°çš„rowsæ˜¯åªæœ‰10001è¡Œï¼Œæ˜¯è¿™ä¸ªåå·®è¯¯å¯¼äº†ä¼˜åŒ–å™¨çš„åˆ¤æ–­ã€‚</p><p>åˆ°è¿™é‡Œï¼Œå¯èƒ½ä½ çš„ç¬¬ä¸€ä¸ªç–‘é—®ä¸æ˜¯ä¸ºä»€ä¹ˆä¸å‡†ï¼Œè€Œæ˜¯ä¼˜åŒ–å™¨ä¸ºä»€ä¹ˆæ”¾ç€æ‰«æ37000è¡Œçš„æ‰§è¡Œè®¡åˆ’ä¸ç”¨ï¼Œå´é€‰æ‹©äº†æ‰«æè¡Œæ•°æ˜¯100000çš„æ‰§è¡Œè®¡åˆ’å‘¢ï¼Ÿ</p><p>è¿™æ˜¯å› ä¸ºï¼Œå¦‚æœä½¿ç”¨ç´¢å¼•aï¼Œæ¯æ¬¡ä»ç´¢å¼•aä¸Šæ‹¿åˆ°ä¸€ä¸ªå€¼ï¼Œéƒ½è¦å›åˆ°ä¸»é”®ç´¢å¼•ä¸ŠæŸ¥å‡ºæ•´è¡Œæ•°æ®ï¼Œè¿™ä¸ªä»£ä»·ä¼˜åŒ–å™¨ä¹Ÿè¦ç®—è¿›å»çš„ã€‚</p><p>è€Œå¦‚æœé€‰æ‹©æ‰«æ10ä¸‡è¡Œï¼Œæ˜¯ç›´æ¥åœ¨ä¸»é”®ç´¢å¼•ä¸Šæ‰«æçš„ï¼Œæ²¡æœ‰é¢å¤–çš„ä»£ä»·ã€‚</p><p>ä¼˜åŒ–å™¨ä¼šä¼°ç®—è¿™ä¸¤ä¸ªé€‰æ‹©çš„ä»£ä»·ï¼Œä»ç»“æœçœ‹æ¥ï¼Œä¼˜åŒ–å™¨è®¤ä¸ºç›´æ¥æ‰«æä¸»é”®ç´¢å¼•æ›´å¿«ã€‚å½“ç„¶ï¼Œä»æ‰§è¡Œæ—¶é—´çœ‹æ¥ï¼Œè¿™ä¸ªé€‰æ‹©å¹¶ä¸æ˜¯æœ€ä¼˜çš„ã€‚</p><p>ä½¿ç”¨æ™®é€šç´¢å¼•éœ€è¦æŠŠå›è¡¨çš„ä»£ä»·ç®—è¿›å»ï¼Œåœ¨å›¾1æ‰§è¡Œexplainçš„æ—¶å€™ï¼Œä¹Ÿè€ƒè™‘äº†è¿™ä¸ªç­–ç•¥çš„ä»£ä»· ï¼Œä½†å›¾1çš„é€‰æ‹©æ˜¯å¯¹çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªç­–ç•¥å¹¶æ²¡æœ‰é—®é¢˜ã€‚</p><p>æ‰€ä»¥å†¤æœ‰å¤´å€ºæœ‰ä¸»ï¼ŒMySQLé€‰é”™ç´¢å¼•ï¼Œè¿™ä»¶äº‹å„¿è¿˜å¾—å½’å’åˆ°æ²¡èƒ½å‡†ç¡®åœ°åˆ¤æ–­å‡ºæ‰«æè¡Œæ•°ã€‚è‡³äºä¸ºä»€ä¹ˆä¼šå¾—åˆ°é”™è¯¯çš„æ‰«æè¡Œæ•°ï¼Œè¿™ä¸ªåŸå› å°±ä½œä¸ºè¯¾åé—®é¢˜ï¼Œç•™ç»™ä½ å»åˆ†æäº†ã€‚</p><p>æ—¢ç„¶æ˜¯ç»Ÿè®¡ä¿¡æ¯ä¸å¯¹ï¼Œé‚£å°±ä¿®æ­£ã€‚analyze table t å‘½ä»¤ï¼Œå¯ä»¥ç”¨æ¥é‡æ–°ç»Ÿè®¡ç´¢å¼•ä¿¡æ¯ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ‰§è¡Œæ•ˆæœã€‚</p><p><img src="https://static001.geekbang.org/resource/image/20/9c/209e9d3514688a3bcabbb75e54e1e49c.png" alt=""></p><center><span class="reference">å›¾6 æ‰§è¡Œanalyze table t å‘½ä»¤æ¢å¤çš„explainç»“æœ</span></center><p>è¿™å›å¯¹äº†ã€‚</p><p>æ‰€ä»¥åœ¨å®è·µä¸­ï¼Œå¦‚æœä½ å‘ç°explainçš„ç»“æœé¢„ä¼°çš„rowså€¼è·Ÿå®é™…æƒ…å†µå·®è·æ¯”è¾ƒå¤§ï¼Œå¯ä»¥é‡‡ç”¨è¿™ä¸ªæ–¹æ³•æ¥å¤„ç†ã€‚</p><p>å…¶å®ï¼Œå¦‚æœåªæ˜¯ç´¢å¼•ç»Ÿè®¡ä¸å‡†ç¡®ï¼Œé€šè¿‡analyzeå‘½ä»¤å¯ä»¥è§£å†³å¾ˆå¤šé—®é¢˜ï¼Œä½†æ˜¯å‰é¢æˆ‘ä»¬è¯´äº†ï¼Œä¼˜åŒ–å™¨å¯ä¸æ­¢æ˜¯çœ‹æ‰«æè¡Œæ•°ã€‚</p><p>ä¾ç„¶æ˜¯åŸºäºè¿™ä¸ªè¡¨tï¼Œæˆ‘ä»¬çœ‹çœ‹å¦å¤–ä¸€ä¸ªè¯­å¥ï¼š</p><pre><code>mysql&gt; select * from t where (a between 1 and 1000)  and (b between 50000 and 100000) order by b limit 1;
</code></pre><p>ä»æ¡ä»¶ä¸Šçœ‹ï¼Œè¿™ä¸ªæŸ¥è¯¢æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„è®°å½•ï¼Œå› æ­¤ä¼šè¿”å›ç©ºé›†åˆã€‚</p><p>åœ¨å¼€å§‹æ‰§è¡Œè¿™æ¡è¯­å¥ä¹‹å‰ï¼Œä½ å¯ä»¥å…ˆè®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä½ æ¥é€‰æ‹©ç´¢å¼•ï¼Œä¼šé€‰æ‹©å“ªä¸€ä¸ªå‘¢ï¼Ÿ</p><p>ä¸ºäº†ä¾¿äºåˆ†æï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹aã€bè¿™ä¸¤ä¸ªç´¢å¼•çš„ç»“æ„å›¾ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/1d/b9/1d037f92063e800c3bfff3f4dbf1a2b9.png" alt=""></p><center><span class="reference">å›¾7 aã€bç´¢å¼•çš„ç»“æ„å›¾</span></center><p>å¦‚æœä½¿ç”¨ç´¢å¼•aè¿›è¡ŒæŸ¥è¯¢ï¼Œé‚£ä¹ˆå°±æ˜¯æ‰«æç´¢å¼•açš„å‰1000ä¸ªå€¼ï¼Œç„¶åå–åˆ°å¯¹åº”çš„idï¼Œå†åˆ°ä¸»é”®ç´¢å¼•ä¸Šå»æŸ¥å‡ºæ¯ä¸€è¡Œï¼Œç„¶åæ ¹æ®å­—æ®µbæ¥è¿‡æ»¤ã€‚æ˜¾ç„¶è¿™æ ·éœ€è¦æ‰«æ1000è¡Œã€‚</p><p>å¦‚æœä½¿ç”¨ç´¢å¼•bè¿›è¡ŒæŸ¥è¯¢ï¼Œé‚£ä¹ˆå°±æ˜¯æ‰«æç´¢å¼•bçš„æœ€å50001ä¸ªå€¼ï¼Œä¸ä¸Šé¢çš„æ‰§è¡Œè¿‡ç¨‹ç›¸åŒï¼Œä¹Ÿæ˜¯éœ€è¦å›åˆ°ä¸»é”®ç´¢å¼•ä¸Šå–å€¼å†åˆ¤æ–­ï¼Œæ‰€ä»¥éœ€è¦æ‰«æ50001è¡Œã€‚</p><p>æ‰€ä»¥ä½ ä¸€å®šä¼šæƒ³ï¼Œå¦‚æœä½¿ç”¨ç´¢å¼•açš„è¯ï¼Œæ‰§è¡Œé€Ÿåº¦æ˜æ˜¾ä¼šå¿«å¾ˆå¤šã€‚é‚£ä¹ˆï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹åˆ°åº•æ˜¯ä¸æ˜¯è¿™ä¹ˆä¸€å›äº‹å„¿ã€‚</p><p>å›¾8æ˜¯æ‰§è¡Œexplainçš„ç»“æœã€‚</p><pre><code>mysql&gt; explain select * from t where (a between 1 and 1000) and (b between 50000 and 100000) order by b limit 1;
</code></pre><p><img src="https://static001.geekbang.org/resource/image/48/b8/483bcb1ef3bb902844e80d9cbdd73ab8.png" alt=""></p><center><span class="reference">å›¾8 ä½¿ç”¨explainæ–¹æ³•æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ 2</span></center><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿”å›ç»“æœä¸­keyå­—æ®µæ˜¾ç¤ºï¼Œè¿™æ¬¡ä¼˜åŒ–å™¨é€‰æ‹©äº†ç´¢å¼•bï¼Œè€Œrowså­—æ®µæ˜¾ç¤ºéœ€è¦æ‰«æçš„è¡Œæ•°æ˜¯50198ã€‚</p><p>ä»è¿™ä¸ªç»“æœä¸­ï¼Œä½ å¯ä»¥å¾—åˆ°ä¸¤ä¸ªç»“è®ºï¼š</p><ol>
<li>
<p>æ‰«æè¡Œæ•°çš„ä¼°è®¡å€¼ä¾ç„¶ä¸å‡†ç¡®ï¼›</p>
</li>
<li>
<p>è¿™ä¸ªä¾‹å­é‡ŒMySQLåˆé€‰é”™äº†ç´¢å¼•ã€‚</p>
</li>
</ol><h1>ç´¢å¼•é€‰æ‹©å¼‚å¸¸å’Œå¤„ç†</h1><p>å…¶å®å¤§å¤šæ•°æ—¶å€™ä¼˜åŒ–å™¨éƒ½èƒ½æ‰¾åˆ°æ­£ç¡®çš„ç´¢å¼•ï¼Œä½†å¶å°”ä½ è¿˜æ˜¯ä¼šç¢°åˆ°æˆ‘ä»¬ä¸Šé¢ä¸¾ä¾‹çš„è¿™ä¸¤ç§æƒ…å†µï¼šåŸæœ¬å¯ä»¥æ‰§è¡Œå¾—å¾ˆå¿«çš„SQLè¯­å¥ï¼Œæ‰§è¡Œé€Ÿåº¦å´æ¯”ä½ é¢„æœŸçš„æ…¢å¾ˆå¤šï¼Œä½ åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p><strong>ä¸€ç§æ–¹æ³•æ˜¯ï¼Œåƒæˆ‘ä»¬ç¬¬ä¸€ä¸ªä¾‹å­ä¸€æ ·ï¼Œé‡‡ç”¨force indexå¼ºè¡Œé€‰æ‹©ä¸€ä¸ªç´¢å¼•ã€‚</strong>MySQLä¼šæ ¹æ®è¯æ³•è§£æçš„ç»“æœåˆ†æå‡ºå¯èƒ½å¯ä»¥ä½¿ç”¨çš„ç´¢å¼•ä½œä¸ºå€™é€‰é¡¹ï¼Œç„¶ååœ¨å€™é€‰åˆ—è¡¨ä¸­ä¾æ¬¡åˆ¤æ–­æ¯ä¸ªç´¢å¼•éœ€è¦æ‰«æå¤šå°‘è¡Œã€‚å¦‚æœforce indexæŒ‡å®šçš„ç´¢å¼•åœ¨å€™é€‰ç´¢å¼•åˆ—è¡¨ä¸­ï¼Œå°±ç›´æ¥é€‰æ‹©è¿™ä¸ªç´¢å¼•ï¼Œä¸å†è¯„ä¼°å…¶ä»–ç´¢å¼•çš„æ‰§è¡Œä»£ä»·ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬äºŒä¸ªä¾‹å­ã€‚åˆšå¼€å§‹åˆ†ææ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºé€‰æ‹©ç´¢å¼•aä¼šæ›´å¥½ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°±æ¥çœ‹çœ‹æ‰§è¡Œæ•ˆæœï¼š</p><p><img src="https://static001.geekbang.org/resource/image/95/54/9582401a6bed6cb8fd803c9555750b54.png" alt=""></p><center><span class="reference">å›¾9 ä½¿ç”¨ä¸åŒç´¢å¼•çš„è¯­å¥æ‰§è¡Œè€—æ—¶</span></center><p>å¯ä»¥çœ‹åˆ°ï¼ŒåŸæœ¬è¯­å¥éœ€è¦æ‰§è¡Œ2.23ç§’ï¼Œè€Œå½“ä½ ä½¿ç”¨force index(a)çš„æ—¶å€™ï¼Œåªç”¨äº†0.05ç§’ï¼Œæ¯”ä¼˜åŒ–å™¨çš„é€‰æ‹©å¿«äº†40å¤šå€ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼˜åŒ–å™¨æ²¡æœ‰é€‰æ‹©æ­£ç¡®çš„ç´¢å¼•ï¼Œforce indexèµ·åˆ°äº†â€œçŸ«æ­£â€çš„ä½œç”¨ã€‚</p><p>ä¸è¿‡å¾ˆå¤šç¨‹åºå‘˜ä¸å–œæ¬¢ä½¿ç”¨force indexï¼Œä¸€æ¥è¿™ä¹ˆå†™ä¸ä¼˜ç¾ï¼ŒäºŒæ¥å¦‚æœç´¢å¼•æ”¹äº†åå­—ï¼Œè¿™ä¸ªè¯­å¥ä¹Ÿå¾—æ”¹ï¼Œæ˜¾å¾—å¾ˆéº»çƒ¦ã€‚è€Œä¸”å¦‚æœä»¥åè¿ç§»åˆ°åˆ«çš„æ•°æ®åº“çš„è¯ï¼Œè¿™ä¸ªè¯­æ³•è¿˜å¯èƒ½ä¼šä¸å…¼å®¹ã€‚</p><p>ä½†å…¶å®ä½¿ç”¨force indexæœ€ä¸»è¦çš„é—®é¢˜è¿˜æ˜¯å˜æ›´çš„åŠæ—¶æ€§ã€‚å› ä¸ºé€‰é”™ç´¢å¼•çš„æƒ…å†µè¿˜æ˜¯æ¯”è¾ƒå°‘å‡ºç°çš„ï¼Œæ‰€ä»¥å¼€å‘çš„æ—¶å€™é€šå¸¸ä¸ä¼šå…ˆå†™ä¸Šforce indexã€‚è€Œæ˜¯ç­‰åˆ°çº¿ä¸Šå‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œä½ æ‰ä¼šå†å»ä¿®æ”¹SQLè¯­å¥ã€åŠ ä¸Šforce indexã€‚ä½†æ˜¯ä¿®æ”¹ä¹‹åè¿˜è¦æµ‹è¯•å’Œå‘å¸ƒï¼Œå¯¹äºç”Ÿäº§ç³»ç»Ÿæ¥è¯´ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸å¤Ÿæ•æ·ã€‚</p><p>æ‰€ä»¥ï¼Œæ•°æ®åº“çš„é—®é¢˜æœ€å¥½è¿˜æ˜¯åœ¨æ•°æ®åº“å†…éƒ¨æ¥è§£å†³ã€‚é‚£ä¹ˆï¼Œåœ¨æ•°æ®åº“é‡Œé¢è¯¥æ€æ ·è§£å†³å‘¢ï¼Ÿ</p><p>æ—¢ç„¶ä¼˜åŒ–å™¨æ”¾å¼ƒäº†ä½¿ç”¨ç´¢å¼•aï¼Œè¯´æ˜aè¿˜ä¸å¤Ÿåˆé€‚ï¼Œæ‰€ä»¥<strong>ç¬¬äºŒç§æ–¹æ³•å°±æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¿®æ”¹è¯­å¥ï¼Œå¼•å¯¼MySQLä½¿ç”¨æˆ‘ä»¬æœŸæœ›çš„ç´¢å¼•ã€‚</strong>æ¯”å¦‚ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæ˜¾ç„¶æŠŠâ€œorder by b limit 1â€ æ”¹æˆ â€œorder by b,a limit 1â€ ï¼Œè¯­ä¹‰çš„é€»è¾‘æ˜¯ç›¸åŒçš„ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹æ”¹ä¹‹åçš„æ•ˆæœï¼š</p><p><img src="https://static001.geekbang.org/resource/image/14/94/14cd598e52a2b72dd334a42603e5b894.png" alt=""></p><center><span class="reference">å›¾10 order by b,a limit 1 æ‰§è¡Œç»“æœ</span></center><p>ä¹‹å‰ä¼˜åŒ–å™¨é€‰æ‹©ä½¿ç”¨ç´¢å¼•bï¼Œæ˜¯å› ä¸ºå®ƒè®¤ä¸ºä½¿ç”¨ç´¢å¼•bå¯ä»¥é¿å…æ’åºï¼ˆbæœ¬èº«æ˜¯ç´¢å¼•ï¼Œå·²ç»æ˜¯æœ‰åºçš„äº†ï¼Œå¦‚æœé€‰æ‹©ç´¢å¼•bçš„è¯ï¼Œä¸éœ€è¦å†åšæ’åºï¼Œåªéœ€è¦éå†ï¼‰ï¼Œæ‰€ä»¥å³ä½¿æ‰«æè¡Œæ•°å¤šï¼Œä¹Ÿåˆ¤å®šä¸ºä»£ä»·æ›´å°ã€‚</p><p>ç°åœ¨order by b,a è¿™ç§å†™æ³•ï¼Œè¦æ±‚æŒ‰ç…§b,aæ’åºï¼Œå°±æ„å‘³ç€ä½¿ç”¨è¿™ä¸¤ä¸ªç´¢å¼•éƒ½éœ€è¦æ’åºã€‚å› æ­¤ï¼Œæ‰«æè¡Œæ•°æˆäº†å½±å“å†³ç­–çš„ä¸»è¦æ¡ä»¶ï¼Œäºæ˜¯æ­¤æ—¶ä¼˜åŒ–å™¨é€‰äº†åªéœ€è¦æ‰«æ1000è¡Œçš„ç´¢å¼•aã€‚</p><p>å½“ç„¶ï¼Œè¿™ç§ä¿®æ”¹å¹¶ä¸æ˜¯é€šç”¨çš„ä¼˜åŒ–æ‰‹æ®µï¼Œåªæ˜¯åˆšå¥½åœ¨è¿™ä¸ªè¯­å¥é‡Œé¢æœ‰limit 1ï¼Œå› æ­¤å¦‚æœæœ‰æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œ order by b limit 1å’Œorder by b,a limit 1 éƒ½ä¼šè¿”å›bæ˜¯æœ€å°çš„é‚£ä¸€è¡Œï¼Œé€»è¾‘ä¸Šä¸€è‡´ï¼Œæ‰å¯ä»¥è¿™ä¹ˆåšã€‚</p><p>å¦‚æœä½ è§‰å¾—ä¿®æ”¹è¯­ä¹‰è¿™ä»¶äº‹å„¿ä¸å¤ªå¥½ï¼Œè¿™é‡Œè¿˜æœ‰ä¸€ç§æ”¹æ³•ï¼Œå›¾11æ˜¯æ‰§è¡Œæ•ˆæœã€‚</p><pre><code>mysql&gt; select * from  (select * from t where (a between 1 and 1000)  and (b between 50000 and 100000) order by b limit 100)alias limit 1;
</code></pre><p><img src="https://static001.geekbang.org/resource/image/b1/d7/b1a2ad43c78477d7f93dbc692cbaa0d7.png" alt=""></p><center><span class="reference">å›¾11 æ”¹å†™SQLçš„explain</span></center><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬ç”¨limit 100è®©ä¼˜åŒ–å™¨æ„è¯†åˆ°ï¼Œä½¿ç”¨bç´¢å¼•ä»£ä»·æ˜¯å¾ˆé«˜çš„ã€‚å…¶å®æ˜¯æˆ‘ä»¬æ ¹æ®æ•°æ®ç‰¹å¾è¯±å¯¼äº†ä¸€ä¸‹ä¼˜åŒ–å™¨ï¼Œä¹Ÿä¸å…·å¤‡é€šç”¨æ€§ã€‚</p><p><strong>ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯ï¼Œåœ¨æœ‰äº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªæ›´åˆé€‚çš„ç´¢å¼•ï¼Œæ¥æä¾›ç»™ä¼˜åŒ–å™¨åšé€‰æ‹©ï¼Œæˆ–åˆ æ‰è¯¯ç”¨çš„ç´¢å¼•ã€‚</strong></p><p>ä¸è¿‡ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘æ²¡æœ‰æ‰¾åˆ°é€šè¿‡æ–°å¢ç´¢å¼•æ¥æ”¹å˜ä¼˜åŒ–å™¨è¡Œä¸ºçš„æ–¹æ³•ã€‚è¿™ç§æƒ…å†µå…¶å®æ¯”è¾ƒå°‘ï¼Œå°¤å…¶æ˜¯ç»è¿‡DBAç´¢å¼•ä¼˜åŒ–è¿‡çš„åº“ï¼Œå†ç¢°åˆ°è¿™ä¸ªbugï¼Œæ‰¾åˆ°ä¸€ä¸ªæ›´åˆé€‚çš„ç´¢å¼•ä¸€èˆ¬æ¯”è¾ƒéš¾ã€‚</p><p>å¦‚æœæˆ‘è¯´è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•æ˜¯åˆ æ‰ç´¢å¼•bï¼Œä½ å¯èƒ½ä¼šè§‰å¾—å¥½ç¬‘ã€‚ä½†å®é™…ä¸Šæˆ‘ç¢°åˆ°è¿‡ä¸¤æ¬¡è¿™æ ·çš„ä¾‹å­ï¼Œæœ€ç»ˆæ˜¯DBAè·Ÿä¸šåŠ¡å¼€å‘æ²Ÿé€šåï¼Œå‘ç°è¿™ä¸ªä¼˜åŒ–å™¨é”™è¯¯é€‰æ‹©çš„ç´¢å¼•å…¶å®æ ¹æœ¬æ²¡æœ‰å¿…è¦å­˜åœ¨ï¼Œäºæ˜¯å°±åˆ æ‰äº†è¿™ä¸ªç´¢å¼•ï¼Œä¼˜åŒ–å™¨ä¹Ÿå°±é‡æ–°é€‰æ‹©åˆ°äº†æ­£ç¡®çš„ç´¢å¼•ã€‚</p><h1>å°ç»“</h1><p>ä»Šå¤©æˆ‘ä»¬ä¸€èµ·èŠäº†èŠç´¢å¼•ç»Ÿè®¡çš„æ›´æ–°æœºåˆ¶ï¼Œå¹¶æåˆ°äº†ä¼˜åŒ–å™¨å­˜åœ¨é€‰é”™ç´¢å¼•çš„å¯èƒ½æ€§ã€‚</p><p>å¯¹äºç”±äºç´¢å¼•ç»Ÿè®¡ä¿¡æ¯ä¸å‡†ç¡®å¯¼è‡´çš„é—®é¢˜ï¼Œä½ å¯ä»¥ç”¨analyze tableæ¥è§£å†³ã€‚</p><p>è€Œå¯¹äºå…¶ä»–ä¼˜åŒ–å™¨è¯¯åˆ¤çš„æƒ…å†µï¼Œä½ å¯ä»¥åœ¨åº”ç”¨ç«¯ç”¨force indexæ¥å¼ºè¡ŒæŒ‡å®šç´¢å¼•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹è¯­å¥æ¥å¼•å¯¼ä¼˜åŒ–å™¨ï¼Œè¿˜å¯ä»¥é€šè¿‡å¢åŠ æˆ–è€…åˆ é™¤ç´¢å¼•æ¥ç»•è¿‡è¿™ä¸ªé—®é¢˜ã€‚</p><p>ä½ å¯èƒ½ä¼šè¯´ï¼Œä»Šå¤©è¿™ç¯‡æ–‡ç« åé¢çš„å‡ ä¸ªä¾‹å­ï¼Œæ€ä¹ˆéƒ½æ²¡æœ‰å±•å¼€è¯´æ˜å…¶åŸç†ã€‚æˆ‘è¦å‘Šè¯‰ä½ çš„æ˜¯ï¼Œä»Šå¤©çš„è¯é¢˜ï¼Œæˆ‘ä»¬é¢å¯¹çš„æ˜¯MySQLçš„bugï¼Œæ¯ä¸€ä¸ªå±•å¼€éƒ½å¿…é¡»æ·±å…¥åˆ°ä¸€è¡Œè¡Œä»£ç å»é‡åŒ–ï¼Œå®åœ¨ä¸æ˜¯æˆ‘ä»¬åœ¨è¿™é‡Œåº”è¯¥åšçš„äº‹æƒ…ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘æŠŠæˆ‘ç”¨è¿‡çš„è§£å†³æ–¹æ³•è·Ÿä½ åˆ†äº«ï¼Œå¸Œæœ›ä½ åœ¨ç¢°åˆ°ç±»ä¼¼æƒ…å†µçš„æ—¶å€™ï¼Œèƒ½å¤Ÿæœ‰ä¸€äº›æ€è·¯ã€‚</p><p>ä½ å¹³æ—¶åœ¨å¤„ç†MySQLä¼˜åŒ–å™¨bugçš„æ—¶å€™æœ‰ä»€ä¹ˆåˆ«çš„æ–¹æ³•ï¼Œä¹Ÿå‘åˆ°è¯„è®ºåŒºåˆ†äº«ä¸€ä¸‹å§ã€‚</p><p>æœ€åï¼Œæˆ‘ç»™ä½ ç•™ä¸‹ä¸€ä¸ªæ€è€ƒé¢˜ã€‚å‰é¢æˆ‘ä»¬åœ¨æ„é€ ç¬¬ä¸€ä¸ªä¾‹å­çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡session Açš„é…åˆï¼Œè®©session Båˆ é™¤æ•°æ®ååˆé‡æ–°æ’å…¥äº†ä¸€éæ•°æ®ï¼Œç„¶åå°±å‘ç°explainç»“æœä¸­ï¼Œrowså­—æ®µä»10001å˜æˆ37000å¤šã€‚</p><p>è€Œå¦‚æœæ²¡æœ‰session Açš„é…åˆï¼Œåªæ˜¯å•ç‹¬æ‰§è¡Œdelete from t ã€call idata()ã€explainè¿™ä¸‰å¥è¯ï¼Œä¼šçœ‹åˆ°rowså­—æ®µå…¶å®è¿˜æ˜¯10000å·¦å³ã€‚ä½ å¯ä»¥è‡ªå·±éªŒè¯ä¸€ä¸‹è¿™ä¸ªç»“æœã€‚</p><p>è¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿä¹Ÿè¯·ä½ åˆ†æä¸€ä¸‹å§ã€‚</p><p>ä½ å¯ä»¥æŠŠä½ çš„åˆ†æç»“è®ºå†™åœ¨ç•™è¨€åŒºé‡Œï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« çš„æœ«å°¾å’Œä½ è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><h1>ä¸ŠæœŸé—®é¢˜æ—¶é—´</h1><p>æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« æœ€åç•™ç»™ä½ çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœæŸæ¬¡å†™å…¥ä½¿ç”¨äº†change bufferæœºåˆ¶ï¼Œä¹‹åä¸»æœºå¼‚å¸¸é‡å¯ï¼Œæ˜¯å¦ä¼šä¸¢å¤±change bufferå’Œæ•°æ®ã€‚</p><p>è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ˜¯ä¸ä¼šä¸¢å¤±ï¼Œç•™è¨€åŒºçš„å¾ˆå¤šåŒå­¦éƒ½å›ç­”å¯¹äº†ã€‚è™½ç„¶æ˜¯åªæ›´æ–°å†…å­˜ï¼Œä½†æ˜¯åœ¨äº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŠŠchange bufferçš„æ“ä½œä¹Ÿè®°å½•åˆ°redo logé‡Œäº†ï¼Œæ‰€ä»¥å´©æºƒæ¢å¤çš„æ—¶å€™ï¼Œchange bufferä¹Ÿèƒ½æ‰¾å›æ¥ã€‚</p><p>åœ¨è¯„è®ºåŒºæœ‰åŒå­¦é—®åˆ°ï¼Œmergeçš„è¿‡ç¨‹æ˜¯å¦ä¼šæŠŠæ•°æ®ç›´æ¥å†™å›ç£ç›˜ï¼Œè¿™æ˜¯ä¸ªå¥½é—®é¢˜ã€‚è¿™é‡Œï¼Œæˆ‘å†ä¸ºä½ åˆ†æä¸€ä¸‹ã€‚</p><p>mergeçš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol>
<li>
<p>ä»ç£ç›˜è¯»å…¥æ•°æ®é¡µåˆ°å†…å­˜ï¼ˆè€ç‰ˆæœ¬çš„æ•°æ®é¡µï¼‰ï¼›</p>
</li>
<li>
<p>ä»change bufferé‡Œæ‰¾å‡ºè¿™ä¸ªæ•°æ®é¡µçš„change buffer è®°å½•(å¯èƒ½æœ‰å¤šä¸ªï¼‰ï¼Œä¾æ¬¡åº”ç”¨ï¼Œå¾—åˆ°æ–°ç‰ˆæ•°æ®é¡µï¼›</p>
</li>
<li>
<p>å†™redo logã€‚è¿™ä¸ªredo logåŒ…å«äº†æ•°æ®çš„å˜æ›´å’Œchange bufferçš„å˜æ›´ã€‚</p>
</li>
</ol><p>åˆ°è¿™é‡Œmergeè¿‡ç¨‹å°±ç»“æŸäº†ã€‚è¿™æ—¶å€™ï¼Œæ•°æ®é¡µå’Œå†…å­˜ä¸­change bufferå¯¹åº”çš„ç£ç›˜ä½ç½®éƒ½è¿˜æ²¡æœ‰ä¿®æ”¹ï¼Œå±äºè„é¡µï¼Œä¹‹åå„è‡ªåˆ·å›è‡ªå·±çš„ç‰©ç†æ•°æ®ï¼Œå°±æ˜¯å¦å¤–ä¸€ä¸ªè¿‡ç¨‹äº†ã€‚</p><p>è¯„è®ºåŒºç•™è¨€ç‚¹èµæ¿ï¼š</p><blockquote>
<p>@æŸã€äºº æŠŠ02ç¯‡çš„redo logæ›´æ–°ç»†èŠ‚å’Œchange bufferçš„æ›´æ–°ä¸²äº†èµ·æ¥ï¼›<br>
@Ivan å›å¤äº†å…¶ä»–åŒå­¦çš„é—®é¢˜ï¼Œå¹¶è”ç³»åˆ°Checkpointæœºåˆ¶ï¼›<br>
@çº¦ä¹¦äºš é—®åˆ°äº†mergeå’Œredologçš„å…³ç³»ã€‚</p>
</blockquote><p><img src="https://static001.geekbang.org/resource/image/ce/d9/ce7f4e35916ed1aa49206a53a0547bd9.jpg" alt=""></p>
                    </div>
                </div>

            </div>
            <div data-v-87ffcada="" class="article-comments pd"><h2 data-v-87ffcada=""><span
                    data-v-87ffcada="">ç²¾é€‰ç•™è¨€</span></h2>
                <ul data-v-87ffcada="">
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æŸã€äºº</span>
                            </div>
                            <div class="bd">ä»Šå¤©è¿™ä¸ªé—®é¢˜ä¸æ˜¯ç‰¹åˆ«æ˜ç™½ä¸ºä»€ä¹ˆã€‚session Aå¼€å¯äº†ä¸€è‡´æ€§è¯»,session B deleteæˆ–è€…insert,ä¹‹å‰è®°å½•éƒ½å·²ç»æ”¾è¿›äº†undoäº†ã€‚äºŒçº§ç´¢å¼•çš„è®°å½•ä¹Ÿå†™è¿›äº†redoå’Œchange buffer,åº”è¯¥è¯´åˆ é™¤äº†ç´¢å¼•é¡µä¹Ÿä¸å½±å“session Açš„é‡å¤è¯»ã€‚ä¼°è®¡æ˜¯å¼€å¯äº†ä¸€è‡´æ€§è¯»ä¹‹å,åœ¨è¿™ä¸ªäº‹åŠ¡æ‰§è¡ŒæœŸé—´,ä¸èƒ½é‡Šæ”¾ç©ºé—´,å¯¼è‡´ç»Ÿè®¡ä¿¡æ¯å˜å¤§ã€‚è¿˜æ˜¯éœ€è¦è€å¸ˆè§£é‡Šä¸‹å…·ä½“çš„ç»†èŠ‚<br><br>ä»Šå¤©æœ‰ä¸¤ä¸ªé—®é¢˜,æƒ³è¯·æ•™ä¸‹è€å¸ˆ<br>1.æˆ‘çš„ç†è§£æ˜¯ç”±äºBæ˜¯æŸ¥æ‰¾(50000,100000),ç”±äºB+æ ‘æœ‰åº,é€šè¿‡äºŒåˆ†æŸ¥æ‰¾æ‰¾åˆ°b=50000çš„å€¼,ä»50000å¾€å³æ‰«æ,ä¸€æ¡ä¸€æ¡å›è¡¨æŸ¥æ•°æ®,åœ¨æ‰§è¡Œå™¨ä¸Šåšwhere a(1,1000)çš„ç­›é€‰,ç„¶ååšåˆ¤æ–­æ˜¯å¦å¤Ÿä¸å¤Ÿlimitçš„æ•°,å¤Ÿå°±ç»“æŸå¾ªç¯ã€‚ç”±äºè¿™é‡Œb(50000,100000)å¿…ç„¶ä¸å­˜åœ¨a(1,1000),æ‰€ä»¥éœ€è¦æ‰«æ5Wè¡Œå·¦å³.ä½†æ˜¯å¦‚æœæŠŠaæ”¹ä¸º(50001,51000),æ‰«æè¡Œæ•°æ²¡æœ‰å˜ã€‚é‚£ä¹ˆæ˜¯å› ä¸ºä¼˜åŒ–å™¨ç»™çš„æ‰«æè¡Œæ•°æœ‰é—®é¢˜è¿˜æ˜¯æ‰§è¡Œå™¨æ²¡æœ‰ç»“æŸå¾ªç¯ï¼Ÿä¸ºä»€ä¹ˆä¸ç»“æŸå¾ªç¯?<br>(å¥½åƒrowsèƒ½ç›´è§‚å±•ç¤ºlimitèµ·ä½œç”¨,å¿…é¡»åœ¨æ‰§è¡Œå™¨ä¸Šè¿‡æ»¤æ•°æ®,ä¸èƒ½åœ¨ç´¢å¼•ä¸Šè¿‡æ»¤æ•°æ®,ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡)<br><br>2.å‡è®¾bä¸Šæ•°æ®æ˜¯ä¼šæœ‰å¾ˆå¤šé‡å¤çš„æ•°æ®,bçš„æœ€å¤§å€¼ä¹Ÿå­˜åœ¨å¤šè¡Œé‡å¤<br>select * from t where (a between 1 and 1000) and (b between 50000 and 100000) order by b desc limit 1;<br>è¿™é‡Œå€’åºå»æ‰«æbç´¢å¼•æ ‘,é€‰å–çš„æ˜¯bå€¼æœ€å¤§,idå€¼ä¸ºä¸€ä¸ªå›ºå®šå€¼(æ—¢ä¸æœ€å¤§ä¹Ÿä¸æœ€å°)<br>select * from t force index(a) where (a between 1 and 1000) and (b between 50000 and 100000) order by b desc limit 1;<br>ç”±äºè¿™é‡Œé€‰å–çš„æ˜¯aç´¢å¼•,æ’åºä¸èƒ½ç”¨åˆ°ç´¢å¼•,åªèƒ½ç”¨ä¼˜åŒ–æ’åº.é€‰å–çš„æ˜¯bå€¼æœ€å¤§,idå€¼æœ€å°é‚£ä¸€è¡Œ<br>è¿™å°±æ˜¯å…¸å‹çš„ä¸¤æ¡ç›¸åŒçš„sql,ä½†æ˜¯ç´¢å¼•é€‰æ‹©çš„ä¸åŒ,å‡ºç°çš„æ•°æ®ä¸ä¸€è‡´ã€‚<br>æ‰€ä»¥å¦‚æœæ˜¯order by b,aå°±å¯ä»¥é¿å…è¿™ç§æƒ…å†µçš„å¼•èµ·çš„ä¸ä¸€è‡´,ä¹Ÿå¯ä»¥é¿å…å †æ’åºé€ æˆçš„ä¸ä¸€è‡´<br>ä½†æ˜¯å¦‚æœæ˜¯ascæ²¡æœ‰å‡ºç°è¿™ç§æƒ…å†µã€‚è¿™é‡Œå‡ºç°ä¸ä¸€è‡´,åº”è¯¥è¿˜ä¸æ˜¯ç”±äºå †æ’åºé€ æˆçš„ã€‚è¿™æ˜¯ä»€ä¹ˆåŸå› é€ æˆçš„ï¼Ÿ <br></div>
                            <span class="time">2018-12-05 20:54</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1. å¥½é—®é¢˜ï¼Œè€Œä¸”ä½ åšäº†ä¸ªä¸é”™çš„å¯¹ç…§å®éªŒã€‚æ˜¯çš„ï¼ŒåŠ äº†limit 1 èƒ½å‡å°‘æ‰«æå¤šå°‘è¡Œï¼Œå…¶å®ä¼˜åŒ–å™¨ä¹Ÿä¸ç¡®å®šï¼Œã€å¾—æ‰§è¡Œæ‰çŸ¥é“ã€‘ï¼Œæ‰€ä»¥æ˜¾ç¤ºçš„æ—¶å€™è¿˜æ˜¯æŒ‰ç…§â€œæœ€å¤šå¯èƒ½æ‰«å¤šå°‘è¡Œâ€æ¥æ˜¾ç¤ºã€‚<br><br>2. ä½ è¿™ä¸ªä¾‹å­é‡Œï¼Œå¦‚æœç¡®å®æ˜¯æŒ‰ç…§bæ‰«æäº†ï¼Œåº”è¯¥è‚¯å®šæ˜¯IDæœ€å¤§å€¼å‘€ï¼Œé™¤éIDæœ€å¤§çš„é‚£ä¸ªè®°å½•ï¼Œaæ¡ä»¶ä¸æ»¡è¶³ã€‚ä½†æ˜¯ä¸€å®šæ˜¯â€œæ»¡è¶³aæ¡ä»¶é‡Œé¢æœ€å¤§çš„é‚£ä¸ªIDçš„â€ï¼Œä½ å†éªŒè¯ä¸‹ã€‚<br><br> è€Œå¦‚æœæ˜¯ç”¨äº†a, é‚£å°±æœ‰ä¸´æ—¶è¡¨æ’åºï¼Œä¸´æ—¶è¡¨æ’åºæœ‰ä¸‰ç§ç®—æ³•ï¼Œè¿˜åˆ†å†…å­˜è¿˜æ˜¯ç£ç›˜ä¸´æ—¶è¡¨â€¦ è¿™é‡Œå±•å¼€ä¸äº†äº†ï¼Œåé¢ã€Šorder byæ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‹è¿™ç¯‡ä¼šè®²ã€‚</p>
                                <p class="reply-time">2018-12-05 22:22</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/34/a5/db01dc4f.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">bowenz</span>
                            </div>
                            <div class="bd">åœ¨5.7.21 percona ç‰ˆæœ¬å®éªŒï¼Œæœªå‡ºç°æ¡ˆä¾‹1çš„æƒ…å†µ ã€‚ <br>dev02&gt; select @@global.tx_isolation,@@tx_isolation,version(),&quot;session A&quot;;<br>+-----------------------+-----------------+---------------+-----------+<br>| @@global.tx_isolation | @@tx_isolation  | version()     | session A |<br>+-----------------------+-----------------+---------------+-----------+<br>| REPEATABLE-READ       | REPEATABLE-READ | 5.7.21-20-log | session A |<br>+-----------------------+-----------------+---------------+-----------+<br>dev02&gt; start transaction with consistent snapshot;<br>Query OK, 0 rows affected (0.00 sec)<br>dev02&gt; commit;<br>Query OK, 0 rows affected (0.00 sec)<br>dev02&gt; select now() ;<br>+---------------------+<br>| now()               |<br>+---------------------+<br>| 2018-12-04 22:03:48 |<br>+---------------------+<br>1 row in set (0.00 sec)<br>dev02&gt; select @@global.tx_isolation,@@tx_isolation,version(),&quot;session B&quot;;<br>+-----------------------+-----------------+---------------+-----------+<br>| @@global.tx_isolation | @@tx_isolation  | version()     | session B |<br>+-----------------------+-----------------+---------------+-----------+<br>| REPEATABLE-READ       | REPEATABLE-READ | 5.7.21-20-log | session B |<br>+-----------------------+-----------------+---------------+-----------+<br>1 row in set, 2 warnings (0.00 sec)<br><br>dev02&gt; delete from t;<br>Query OK, 100000 rows affected (0.51 sec)<br><br>dev02&gt; call idata();<br>Query OK, 1 row affected (2 min 38.34 sec)<br><br>dev02&gt; select now();<br>+---------------------+<br>| now()               |<br>+---------------------+<br>| 2018-12-04 22:03:58 |<br>+---------------------+<br>1 row in set (0.00 sec)<br><br>dev02&gt; explain select * from t where a between 10000 and 20000;<br>| id | select_type | table | partitions | type  | possible_keys | key  | key_len | ref  | rows  | filtered | Extra                 |<br>|  1 | SIMPLE      | t     | NULL       | range | a             | a    | 5       | NULL | 10001 |   100.00 | Using index condition | <br></div>
                            <span class="time">2018-12-05 14:12</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">Session Aæäº¤æ—©äº†â€¦ ä»ä¸Šåˆ°ä¸‹æŒ‰ç…§æ—¶é—´é¡ºåºæ‰§è¡Œå“ˆ</p>
                                <p class="reply-time">2018-12-05 20:14</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/16/31/ae8adf82.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è·¯è¿‡</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œå…³äºæœ¬ç« ä¸­çš„â€œåŸºæ•°â€ï¼ˆcardinalityï¼‰é—®é¢˜ã€‚æ—¢ç„¶å·²ç»ä¸ºåˆ—aåˆ›å»ºäº†ç´¢å¼•ï¼Œå³æœ‰ä¸“é—¨çš„æ•°æ®é¡µå­˜æ”¾ç´¢å¼•ã€‚éå†ç´¢å¼•æ˜¯å¾ˆå¿«çš„ï¼Œä»è€Œå¾—åˆ°â€œåŸºæ•°â€çš„å€¼åº”è¯¥å¾ˆå¿«å‘€ã€‚ä¸ºä½•è¦åˆ°åŸå§‹çš„æ•°æ®é¡µä¸­ï¼Œæ‰¾Né¡µï¼Œç»Ÿè®¡ä¸Šé¢ä¸åŒçš„å€¼å‘¢ï¼Ÿæœ‰ç‚¹å¤šæ­¤ä¸€ä¸¾å•Šã€‚å¦‚æœè¿™æ ·æ“ä½œï¼Œä¼šå¯¼è‡´ä¿¡æ¯ä¸å‡†ç¡®ï¼Œæ¯”å¦‚æœ¬æ¥ä¸€ä¸ªé¡µä¸­æœ‰50æ¡æ•°æ®ï¼Œåæ¥å…¶ä¸­20æ¡æ•°æ®è¢«åˆ é™¤äº†ï¼Œç©ºé—´æ²¡æœ‰è¢«é‡Šæ”¾ï¼Œè¿™å¯¼è‡´ç»Ÿè®¡çš„ä¿¡æ¯å°±å‘ç”Ÿåå·®ã€‚åŸºæ•°ä¿¡æ¯å°±æ›´ä¸å‡†ç¡®äº†ã€‚<br>ä»åŸå§‹é¡µä¸­è®¡ç®—â€œåŸºæ•°â€ï¼Œæ˜¯ä¸æ˜¯è€ƒè™‘åˆ°ç´¢å¼•é¡µä¸­çš„æ•°æ®å…·æœ‰æ»åæ€§ï¼Œå³æ›´æ–°äº†è¡¨ä¸­æ•°æ®ï¼Œè¦è¿‡ä¸€ä¼šæ‰æ›´æ–°ç´¢å¼•é¡µï¼Ÿ<br>è¯·è€å¸ˆæŒ‡æ­£ï¼Œè°¢è°¢ï¼<br><br> <br></div>
                            <span class="time">2018-12-05 22:46</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å•Šï¼Œè¯¯ä¼šäº†ï¼Œç¡®å®æ˜¯å“ªä¸ªç´¢å¼•çš„åŸºæ•°å°±æ˜¯åœ¨å“ªä¸ªç´¢å¼•æ ‘ä¸Šæ‹¿çš„ã€‚<br><br>ä½ çš„ç†è§£æ˜¯å¯¹çš„ï¼Œæˆ‘æ–‡ä¸­ä¹Ÿæ˜¯è¿™ä¸ªæ„æ€å“¦ğŸ˜“</p>
                                <p class="reply-time">2018-12-06 00:21</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æŸã€äºº</span>
                            </div>
                            <div class="bd">è¶ç€ç­”æ¡ˆå…¬å¸ƒä¹‹å‰çš„æœ€åæ—¶é—´,å†æ¥å°è¯•æ€§ç­”ä¸€ä¸‹è¿™ä¸ªé¢˜<br>1.ä¸ºä»€ä¹ˆæ²¡æœ‰session A,session Bæ‰«æçš„è¡Œæ•°æ˜¯1W<br>ç”±äºmysqlæ˜¯ä½¿ç”¨æ ‡è®°åˆ é™¤æ¥åˆ é™¤è®°å½•çš„,å¹¶ä¸ä»ç´¢å¼•å’Œæ•°æ®æ–‡ä»¶ä¸­çœŸæ­£çš„åˆ é™¤ã€‚<br>å¦‚æœdeleteå’Œinsertä¸­é—´çš„é—´éš”ç›¸å¯¹è¾ƒå°,purgeçº¿ç¨‹è¿˜æ²¡æœ‰æ¥å¾—åŠæ¸…ç†è¯¥è®°å½•ã€‚<br>å¦‚æœä¸»é”®ç›¸åŒçš„æƒ…å†µä¸‹,æ–°æ’å…¥çš„insertä¼šæ²¿ç”¨ä¹‹å‰åˆ é™¤çš„deleteçš„è®°å½•çš„ç©ºé—´ã€‚<br>ç”±äºç›¸åŒçš„æ•°æ®é‡ä»¥åŠè¡¨å¤§å°,æ‰€ä»¥å¯¼è‡´äº†ç»Ÿè®¡ä¿¡æ¯æ²¡æœ‰å˜åŒ–<br>2.ä¸ºä»€ä¹ˆå¼€å¯äº†session A,session Bæ‰«æè¡Œæ•°å˜æˆ3W<br>ç”±äºsession Aå¼€å¯äº†ä¸€è‡´æ€§è¯»,ç›®çš„ä¸ºäº†ä¿è¯session Açš„å¯é‡å¤è¯»,insertåªèƒ½<br>å¦èµ·ç‚‰ç¶,ä¸èƒ½å ç”¨deleteçš„ç©ºé—´ã€‚æ‰€ä»¥å‡ºç°çš„æƒ…å†µå°±æ˜¯deleteè™½ç„¶åˆ é™¤äº†,ä½†æ˜¯<br>æœªé‡Šæ”¾ç©ºé—´,insertåˆå¢åŠ äº†ç©ºé—´ã€‚å¯¼è‡´ç»Ÿè®¡ä¿¡æ¯æœ‰è¯¯ <br></div>
                            <span class="time">2018-12-06 23:34</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘ğŸ¿</p>
                                <p class="reply-time">2018-12-07 00:05</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/ea/9a/02d589f9.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ–œé¢é•œå­ Bill</span>
                            </div>
                            <div class="bd">é—®é¢˜çš„æ€è€ƒï¼š<br>æˆ‘ç†è§£ session A å¼€å¯çš„äº‹åŠ¡å¯¹ session Bçš„deleteæ“ä½œåçš„ç´¢å¼•æ•°æ®çš„ç»Ÿè®¡æ—¶æ•ˆäº§ç”Ÿäº†å½±å“ï¼Œå› ä¸ºéœ€è¦ä¿è¯äº‹åŠ¡Açš„é‡å¤è¯»ï¼Œåœ¨æ•°æ®é¡µæ²¡æœ‰å®é™…åˆ é™¤ï¼Œè€Œç´¢å¼•çš„ç»Ÿè®¡é€‰æ‹©äº†Nä¸ªæ•°æ®é¡µï¼Œè¿™éƒ¨åˆ†æ•°æ®é¡µä¸æ”¶åˆ°å‰å°äº‹åŠ¡çš„å½±å“ï¼Œæ‰€ä»¥æ•´ä½“ç»Ÿè®¡å€¼ä¼šå˜å¤§ï¼Œç›´æ¥å½±å“äº†ç´¢å¼•é€‰æ‹©çš„å‡†ç¡®æ€§ï¼› <br></div>
                            <span class="time">2018-12-05 10:59</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘ğŸ¿</p>
                                <p class="reply-time">2018-12-05 12:07</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/e9/8f/0de9ca55.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Niko.</span>
                            </div>
                            <div class="bd">æˆ‘è¯•äº†å‡ é ä¹Ÿæ˜¯æ²¡æœ‰å¤ç°é€‰é”™ç´¢å¼•<br>Aä¼šè¯<br>mysql&gt; select @@tx_isolation;<br>+-----------------+<br>| @@tx_isolation  |<br>+-----------------+<br>| REPEATABLE-READ |<br>+-----------------+<br>1 row in set, 1 warning (0.01 sec)<br><br>mysql&gt; select @@version<br>    -&gt; ;<br>+------------+<br>| @@version  |<br>+------------+<br>| 5.7.22-log |<br>+------------+<br>1 row in set (0.00 sec)<br>mysql&gt; start transaction with consistent snapshot;<br>Query OK, 0 rows affected (0.00 sec)<br><br>Bä¼šè¯<br>mysql&gt; delete from t;<br>Query OK, 100000 rows affected (2.58 sec)<br><br>mysql&gt; call idata();<br>Query OK, 1 row affected (24.32 sec)<br><br>mysql&gt; explain select * from t where a between 10000 and 20000;<br>+----+-------------+-------+------------+-------+---------------+------+---------+------+-------+----------+-----------------------+<br>| id | select_type | table | partitions | type  | possible_keys | key  | key_len | ref  | rows  | filtered | Extra                 |<br>+----+-------------+-------+------------+-------+---------------+------+---------+------+-------+----------+-----------------------+<br>|  1 | SIMPLE      | t     | NULL       | range | a             | a    | 5       | NULL | 10001 |   100.00 | Using index condition |<br>+----+-------------+-------+------------+-------+---------------+------+---------+------+-------+----------+-----------------------+<br>1 row in set, 1 warning (0.00 sec)<br><br>ä¸ºå•¥å‘¢ï¼Ÿ  <br></div>
                            <span class="time">2018-12-12 11:09</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æŸã€äºº</span>
                            </div>
                            <div class="bd">è°¢è°¢è€å¸ˆçš„å›ç­”.<br>1.ç¡®å®æœ‰æ—¶å€™æ„Ÿè§‰è™½ç„¶æ˜¾ç¤ºäº†æ‰«æè¡Œæ•°æ¯”è¾ƒå¤š,ä½†æ˜¯limitåº”è¯¥æ˜¯èµ·äº†ä½œç”¨çš„,ä»æ‰§è¡Œæ—¶é—´å°±èƒ½çœ‹å‡ºæ¥ã€‚<br>2.å¤±è¯¯,ç¡®å®æ˜¯åº”è¯¥æ»¡è¶³aæ¡ä»¶idæœ€å¤§çš„ã€‚<br>ä¸´æ—¶è¡¨æ’åºä¹‹å‰äº†è§£è¿‡ä¸€ç‚¹,1.å¸¸è§„æ’åºã€‚2.ä¼˜åŒ–æ’åº 3.ä¼˜å…ˆé˜Ÿåˆ—æ’åº(å †æ’åº)<br>ç”±äºé€‰å–çš„å­—æ®µæ²¡è¶…è¿‡max_length_for_sort_data,æ‰€ä»¥é€‰å–çš„æ˜¯ä¼˜åŒ–æ’åº,åªéœ€è¦è¿›è¡Œä¸€æ¬¡I&#47;Oã€‚ <br></div>
                            <span class="time">2018-12-05 23:00</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/fd/d5/0194ea41.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ²‰æµ®</span>
                            </div>
                            <div class="bd">å›¾åä¸‹é¢ç¬¬äºŒæ®µ<br>ç°åœ¨ limit b,a è¿™ç§å†™æ³•ï¼Œè¦æ±‚æŒ‰ç…§ b,a æ’åºï¼Œå°±æ„å‘³ç€ä½¿ç”¨è¿™ä¸¤ä¸ªç´¢å¼•éƒ½éœ€è¦æ’åºã€‚<br>åº”è¯¥æ˜¯order by b,aå§<br>å¦å¤–æœ‰ä¸ªé—®é¢˜è¯·æ•™æ—è€å¸ˆï¼Œæ ¹æ®ç»éªŒå¤§è¡¨å¢åŠ ç´¢å¼•çš„æ—¶å€™æ¯”è¾ƒæ…¢ï¼Œè¿™ä¸ªæ˜¯ç†è§£çš„ï¼Œä½†æ˜¯åˆ é™¤ç´¢å¼•çš„æ—¶å€™èƒ½åšåˆ°ç§’åˆ ï¼Œè¿™ä¸ªä»€ä¹ˆåŸç†å‘¢ï¼Ÿ <br></div>
                            <span class="time">2018-12-05 09:20</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ˜¯ï¼Œå·²ç»ä¿®æ”¹äº†ï¼Œè°¢è°¢ã€‚<br><br>åˆ é™¤çš„æ—¶å€™æ˜¯æ ‡è®°åˆ é™¤ï¼Œæ‰€ä»¥å¾ˆå¿«ã€‚<br>å»ºç´¢å¼•æ˜¯è¦æ‰«ææ•°æ®å’ŒçœŸæ­£ç”Ÿæˆç´¢å¼•æ ‘ï¼Œæ˜¯ä¼šæ…¢äº›</p>
                                <p class="reply-time">2018-12-05 12:43</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/f3/4a/b6a46894.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Ying</span>
                            </div>
                            <div class="bd">ç°å­¦ç°ç”¨ ä»Šå¤©æœ‰ä¸ª500ä¸‡çš„è¡¨ åˆ†é¡µæŸ¥è¯¢ç‰¹åˆ«æ…¢ã€‚<br>select * from table where create_time and create_time&gt;=æ—¶é—´æˆ³ and  create_time&lt;=æ—¶é—´æˆ³ <br>and subtype=&#39;xx&#39; and type=&#39;xx&#39; and company_id =x order by create_time limited 90,30 ;<br>å·²ç»å»ºç«‹äº†ç»„åˆç´¢å¼• union_indexåŒ…æ‹¬å­—æ®µ create_time subtype  type company_id<br>ä½†æ˜¯ explain å‘ç°ç«Ÿç„¶èµ°äº†create_time çš„ç´¢å¼•<br>è¯­å¥é‡ŒåŠ äº†ä¸€ä¸ªuse index(union_index) ï¼Œç«‹é©¬å¥½äº†<br>çœŸæ­£çš„è§£å†³äº†å®¢æˆ·çš„å®é™…é—®é¢˜å•Šã€‚ æ„Ÿè°¢è€å¸ˆ <br></div>
                            <span class="time">2018-12-05 20:04</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘ğŸ¿<br><br>è€Œä¸”å‘è¯„è®ºçš„æ—¶å€™è¿˜åšäº†å¾ˆç»†è‡´åœ°è„±æ•ï¼Œèµ</p>
                                <p class="reply-time">2018-12-05 21:27</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">LeonğŸ“·</span>
                            </div>
                            <div class="bd">å…¬å¸æµ‹è¯•æœºå™¨IOæ€§èƒ½å¤ªå·®ï¼Œæ’åä¸‡æ¡è¦27åˆ†é’Ÿï¼Œåšè¿™ä¸ªæ–‡ç« çš„å®éªŒè¦1ä¸ªå°æ—¶ä»¥ä¸Š <br></div>
                            <span class="time">2018-12-05 16:01</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">â€¦â€¦â€¦<br><br>ä¸ä¼šå§ï¼Œæ’å…¥10ä¸‡æ¡27åˆ†é’Ÿâ€¦ ä½ æŠŠinnodb_flush_log_at_trx_commit å’Œ sync_binlogéƒ½è®¾ç½®æˆ0è¯•è¯•</p>
                                <p class="reply-time">2018-12-05 23:13</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/47/e7/53416498.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ›¹é¾™é£</span>
                            </div>
                            <div class="bd">ä¸è€å¸ˆï¼ŒæŒ‰ç…§å›¾2çš„æµç¨‹,è¿˜å‚è€ƒäº†è€å¸ˆä¸‹ä¸€ç¯‡æ–‡ç« æœ«å°¾çš„è§†é¢‘,è¿˜æ˜¯æ²¡æœ‰é‡ç°é€‰é”™ç´¢å¼•çš„æƒ…å†µï¼›æ“ä½œå¾ªåºæ˜¯æ²¡æœ‰é—®é¢˜ï¼Œéš”ç¦»çº§åˆ«å’Œè¡¨çš„å­˜å‚¨å¼•æ“ç±»å‹æˆ‘éƒ½æ£€æŸ¥äº†ï¼Œæˆ‘æƒ³é—®çš„æ˜¯:è¿™ä¸ªæ˜¯å¿…ç°çš„å—ï¼Ÿå¦‚æœæ˜¯å¿…ç°ï¼Œä¸å‡ºç°çš„å¯èƒ½åŸå› åˆæœ‰å“ªäº›å‘¢ï¼Ÿ <br></div>
                            <span class="time">2018-12-25 11:00</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/39/99/42929758.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">andy</span>
                            </div>
                            <div class="bd">create table #t<br>(<br>	a int,<br>	b int,<br>	c int<br>)<br><br>insert into #t values(1,1,1)<br><br>declare @count int<br>set @count=1<br><br>while @count&lt;=70000<br>begin<br>	insert into #t select a+@count,b+@count,c+@count from #t<br>	set @count= @count*2<br>end<br><br>æ’å…¥æµ‹è¯•æ•°æ®ï¼Œè¿™ç§æ–¹æ³•æˆ‘è¯•è¿‡å¾ˆå¿«ï¼Œä¸è¿‡ä¸èƒ½å‡†ç¡®æ’å…¥10ä¸‡æ¡ï¼Œä»¥ä¸Šæ˜¯SQL Serverçš„è¯­æ³• <br></div>
                            <span class="time">2018-12-10 09:49</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/e9/ab/37903736.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">J!</span>
                            </div>
                            <div class="bd">æˆ‘æƒ³é—®ä¸‹mysql dbname çš„é•¿åº¦åœ¨æºç ä¸­æ˜¯åœ¨å“ªé‡Œå®šä¹‰çš„ï¼Œä¸ºä»€ä¹ˆæœ€å¤§é•¿åº¦æ˜¯64=? <br></div>
                            <span class="time">2018-12-06 21:12</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/e3/bc/064401c7.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">EAGLE</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œçœ‹äº†ä¸€ç¯‡æ–‡ç« è¯´innodbå¦‚æœä¸åŠ order byé»˜è®¤æ˜¯æŒ‰ç…§ä¸»é”®æ’åºçš„ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœä¸åŠ order byï¼ŒæŸ¥è¯¢ç»“æœä¹Ÿæ˜¯æœ‰ä¸€å®šæ¬¡åºçš„ã€‚é‚£ä¹ˆå¦‚æœæ²¡æœ‰ä¸šåŠ¡éœ€æ±‚ï¼Œçº¯ç²¹åªæ˜¯ä¸ºäº†åˆ†é¡µæ˜¾ç¤ºæ•°æ®ï¼Œä¸åŠ order byä¹Ÿæ˜¯å¯ä»¥çš„å—ï¼Ÿ <br></div>
                            <span class="time">2018-12-06 16:35</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ–‡ç« è¯´é”™äº†â€¦ ğŸ˜“<br>é»˜è®¤æŒ‰ç…§â€œæŸ¥è¯¢ä½¿ç”¨çš„ç´¢å¼•â€æ’åº</p>
                                <p class="reply-time">2018-12-06 17:49</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epGMibYc0m7cDHMsNRBUur2NPVnlBZFXoNjWomibfjnHeAO3XRt27VaH3WNtdUX11d3uIT1ZHWCxLeg/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">york</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼š<br>1.  æˆ‘çš„æœºå™¨ä¹Ÿæ²¡å¤ç°å›¾2æ‰€æŒ‡çš„é—®é¢˜ï¼ŒMySQLç‰ˆæœ¬5.7.24<br>2. set sql_long_query=0å‘½ä»¤ï¼Œåœ¨æˆ‘çš„MySQLæ‰§è¡ŒæŠ¥é”™<br>    Unknown system variable &#39;sql_long_query&#39;<br>3. ç”¨è™šæ‹Ÿæœºæ’å…¥10ä¸‡æ¡æ•°æ®è€—æ—¶é•¿çš„é—®é¢˜ï¼Œå¯èƒ½æ˜¯å› ä¸ºåˆ›å»ºè™šæ‹Ÿæœºæ—¶ï¼Œç£ç›˜é€‰æ‹©çš„æ˜¯åŠ¨æ€å¢é•¿å®¹é‡çš„æ–¹å¼ï¼Œå…¶ä»–åŒå­¦å¯ä»¥è¯•è¯•ã€‚ <br></div>
                            <span class="time">2018-12-06 15:11</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">set sql_long_query=0; æ”¹æˆ set long_query_time=0; ğŸ˜“</p>
                                <p class="reply-time">2018-12-06 16:22</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/0d/0c/3dbffd56.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">åšæ¢¦åˆ°å¤©äº®list</span>
                            </div>
                            <div class="bd">èˆ’æœäº† <br></div>
                            <span class="time">2018-12-05 23:52</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/40/5e/b8fada94.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Ryoma</span>
                            </div>
                            <div class="bd">è¯·é—®ä½¿ç”¨insert ... on duplicate key updateå¯¹æ€§èƒ½æœ‰ä»€ä¹ˆå½±å“å‘¢ <br></div>
                            <span class="time">2018-12-05 20:25</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ¯”åˆ†æˆä¸¤å¥å¿«ğŸ˜„</p>
                                <p class="reply-time">2018-12-05 22:29</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/80/d6/1f78bc57.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è§è‹¥æ„š</span>
                            </div>
                            <div class="bd">è¯·æ•™ä¸ªé—®é¢˜ï¼Œå¦‚æœä¸€ä¸ªè¡¨çš„å­—æ®µåä¸­åŒ…å«è¡¨æƒ…ç¬¦å·æ¯”å¦‚ ağŸ˜‡ï¼ŒæŸ¥è¯¢è¡¨çš„ç»“æœä¸­å­—æ®µåå˜ä¸ºaï¼Ÿï¼Œè¯¥è¡¨çš„å­—ç¬¦é›†å·²è®¾ä¸º utf8_mb4ã€‚æŸ¥çœ‹ information_schema è¡¨ä¸­å­—æ®µåä¹Ÿæ˜¯aï¼Ÿï¼Œå‘ç° information_schema è¡¨çš„é»˜è®¤å­—ç¬¦é›†æ˜¯ utf8ã€‚æŸ¥è¯¢æ—¶è‹¥æ¡ä»¶è¯­å¥ä¸­ç”¨åˆ°è¯¥å­—æ®µåæ—¶ï¼Œç”¨`a?`ï¼Œ`ağŸ˜‡`ï¼Œä»¥åŠ ağŸ˜‡ éƒ½å¯æ­£ç¡®æŸ¥è¯¢åˆ°ç»“æœï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿè¿˜æœ‰ï¼Œå¦‚ä½•æŸ¥è¯¢å‡ºæ­£ç¡®çš„å­—æ®µåï¼Œå³æŸ¥è¯¢ç»“æœä¸­ä¸º ağŸ˜‡ è€Œä¸æ˜¯ a?ã€‚è°¢è°¢ï¼ <br></div>
                            <span class="time">2018-12-05 11:32</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¿™ä¸ªé—®é¢˜ä¼šåœ¨åé¢ã€Šä¹±ç æ€ä¹ˆåŠã€‹ä¸­å±•å¼€å“ˆã€‚<br><br>å…ˆç®€å•å›ç­”ä¸€ä¸ªï¼Œå­—æ®µåçš„ä¹±ç æ˜¯æ”¹ä¸äº†äº†ï¼Œè¿”å›ç»“æœçš„schemaä¿¡æ¯å›ºå®šåªèƒ½ç”¨utf8, utf8ä¸è®¤è¯†è¡¨æƒ…ç¬¦å·â€¦</p>
                                <p class="reply-time">2018-12-05 12:10</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/fe/68/e0bebd9a.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">é«˜æ•</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæ‚¨æ–‡ä¸­æåˆ°ï¼šâ€œä» change buffer é‡Œæ‰¾å‡ºè¿™ä¸ªæ•°æ®é¡µçš„ change buffer è®°å½• (å¯èƒ½æœ‰å¤šä¸ªï¼‰ï¼Œä¾æ¬¡åº”ç”¨ï¼Œå¾—åˆ°æ–°ç‰ˆæ•°æ®é¡µï¼›<br><br>å†™ redo logã€‚è¿™ä¸ª redo log åŒ…å«äº†æ•°æ®çš„å˜æ›´å’Œ change buffer çš„å˜æ›´ã€‚â€<br>æ‚¨çš„æ„æ€æ˜¯ï¼Œè¿™äº›æ–°ç‰ˆçš„æ•°æ®é¡µåçš„æ•°æ® ï¼Œæ²¡æœ‰ç›´æ¥å†™å›åˆ°ç£ç›˜ï¼ˆæ•°æ®é¡µï¼‰ï¼Œè€Œæ˜¯å†™è¿›äº†redo logï¼Ÿ<br>å†™å›æ•°æ®é¡µå’Œæ›´æ–°ç³»ç»Ÿè¡¨ç©ºé—´å¯¹åº”çš„change bufferæ˜¯å¦å¤–çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Ÿ<br>å†™è¿› <br></div>
                            <span class="time">2018-12-05 10:17</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1. æ˜¯çš„</p>
                                <p class="reply-time">2018-12-05 12:48</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/fe/68/e0bebd9a.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">é«˜æ•</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæ‚¨æ–‡ä¸­æœ€åå†™é“ï¼šâ€œè¿™æ—¶å€™ï¼Œæ•°æ®é¡µå’Œå†…å­˜ä¸­ change buffer å¯¹åº”çš„ç£ç›˜ä½ç½®éƒ½è¿˜æ²¡æœ‰ä¿®æ”¹ï¼Œå±äºè„é¡µï¼Œä¹‹åå„è‡ªåˆ·å›è‡ªå·±çš„ç‰©ç†æ•°æ®ï¼Œå°±æ˜¯å¦å¤–ä¸€ä¸ªè¿‡ç¨‹äº†ã€‚â€<br>èƒ½å†ç»™è§£é‡Šä¸‹change bufferå’Œæ•°æ®é¡µå¯¹åº”çš„ç£ç›˜ä½ç½®æ˜¯å“ªé‡Œå—ï¼Ÿ<br>æˆ‘ç†è§£change buffer å¯¹åº”çš„ç£ç›˜ä½ç½®æ˜¯ç³»ç»Ÿè¡¨ç©ºé—´ï¼Œæ•°æ®é¡µæ‰€åœ¨çš„ç£ç›˜ä½ç½®æ˜¯è¡¨ç©ºé—´çš„ä½ç½®ï¼Œmargeå¹¶æ²¡æœ‰æŠŠæ•°æ®ç›´æ¥å†™é“è¿™ä¸ªè¡¨ç©ºé—´çš„ä½ç½®å—ï¼Ÿ <br></div>
                            <span class="time">2018-12-05 10:07</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å‰é¢ä¸¤å¥ç†è§£å¯¹åº”ä½ç½®æ˜¯å¯¹çš„å“ˆï¼Œ<br>æœ€åä¸€å¥é—®é¢˜ï¼šæ²¡æœ‰é©¬ä¸Šå†™</p>
                                <p class="reply-time">2018-12-05 11:08</p>
                            </div>
                            
                        </div>
                    </li>
                    


                </ul>
            </div>
        </div>
    </div>
</div>
</body>
</html>