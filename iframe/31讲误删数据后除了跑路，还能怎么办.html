<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <style type="text/css">

#watermark {

  position: relative;
  overflow: hidden;
}

#watermark .x {
  position: absolute;
  top: 800;
  left: 400;
  color: #3300ff;
  font-size: 50px;
  pointer-events: none;
  opacity:0.3;
  filter:Alpha(opacity=50);
  
  
}
    </style>


    <style type="text/css">
 html{color:#333;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;text-rendering:optimizelegibility;font-family:Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif}html.borderbox *,html.borderbox :after,html.borderbox :before{box-sizing:border-box}article,aside,blockquote,body,button,code,dd,details,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hr,input,legend,li,menu,nav,ol,p,pre,section,td,textarea,th,ul{margin:0;padding:0}article,aside,details,figcaption,figure,footer,header,menu,nav,section{display:block}audio,canvas,video{display:inline-block}body,button,input,select,textarea{font:300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}table{border-collapse:collapse;border-spacing:0}fieldset,img{border:0}blockquote{position:relative;color:#999;font-weight:400;border-left:1px solid #1abc9c;padding-left:1em;margin:1em 3em 1em 2em}@media only screen and (max-width:640px){blockquote{margin:1em 0}}abbr,acronym{border-bottom:1px dotted;font-variant:normal}abbr{cursor:help}del{text-decoration:line-through}address,caption,cite,code,dfn,em,th,var{font-style:normal;font-weight:400}ol,ul{list-style:none}caption,th{text-align:left}q:after,q:before{content:""}sub,sup{font-size:75%;line-height:0;position:relative}:root sub,:root sup{vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}a{color:#1abc9c}a:hover{text-decoration:underline}.typo a{border-bottom:1px solid #1abc9c}.typo a:hover{border-bottom-color:#555;color:#555}.typo a:hover,a,ins{text-decoration:none}.typo-u,u{text-decoration:underline}mark{background:#fffdd1;border-bottom:1px solid #ffedce;padding:2px;margin:0 5px}code,pre,pre tt{font-family:Courier,Courier New,monospace}pre{background:hsla(0,0%,97%,.7);border:1px solid #ddd;padding:1em 1.5em;display:block;-webkit-overflow-scrolling:touch}hr{border:none;border-bottom:1px solid #cfcfcf;margin-bottom:.8em;height:10px}.typo-small,figcaption,small{font-size:.9em;color:#888}b,strong{font-weight:700;color:#000}[draggable]{cursor:move}.clearfix:after,.clearfix:before{content:"";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.textwrap,.textwrap td,.textwrap th{word-wrap:break-word;word-break:break-all}.textwrap-table{table-layout:fixed}.serif{font-family:Palatino,Optima,Georgia,serif}.typo-dl,.typo-form,.typo-hr,.typo-ol,.typo-p,.typo-pre,.typo-table,.typo-ul,.typo dl,.typo form,.typo hr,.typo ol,.typo p,.typo pre,.typo table,.typo ul,blockquote{margin-bottom:1rem}h1,h2,h3,h4,h5,h6{font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;line-height:1.35}.typo-h1,.typo-h2,.typo-h3,.typo-h4,.typo-h5,.typo-h6,.typo h1,.typo h2,.typo h3,.typo h4,.typo h5,.typo h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}.typo-h1,.typo h1{font-size:2em}.typo-h2,.typo h2{font-size:1.8em}.typo-h3,.typo h3{font-size:1.6em}.typo-h4,.typo h4{font-size:1.4em}.typo-h5,.typo-h6,.typo h5,.typo h6{font-size:1.2em}.typo-ul,.typo ul{margin-left:1.3em;list-style:disc}.typo-ol,.typo ol{list-style:decimal;margin-left:1.9em}.typo-ol ol,.typo-ol ul,.typo-ul ol,.typo-ul ul,.typo li ol,.typo li ul{margin-bottom:.8em;margin-left:2em}.typo-ol ul,.typo-ul ul,.typo li ul{list-style:circle}.typo-table td,.typo-table th,.typo table caption,.typo table td,.typo table th{border:1px solid #ddd;padding:.5em 1em;color:#666}.typo-table th,.typo table th{background:#fbfbfb}.typo-table thead th,.typo table thead th{background:hsla(0,0%,95%,.7)}.typo table caption{border-bottom:none}.typo-input,.typo-textarea{-webkit-appearance:none;border-radius:0}.typo-em,.typo em,caption,legend{color:#000;font-weight:inherit}.typo-em{position:relative}.typo-em:after{position:absolute;top:.65em;left:0;width:100%;overflow:hidden;white-space:nowrap;content:"\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"}.typo img{max-width:100%}.common-content{font-weight:400;color:#353535;line-height:1.75rem;white-space:normal;word-break:normal;font-size:1rem}.common-content img{display:block;max-width:100%;background-color:#eee}.common-content audio,.common-content video{width:100%;background-color:#eee}.common-content center,.common-content font{margin-top:1rem;display:inline-block}.common-content center{width:100%}.common-content pre{margin-top:1rem;padding-left:0;padding-right:0;position:relative;overflow:hidden}.common-content pre code{font-size:.8rem;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;display:block;width:100%;box-sizing:border-box;padding-left:1rem;padding-right:1rem;overflow-x:auto}.common-content hr{border:none;margin-top:1.5rem;margin-bottom:1.5rem;border-top:1px solid #f5f5f5;height:1px;background:none}.common-content b,.common-content h1,.common-content h2,.common-content h3,.common-content h4,.common-content h5,.common-content strong{font-weight:700}.common-content h1,.common-content h2{font-size:1.125rem;margin-bottom:.45rem}.common-content h3,.common-content h4,.common-content h5{font-size:1rem;margin-bottom:.45rem}.common-content p{font-weight:400;color:#353535;margin-top:.15rem}.common-content .orange{color:#ff5a05}.common-content .reference{font-size:1rem;color:#888}.custom-rich-content h1{margin-top:0;font-weight:400;font-size:15.25px;border-bottom:1px solid #eee;line-height:2.8}.custom-rich-content li,.custom-rich-content p{font-size:14px;color:#888;line-height:1.6}table.hljs-ln{margin-bottom:0;border-spacing:0;border-collapse:collapse}table.hljs-ln,table.hljs-ln tbody,table.hljs-ln td,table.hljs-ln tr{box-sizing:border-box}table.hljs-ln td{padding:0;border:0}table.hljs-ln td.hljs-ln-numbers{min-width:15px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;cursor:pointer;user-select:none}table.hljs-ln td.hljs-ln-code,table.hljs-ln td.hljs-ln-numbers{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;line-height:20px;vertical-align:top}table.hljs-ln td.hljs-ln-code{position:relative;padding-right:10px;padding-left:10px;overflow:visible;color:#24292e;word-wrap:normal;white-space:pre}video::-webkit-media-controls{overflow:hidden!important}video::-webkit-media-controls-enclosure{width:calc(100% + 32px);margin-left:auto}.button-cancel{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel,.button-primary{-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary{color:#fff;background-color:#ff5a05;border-radius:3px}@font-face{font-family:iconfont;src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot);src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.woff) format("woff"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.ttf) format("truetype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.svg#iconfont) format("svg")}@font-face{font-family:player-font;src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot);src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.woff) format("woff"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.ttf) format("truetype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.svg#player-font) format("svg")}.iconfont{font-family:iconfont!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;-moz-osx-font-smoothing:grayscale}html{background:#fff;min-height:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{width:100%}body.fixed{overflow:hidden;position:fixed;width:100vw;height:100vh}i{font-style:normal}a{word-wrap:break-word;-webkit-tap-highlight-color:rgba(0,0,0,0)}a:hover{text-decoration:none}.fade-enter-active,.fade-leave-active{transition:opacity .3s}.fade-enter,.fade-leave-to{opacity:0}.MathJax,.MathJax_CHTML,.MathJax_MathContainer,.MathJax_MathML,.MathJax_PHTML,.MathJax_PlainSource,.MathJax_SVG{outline:0}.ios-app-switch .js-audit{display:none}._loading_wrap_{position:fixed;width:100vw;height:100vh;top:50%;left:50%;transform:translate(-50%,-50%);z-index:999}._loading_div_class_,._loading_wrap_{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._loading_div_class_{word-wrap:break-word;padding:.5rem .75rem;text-align:center;z-index:9999;font-size:.6rem;max-width:60%;color:#fff;border-radius:.25rem;-ms-flex-direction:column;flex-direction:column}._loading_div_class_ .message{color:#353535;font-size:16px;line-height:3}.spinner{animation:circle-rotator 1.4s linear infinite}.spinner *{line-height:0;box-sizing:border-box}@keyframes circle-rotator{0%{transform:rotate(0deg)}to{transform:rotate(270deg)}}.path{stroke-dasharray:187;stroke-dashoffset:0;transform-origin:center;animation:circle-dash 1.4s ease-in-out infinite,circle-colors 5.6s ease-in-out infinite}@keyframes circle-colors{0%{stroke:#ff5a05}to{stroke:#ff5a05}}@keyframes circle-dash{0%{stroke-dashoffset:187}50%{stroke-dashoffset:46.75;transform:rotate(135deg)}to{stroke-dashoffset:187;transform:rotate(450deg)}}.confirm-box-wrapper,.confirm-box-wrapper .mask{position:absolute;top:0;left:0;right:0;bottom:0}.confirm-box-wrapper .mask{background:rgba(0,0,0,.6)}.confirm-box-wrapper .confirm-box{position:fixed;top:50%;left:50%;width:267px;background:#fff;transform:translate(-50%,-50%);border-radius:7px}.confirm-box-wrapper .confirm-box .head{margin:0 18px;font-size:18px;text-align:center;line-height:65px;border-bottom:1px solid #d9d9d9}.confirm-box-wrapper .confirm-box .body{padding:18px;padding-bottom:0;color:#353535;font-size:12.5px;max-height:150px;overflow:auto}.confirm-box-wrapper .confirm-box .foot{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;padding:18px}.confirm-box-wrapper .confirm-box .foot .button-cancel{border:1px solid #d9d9d9}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}




    </style>
    <style type="text/css">
        .button-cancel[data-v-87ffcada]{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel[data-v-87ffcada],.button-primary[data-v-87ffcada]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary[data-v-87ffcada]{color:#fff;background-color:#ff5a05;border-radius:3px}.pd[data-v-87ffcada]{padding-left:1.375rem;padding-right:1.375rem}.article[data-v-87ffcada]{max-width:70rem;margin:0 auto}.article .article-unavailable[data-v-87ffcada]{color:#fa8919;font-size:15px;font-weight:600;line-height:24px;border-radius:5px;padding:12px;background-color:#f6f7fb;margin-top:20px}.article .article-unavailable .iconfont[data-v-87ffcada]{font-size:12px}.article .main[data-v-87ffcada]{padding:1.25rem 0;margin-bottom:52px}.article-title[data-v-87ffcada]{color:#353535;font-weight:400;line-height:1.65rem;font-size:1.34375rem}.article-info[data-v-87ffcada]{color:#888;font-size:.9375rem;margin-top:1.0625rem}.article-content[data-v-87ffcada]{margin-top:1.0625rem}.article-content.android video[data-v-87ffcada]::-webkit-media-controls-fullscreen-button{display:none}.copyright[data-v-87ffcada]{color:#b2b2b2;padding-bottom:20px;margin-top:20px;font-size:13px}.audio-player[data-v-87ffcada]{width:100%;margin:20px 0}.to-comment[data-v-87ffcada]{overflow:hidden;padding-top:10px;margin-bottom:-30px}.to-comment a.button-primary[data-v-87ffcada]{float:right;height:20px;font-size:12px;line-height:20px;padding:4px 8px;cursor:pointer}.article-comments[data-v-87ffcada]{margin-top:2rem}.article-comments h2[data-v-87ffcada]{text-align:center;color:#888;position:relative;z-index:1;margin-bottom:1rem}.article-comments h2[data-v-87ffcada]:before{border-top:1px dotted #888;content:"";position:absolute;top:56%;left:0;width:100%;z-index:-1}.article-comments h2 span[data-v-87ffcada]{font-size:15.25px;font-weight:400;padding:0 1rem;background:#fff;display:inline-block}.article-sub-bottom[data-v-87ffcada]{z-index:10;cursor:pointer}.switch-btns[data-v-87ffcada]{height:76px;cursor:pointer;padding-top:24px;padding-bottom:24px;border-bottom:10px solid #f6f7fb;position:relative}.switch-btns[data-v-87ffcada]:before{content:" ";height:1px;background:#e8e8e8;position:absolute;top:0;left:0;-webkit-box-sizing:border-box;box-sizing:border-box;left:1.375rem;right:1.375rem}.switch-btns .btn[data-v-87ffcada]{height:38px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.switch-btns .btn .tag[data-v-87ffcada]{-webkit-box-flex:0;-ms-flex:0 0 62px;flex:0 0 62px;text-align:center;color:#888;font-size:14px;border-radius:10px;height:22px;line-height:22px;background:#f6f7fb;font-weight:400}.switch-btns .btn .txt[data-v-87ffcada]{margin-left:10px;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:#888;font-size:15px;height:22px;line-height:22px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400}@media (max-width:769px){.article .breadcrumb[data-v-87ffcada]{padding-top:10px;padding-bottom:10px}}





    </style>

    <style type="text/css">
        .comment-item{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:1rem}.comment-item a{border-bottom:none}.comment-item .avatar{width:2.625rem;height:2.625rem;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}.comment-item .info{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.comment-item .info .hd{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .username{color:#888;font-size:15.25px;font-weight:400;line-height:1.2}.comment-item .info .hd .control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .control .btn-share{color:#888;font-size:.75rem;margin-right:1rem}.comment-item .info .hd .control .btn-praise{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:15.25px;text-decoration:none}.comment-item .info .hd .control .btn-praise i{color:#888;display:inline-block;font-size:.75rem;margin-right:.3rem;margin-top:-.01rem}.comment-item .info .hd .control .btn-praise i.on,.comment-item .info .hd .control .btn-praise span{color:#ff5a05}.comment-item .info .bd{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6}.comment-item .info .time{color:#888;font-size:9px;line-height:1}.comment-item .info .reply .reply-hd{font-size:15.25px}.comment-item .info .reply .reply-hd span{margin-left:-12px;color:#888;font-weight:400}.comment-item .info .reply .reply-hd i{color:#ff5a05;font-size:15.25px}.comment-item .info .reply .reply-content{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all}.comment-item .info .reply .reply-time{color:#888;font-size:9px}




    </style>
</head>
<body>
<div id="app">


    <div data-v-87ffcada="" class="article" id="watermark">
        <div data-v-87ffcada="" class="main main-app">
            <h1 data-v-87ffcada="" class="article-title pd">
                31è®²è¯¯åˆ æ•°æ®åé™¤äº†è·‘è·¯ï¼Œè¿˜èƒ½æ€ä¹ˆåŠ
            </h1>
            <div data-v-87ffcada="" class="article-content typo common-content pd"><img data-v-87ffcada=""
                                                                                        src="https://static001.geekbang.org/resource/image/c1/19/c197f72fb1639cde5ac57ffe5a847419.jpg">

                <div>
                    <audio controls="controls" height="100" width="100">
                        <source src="31è®²è¯¯åˆ æ•°æ®åé™¤äº†è·‘è·¯ï¼Œè¿˜èƒ½æ€ä¹ˆåŠ.mp3" type="audio/mp3" />
                        <embed height="100" width="100" src="31è®²è¯¯åˆ æ•°æ®åé™¤äº†è·‘è·¯ï¼Œè¿˜èƒ½æ€ä¹ˆåŠ.mp3" />
                    </audio>
                </div>
                <div data-v-87ffcada="" id="article-content" class="">
                    <div class="text">
                        <p>ä»Šå¤©æˆ‘è¦å’Œä½ è®¨è®ºçš„æ˜¯ä¸€ä¸ªæ²‰é‡çš„è¯é¢˜ï¼šè¯¯åˆ æ•°æ®ã€‚</p><p>åœ¨å‰é¢å‡ ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†MySQLçš„é«˜å¯ç”¨æ¶æ„ã€‚å½“ç„¶ï¼Œä¼ ç»Ÿçš„é«˜å¯ç”¨æ¶æ„æ˜¯ä¸èƒ½é¢„é˜²è¯¯åˆ æ•°æ®çš„ï¼Œå› ä¸ºä¸»åº“çš„ä¸€ä¸ªdrop tableå‘½ä»¤ï¼Œä¼šé€šè¿‡binlogä¼ ç»™æ‰€æœ‰ä»åº“å’Œçº§è”ä»åº“ï¼Œè¿›è€Œå¯¼è‡´æ•´ä¸ªé›†ç¾¤çš„å®ä¾‹éƒ½ä¼šæ‰§è¡Œè¿™ä¸ªå‘½ä»¤ã€‚</p><p>è™½ç„¶æˆ‘ä»¬ä¹‹å‰é‡åˆ°çš„å¤§å¤šæ•°çš„æ•°æ®è¢«åˆ ï¼Œéƒ½æ˜¯è¿ç»´åŒå­¦æˆ–è€…DBAèƒŒé”…çš„ã€‚ä½†å®é™…ä¸Šï¼Œåªè¦æœ‰æ•°æ®æ“ä½œæƒé™çš„åŒå­¦ï¼Œéƒ½æœ‰å¯èƒ½è¸©åˆ°è¯¯åˆ æ•°æ®è¿™æ¡çº¿ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬å°±æ¥èŠèŠè¯¯åˆ æ•°æ®å‰åï¼Œæˆ‘ä»¬å¯ä»¥åšäº›ä»€ä¹ˆï¼Œå‡å°‘è¯¯åˆ æ•°æ®çš„é£é™©ï¼Œå’Œç”±è¯¯åˆ æ•°æ®å¸¦æ¥çš„æŸå¤±ã€‚</p><p>ä¸ºäº†æ‰¾åˆ°è§£å†³è¯¯åˆ æ•°æ®çš„æ›´é«˜æ•ˆçš„æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹å’ŒMySQLç›¸å…³çš„è¯¯åˆ æ•°æ®ï¼Œåšä¸‹åˆ†ç±»ï¼š</p><ol>
<li>
<p>ä½¿ç”¨deleteè¯­å¥è¯¯åˆ æ•°æ®è¡Œï¼›</p>
</li>
<li>
<p>ä½¿ç”¨drop tableæˆ–è€…truncate tableè¯­å¥è¯¯åˆ æ•°æ®è¡¨ï¼›</p>
</li>
<li>
<p>ä½¿ç”¨drop databaseè¯­å¥è¯¯åˆ æ•°æ®åº“ï¼›</p>
</li>
<li>
<p>ä½¿ç”¨rmå‘½ä»¤è¯¯åˆ æ•´ä¸ªMySQLå®ä¾‹ã€‚</p>
</li>
</ol><h1>è¯¯åˆ è¡Œ</h1><p>åœ¨<a href="https://time.geekbang.org/column/article/76446">ç¬¬24ç¯‡æ–‡ç« </a>ä¸­ï¼Œæˆ‘ä»¬æåˆ°å¦‚æœæ˜¯ä½¿ç”¨deleteè¯­å¥è¯¯åˆ äº†æ•°æ®è¡Œï¼Œå¯ä»¥ç”¨Flashbackå·¥å…·é€šè¿‡é—ªå›æŠŠæ•°æ®æ¢å¤å›æ¥ã€‚</p><p>Flashbackæ¢å¤æ•°æ®çš„åŸç†ï¼Œæ˜¯ä¿®æ”¹binlogçš„å†…å®¹ï¼Œæ‹¿å›åŸåº“é‡æ”¾ã€‚è€Œèƒ½å¤Ÿä½¿ç”¨è¿™ä¸ªæ–¹æ¡ˆçš„å‰ææ˜¯ï¼Œéœ€è¦ç¡®ä¿binlog_format=row å’Œ binlog_row_image=FULLã€‚</p><!-- [[[read_end]]] --><p>å…·ä½“æ¢å¤æ•°æ®æ—¶ï¼Œå¯¹å•ä¸ªäº‹åŠ¡åšå¦‚ä¸‹å¤„ç†ï¼š</p><ol>
<li>
<p>å¯¹äºinsertè¯­å¥ï¼Œå¯¹åº”çš„binlog eventç±»å‹æ˜¯Write_rows eventï¼ŒæŠŠå®ƒæ”¹æˆDelete_rows eventå³å¯ï¼›</p>
</li>
<li>
<p>åŒç†ï¼Œå¯¹äºdeleteè¯­å¥ï¼Œä¹Ÿæ˜¯å°†Delete_rows eventæ”¹ä¸ºWrite_rows eventï¼›</p>
</li>
<li>
<p>è€Œå¦‚æœæ˜¯Update_rowsçš„è¯ï¼Œbinlogé‡Œé¢è®°å½•äº†æ•°æ®è¡Œä¿®æ”¹å‰å’Œä¿®æ”¹åçš„å€¼ï¼Œå¯¹è°ƒè¿™ä¸¤è¡Œçš„ä½ç½®å³å¯ã€‚</p>
</li>
</ol><p>å¦‚æœè¯¯æ“ä½œä¸æ˜¯ä¸€ä¸ªï¼Œè€Œæ˜¯å¤šä¸ªï¼Œä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿæ¯”å¦‚ä¸‹é¢ä¸‰ä¸ªäº‹åŠ¡ï¼š</p><pre><code>(A)delete ...
(B)insert ...
(C)update ...
</code></pre><p>ç°åœ¨è¦æŠŠæ•°æ®åº“æ¢å¤å›è¿™ä¸‰ä¸ªäº‹åŠ¡æ“ä½œä¹‹å‰çš„çŠ¶æ€ï¼Œç”¨Flashbackå·¥å…·è§£æbinlogåï¼Œå†™å›ä¸»åº“çš„å‘½ä»¤æ˜¯ï¼š</p><pre><code>(reverse C)update ...
(reverse B)delete ...
(reverse A)insert ...
</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¯¯åˆ æ•°æ®æ¶‰åŠåˆ°äº†å¤šä¸ªäº‹åŠ¡çš„è¯ï¼Œéœ€è¦å°†äº‹åŠ¡çš„é¡ºåºè°ƒè¿‡æ¥å†æ‰§è¡Œã€‚</p><p><strong>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œæˆ‘ä¸å»ºè®®ä½ ç›´æ¥åœ¨ä¸»åº“ä¸Šæ‰§è¡Œè¿™äº›æ“ä½œã€‚</strong></p><p>æ¢å¤æ•°æ®æ¯”è¾ƒå®‰å…¨çš„åšæ³•ï¼Œæ˜¯æ¢å¤å‡ºä¸€ä¸ªå¤‡ä»½ï¼Œæˆ–è€…æ‰¾ä¸€ä¸ªä»åº“ä½œä¸ºä¸´æ—¶åº“ï¼Œåœ¨è¿™ä¸ªä¸´æ—¶åº“ä¸Šæ‰§è¡Œè¿™äº›æ“ä½œï¼Œç„¶åå†å°†ç¡®è®¤è¿‡çš„ä¸´æ—¶åº“çš„æ•°æ®ï¼Œæ¢å¤å›ä¸»åº“ã€‚</p><p>ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšå‘¢ï¼Ÿ</p><p>è¿™æ˜¯å› ä¸ºï¼Œä¸€ä¸ªåœ¨æ‰§è¡Œçº¿ä¸Šé€»è¾‘çš„ä¸»åº“ï¼Œæ•°æ®çŠ¶æ€çš„å˜æ›´å¾€å¾€æ˜¯æœ‰å…³è”çš„ã€‚å¯èƒ½ç”±äºå‘ç°æ•°æ®é—®é¢˜çš„æ—¶é—´æ™šäº†ä¸€ç‚¹å„¿ï¼Œå°±å¯¼è‡´å·²ç»åœ¨ä¹‹å‰è¯¯æ“ä½œçš„åŸºç¡€ä¸Šï¼Œä¸šåŠ¡ä»£ç é€»è¾‘åˆç»§ç»­ä¿®æ”¹äº†å…¶ä»–æ•°æ®ã€‚æ‰€ä»¥ï¼Œå¦‚æœè¿™æ—¶å€™å•ç‹¬æ¢å¤è¿™å‡ è¡Œæ•°æ®ï¼Œè€Œåˆæœªç»ç¡®è®¤çš„è¯ï¼Œå°±å¯èƒ½ä¼šå‡ºç°å¯¹æ•°æ®çš„äºŒæ¬¡ç ´åã€‚</p><p>å½“ç„¶ï¼Œ<strong>æˆ‘ä»¬ä¸æ­¢è¦è¯´è¯¯åˆ æ•°æ®çš„äº‹åå¤„ç†åŠæ³•ï¼Œæ›´é‡è¦æ˜¯è¦åšåˆ°äº‹å‰é¢„é˜²</strong>ã€‚æˆ‘æœ‰ä»¥ä¸‹ä¸¤ä¸ªå»ºè®®ï¼š</p><ol>
<li>
<p>æŠŠsql_safe_updateså‚æ•°è®¾ç½®ä¸ºonã€‚è¿™æ ·ä¸€æ¥ï¼Œå¦‚æœæˆ‘ä»¬å¿˜è®°åœ¨deleteæˆ–è€…updateè¯­å¥ä¸­å†™whereæ¡ä»¶ï¼Œæˆ–è€…whereæ¡ä»¶é‡Œé¢æ²¡æœ‰åŒ…å«ç´¢å¼•å­—æ®µçš„è¯ï¼Œè¿™æ¡è¯­å¥çš„æ‰§è¡Œå°±ä¼šæŠ¥é”™ã€‚</p>
</li>
<li>
<p>ä»£ç ä¸Šçº¿å‰ï¼Œå¿…é¡»ç»è¿‡SQLå®¡è®¡ã€‚</p>
</li>
</ol><p>ä½ å¯èƒ½ä¼šè¯´ï¼Œè®¾ç½®äº†sql_safe_updates=onï¼Œå¦‚æœæˆ‘çœŸçš„è¦æŠŠä¸€ä¸ªå°è¡¨çš„æ•°æ®å…¨éƒ¨åˆ æ‰ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>å¦‚æœä½ ç¡®å®šè¿™ä¸ªåˆ é™¤æ“ä½œæ²¡é—®é¢˜çš„è¯ï¼Œå¯ä»¥åœ¨deleteè¯­å¥ä¸­åŠ ä¸Šwhereæ¡ä»¶ï¼Œæ¯”å¦‚where id&gt;=0ã€‚</p><p>ä½†æ˜¯ï¼Œdeleteå…¨è¡¨æ˜¯å¾ˆæ…¢çš„ï¼Œéœ€è¦ç”Ÿæˆå›æ»šæ—¥å¿—ã€å†™redoã€å†™binlogã€‚æ‰€ä»¥ï¼Œä»æ€§èƒ½è§’åº¦è€ƒè™‘ï¼Œä½ åº”è¯¥ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨truncate tableæˆ–è€…drop tableå‘½ä»¤ã€‚</p><p>ä½¿ç”¨deleteå‘½ä»¤åˆ é™¤çš„æ•°æ®ï¼Œä½ è¿˜å¯ä»¥ç”¨Flashbackæ¥æ¢å¤ã€‚è€Œä½¿ç”¨truncate /drop tableå’Œdrop databaseå‘½ä»¤åˆ é™¤çš„æ•°æ®ï¼Œå°±æ²¡åŠæ³•é€šè¿‡Flashbackæ¥æ¢å¤äº†ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>è¿™æ˜¯å› ä¸ºï¼Œå³ä½¿æˆ‘ä»¬é…ç½®äº†binlog_format=rowï¼Œæ‰§è¡Œè¿™ä¸‰ä¸ªå‘½ä»¤æ—¶ï¼Œè®°å½•çš„binlogè¿˜æ˜¯statementæ ¼å¼ã€‚binlogé‡Œé¢å°±åªæœ‰ä¸€ä¸ªtruncate/drop è¯­å¥ï¼Œè¿™äº›ä¿¡æ¯æ˜¯æ¢å¤ä¸å‡ºæ•°æ®çš„ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬çœŸçš„æ˜¯ä½¿ç”¨è¿™å‡ æ¡å‘½ä»¤è¯¯åˆ æ•°æ®äº†ï¼Œåˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><h1>è¯¯åˆ åº“/è¡¨</h1><p>è¿™ç§æƒ…å†µä¸‹ï¼Œè¦æƒ³æ¢å¤æ•°æ®ï¼Œå°±éœ€è¦ä½¿ç”¨å…¨é‡å¤‡ä»½ï¼ŒåŠ å¢é‡æ—¥å¿—çš„æ–¹å¼äº†ã€‚è¿™ä¸ªæ–¹æ¡ˆè¦æ±‚çº¿ä¸Šæœ‰å®šæœŸçš„å…¨é‡å¤‡ä»½ï¼Œå¹¶ä¸”å®æ—¶å¤‡ä»½binlogã€‚</p><p>åœ¨è¿™ä¸¤ä¸ªæ¡ä»¶éƒ½å…·å¤‡çš„æƒ…å†µä¸‹ï¼Œå‡å¦‚æœ‰äººä¸­åˆ12ç‚¹è¯¯åˆ äº†ä¸€ä¸ªåº“ï¼Œæ¢å¤æ•°æ®çš„æµç¨‹å¦‚ä¸‹ï¼š</p><ol>
<li>
<p>å–æœ€è¿‘ä¸€æ¬¡å…¨é‡å¤‡ä»½ï¼Œå‡è®¾è¿™ä¸ªåº“æ˜¯ä¸€å¤©ä¸€å¤‡ï¼Œä¸Šæ¬¡å¤‡ä»½æ˜¯å½“å¤©0ç‚¹ï¼›</p>
</li>
<li>
<p>ç”¨å¤‡ä»½æ¢å¤å‡ºä¸€ä¸ªä¸´æ—¶åº“ï¼›</p>
</li>
<li>
<p>ä»æ—¥å¿—å¤‡ä»½é‡Œé¢ï¼Œå–å‡ºå‡Œæ™¨0ç‚¹ä¹‹åçš„æ—¥å¿—ï¼›</p>
</li>
<li>
<p>æŠŠè¿™äº›æ—¥å¿—ï¼Œé™¤äº†è¯¯åˆ é™¤æ•°æ®çš„è¯­å¥å¤–ï¼Œå…¨éƒ¨åº”ç”¨åˆ°ä¸´æ—¶åº“ã€‚</p>
</li>
</ol><p>è¿™ä¸ªæµç¨‹çš„ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://static001.geekbang.org/resource/image/2f/db/2fafd0b75286e0163f432f85428ff8db.png" alt=""></p><center><span class="reference">å›¾1 æ•°æ®æ¢å¤æµç¨‹-mysqlbinlogæ–¹æ³•</span></center><p>å…³äºè¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘éœ€è¦å’Œä½ è¯´æ˜å¦‚ä¸‹å‡ ç‚¹ï¼š</p><ol>
<li>
<p>ä¸ºäº†åŠ é€Ÿæ•°æ®æ¢å¤ï¼Œå¦‚æœè¿™ä¸ªä¸´æ—¶åº“ä¸Šæœ‰å¤šä¸ªæ•°æ®åº“ï¼Œä½ å¯ä»¥åœ¨ä½¿ç”¨mysqlbinlogå‘½ä»¤æ—¶ï¼ŒåŠ ä¸Šä¸€ä¸ªâ€“databaseå‚æ•°ï¼Œç”¨æ¥æŒ‡å®šè¯¯åˆ è¡¨æ‰€åœ¨çš„åº“ã€‚è¿™æ ·ï¼Œå°±é¿å…äº†åœ¨æ¢å¤æ•°æ®æ—¶è¿˜è¦åº”ç”¨å…¶ä»–åº“æ—¥å¿—çš„æƒ…å†µã€‚</p>
</li>
<li>
<p>åœ¨åº”ç”¨æ—¥å¿—çš„æ—¶å€™ï¼Œéœ€è¦è·³è¿‡12ç‚¹è¯¯æ“ä½œçš„é‚£ä¸ªè¯­å¥çš„binlogï¼š</p>
<ul>
<li>å¦‚æœåŸå®ä¾‹æ²¡æœ‰ä½¿ç”¨GTIDæ¨¡å¼ï¼Œåªèƒ½åœ¨åº”ç”¨åˆ°åŒ…å«12ç‚¹çš„binlogæ–‡ä»¶çš„æ—¶å€™ï¼Œå…ˆç”¨â€“stop-positionå‚æ•°æ‰§è¡Œåˆ°è¯¯æ“ä½œä¹‹å‰çš„æ—¥å¿—ï¼Œç„¶åå†ç”¨â€“start-positionä»è¯¯æ“ä½œä¹‹åçš„æ—¥å¿—ç»§ç»­æ‰§è¡Œï¼›</li>
<li>å¦‚æœå®ä¾‹ä½¿ç”¨äº†GTIDæ¨¡å¼ï¼Œå°±æ–¹ä¾¿å¤šäº†ã€‚å‡è®¾è¯¯æ“ä½œå‘½ä»¤çš„GTIDæ˜¯gtid1ï¼Œé‚£ä¹ˆåªéœ€è¦æ‰§è¡Œset gtid_next=gtid1;begin;commit; å…ˆæŠŠè¿™ä¸ªGTIDåŠ åˆ°ä¸´æ—¶å®ä¾‹çš„GTIDé›†åˆï¼Œä¹‹åæŒ‰é¡ºåºæ‰§è¡Œbinlogçš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨è·³è¿‡è¯¯æ“ä½œçš„è¯­å¥ã€‚</li>
</ul>
</li>
</ol><p>ä¸è¿‡ï¼Œå³ä½¿è¿™æ ·ï¼Œä½¿ç”¨mysqlbinlogæ–¹æ³•æ¢å¤æ•°æ®è¿˜æ˜¯ä¸å¤Ÿå¿«ï¼Œä¸»è¦åŸå› æœ‰ä¸¤ä¸ªï¼š</p><ol>
<li>
<p>å¦‚æœæ˜¯è¯¯åˆ è¡¨ï¼Œæœ€å¥½å°±æ˜¯åªæ¢å¤å‡ºè¿™å¼ è¡¨ï¼Œä¹Ÿå°±æ˜¯åªé‡æ”¾è¿™å¼ è¡¨çš„æ“ä½œï¼Œä½†æ˜¯mysqlbinlogå·¥å…·å¹¶ä¸èƒ½æŒ‡å®šåªè§£æä¸€ä¸ªè¡¨çš„æ—¥å¿—ï¼›</p>
</li>
<li>
<p>ç”¨mysqlbinlogè§£æå‡ºæ—¥å¿—åº”ç”¨ï¼Œåº”ç”¨æ—¥å¿—çš„è¿‡ç¨‹å°±åªèƒ½æ˜¯å•çº¿ç¨‹ã€‚æˆ‘ä»¬åœ¨<a href="https://time.geekbang.org/column/article/77083">ç¬¬26ç¯‡æ–‡ç« </a>ä¸­ä»‹ç»çš„é‚£äº›å¹¶è¡Œå¤åˆ¶çš„æ–¹æ³•ï¼Œåœ¨è¿™é‡Œéƒ½ç”¨ä¸ä¸Šã€‚</p>
</li>
</ol><p><strong>ä¸€ç§åŠ é€Ÿçš„æ–¹æ³•æ˜¯ï¼Œ</strong>åœ¨ç”¨å¤‡ä»½æ¢å¤å‡ºä¸´æ—¶å®ä¾‹ä¹‹åï¼Œå°†è¿™ä¸ªä¸´æ—¶å®ä¾‹è®¾ç½®æˆçº¿ä¸Šå¤‡åº“çš„ä»åº“ï¼Œè¿™æ ·ï¼š</p><ol>
<li>
<p>åœ¨start slaveä¹‹å‰ï¼Œå…ˆé€šè¿‡æ‰§è¡Œï»¿<br>
ï»¿change replication filter replicate_do_table = (tbl_name) å‘½ä»¤ï¼Œå°±å¯ä»¥è®©ä¸´æ—¶åº“åªåŒæ­¥è¯¯æ“ä½œçš„è¡¨ï¼›</p>
</li>
<li>
<p>è¿™æ ·åšä¹Ÿå¯ä»¥ç”¨ä¸Šå¹¶è¡Œå¤åˆ¶æŠ€æœ¯ï¼Œæ¥åŠ é€Ÿæ•´ä¸ªæ•°æ®æ¢å¤è¿‡ç¨‹ã€‚</p>
</li>
</ol><p>è¿™ä¸ªè¿‡ç¨‹çš„ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src="https://static001.geekbang.org/resource/image/65/f1/65bb04929b8235fb677c7a78b5bd67f1.png" alt=""></p><center><span class="reference">å›¾2 æ•°æ®æ¢å¤æµç¨‹-master-slaveæ–¹æ³•</span></center><p>å¯ä»¥çœ‹åˆ°ï¼Œå›¾ä¸­binlogå¤‡ä»½ç³»ç»Ÿåˆ°çº¿ä¸Šå¤‡åº“æœ‰ä¸€æ¡è™šçº¿ï¼Œæ˜¯æŒ‡å¦‚æœç”±äºæ—¶é—´å¤ªä¹…ï¼Œå¤‡åº“ä¸Šå·²ç»åˆ é™¤äº†ä¸´æ—¶å®ä¾‹éœ€è¦çš„binlogçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä»binlogå¤‡ä»½ç³»ç»Ÿä¸­æ‰¾åˆ°éœ€è¦çš„binlogï¼Œå†æ”¾å›å¤‡åº“ä¸­ã€‚</p><p>å‡è®¾ï¼Œæˆ‘ä»¬å‘ç°å½“å‰ä¸´æ—¶å®ä¾‹éœ€è¦çš„binlogæ˜¯ä»master.000005å¼€å§‹çš„ï¼Œä½†æ˜¯åœ¨å¤‡åº“ä¸Šæ‰§è¡Œshow binlogs æ˜¾ç¤ºçš„æœ€å°çš„binlogæ–‡ä»¶æ˜¯master.000007ï¼Œæ„å‘³ç€å°‘äº†ä¸¤ä¸ªbinlogæ–‡ä»¶ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦å»binlogå¤‡ä»½ç³»ç»Ÿä¸­æ‰¾åˆ°è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚</p><p>æŠŠä¹‹å‰åˆ æ‰çš„binlogæ”¾å›å¤‡åº“çš„æ“ä½œæ­¥éª¤ï¼Œæ˜¯è¿™æ ·çš„ï¼š</p><ol>
<li>
<p>ä»å¤‡ä»½ç³»ç»Ÿä¸‹è½½master.000005å’Œmaster.000006è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ”¾åˆ°å¤‡åº“çš„æ—¥å¿—ç›®å½•ä¸‹ï¼›</p>
</li>
<li>
<p>æ‰“å¼€æ—¥å¿—ç›®å½•ä¸‹çš„master.indexæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶å¼€å¤´åŠ å…¥ä¸¤è¡Œï¼Œå†…å®¹åˆ†åˆ«æ˜¯ â€œ./master.000005â€å’Œâ€œ./master.000006â€;</p>
</li>
<li>
<p>é‡å¯å¤‡åº“ï¼Œç›®çš„æ˜¯è¦è®©å¤‡åº“é‡æ–°è¯†åˆ«è¿™ä¸¤ä¸ªæ—¥å¿—æ–‡ä»¶ï¼›</p>
</li>
<li>
<p>ç°åœ¨è¿™ä¸ªå¤‡åº“ä¸Šå°±æœ‰äº†ä¸´æ—¶åº“éœ€è¦çš„æ‰€æœ‰binlogäº†ï¼Œå»ºç«‹ä¸»å¤‡å…³ç³»ï¼Œå°±å¯ä»¥æ­£å¸¸åŒæ­¥äº†ã€‚</p>
</li>
</ol><p>ä¸è®ºæ˜¯æŠŠmysqlbinlogå·¥å…·è§£æå‡ºçš„binlogæ–‡ä»¶åº”ç”¨åˆ°ä¸´æ—¶åº“ï¼Œè¿˜æ˜¯æŠŠä¸´æ—¶åº“æ¥åˆ°å¤‡åº“ä¸Šï¼Œè¿™ä¸¤ä¸ªæ–¹æ¡ˆçš„å…±åŒç‚¹æ˜¯ï¼šè¯¯åˆ åº“æˆ–è€…è¡¨åï¼Œæ¢å¤æ•°æ®çš„æ€è·¯ä¸»è¦å°±æ˜¯é€šè¿‡å¤‡ä»½ï¼Œå†åŠ ä¸Šåº”ç”¨binlogçš„æ–¹å¼ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸¤ä¸ªæ–¹æ¡ˆéƒ½è¦æ±‚å¤‡ä»½ç³»ç»Ÿå®šæœŸå¤‡ä»½å…¨é‡æ—¥å¿—ï¼Œè€Œä¸”éœ€è¦ç¡®ä¿binlogåœ¨è¢«ä»æœ¬åœ°åˆ é™¤ä¹‹å‰å·²ç»åšäº†å¤‡ä»½ã€‚</p><p>ä½†æ˜¯ï¼Œä¸€ä¸ªç³»ç»Ÿä¸å¯èƒ½å¤‡ä»½æ— é™çš„æ—¥å¿—ï¼Œä½ è¿˜éœ€è¦æ ¹æ®æˆæœ¬å’Œç£ç›˜ç©ºé—´èµ„æºï¼Œè®¾å®šä¸€ä¸ªæ—¥å¿—ä¿ç•™çš„å¤©æ•°ã€‚å¦‚æœä½ çš„DBAå›¢é˜Ÿå‘Šè¯‰ä½ ï¼Œå¯ä»¥ä¿è¯æŠŠæŸä¸ªå®ä¾‹æ¢å¤åˆ°åŠä¸ªæœˆå†…çš„ä»»æ„æ—¶é—´ç‚¹ï¼Œè¿™å°±è¡¨ç¤ºå¤‡ä»½ç³»ç»Ÿä¿ç•™çš„æ—¥å¿—æ—¶é—´å°±è‡³å°‘æ˜¯åŠä¸ªæœˆã€‚</p><p>å¦å¤–ï¼Œæˆ‘å»ºè®®ä½ ä¸è®ºä½¿ç”¨ä¸Šè¿°å“ªç§æ–¹å¼ï¼Œéƒ½è¦æŠŠè¿™ä¸ªæ•°æ®æ¢å¤åŠŸèƒ½åšæˆè‡ªåŠ¨åŒ–å·¥å…·ï¼Œå¹¶ä¸”ç»å¸¸æ‹¿å‡ºæ¥æ¼”ç»ƒã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿ</p><p>è¿™é‡Œçš„åŸå› ï¼Œä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªæ–¹é¢ï¼š</p><ol>
<li>
<p>è™½ç„¶â€œå‘ç”Ÿè¿™ç§äº‹ï¼Œå¤§å®¶éƒ½ä¸æƒ³çš„â€ï¼Œä½†æ˜¯ä¸‡ä¸€å‡ºç°äº†è¯¯åˆ äº‹ä»¶ï¼Œèƒ½å¤Ÿå¿«é€Ÿæ¢å¤æ•°æ®ï¼Œå°†æŸå¤±é™åˆ°æœ€å°ï¼Œä¹Ÿåº”è¯¥ä¸ç”¨è·‘è·¯äº†ã€‚</p>
</li>
<li>
<p>è€Œå¦‚æœä¸´æ—¶å†æ‰‹å¿™è„šä¹±åœ°æ‰‹åŠ¨æ“ä½œï¼Œæœ€ååˆè¯¯æ“ä½œäº†ï¼Œå¯¹ä¸šåŠ¡é€ æˆäº†äºŒæ¬¡ä¼¤å®³ï¼Œé‚£å°±è¯´ä¸è¿‡å»äº†ã€‚</p>
</li>
</ol><h1>å»¶è¿Ÿå¤åˆ¶å¤‡åº“</h1><p>è™½ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨å¹¶è¡Œå¤åˆ¶æ¥åŠ é€Ÿæ¢å¤æ•°æ®çš„è¿‡ç¨‹ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ¡ˆä»ç„¶å­˜åœ¨â€œæ¢å¤æ—¶é—´ä¸å¯æ§â€çš„é—®é¢˜ã€‚</p><p>å¦‚æœä¸€ä¸ªåº“çš„å¤‡ä»½ç‰¹åˆ«å¤§ï¼Œæˆ–è€…è¯¯æ“ä½œçš„æ—¶é—´è·ç¦»ä¸Šä¸€ä¸ªå…¨é‡å¤‡ä»½çš„æ—¶é—´è¾ƒé•¿ï¼Œæ¯”å¦‚ä¸€å‘¨ä¸€å¤‡çš„å®ä¾‹ï¼Œåœ¨å¤‡ä»½ä¹‹åçš„ç¬¬6å¤©å‘ç”Ÿè¯¯æ“ä½œï¼Œé‚£å°±éœ€è¦æ¢å¤6å¤©çš„æ—¥å¿—ï¼Œè¿™ä¸ªæ¢å¤æ—¶é—´å¯èƒ½æ˜¯è¦æŒ‰å¤©æ¥è®¡ç®—çš„ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥ç¼©çŸ­æ¢å¤æ•°æ®éœ€è¦çš„æ—¶é—´å‘¢ï¼Ÿ</p><p>å¦‚æœæœ‰éå¸¸æ ¸å¿ƒçš„ä¸šåŠ¡ï¼Œä¸å…è®¸å¤ªé•¿çš„æ¢å¤æ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘<strong>æ­å»ºå»¶è¿Ÿå¤åˆ¶çš„å¤‡åº“ã€‚</strong>è¿™ä¸ªåŠŸèƒ½æ˜¯MySQL 5.6ç‰ˆæœ¬å¼•å…¥çš„ã€‚</p><p>ä¸€èˆ¬çš„ä¸»å¤‡å¤åˆ¶ç»“æ„å­˜åœ¨çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœä¸»åº“ä¸Šæœ‰ä¸ªè¡¨è¢«è¯¯åˆ äº†ï¼Œè¿™ä¸ªå‘½ä»¤å¾ˆå¿«ä¹Ÿä¼šè¢«å‘ç»™æ‰€æœ‰ä»åº“ï¼Œè¿›è€Œå¯¼è‡´æ‰€æœ‰ä»åº“çš„æ•°æ®è¡¨ä¹Ÿéƒ½ä¸€èµ·è¢«è¯¯åˆ äº†ã€‚</p><p>å»¶è¿Ÿå¤åˆ¶çš„å¤‡åº“æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¤‡åº“ï¼Œé€šè¿‡ CHANGE MASTER TO MASTER_DELAY = Nå‘½ä»¤ï¼Œå¯ä»¥æŒ‡å®šè¿™ä¸ªå¤‡åº“æŒç»­ä¿æŒè·Ÿä¸»åº“æœ‰Nç§’çš„å»¶è¿Ÿã€‚</p><p>æ¯”å¦‚ä½ æŠŠNè®¾ç½®ä¸º3600ï¼Œè¿™å°±ä»£è¡¨äº†å¦‚æœä¸»åº“ä¸Šæœ‰æ•°æ®è¢«è¯¯åˆ äº†ï¼Œå¹¶ä¸”åœ¨1å°æ—¶å†…å‘ç°äº†è¿™ä¸ªè¯¯æ“ä½œå‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤å°±è¿˜æ²¡æœ‰åœ¨è¿™ä¸ªå»¶è¿Ÿå¤åˆ¶çš„å¤‡åº“æ‰§è¡Œã€‚è¿™æ—¶å€™åˆ°è¿™ä¸ªå¤‡åº“ä¸Šæ‰§è¡Œstop slaveï¼Œå†é€šè¿‡ä¹‹å‰ä»‹ç»çš„æ–¹æ³•ï¼Œè·³è¿‡è¯¯æ“ä½œå‘½ä»¤ï¼Œå°±å¯ä»¥æ¢å¤å‡ºéœ€è¦çš„æ•°æ®ã€‚</p><p>è¿™æ ·çš„è¯ï¼Œä½ å°±éšæ—¶å¯ä»¥å¾—åˆ°ä¸€ä¸ªï¼Œåªéœ€è¦æœ€å¤šå†è¿½1å°æ—¶ï¼Œå°±å¯ä»¥æ¢å¤å‡ºæ•°æ®çš„ä¸´æ—¶å®ä¾‹ï¼Œä¹Ÿå°±ç¼©çŸ­äº†æ•´ä¸ªæ•°æ®æ¢å¤éœ€è¦çš„æ—¶é—´ã€‚</p><h1>é¢„é˜²è¯¯åˆ åº“/è¡¨çš„æ–¹æ³•</h1><p>è™½ç„¶å¸¸åœ¨æ²³è¾¹èµ°ï¼Œå¾ˆéš¾ä¸æ¹¿é‹ï¼Œä½†ç»ˆç©¶è¿˜æ˜¯å¯ä»¥æ‰¾åˆ°ä¸€äº›æ–¹æ³•æ¥é¿å…çš„ã€‚æ‰€ä»¥è¿™é‡Œï¼Œæˆ‘ä¹Ÿä¼šç»™ä½ ä¸€äº›å‡å°‘è¯¯åˆ æ“ä½œé£é™©çš„å»ºè®®ã€‚</p><p>ç¬¬ä¸€æ¡å»ºè®®æ˜¯ï¼Œè´¦å·åˆ†ç¦»ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ï¼Œé¿å…å†™é”™å‘½ä»¤ã€‚æ¯”å¦‚ï¼š</p><ul>
<li>æˆ‘ä»¬åªç»™ä¸šåŠ¡å¼€å‘åŒå­¦DMLæƒé™ï¼Œè€Œä¸ç»™truncate/dropæƒé™ã€‚è€Œå¦‚æœä¸šåŠ¡å¼€å‘äººå‘˜æœ‰DDLéœ€æ±‚çš„è¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¼€å‘ç®¡ç†ç³»ç»Ÿå¾—åˆ°æ”¯æŒã€‚</li>
<li>å³ä½¿æ˜¯DBAå›¢é˜Ÿæˆå‘˜ï¼Œæ—¥å¸¸ä¹Ÿéƒ½è§„å®šåªä½¿ç”¨åªè¯»è´¦å·ï¼Œå¿…è¦çš„æ—¶å€™æ‰ä½¿ç”¨æœ‰æ›´æ–°æƒé™çš„è´¦å·ã€‚</li>
</ul><p>ç¬¬äºŒæ¡å»ºè®®æ˜¯ï¼Œåˆ¶å®šæ“ä½œè§„èŒƒã€‚è¿™æ ·åšçš„ç›®çš„ï¼Œæ˜¯é¿å…å†™é”™è¦åˆ é™¤çš„è¡¨åã€‚æ¯”å¦‚ï¼š</p><ul>
<li>åœ¨åˆ é™¤æ•°æ®è¡¨ä¹‹å‰ï¼Œå¿…é¡»å…ˆå¯¹è¡¨åšæ”¹åæ“ä½œã€‚ç„¶åï¼Œè§‚å¯Ÿä¸€æ®µæ—¶é—´ï¼Œç¡®ä¿å¯¹ä¸šåŠ¡æ— å½±å“ä»¥åå†åˆ é™¤è¿™å¼ è¡¨ã€‚</li>
<li>æ”¹è¡¨åçš„æ—¶å€™ï¼Œè¦æ±‚ç»™è¡¨ååŠ å›ºå®šçš„åç¼€ï¼ˆæ¯”å¦‚åŠ _to_be_deleted)ï¼Œç„¶ååˆ é™¤è¡¨çš„åŠ¨ä½œå¿…é¡»é€šè¿‡ç®¡ç†ç³»ç»Ÿæ‰§è¡Œã€‚å¹¶ä¸”ï¼Œç®¡ç†ç³»åˆ é™¤è¡¨çš„æ—¶å€™ï¼Œåªèƒ½åˆ é™¤å›ºå®šåç¼€çš„è¡¨ã€‚</li>
</ul><h1>rmåˆ é™¤æ•°æ®</h1><p>å…¶å®ï¼Œå¯¹äºä¸€ä¸ªæœ‰é«˜å¯ç”¨æœºåˆ¶çš„MySQLé›†ç¾¤æ¥è¯´ï¼Œæœ€ä¸æ€•çš„å°±æ˜¯rmåˆ é™¤æ•°æ®äº†ã€‚åªè¦ä¸æ˜¯æ¶æ„åœ°æŠŠæ•´ä¸ªé›†ç¾¤åˆ é™¤ï¼Œè€Œåªæ˜¯åˆ æ‰äº†å…¶ä¸­æŸä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®çš„è¯ï¼ŒHAç³»ç»Ÿå°±ä¼šå¼€å§‹å·¥ä½œï¼Œé€‰å‡ºä¸€ä¸ªæ–°çš„ä¸»åº“ï¼Œä»è€Œä¿è¯æ•´ä¸ªé›†ç¾¤çš„æ­£å¸¸å·¥ä½œã€‚</p><p>è¿™æ—¶ï¼Œä½ è¦åšçš„å°±æ˜¯åœ¨è¿™ä¸ªèŠ‚ç‚¹ä¸ŠæŠŠæ•°æ®æ¢å¤å›æ¥ï¼Œå†æ¥å…¥æ•´ä¸ªé›†ç¾¤ã€‚</p><p>å½“ç„¶äº†ï¼Œç°åœ¨ä¸æ­¢æ˜¯DBAæœ‰è‡ªåŠ¨åŒ–ç³»ç»Ÿï¼ŒSAï¼ˆç³»ç»Ÿç®¡ç†å‘˜ï¼‰ä¹Ÿæœ‰è‡ªåŠ¨åŒ–ç³»ç»Ÿï¼Œæ‰€ä»¥ä¹Ÿè®¸ä¸€ä¸ªæ‰¹é‡ä¸‹çº¿æœºå™¨çš„æ“ä½œï¼Œä¼šè®©ä½ æ•´ä¸ªMySQLé›†ç¾¤çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å…¨å†›è¦†æ²¡ã€‚</p><p>åº”å¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘çš„å»ºè®®åªèƒ½æ˜¯è¯´å°½é‡æŠŠä½ çš„å¤‡ä»½è·¨æœºæˆ¿ï¼Œæˆ–è€…æœ€å¥½æ˜¯è·¨åŸå¸‚ä¿å­˜ã€‚</p><h1>å°ç»“</h1><p>ä»Šå¤©ï¼Œæˆ‘å’Œä½ è®¨è®ºäº†è¯¯åˆ æ•°æ®çš„å‡ ç§å¯èƒ½ï¼Œä»¥åŠè¯¯åˆ åçš„å¤„ç†æ–¹æ³•ã€‚</p><p>ä½†ï¼Œæˆ‘è¦å¼ºè°ƒçš„æ˜¯ï¼Œé¢„é˜²è¿œæ¯”å¤„ç†çš„æ„ä¹‰æ¥å¾—å¤§ã€‚</p><p>å¦å¤–ï¼Œåœ¨MySQLçš„é›†ç¾¤æ–¹æ¡ˆä¸­ï¼Œä¼šæ—¶ä¸æ—¶åœ°ç”¨åˆ°å¤‡ä»½æ¥æ¢å¤å®ä¾‹ï¼Œå› æ­¤å®šæœŸæ£€æŸ¥å¤‡ä»½çš„æœ‰æ•ˆæ€§ä¹Ÿå¾ˆæœ‰å¿…è¦ã€‚</p><p>å¦‚æœä½ æ˜¯ä¸šåŠ¡å¼€å‘åŒå­¦ï¼Œä½ å¯ä»¥ç”¨show grantså‘½ä»¤æŸ¥çœ‹è´¦æˆ·çš„æƒé™ï¼Œå¦‚æœæƒé™è¿‡å¤§ï¼Œå¯ä»¥å»ºè®®DBAåŒå­¦ç»™ä½ åˆ†é…æƒé™ä½ä¸€äº›çš„è´¦å·ï¼›ä½ ä¹Ÿå¯ä»¥è¯„ä¼°ä¸šåŠ¡çš„é‡è¦æ€§ï¼Œå’ŒDBAå•†é‡å¤‡ä»½çš„å‘¨æœŸã€æ˜¯å¦æœ‰å¿…è¦åˆ›å»ºå»¶è¿Ÿå¤åˆ¶çš„å¤‡åº“ç­‰ç­‰ã€‚</p><p>æ•°æ®å’ŒæœåŠ¡çš„å¯é æ€§ä¸æ­¢æ˜¯è¿ç»´å›¢é˜Ÿçš„å·¥ä½œï¼Œæœ€ç»ˆæ˜¯å„ä¸ªç¯èŠ‚ä¸€èµ·ä¿éšœçš„ç»“æœã€‚</p><p>ä»Šå¤©çš„è¯¾åè¯é¢˜æ˜¯ï¼Œå›å¿†ä¸‹ä½ äº²èº«ç»å†è¿‡çš„è¯¯åˆ æ•°æ®äº‹ä»¶å§ï¼Œä½ ç”¨äº†ä»€ä¹ˆæ–¹æ³•æ¥æ¢å¤æ•°æ®å‘¢ï¼Ÿä½ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¾—åˆ°çš„ç»éªŒåˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ä½ å¯ä»¥æŠŠä½ çš„ç»å†å’Œç»éªŒå†™åœ¨ç•™è¨€åŒºï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« çš„æœ«å°¾é€‰å–æœ‰è¶£çš„è¯„è®ºå’Œä½ ä¸€èµ·è®¨è®ºã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><h1>ä¸ŠæœŸé—®é¢˜æ—¶é—´</h1><p>æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ç»™ä½ ç•™çš„é—®é¢˜ï¼Œæ˜¯å…³äºç©ºè¡¨çš„é—´éš™çš„å®šä¹‰ã€‚</p><p>ä¸€ä¸ªç©ºè¡¨å°±åªæœ‰ä¸€ä¸ªé—´éš™ã€‚æ¯”å¦‚ï¼Œåœ¨ç©ºè¡¨ä¸Šæ‰§è¡Œï¼š</p><pre><code>begin;
select * from t where id&gt;1 for update;
</code></pre><p>è¿™ä¸ªæŸ¥è¯¢è¯­å¥åŠ é”çš„èŒƒå›´å°±æ˜¯next-key lock (-âˆ, supremum]ã€‚</p><p>éªŒè¯æ–¹æ³•çš„è¯ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ“ä½œåºåˆ—ã€‚ä½ å¯ä»¥åœ¨å›¾4ä¸­çœ‹åˆ°æ˜¾ç¤ºçš„ç»“æœã€‚</p><p><img src="https://static001.geekbang.org/resource/image/12/65/12eb6a38c347203f60df72ecaea95565.png" alt=""></p><center><span class="reference">å›¾3 å¤ç°ç©ºè¡¨çš„next-key lock</span></center><p><img src="https://static001.geekbang.org/resource/image/53/9f/531b6556ffc82c6b02f9a010a3ceb09f.png" alt=""></p><center><span class="reference">å›¾4 show engine innodb status éƒ¨åˆ†ç»“æœ</span></center><p>è¯„è®ºåŒºç•™è¨€ç‚¹èµæ¿ï¼š</p><blockquote>
<p>@è€æ¨åŒå¿— ç»™å‡ºäº†æ­£ç¡®çš„åˆ†æå’ŒSQLè¯­å¥éªŒè¯æ–¹æ³•ï¼›<br>
@åº“æ·˜æ·˜ æŒ‡å‡ºäº†show engine innodb statuséªŒè¯ç»“è®ºã€‚</p>
</blockquote><p>èµè¿™äº›æ€è€ƒå’Œåé¦ˆã€‚</p><p><img src="https://static001.geekbang.org/resource/image/09/77/09c1073f99cf71d2fb162a716b5fa577.jpg" alt=""></p>
                    </div>
                </div>

            </div>
            <div data-v-87ffcada="" class="article-comments pd"><h2 data-v-87ffcada=""><span
                    data-v-87ffcada="">ç²¾é€‰ç•™è¨€</span></h2>
                <ul data-v-87ffcada="">
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/d2/cd/6fb14677.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è‹èŒ«</span>
                            </div>
                            <div class="bd">æœ‰ä¸€æ¬¡ï¼Œæˆ‘ç»´æŠ¤ä¸€å¼ è¡¨ï¼Œéœ€è¦æ‰‹åŠ¨ä¿®æ”¹å¤§é‡æ•°æ®çš„çŠ¶æ€ï¼Œsqlå°±å¾ˆå¤šï¼Œç„¶åæˆ‘ä¿å­˜åˆ°txtæ–‡ä»¶ä¸­ä»¥é™„ä»¶çš„å½¢å¼å‘ç»™éƒ¨é—¨è€å¤§å®¡æ‰¹ï¼Œéƒ¨é—¨è€å¤§å®¡æ‰¹åè½¬å‘é‚®ä»¶ç»™è¿ç»´ï¼Œç„¶åè¿ç»´è¿™å“¥ä»¬ç”¨çš„æ˜¯360æµè§ˆå™¨ï¼Œä»–é¢„è§ˆçš„sqlï¼Œç„¶åå…¨éƒ¨å¤åˆ¶åˆ°å®¢æˆ·ç«¯æ‰§è¡Œï¼Œä½†æ˜¯é—®é¢˜ä¹Ÿåœ¨è¿™ï¼Œ360æµè§ˆå™¨é¢„è§ˆçš„æ—¶å€™ç”±äºæ–‡æœ¬åé•¿ï¼Œåˆ°äº†æŸä¸€æ¡è¯­å¥åªæœ‰å‰åŠéƒ¨åˆ†çš„updateè¯­å¥ï¼Œæ²¡æœ‰åé¢çš„æ¡ä»¶ï¼Œç„¶åå°±æ‚²å‰§äº†ã€‚å…¨è¡¨çš„çŠ¶æ€éƒ½å˜æˆåŒä¸€ä¸ªã€‚ç„¶åæˆ‘å°±ç‰¹åˆ«è«åå…¶å¦™ï¼Œè¿˜è¢«è€å¤§æ‰¹äº†ä¸€é¡¿ã€‚è¯´æˆ‘å†™çš„è„šæœ¬æœ‰é—®é¢˜ã€‚è¿™é”…æˆ‘å¯ä¸èƒŒï¼Œæˆ‘æŠŠè„šæœ¬åœ¨æœ¬åœ°å¤‡ä»½åº“è·‘äº†ä¸€éåˆä¸€éå°±æ˜¯æ²¡æœ‰é—®é¢˜ã€‚ç„¶åæˆ‘å†å»è¿ç»´å“¥ä»¬é‚£ï¼Œå«ä»–å†å¤åˆ¶ä¸€ä¸‹è„šæœ¬å°±å‘ç°é—®é¢˜äº†ã€‚å¥½åœ¨æ‰§è¡Œè„šæœ¬å‰è¿›è¡Œäº†è¡¨å¤‡ä»½ã€‚æ‰©å±•ä¸€ä¸‹ï¼Œå¦‚æœä½ ç”¨è°·æ­Œæµè§ˆå™¨å°±ä¸ä¼šå‡ºç°è¿™ç§é—®é¢˜ï¼å‘ç°é—®é¢˜åï¼Œç«‹é©¬æ¢å¤äº†æ•°æ® <br></div>
                            <span class="time">2019-01-23 23:46</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘ è¿™ä¸ªæ˜¯è¡€æ³ªç»éªŒ<br><br>æ‹·è´æ–‡æœ¬æ‰§è¡Œï¼Œè¿™ä¸ªæ“ä½œè¿˜å¯èƒ½å­˜åœ¨å­—ç¬¦é›†éšæ‚£ã€‚<br><br>è¿™ä¸ªäº‹æƒ…æ›´æ·±ä¸€å±‚é€»è¾‘ï¼Œæ˜¯ä½ åšäº†åˆ›é€ æ€§çš„äº‹æƒ…ï¼Œéå¸¸ä¼˜ç§€ğŸ‘ã€‚<br>è€Œè¿™ä¸ªè¿ç»´åŒå­¦è®¤ä¸ºä»–åªæ˜¯ä¸€ä¸ªâ€å¤åˆ¶ç²˜è´´æ‰§è¡Œçš„äººâ€ï¼Œ è¿™ç§æ€è·¯ä¸‹æ˜¯è¿Ÿæ—©ä¼šå‡ºé—®é¢˜çš„ã€‚</p>
                                <p class="reply-time">2019-01-24 08:14</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/hGLA7hlgfLk3VQs1m3HbkGCg0zicgaSJeYFGfW7JgocuicpoN0Ukyic7MouDXXxBDAKSJLJyEWb3Ef7ic6K6bOKbsw/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">linhui0705</span>
                            </div>
                            <div class="bd">å¯¹ç”Ÿäº§æ•°æ®åº“æ“ä½œï¼Œå…¬å¸DBAæå‡ºçš„ç¼–å†™è„šæœ¬æ–¹æ³•ï¼Œä¸ªäººè§‰å¾—è¿˜æ˜¯å€¼å¾—åˆ†äº«ï¼Œè™½è¯´å¯èƒ½å¤§éƒ¨åˆ†å…¬å¸ä¹Ÿå¯èƒ½æœ‰è¿™æ ·çš„è§„èŒƒã€‚<br>ä¿®æ”¹ç”Ÿäº§çš„æ•°æ®ï¼Œæˆ–è€…æ·»åŠ ç´¢å¼•ä¼˜åŒ–ï¼Œéƒ½è¦å…ˆå†™å¥½å››ä¸ªè„šæœ¬ï¼šå¤‡ä»½è„šæœ¬ã€æ‰§è¡Œè„šæœ¬ã€éªŒè¯è„šæœ¬å’Œå›æ»šè„šæœ¬ã€‚å¤‡ä»½è„šæœ¬æ˜¯å¯¹éœ€è¦å˜æ›´çš„æ•°æ®å¤‡ä»½åˆ°ä¸€å¼ è¡¨ä¸­ï¼Œå›ºå®šéœ€è¦æ“ä½œçš„æ•°æ®è¡Œï¼Œä»¥ä¾¿è¯¯æ“ä½œæˆ–ä¸šåŠ¡è¦æ±‚è¿›è¡Œå›æ»šï¼›æ‰§è¡Œè„šæœ¬å°±æ˜¯å¯¹æ•°æ®å˜æ›´çš„è„šæœ¬ï¼Œä¸ºé˜²Updateé”™æ•°æ®ï¼Œä¸€èˆ¬è¿å¤‡ä»½è¡¨è¿›è¡ŒUpdateæ“ä½œï¼›éªŒè¯è„šæœ¬æ˜¯éªŒè¯æ•°æ®å˜æ›´æˆ–å½±å“è¡Œæ•°æ˜¯å¦è¾¾åˆ°é¢„æœŸè¦æ±‚æ•ˆæœï¼›å›æ»šè„šæœ¬å°±æ˜¯å°†æ•°æ®å›æ»šåˆ°ä¿®æ”¹å‰çš„çŠ¶æ€ã€‚<br>è™½è¯´åˆ†å››æ­¥éª¤å†™è„šæœ¬å¯èƒ½ä¼šæ¯”è¾ƒç¹çï¼Œä½†æ˜¯è¿™èƒ½å¤Ÿå¾ˆå¤§ç¨‹åº¦é¿å…æ•°æ®è¯¯æ“ä½œã€‚ <br></div>
                            <span class="time">2019-01-23 20:40</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘ éå¸¸å¥½çš„ç»éªŒ<br>å¦‚æœèƒ½å¤Ÿåˆ‡å®æ‰§è¡Œï¼Œå³ä½¿æœ‰å‡ºé—®é¢˜ï¼Œä¹Ÿæ˜¯å¯ä»¥å¾ˆå¿«æ¢å¤çš„<br>æŠŠè¿™äº›è„šæœ¬å½“åšå¼€å‘ä»£ç æ¥ç»´æŠ¤ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®è·µ</p>
                                <p class="reply-time">2019-01-23 23:34</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æŸã€äºº</span>
                            </div>
                            <div class="bd">æ€»ç»“ä¸‹ä»Šå¤©çš„çŸ¥è¯†ç‚¹:<br>æˆ‘è§‰å¾—DBAçš„æœ€æ ¸å¿ƒçš„å·¥ä½œå°±æ˜¯ä¿è¯æ•°æ®çš„å®Œæ•´æ€§<br>ä»Šå¤©è€å¸ˆä¹Ÿè®²åˆ°äº†å…ˆè¦åšå¥½é¢„é˜²,é¢„é˜²çš„è¯å¤§æ¦‚æ˜¯é€šè¿‡è¿™å‡ ä¸ªç‚¹ï¼š<br>1.æƒé™æ§åˆ¶ä¸åˆ†é…(æ•°æ®åº“å’ŒæœåŠ¡å™¨æƒé™)<br>2.åˆ¶ä½œæ“ä½œè§„èŒƒ<br>3.å®šæœŸç»™å¼€å‘è¿›è¡ŒåŸ¹è®­<br>4.æ­å»ºå»¶è¿Ÿå¤‡åº“<br>5.åšå¥½sqlå®¡è®¡,åªè¦æ˜¯å¯¹çº¿ä¸Šæ•°æ®æœ‰æ›´æ”¹æ“ä½œçš„è¯­å¥(DMLå’ŒDDL)éƒ½éœ€è¦è¿›è¡Œå®¡æ ¸<br>6.åšå¥½å¤‡ä»½ã€‚å¤‡ä»½çš„è¯åˆåˆ†ä¸ºä¸¤ä¸ªç‚¹.<br>(1)å¦‚æœæ•°æ®é‡æ¯”è¾ƒå¤§,ç”¨ç‰©ç†å¤‡ä»½xtrabackupã€‚å®šæœŸå¯¹æ•°æ®åº“è¿›è¡Œå…¨é‡å¤‡ä»½,ä¹Ÿå¯ä»¥åšå¢é‡å¤‡ä»½ã€‚<br>(2)å¦‚æœæ•°æ®é‡è¾ƒå°‘,ç”¨mysqldumpæˆ–è€…mysqldumperã€‚å†åˆ©ç”¨binlogæ¥æ¢å¤æˆ–è€…æ­å»ºä¸»ä»çš„æ–¹å¼æ¥æ¢å¤æ•°æ®ã€‚<br>å®šæœŸå¤‡ä»½binlogæ–‡ä»¶ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„<br>è¿˜éœ€è¦å®šæœŸæ£€æŸ¥å¤‡ä»½æ–‡ä»¶æ˜¯å¦å¯ç”¨,å¦‚æœçœŸçš„å‘ç”Ÿäº†è¯¯æ“ä½œ,éœ€è¦æ¢å¤æ•°æ®çš„æ—¶å€™,å‘ç”Ÿå¤‡ä»½æ–‡ä»¶ä¸å¯ç”¨,é‚£å°±æ›´æ‚²å‰§äº†<br><br>å¦‚æœå‘ç”Ÿäº†æ•°æ®åˆ é™¤çš„æ“ä½œ,åˆå¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªç‚¹æ¥æ¢å¤:<br>1.DMLè¯¯æ“ä½œè¯­å¥é€ æˆæ•°æ®ä¸å®Œæ•´æˆ–è€…ä¸¢å¤±ã€‚å¯ä»¥é€šè¿‡flashback,ä¸è¿‡æˆ‘ä»¬ç›®å‰ç”¨çš„æ˜¯ç¾å›¢çš„myflash,ä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„å·¥å…·ï¼Œæœ¬è´¨éƒ½å·®ä¸å¤š.éƒ½æ˜¯å…ˆè§£æbinlog event,ç„¶ååœ¨è¿›è¡Œåè½¬ã€‚æŠŠdeleteåè½¬ä¸ºinsert,insertåè½¬ä¸ºdelete,updateå‰åimageå¯¹è°ƒã€‚æ‰€ä»¥å¿…é¡»è®¾ç½®binlog_format=row å’Œ binlog_row_image=full.<br>åˆ‡è®°æ¢å¤æ•°æ®çš„æ—¶å€™,åº”è¯¥å…ˆæ¢å¤åˆ°ä¸´æ—¶çš„å®ä¾‹,ç„¶ååœ¨æ¢å¤å›ä¸»åº“ä¸Šã€‚<br>2.DDLè¯­å¥è¯¯æ“ä½œ(truncateå’Œdrop),ç”±äºDDLè¯­å¥ä¸ç®¡binlog_formatæ˜¯rowè¿˜æ˜¯statement.åœ¨binlogé‡Œéƒ½åªè®°å½•è¯­å¥,ä¸è®°å½•imageæ‰€ä»¥æ¢å¤èµ·æ¥ç›¸å¯¹è¦éº»çƒ¦å¾—å¤šã€‚åªèƒ½é€šè¿‡å…¨é‡å¤‡ä»½+åº”ç”¨binlogçš„æ–¹å¼æ¥æ¢å¤æ•°æ®ã€‚ä¸€æ—¦æ•°æ®é‡æ¯”è¾ƒå¤§,é‚£ä¹ˆæ¢å¤æ—¶é—´å°±ç‰¹åˆ«é•¿,<br>å¯¹ä¸šåŠ¡æ˜¯ä¸ªè€ƒéªŒã€‚æ‰€ä»¥å°±æ¶‰åŠåˆ°è€å¸ˆåœ¨ç¬¬äºŒè®²æåˆ°çš„é—®é¢˜äº†ï¼Œå…¨é‡å¤‡ä»½çš„å‘¨æœŸæ€ä¹ˆå»é€‰æ‹© <br></div>
                            <span class="time">2019-01-23 14:14</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘ </p>
                                <p class="reply-time">2019-01-23 18:22</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/93/8a/abb7bfe3.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">äº®</span>
                            </div>
                            <div class="bd">CREATE TABLE `t` (<br>`id` int(11) NOT NULL,<br>`city` varchar(16) NOT NULL,<br>`name` varchar(16) NOT NULL,<br>`age` int(11) NOT NULL,<br>`addr` varchar(128) DEFAULT NULL,<br>PRIMARY KEY (`id`),<br>KEY `city` (`city`)<br>) ENGINE=InnoDB;<br><br>è€å¸ˆè¯·æ•™æ‚¨16ç« çš„é—®é¢˜ï¼Œæ‚¨æåˆ°â€œcityã€nameã€age è¿™ä¸‰ä¸ªå­—æ®µçš„å®šä¹‰æ€»é•¿åº¦æ˜¯36â€ï¼Œè¿™ä¸ªæ˜¯æ€ä¹ˆç®—å‡ºæ¥çš„å‘¢ï¼Œvarchar(16)æ˜¯å¯ä»¥ä¿å­˜16ä¸ªå­—ç¬¦ï¼Œå ç”¨äº†49ä¸ªå­—èŠ‚ï¼ˆutf8ï¼‰ï¼Œæ‰€ä»¥æˆ‘æ²¡æƒ³æ˜ç™½36æ˜¯æ€ä¹ˆæ¥çš„ã€‚<br><br>ç¬¬äºŒä¸ªé—®é¢˜æ˜¯max_length_for_sort_dataå‚æ•°ç³»ç»Ÿé»˜è®¤æ˜¯1024ï¼Œæ˜¯1024ä¸ªå­—èŠ‚çš„æ„æ€å—ï¼Ÿ<br><br>2019-01-23<br><br>î˜ˆ ä½œè€…å›å¤<br><br>1. age(11)å…¶å®æ˜¯4ä¸ªå­—èŠ‚å“ˆ<br>2. å¯¹ï¼Œå•ä½æ˜¯å­—èŠ‚<br><br>è°¢è°¢è€å¸ˆï¼Œä¸è¿‡è¿˜æ˜¯æ²¡æ˜ç™½ï¼Œageæ˜¯4ä¸ªå­—èŠ‚ï¼Œcityå’Œnameåˆ†åˆ«æ˜¯49ä¸ªå­—èŠ‚ï¼Œ49+49+4=102å­—èŠ‚ï¼Œ36æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿå†æ¬¡æ„Ÿè°¢<br> <br></div>
                            <span class="time">2019-01-23 16:55</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å“¦ æŠ±æ­‰å“ˆï¼Œæˆ‘è¿™è¾¹éªŒè¯çš„æ—¶å€™é»˜è®¤ç”¨çš„latin1ï¼Œæ˜¯16+16+4</p>
                                <p class="reply-time">2019-01-23 18:28</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/9d/60/fe522a1a.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æŠ€æœ¯äººæˆé•¿</span>
                            </div>
                            <div class="bd">æˆ‘åªæƒ³è¯´ï¼Œä½œè€…åŠŸåŠ›è¿‡äºæ·±åšäº†ï¼ <br></div>
                            <span class="time">2019-01-25 12:15</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/e6/ee/e3c4c9b3.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Cranliu</span>
                            </div>
                            <div class="bd">ä¸ªäººè§‰å¾—ï¼Œé¢„é˜²åŒæ ·å¾ˆé‡è¦ï¼Œä¸€èˆ¬çš„dmlæ“ä½œï¼Œæˆ‘æ˜¯å…ˆctasè¦æ“ä½œçš„æ•°æ®ï¼Œdrop&#47;truncate çš„æ—¶å€™å…ˆé€»è¾‘å¤‡ä»½ã€‚ <br></div>
                            <span class="time">2019-01-23 08:37</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å¯¹çš„ï¼Œå¤‡ä»½çš„æ„è¯†å¾ˆé‡è¦ã€‚<br><br><br>ä¸è¿‡â€œdrop&#47;truncate çš„æ—¶å€™å…ˆé€»è¾‘å¤‡ä»½â€è¿™ä¹ˆåšçš„ä¸å¤š^_^ <br>ä¸»è¦çš„åŸå› æ˜¯é€»è¾‘å¤‡ä»½å¯èƒ½ä¼šå¯¹ç³»ç»Ÿæœ‰é¢å¤–æ¶ˆè€—ã€‚ï¼ˆå…¨è¡¨æ‰«æï¼‰<br><br></p>
                                <p class="reply-time">2019-01-23 09:00</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/f4/cf/2af390ad.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">511</span>
                            </div>
                            <div class="bd">æ—©~ <br></div>
                            <span class="time">2019-01-23 08:35</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/20/3a/90db6a24.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Long</span>
                            </div>
                            <div class="bd">åˆåˆ°äº†è®²æ•…äº‹(äº‹æ•…)çš„æ—¶å€™äº†ï¼Œå†å²ä¸Šé‡åˆ°è¿‡å¾ˆå¤šæ¬¡äº‹æ•…ã€‚å…¨è¡¨è¯¯åˆ é™¤ï¼Œè¯¯æ›´æ–°ä¸ä¸‹äº8æ¬¡ï¼Œæœ‰MySQL çš„DBä¹Ÿæœ‰memory DB.   æœ‰ä¸€æ¬¡åŒäº‹æ¯”è¾ƒæç¬‘çš„æ˜¯ï¼Œæœ‰ä¸€æ¬¡ä¸€å¼ é‡è¦çš„æƒé™æ§åˆ¶è¡¨æ›´æ–°ï¼Œç”±äºç”¨çš„æ˜¯workbench ç•Œé¢å·¥å…·å½“æ—¶å†™äº†whereæ¡ä»¶ï¼Œä½†æ˜¯åœ¨é€‰ä¸­æ‰§è¡Œè¡Œçš„æ—¶å€™whereæ¡ä»¶åœ¨ç¬¬äºŒè¡Œï¼Œæ²¡é€‰ä¸­ï¼Œè¿˜åœ¨æ‰§è¡Œå‰çš„æ—¶å€™æ‰‹åŠ¨æŠŠsession çº§çš„sql_safe_updates=0äº†ï¼Œä¹Ÿæ²¡æœ‰ç‚¹å¼€é‚£ä¸ªautocommitå–æ¶ˆçš„æŒ‰é’®ã€‚ç„¶åä¸€æ‰§è¡Œï¼Œå…¨è¡¨æ›´æ–°äº†ï¼Œå¯¼è‡´å…¨ç½‘åªæœ‰ä¸€ä¸ªç”¨æˆ·å¯ä»¥æ­£å¸¸ç™»å½•ã€‚è¿˜æœ‰å…¶ä»–çš„è¯¯æ“ä½œï¼Œæ€»ç»“å†å²é‡åˆ°è¿‡çš„è¿™ç±»é—®é¢˜åŸºæœ¬å°±æ˜¯å‡ ç±»<br>1. ç™»é”™ç¯å¢ƒï¼Œä»¥ä¸ºæ˜¯æµ‹è¯•ç¯å¢ƒï¼Œä¸€é¡¿æ“ä½œçŒ›å¦‚è™ï¼Œä¸€çœ‹ç¯å¢ƒæ˜¯ç”Ÿäº§ï¼Œå›å¤´ä¸€çœ‹ï¼Œè¡¨å·²ç»dropäº†â€¦â€¦<br>2. sqlå†™çš„æœ‰é—®é¢˜ï¼Œé€»è¾‘é”™è¯¯ï¼Œæˆ–è€…æ¡ä»¶ç¼ºå¤±ï¼Œå¸¸è§çš„å¦‚ä¸å¸¦whereï¼›orå…³é”®å­—çš„é€»è¾‘æ²¡æœ‰ç”¨æ‹¬å·æ‹¬å¥½<br>3. è¿˜æœ‰ä¸€äº›å¥‡è‘©çš„ï¼Œæ¯”å¦‚where å­—æ®µ1=å­—æ®µ2å†™æˆäº†å­—æ®µ1+å­—æ®µ2ï¼Œé€»è¾‘ç­‰äºåˆ¤æ–­å˜æˆäº†æ˜¯å¦ä¸º1çš„åˆ¤æ–­äº†ï¼Œå¤§æ¦‚ç‡å…¨è¡¨æ›´æ–°äº†ã€‚<br><br>é”™è¯¯è§£å†³å¤§éƒ¨åˆ†éƒ½æ˜¯ç”¨å¤‡ä»½æ¢å¤æˆ–è€…æ ¹æ®é”™è¯¯çš„é€»è¾‘æ¥é€»è¾‘æ¢å¤ã€‚<br><br><br>è¿˜æœ‰ä¸€ä¸ªï¼Œæœ€è¿‘åœ¨å°è¯•çš„ï¼Œå°±æ˜¯ibdæ–‡ä»¶ä¸­æœ‰åé¡µï¼Œåªè¦ä¸€è¯»åˆ°é‚£ä¸ªåé¡µï¼Œå°±ä¼šcrashï¼ŒæŠ¥é”™spaceid page no should beå¤šå°‘å¤šå°‘ï¼Œå°è¯•äº†copy frm, ibdï¼Œibdata, iblogfileè¿™äº›è¡¨ç»“æ„ï¼Œæ•°æ®æ–‡ä»¶ï¼Œæ•°æ®å­—å…¸ï¼Œundo redo æ—¥å¿—ï¼Œä¹Ÿå°è¯•ç”¨äº†undropçš„å·¥å…·ä¹Ÿè§£æä¸å‡ºæ¥ã€‚è¿™ä¸ªè¡¨æ¯”è¾ƒç‰¹æ®Šï¼Œæ˜¯ä¸€ä¸ªç‰¹æ®Šåº“ï¼Œæ²¡å¤‡ä»½ï¼Œè¡¨æ²¡æœ‰ç´¢å¼•æ²¡æ³•é€šè¿‡èµ°ç´¢å¼•è·³è¿‡é‚£ä¸ªåé¡µçš„é‚£äº›è¡Œï¼Œç°åœ¨çš„çŠ¶æ€æ˜¯ï¼Œåªèƒ½ç”¨nysqldumpæ¢å¤ä¸€éƒ¨åˆ†æ•°æ®ã€‚   æˆ‘æƒ³é€šè¿‡16è¿›åˆ¶ï¼Œè‡ªå·±æ…¢æ…¢æ‰¾åˆ°é‚£ä¸ªè„å†™çš„æ•°æ®ï¼Œç„¶åä¿®æ”¹ä¸€ä¸‹æ–‡ä»¶â€¦â€¦<br>è€å¸ˆæœ‰ä»€ä¹ˆæ¯”è¾ƒå¥½çš„å»ºè®®å—ï¼Ÿæˆ–è€…åé¢ä¼šè¯´åˆ°ibdæ–‡ä»¶çš„ç‰©ç†ç»“æ„ä¹‹ç±»çš„å—ï¼Ÿ æ„Ÿè°¢ <br></div>
                            <span class="time">2019-01-28 04:32</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ„Ÿè°¢ä½ çš„åˆ†äº«ï¼Œéƒ½æ˜¯è¡€æ³ªæ•™è®­ã€‚ã€‚<br>æˆ‘çœ‹æœ‰å‡ ä¸ªæ˜¯ç”¨çš„å¯è§†åŒ–å·¥å…·å¯¼è‡´çš„ï¼Œåé¢è¿˜æ˜¯å°½é‡ç”¨MySQLå®¢æˆ·ç«¯æ•²å‘½ä»¤å§ğŸ˜†<br><br>ibdæ–‡ä»¶åé¡µæˆ‘ä¹‹å‰æœ‰å›ç­”è¿‡å…¶ä»–åŒå­¦çš„ï¼Œçœ‹ä¸‹è¿™ä¸ª<br>https:&#47;&#47;weibo.com&#47;1933424965&#47;H3qIu0JYo?from=page_1005051933424965_profile&amp;wvr=6&amp;mod=weibotime</p>
                                <p class="reply-time">2019-01-28 08:41</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/f6/d1/dcafd7cf.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">PengfeiWang</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæ‚¨å¥½ï¼Œæœ‰ä¸ªé—®é¢˜è¯·æ•™ä¸€ä¸‹ï¼š<br>å…³äºMySQLå¤‡ä»½æœ‰æ•ˆæ€§çš„éªŒè¯ï¼Œä½ æœ‰ä»€ä¹ˆå¥½çš„æ–¹æ³•å¯ä»¥æ¨èå—ï¼Ÿç›®å‰åªèƒ½é€šè¿‡ä¸å®šæœŸçš„å¤‡ä»½æ¢å¤æ¥éªŒè¯ã€‚ <br></div>
                            <span class="time">2019-01-25 15:46</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å¤§å®¶éƒ½æ˜¯è¿™ä¹ˆåšçš„ğŸ˜†</p>
                                <p class="reply-time">2019-01-25 18:47</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/ef/3e/9c3a8abc.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">AIæœå˜‰å˜‰</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæ¥ç€ä¸Šé¢é—®é¢˜ã€‚æ˜¯åˆ è¡¨ï¼Œçº¿ä¸Šrenameï¼Œæœ‰ä»€ä¹ˆé£é™©å—ï¼Ÿéœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿrenameæ˜¯ä¸æ˜¯ddlæ“ä½œ <br></div>
                            <span class="time">2019-01-25 15:42</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ˜¯ï¼Œä¸è¿‡renameçš„æ‰§è¡Œé€Ÿåº¦å¾ˆå¿«<br></p>
                                <p class="reply-time">2019-01-25 18:47</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eop9WylZJicLQxlvXukXUgPp39zJHyyReK5s1C9VhA6rric7GiarbfQMuWhdCCDdxdfL610Hc4cNkn9Q/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è¿˜ä¸€æ£µæ ‘</span>
                            </div>
                            <div class="bd">æˆ‘é‡åˆ°è¿‡ä¸€ä¸ªçº¿ä¸Šè¯¯truncateè¡¨çš„ï¼Œæœ€ç»ˆé€‰æ‹©çš„å¤„ç†è¿‡ç¨‹å¦‚ä¸‹ï¼š<br>1ã€åˆ›å»ºä¸€ä¸ªåŒç‰ˆæœ¬çš„ç©ºmysqlå®ä¾‹ï¼Œå»ºä¸€ä¸ªåå­—+ç»“æ„ä¸€æ¨¡ä¸€æ ·çš„è¡¨<br>2ã€discardè¿™ä¸ªè¡¨çš„tablespace<br>3ã€ä»ä¹‹å‰çš„å¤‡ä»½é›†ä¸­   innobackupex --apply-log å¹¶è®°å½•binlogä½ç½®ï¼ˆç”¨innobackupexå¤‡ä»½çš„ï¼‰ã€‚è¿˜åŸåæ‰¾åˆ°è¯¯æ“ä½œè¡¨çš„.ibdæ–‡ä»¶ï¼Œcopyåˆ°æ–°å®ä¾‹å¯¹åº”çš„ä½ç½®<br>4ã€åœ¨ä¹‹å‰åˆ›å»ºçš„mysqlå®ä¾‹ä¸Šimport  tablespace<br>5ã€åˆ©ç”¨mysqlbinlog å¤„ç†å¢é‡æ•°æ®<br>6ã€æœ€åå¯¼å‡º å†å¯¼å…¥ <br></div>
                            <span class="time">2019-01-24 20:19</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘<br>è¿™åŸºæœ¬ä¸Šæ˜¯æœ€å¿«çš„æ¢å¤æ­¥éª¤äº†</p>
                                <p class="reply-time">2019-01-24 20:46</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/d2/cd/6fb14677.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è‹èŒ«</span>
                            </div>
                            <div class="bd">æœ‰ä¸€æ¬¡æˆ‘åœ¨æŸ¥è¯¢æ•°æ®å€’æ•°æŠ¥è¡¨ç»™ä¸šåŠ¡æ–¹ï¼Œé‚£ä¸ªè„šæœ¬æ˜¯æˆ‘å†™çš„ï¼Œå…³è”äº†å¾ˆå¤šè¡¨ï¼Œè¿˜è·¨äº†åº“ï¼Œä¸€ä¸ªä¸»è¡¨æœ‰ä¸€ä¸‡å¤šæ¡çºªå½•ï¼Œå…³è”å¦ä¸€å¼ æ“ä½œè®°å½•è¡¨å¥½åƒæ˜¯10ä¸‡æ¡æ•°æ®ã€‚å› ä¸ºè¦ç»Ÿè®¡å¤šæ­¥æ“ä½œæ­¥éª¤ï¼Œæ‰€ä»¥æ¯ä¸€æ­¥çš„æ“ä½œè®°å½•æˆ‘å°±å¾—æŒ‰ç…§ä¸åŒçš„æ¡ä»¶å…³è”äº§ç”Ÿä¸´æ—¶è¡¨ï¼ˆå…³è”ä¸­æœ‰group è¿˜æœ‰maxï¼ˆï¼‰èšåˆå‡½æ•°ï¼Œè¿™ä¸ªæ˜¯éœ€æ±‚å¯¼è‡´çš„ï¼‰ï¼Œä¸€å¼€å§‹å†™å¥½çš„æŸ¥è¯¢å¾ˆå¿«æœ‰äº†ç»“æœã€‚é‚£å¤©11ç‚¹å¤šçš„æ—¶å€™ï¼Œæˆ‘æ‰§è¡Œé‚£ä¸ªè„šæœ¬ï¼Œå‘ç°å¾ˆæ…¢æ²¡æœ‰ååº”ï¼Œç„¶åæˆ‘å°±æŠŠè¿æ¥å…³äº†ï¼Œé‡å¤å‡ æ¬¡æ“ä½œï¼Œç„¶åç”Ÿäº§åº“å°±è¢«æˆ‘ææŒ‚äº†ã€‚åé¢è¿ç»´çš„åŒå­¦æ“ä½œäº†ä¸€æ³¢æ‰æ¢å¤è¿‡æ¥ã€‚è¿™æ¬¡ä¹Ÿæ˜¯è¿ç»´åŒå­¦èƒŒçš„é”…ã€‚åé¢ï¼Œè¿˜æŠŠæˆ‘çš„æ“ä½œç»™è´´å‡ºæ¥äº†ï¼Œåšé€šæŠ¥æ‰¹è¯„ã€‚æˆ‘æƒ³é—®ä¸‹ä¸ºå•¥ä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿ<br>åç»­æˆ‘çš„ç»„é•¿å¯¹æˆ‘å†™çš„sqlè¿›è¡Œäº†ä¼˜åŒ–ï¼Œä¸»è¦æ˜¯æŠŠè”è¡¨æ“ä½œéœ€è¦çš„ä¿¡æ¯æ”¾åœ¨å­æŸ¥è¯¢ä¸­ï¼Œç„¶åå†æ“ä½œè®°å½•è¡¨ä¸­åŠ äº†ç´¢å¼•ï¼Œæœ‰äº†å¤‡ä»½åº“ï¼Œæ¯æ¬¡æ‰§è¡Œè„šæœ¬å¯¼å‡ºæ•°æ®éƒ½æ˜¯åœ¨å¤‡ä»½åº“ä¸­å¯¼å‡ºï¼Œå°±å†ä¹Ÿæ²¡æœ‰å‘ç”Ÿè¿™ä¸ªé—®é¢˜äº†ã€‚ <br></div>
                            <span class="time">2019-01-24 19:42</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">åé¢æœ‰ä¸€ç¯‡ä¸“é—¨è¯´è¿™ä¸ªï¼Œæ•¬è¯·æœŸå¾…å“ˆ</p>
                                <p class="reply-time">2019-01-24 20:17</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erJFlHhylrbLANtehiaX50wgVa2Z1ibQAdLpgyW4gCpEyOKEI9bPNZZBiabrP2oCleZWc2KKyKADz8tg/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">xishuai</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œéº»çƒ¦é—®ä¸€ä¸‹ï¼Œ5.7.21ä¸Šinnodbçš„è¡¨ä¸¤åˆ—ï¼ˆæœ‰ä¸­æ–‡æœ‰è‹±æ–‡ï¼‰å»ºçš„å…¨æ–‡ç´¢å¼•ï¼Œæœ€å°åˆ†è¯1ï¼ŒæŒ‰ä¸­æ–‡å¯ä»¥æŸ¥è¯¢ï¼ŒæŒ‰è‹±æ–‡æœ‰äº›æŸ¥è¯¢ä¸å‡ºæ¥ï¼Œæ‚¨çŸ¥é“åŸå› å—ï¼Ÿ <br></div>
                            <span class="time">2019-01-24 18:52</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å…¨æ–‡ç´¢å¼•æœ‰stop wordsçš„ï¼Œä½ çœ‹çœ‹æ˜¯ä¸æ˜¯è½åœ¨stop wordsé‡Œäº†</p>
                                <p class="reply-time">2019-01-24 20:18</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/G9pdXkStPJoCwmpxux3kshQFrhWOnKcia1AH2O6uSTSGAVMm7AO7h76t2w7BpnVl6vp2hlzODAibia5xa7KIKvtWg/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">catalina</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæˆ‘ä»¬ç°åœ¨éœ€è¦å°†ä¸€ä¸ªåº“ä¸‹é¢çš„æ‰€æœ‰è¡¨çš„æ•°æ®åŒæ­¥åˆ°å¦å¤–ä¸€ä¸ªåº“ï¼Œæ¯ä¸ªè¡¨æœ‰å‡ ç™¾ä¸‡æ•°æ®å§ï¼Œå¤§çº¦åå¤šå¼ è¡¨ã€‚æœ‰ä»€ä¹ˆå¥½çš„æ–¹æ³•å—ï¼Ÿ <br></div>
                            <span class="time">2019-01-24 18:22</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">åŸåº“çš„è¿™å‡ ä¸ªè¡¨è¿˜ä¼šç»§ç»­æ›´æ–°å—ï¼Ÿ å¦‚æœä¼šç»§ç»­æ›´æ–°ï¼Œå°±ç”¨æ­ä¸»å¤‡çš„æ–¹æ³•ï¼›<br>å¦‚æœæ²¡æ›´æ–°äº†ï¼Œåé¢æœ‰ä¸€ä¸ªæ–‡ç« ä¸“é—¨è®²è¿™ä¸ªé—®é¢˜å“ˆ</p>
                                <p class="reply-time">2019-01-24 20:21</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/41/27/3ff1a1d6.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">hua168</span>
                            </div>
                            <div class="bd">å¤§ç¥ï¼Œæœ‰äº²æˆšå°å…¬å¸æDBAä¸€å¹´ï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹ï¼š<br>1.DBAä¸€èˆ¬å‘å±•æ–¹å‘æ˜¯æ€æ ·çš„å‘€ï¼Ÿè¿ç»´å’Œå¼€å‘æˆ‘äº†è§£ï¼ŒDBAæ²¡æ¥è§¦è¿‡ï¼Œæ— æ³•ç»™å»ºè®®ï¼Œä¸€èˆ¬çš„å‡çº§è¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ<br>2.ä»¥åå‘å±•æ–¹å‘æ˜¯æ€æ ·ï¼Ÿç°åœ¨éƒ½æ˜¯å¼€æºã€å¤§æ•°æ®æ—¶ä»£æ—¶ä»£ï¼Œé˜¿é‡Œåˆæâ€œå»IOEâ€ï¼Œä¸€èˆ¬oracle DBAå‘å±•å‰æ™¯ä¸å¥½å§ï¼Ÿ<br><br>èƒ½å¸®æŒ‡ä¸€ä¸ªå¤§æ¦‚çš„æ–¹å‘å—ï¼Ÿè°¢è°¢~~ <br></div>
                            <span class="time">2019-01-24 15:24</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/8a/3e/30c05bce.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">aliang</span>
                            </div>
                            <div class="bd">è€å¸ˆå¥½ã€‚è¿™æ˜¯ç¬¬6è®²è¯„è®ºåŒºTony Duçš„è¯„è®ºï¼š<br>session A: begin; select * from t limit 1; æœ€å…ˆå¯åŠ¨sessionA<br>session B: begin; select * from t limit 1; ç´§æ¥ç€å¯åŠ¨sessionB<br>session C: alter table t add f int; ç„¶åå†æ˜¯å¯åŠ¨sessionC<br>session D: begin; select * from t limit 1; æœ€åæ˜¯å¯åŠ¨sessionD<br>ä»–è¯´session Cä¼šè¢«Aå’ŒBé˜»å¡ï¼ŒDä¼šè¢«Cé˜»å¡ï¼›å½“Aå’ŒBæäº¤åï¼ŒDæ˜¯å¯ä»¥ç»§ç»­æ‰§è¡Œå¾—åˆ°æŸ¥è¯¢ç»“æœçš„ï¼Œä½†æ˜¯Cä»ç„¶è¢«é˜»å¡ï¼Œåªæœ‰Dæäº¤åCæ‰èƒ½æ‰§è¡ŒæˆåŠŸã€‚æˆ‘è‡ªå·±åœ¨5.6å’Œ5.7æŒ‰ä»–çš„æ­¥éª¤åšäº†è¯•éªŒï¼Œç»“æœå’Œä»–ä¸€æ ·ã€‚<br>ç„¶åæˆ‘å†åšäº†ä¸€æ¬¡è¯•éªŒï¼Œè¿™æ¬¡æŠŠDçš„begin;å»æ‰ï¼Œå˜æˆäº†ï¼š<br>session A: begin; select * from t limit 1; æœ€å…ˆå¯åŠ¨sessionA<br>session B: begin; select * from t limit 1; ç´§æ¥ç€å¯åŠ¨sessionB<br>session C: alter table t add f int; ç„¶åå†æ˜¯å¯åŠ¨sessionC<br>session D: select * from t limit 1; æœ€åæ˜¯å¯åŠ¨sessionD<br>ç»“æœæ˜¯å½“Aå’ŒBæäº¤åï¼ŒDå’ŒCéƒ½èƒ½æ‰§è¡ŒæˆåŠŸäº†ï¼ˆå’Œè€å¸ˆçš„ç»“æœä¸€æ ·ï¼‰ã€‚æˆ‘çš„é—®é¢˜æ˜¯ï¼šä¸ºä»€ä¹ˆç¬¬ä¸€æ¬¡session Dæ˜¾å¼å¼€å¯äº‹åŠ¡ï¼Œå’Œç¬¬äºŒæ¬¡ä¸æ˜¾å¼å¼€å¯çš„ç»“æœä¸ä¸€æ ·å‘¢ï¼Ÿ <br></div>
                            <span class="time">2019-01-24 11:12</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/dd/39/f5747c5d.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¤ªç¦</span>
                            </div>
                            <div class="bd">å› ä¸ºæ—¶é—´åŸå› ï¼Œå‰é¢çš„è¯¾ç¨‹æ²¡è·Ÿä¸Šï¼Œåœ¨è¿™é‡Œè¯·æ•™ä¸ªæœ€è¿‘çº¿ä¸Šmysqlé‡åˆ°çš„é—®é¢˜ï¼š<br>  ä¸€ä¸ªä»åº“mysql5.6ç‰ˆæœ¬,æ­£å¸¸æƒ…å†µä¸‹åªæœ‰3åˆ°5ä¸ªå¹¶å‘sqlåœ¨æŸ¥è¯¢ï¼Œæ¯åˆ†é’Ÿç”¨ä¸‹é¢çš„sqlæŸ¥çœ‹ä¸€æ¬¡æ£€æµ‹åˆ°çš„<br> SELECT  t1.* FROM information_schema.`PROCESSLIST` t1  WHERE  info is not null ORDER BY time desc;<br> å‰ä¸€æ¬¡æ£€æµ‹è¿˜æ˜¯å‡ ä¸ªsqlåœ¨æŸ¥è¯¢ï¼Œä¸‹1åˆ†é’ŸæŸ¥åˆ°2000å¤šä¸ªsqlåœ¨è·‘ï¼Œå¾ˆå¤šå †ç§¯äº†å‡ åç§’çš„sqlï¼ŒçŠ¶æ€â€œSending dataâ€ â€œCreating sort indexâ€<br> ï¼Œè€Œè¿™äº›sqlåœ¨æ­£å¸¸æƒ…å†µä¸‹æ˜¯ä¸åˆ°1ç§’å°±æŸ¥åˆ°ç»“æœäº†çš„ï¼Œä¸”cpuä½¿ç”¨ç‡ä¸ioå¾ˆä½ï¼Œçœ‹èµ·æ¥mysqlåƒµæ­»çš„äº†ã€‚<br>æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š1ï¼‰é—®é¢˜çªç„¶å‡ºç°<br>              2ï¼‰å¤§é‡sqlåœ¨è·‘ï¼Œè€Œcpuä¸ç£ç›˜ioåè€Œæ¯”æ­£å¸¸ä¸‹é™ï¼›è¿™æ˜¯ä»åº“ï¼Œå†™åªæœ‰ä¸»ä»åŒæ­¥ï¼Œå…¶å®ƒéƒ½æ˜¯è¯»æŸ¥è¯¢ã€‚<br>é…ç½®ï¼š64Gå†…å­˜ï¼Œbpåˆ†é…40Gï¼Œioä½¿ç”¨ä¸é«˜<br>,ä¸šåŠ¡é‡æ²¡å¤§å˜åŠ¨ï¼Œä¹Ÿæ²¡æ–°ç‰ˆæœ¬å‘å¸ƒï¼Œå¤§ä½“æ’é™¤ä¸šåŠ¡å¹¶å‘åŠ å¤§å¯¼è‡´çš„ã€‚ <br></div>
                            <span class="time">2019-01-24 10:24</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/45/64/2b09a36b.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">é£äºŒä¸­</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæ‚¨å¥½ã€‚å¦‚ä½•è®¾ç½®binlog çš„å¤‡ä»½æ—¶é—´å‘¢ï¼Œæ„Ÿè§‰RPO æ—¶é—´æ€»æ˜¯ä¸èƒ½ä¸ºé›¶ï¼Œå¦‚æœæ˜¯informix å¯ä»¥åªä¸¢ä¸€ä¸ªé€»è¾‘æ—¥å¿—ã€‚å¯¹äºéœ€è¦ä¿è¯mysqlæ¢å¤ RPO æ—¶é—´ä¸ºé›¶ï¼Œæœ‰ä»€ä¹ˆå»ºè®®å—ï¼Ÿå¤‡åº“å»¶è¿Ÿ1å°æ—¶ï¼ŒåŠ æ¯å°æ—¶å¤‡ä»½ä¸€æ¬¡binlog ã€‚ <br></div>
                            <span class="time">2019-01-23 19:36</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å—¯ å¯¹äºæ ¸å¿ƒä¸šåŠ¡ï¼Œä½¿ç”¨å»¶è¿Ÿå¤åˆ¶çš„å¤‡ä»½<br><br>RPOæ—¶é—´ä¸º0ï¼Ÿæœ‰è¿™ä¹ˆå‡¶æ®‹çš„ä¸šåŠ¡éœ€æ±‚å—ã€‚ã€‚æˆ‘èƒ½æƒ³åˆ°çš„å°±æ˜¯å¤šå¥—å»¶è¿Ÿå¤‡ä»½çš„åº“ã€‚<br>æ¯”å¦‚å¼€3ä¸ªï¼Œ ä¸€ä¸ªæ˜¯10åˆ†é’Ÿï¼Œä¸€ä¸ª20åˆ†é’Ÿï¼Œä¸€ä¸ª30åˆ†é’Ÿï¼ˆä¸»è¦è€ƒè™‘æˆæœ¬ï¼‰<br>RPOè¿™ä¹ˆæ•æ„Ÿçš„ï¼Œåº”è¯¥æœ‰å¯¹åº”æ•æ„Ÿçš„ç›‘æ§ï¼Œè¯¯æ“ä½œè¦æ˜¯30åˆ†é’Ÿè¿˜ä¸èƒ½å‘ç°ï¼Œå¯ä»¥æŒ‘æˆ˜ä¸€ä¸‹ï¼Œè¿™ä¸ªä¸šåŠ¡æ˜¯ä¸æ˜¯å€¼å¾—è¿™ä¹ˆé«˜çš„æŒ‡æ ‡^_^<br><br></p>
                                <p class="reply-time">2019-01-23 20:09</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">700</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œè¯·æ•™ã€‚å‡å¦‚æˆ‘æœ‰æ•°æ®åº“çš„ç‰©ç†å¤‡ä»½å’Œé€»è¾‘å¤‡ä»½ï¼ˆmydumperï¼‰ï¼Œå› ä¸º mydumper å¯¼å‡ºçš„æ•°æ®æ˜¯æŒ‰è¡¨ååˆ†å¼€å­˜æ”¾çš„ï¼Œé‚£ä¹ˆè¡¨è¯¯åˆ æ•°æ®çš„æ—¶å€™ä¼˜å…ˆè€ƒè™‘é€»è¾‘å¤‡ä»½ï¼ˆè¯¯åˆ æ•°æ®è¡¨çš„å¤‡ä»½é›†ï¼‰+binlog æ¢å¤æ¯”ç‰©ç†å¤‡ä»½æ¢å¤ä¼šå¿«ç‚¹ï¼ŸåŸºäºæ­¤ï¼Œæˆ‘æ€»æ„Ÿè§‰ç‰©ç†å¤‡ä»½åªæ˜¯åœ¨è¦æ¢å¤æ•´ä¸ªå®ä¾‹æ—¶æ‰ä¼šä¼˜å…ˆè€ƒè™‘ï¼Œè€Œæ¢å¤æ•´ä¸ªå®ä¾‹çš„åœºæ™¯åˆæ˜¯æ¯”è¾ƒå°‘çš„ï¼Œæ¯•ç«Ÿä¸€èˆ¬å¤§å®¶çš„çº¿ä¸Šæ¶æ„è‡³å°‘éƒ½æ˜¯ä¸»ä»æ¨¡å¼ã€‚æ‰€ä»¥é€»è¾‘å¤‡ä»½è¢«ç‰©ç†å¤‡ä»½æ›´å®ç”¨ã€‚è¿™ç§æƒ³æ³•ç®—æ˜¯è¯´å¾—é€šå—ï¼Ÿ <br></div>
                            <span class="time">2019-01-23 18:23</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å…¶å®æ˜¯è¦çœ‹è¡¨çš„å¤§å°<br><br>å¦‚æœæ˜¯ä¸€ä¸ªå¤§è¡¨ï¼Œé€»è¾‘æ¢å¤è¿˜æ˜¯æ¯”è¾ƒæ…¢çš„ï¼Œæ¯•ç«Ÿç”¨ç‰©ç†å¤‡ä»½æ¥æ¢å¤å‡ºå®ä¾‹ï¼Œç›¸å¯¹ä¼šå¿«äº›ã€‚<br><br>å½“ç„¶å¦‚æœä½ å·²ç»æœ‰äº†ä¸€ä¸ªæˆç†Ÿç³»ç»Ÿç”¨é€»è¾‘æ¢å¤æ¥å®ç°ï¼Œä¹Ÿä¸ç”¨æ”¹å®ƒï¼Œä¸»è¦å…³æ³¨ä¸€ä¸‹æ˜¯å¦æ»¡è¶³SLAå°±å¯ä»¥äº†^_^<br>facebookå°±æ˜¯ä¸»è¦ç”¨é€»è¾‘å¤‡ä»½çš„</p>
                                <p class="reply-time">2019-01-23 19:16</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/06/b1/ba6b4335.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">é«˜å¼º</span>
                            </div>
                            <div class="bd">è€å¸ˆä½ å¥½ï¼Œé—®ä¸ªå¸¦å­æŸ¥è¯¢çš„delete&#47;update&#47;inserté—®é¢˜ï¼ŒDelete from A where name in(
<br>   Select name from B where time&lt;â€™2019-01-23 11:11:12â€™
<br>)  è¿™æ¡è¯­å¥åˆ é™¤Aè¡¨è®°å½•ä¹‹å‰æ˜¯ä¸æ˜¯ä¹Ÿä¼šæŠŠè¡¨ Bæ»¡è¶³æ¡ä»¶çš„è®°å½•ä¹Ÿä¼šç»™é”ä½å‘¢?<br>æˆ‘è¯•éªŒäº†ä¸€ä¸‹ä¼šé”ä½Bè¡¨è®°å½•çš„ï¼Œæœ‰æ²¡æœ‰å…¶ä»–åŠæ³•ä¸è®©é”Bè¡¨å‘¢? <br></div>
                            <span class="time">2019-01-23 16:38</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ”¹æˆRCéš”ç¦»çº§åˆ«è¯•è¯•</p>
                                <p class="reply-time">2019-01-23 18:25</p>
                            </div>
                            
                        </div>
                    </li>
                    


                </ul>
            </div>
        </div>
    </div>
</div>
</body>
</html>