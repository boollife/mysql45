<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <style type="text/css">

#watermark {

  position: relative;
  overflow: hidden;
}

#watermark .x {
  position: absolute;
  top: 800;
  left: 400;
  color: #3300ff;
  font-size: 50px;
  pointer-events: none;
  opacity:0.3;
  filter:Alpha(opacity=50);
  
  
}
    </style>


    <style type="text/css">
 html{color:#333;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;text-rendering:optimizelegibility;font-family:Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif}html.borderbox *,html.borderbox :after,html.borderbox :before{box-sizing:border-box}article,aside,blockquote,body,button,code,dd,details,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hr,input,legend,li,menu,nav,ol,p,pre,section,td,textarea,th,ul{margin:0;padding:0}article,aside,details,figcaption,figure,footer,header,menu,nav,section{display:block}audio,canvas,video{display:inline-block}body,button,input,select,textarea{font:300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}table{border-collapse:collapse;border-spacing:0}fieldset,img{border:0}blockquote{position:relative;color:#999;font-weight:400;border-left:1px solid #1abc9c;padding-left:1em;margin:1em 3em 1em 2em}@media only screen and (max-width:640px){blockquote{margin:1em 0}}abbr,acronym{border-bottom:1px dotted;font-variant:normal}abbr{cursor:help}del{text-decoration:line-through}address,caption,cite,code,dfn,em,th,var{font-style:normal;font-weight:400}ol,ul{list-style:none}caption,th{text-align:left}q:after,q:before{content:""}sub,sup{font-size:75%;line-height:0;position:relative}:root sub,:root sup{vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}a{color:#1abc9c}a:hover{text-decoration:underline}.typo a{border-bottom:1px solid #1abc9c}.typo a:hover{border-bottom-color:#555;color:#555}.typo a:hover,a,ins{text-decoration:none}.typo-u,u{text-decoration:underline}mark{background:#fffdd1;border-bottom:1px solid #ffedce;padding:2px;margin:0 5px}code,pre,pre tt{font-family:Courier,Courier New,monospace}pre{background:hsla(0,0%,97%,.7);border:1px solid #ddd;padding:1em 1.5em;display:block;-webkit-overflow-scrolling:touch}hr{border:none;border-bottom:1px solid #cfcfcf;margin-bottom:.8em;height:10px}.typo-small,figcaption,small{font-size:.9em;color:#888}b,strong{font-weight:700;color:#000}[draggable]{cursor:move}.clearfix:after,.clearfix:before{content:"";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.textwrap,.textwrap td,.textwrap th{word-wrap:break-word;word-break:break-all}.textwrap-table{table-layout:fixed}.serif{font-family:Palatino,Optima,Georgia,serif}.typo-dl,.typo-form,.typo-hr,.typo-ol,.typo-p,.typo-pre,.typo-table,.typo-ul,.typo dl,.typo form,.typo hr,.typo ol,.typo p,.typo pre,.typo table,.typo ul,blockquote{margin-bottom:1rem}h1,h2,h3,h4,h5,h6{font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;line-height:1.35}.typo-h1,.typo-h2,.typo-h3,.typo-h4,.typo-h5,.typo-h6,.typo h1,.typo h2,.typo h3,.typo h4,.typo h5,.typo h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}.typo-h1,.typo h1{font-size:2em}.typo-h2,.typo h2{font-size:1.8em}.typo-h3,.typo h3{font-size:1.6em}.typo-h4,.typo h4{font-size:1.4em}.typo-h5,.typo-h6,.typo h5,.typo h6{font-size:1.2em}.typo-ul,.typo ul{margin-left:1.3em;list-style:disc}.typo-ol,.typo ol{list-style:decimal;margin-left:1.9em}.typo-ol ol,.typo-ol ul,.typo-ul ol,.typo-ul ul,.typo li ol,.typo li ul{margin-bottom:.8em;margin-left:2em}.typo-ol ul,.typo-ul ul,.typo li ul{list-style:circle}.typo-table td,.typo-table th,.typo table caption,.typo table td,.typo table th{border:1px solid #ddd;padding:.5em 1em;color:#666}.typo-table th,.typo table th{background:#fbfbfb}.typo-table thead th,.typo table thead th{background:hsla(0,0%,95%,.7)}.typo table caption{border-bottom:none}.typo-input,.typo-textarea{-webkit-appearance:none;border-radius:0}.typo-em,.typo em,caption,legend{color:#000;font-weight:inherit}.typo-em{position:relative}.typo-em:after{position:absolute;top:.65em;left:0;width:100%;overflow:hidden;white-space:nowrap;content:"\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"}.typo img{max-width:100%}.common-content{font-weight:400;color:#353535;line-height:1.75rem;white-space:normal;word-break:normal;font-size:1rem}.common-content img{display:block;max-width:100%;background-color:#eee}.common-content audio,.common-content video{width:100%;background-color:#eee}.common-content center,.common-content font{margin-top:1rem;display:inline-block}.common-content center{width:100%}.common-content pre{margin-top:1rem;padding-left:0;padding-right:0;position:relative;overflow:hidden}.common-content pre code{font-size:.8rem;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;display:block;width:100%;box-sizing:border-box;padding-left:1rem;padding-right:1rem;overflow-x:auto}.common-content hr{border:none;margin-top:1.5rem;margin-bottom:1.5rem;border-top:1px solid #f5f5f5;height:1px;background:none}.common-content b,.common-content h1,.common-content h2,.common-content h3,.common-content h4,.common-content h5,.common-content strong{font-weight:700}.common-content h1,.common-content h2{font-size:1.125rem;margin-bottom:.45rem}.common-content h3,.common-content h4,.common-content h5{font-size:1rem;margin-bottom:.45rem}.common-content p{font-weight:400;color:#353535;margin-top:.15rem}.common-content .orange{color:#ff5a05}.common-content .reference{font-size:1rem;color:#888}.custom-rich-content h1{margin-top:0;font-weight:400;font-size:15.25px;border-bottom:1px solid #eee;line-height:2.8}.custom-rich-content li,.custom-rich-content p{font-size:14px;color:#888;line-height:1.6}table.hljs-ln{margin-bottom:0;border-spacing:0;border-collapse:collapse}table.hljs-ln,table.hljs-ln tbody,table.hljs-ln td,table.hljs-ln tr{box-sizing:border-box}table.hljs-ln td{padding:0;border:0}table.hljs-ln td.hljs-ln-numbers{min-width:15px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;cursor:pointer;user-select:none}table.hljs-ln td.hljs-ln-code,table.hljs-ln td.hljs-ln-numbers{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;line-height:20px;vertical-align:top}table.hljs-ln td.hljs-ln-code{position:relative;padding-right:10px;padding-left:10px;overflow:visible;color:#24292e;word-wrap:normal;white-space:pre}video::-webkit-media-controls{overflow:hidden!important}video::-webkit-media-controls-enclosure{width:calc(100% + 32px);margin-left:auto}.button-cancel{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel,.button-primary{-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary{color:#fff;background-color:#ff5a05;border-radius:3px}@font-face{font-family:iconfont;src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot);src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.woff) format("woff"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.ttf) format("truetype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.svg#iconfont) format("svg")}@font-face{font-family:player-font;src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot);src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.woff) format("woff"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.ttf) format("truetype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.svg#player-font) format("svg")}.iconfont{font-family:iconfont!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;-moz-osx-font-smoothing:grayscale}html{background:#fff;min-height:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{width:100%}body.fixed{overflow:hidden;position:fixed;width:100vw;height:100vh}i{font-style:normal}a{word-wrap:break-word;-webkit-tap-highlight-color:rgba(0,0,0,0)}a:hover{text-decoration:none}.fade-enter-active,.fade-leave-active{transition:opacity .3s}.fade-enter,.fade-leave-to{opacity:0}.MathJax,.MathJax_CHTML,.MathJax_MathContainer,.MathJax_MathML,.MathJax_PHTML,.MathJax_PlainSource,.MathJax_SVG{outline:0}.ios-app-switch .js-audit{display:none}._loading_wrap_{position:fixed;width:100vw;height:100vh;top:50%;left:50%;transform:translate(-50%,-50%);z-index:999}._loading_div_class_,._loading_wrap_{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._loading_div_class_{word-wrap:break-word;padding:.5rem .75rem;text-align:center;z-index:9999;font-size:.6rem;max-width:60%;color:#fff;border-radius:.25rem;-ms-flex-direction:column;flex-direction:column}._loading_div_class_ .message{color:#353535;font-size:16px;line-height:3}.spinner{animation:circle-rotator 1.4s linear infinite}.spinner *{line-height:0;box-sizing:border-box}@keyframes circle-rotator{0%{transform:rotate(0deg)}to{transform:rotate(270deg)}}.path{stroke-dasharray:187;stroke-dashoffset:0;transform-origin:center;animation:circle-dash 1.4s ease-in-out infinite,circle-colors 5.6s ease-in-out infinite}@keyframes circle-colors{0%{stroke:#ff5a05}to{stroke:#ff5a05}}@keyframes circle-dash{0%{stroke-dashoffset:187}50%{stroke-dashoffset:46.75;transform:rotate(135deg)}to{stroke-dashoffset:187;transform:rotate(450deg)}}.confirm-box-wrapper,.confirm-box-wrapper .mask{position:absolute;top:0;left:0;right:0;bottom:0}.confirm-box-wrapper .mask{background:rgba(0,0,0,.6)}.confirm-box-wrapper .confirm-box{position:fixed;top:50%;left:50%;width:267px;background:#fff;transform:translate(-50%,-50%);border-radius:7px}.confirm-box-wrapper .confirm-box .head{margin:0 18px;font-size:18px;text-align:center;line-height:65px;border-bottom:1px solid #d9d9d9}.confirm-box-wrapper .confirm-box .body{padding:18px;padding-bottom:0;color:#353535;font-size:12.5px;max-height:150px;overflow:auto}.confirm-box-wrapper .confirm-box .foot{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;padding:18px}.confirm-box-wrapper .confirm-box .foot .button-cancel{border:1px solid #d9d9d9}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}




    </style>
    <style type="text/css">
        .button-cancel[data-v-87ffcada]{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel[data-v-87ffcada],.button-primary[data-v-87ffcada]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary[data-v-87ffcada]{color:#fff;background-color:#ff5a05;border-radius:3px}.pd[data-v-87ffcada]{padding-left:1.375rem;padding-right:1.375rem}.article[data-v-87ffcada]{max-width:70rem;margin:0 auto}.article .article-unavailable[data-v-87ffcada]{color:#fa8919;font-size:15px;font-weight:600;line-height:24px;border-radius:5px;padding:12px;background-color:#f6f7fb;margin-top:20px}.article .article-unavailable .iconfont[data-v-87ffcada]{font-size:12px}.article .main[data-v-87ffcada]{padding:1.25rem 0;margin-bottom:52px}.article-title[data-v-87ffcada]{color:#353535;font-weight:400;line-height:1.65rem;font-size:1.34375rem}.article-info[data-v-87ffcada]{color:#888;font-size:.9375rem;margin-top:1.0625rem}.article-content[data-v-87ffcada]{margin-top:1.0625rem}.article-content.android video[data-v-87ffcada]::-webkit-media-controls-fullscreen-button{display:none}.copyright[data-v-87ffcada]{color:#b2b2b2;padding-bottom:20px;margin-top:20px;font-size:13px}.audio-player[data-v-87ffcada]{width:100%;margin:20px 0}.to-comment[data-v-87ffcada]{overflow:hidden;padding-top:10px;margin-bottom:-30px}.to-comment a.button-primary[data-v-87ffcada]{float:right;height:20px;font-size:12px;line-height:20px;padding:4px 8px;cursor:pointer}.article-comments[data-v-87ffcada]{margin-top:2rem}.article-comments h2[data-v-87ffcada]{text-align:center;color:#888;position:relative;z-index:1;margin-bottom:1rem}.article-comments h2[data-v-87ffcada]:before{border-top:1px dotted #888;content:"";position:absolute;top:56%;left:0;width:100%;z-index:-1}.article-comments h2 span[data-v-87ffcada]{font-size:15.25px;font-weight:400;padding:0 1rem;background:#fff;display:inline-block}.article-sub-bottom[data-v-87ffcada]{z-index:10;cursor:pointer}.switch-btns[data-v-87ffcada]{height:76px;cursor:pointer;padding-top:24px;padding-bottom:24px;border-bottom:10px solid #f6f7fb;position:relative}.switch-btns[data-v-87ffcada]:before{content:" ";height:1px;background:#e8e8e8;position:absolute;top:0;left:0;-webkit-box-sizing:border-box;box-sizing:border-box;left:1.375rem;right:1.375rem}.switch-btns .btn[data-v-87ffcada]{height:38px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.switch-btns .btn .tag[data-v-87ffcada]{-webkit-box-flex:0;-ms-flex:0 0 62px;flex:0 0 62px;text-align:center;color:#888;font-size:14px;border-radius:10px;height:22px;line-height:22px;background:#f6f7fb;font-weight:400}.switch-btns .btn .txt[data-v-87ffcada]{margin-left:10px;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:#888;font-size:15px;height:22px;line-height:22px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400}@media (max-width:769px){.article .breadcrumb[data-v-87ffcada]{padding-top:10px;padding-bottom:10px}}





    </style>

    <style type="text/css">
        .comment-item{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:1rem}.comment-item a{border-bottom:none}.comment-item .avatar{width:2.625rem;height:2.625rem;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}.comment-item .info{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.comment-item .info .hd{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .username{color:#888;font-size:15.25px;font-weight:400;line-height:1.2}.comment-item .info .hd .control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .control .btn-share{color:#888;font-size:.75rem;margin-right:1rem}.comment-item .info .hd .control .btn-praise{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:15.25px;text-decoration:none}.comment-item .info .hd .control .btn-praise i{color:#888;display:inline-block;font-size:.75rem;margin-right:.3rem;margin-top:-.01rem}.comment-item .info .hd .control .btn-praise i.on,.comment-item .info .hd .control .btn-praise span{color:#ff5a05}.comment-item .info .bd{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6}.comment-item .info .time{color:#888;font-size:9px;line-height:1}.comment-item .info .reply .reply-hd{font-size:15.25px}.comment-item .info .reply .reply-hd span{margin-left:-12px;color:#888;font-weight:400}.comment-item .info .reply .reply-hd i{color:#ff5a05;font-size:15.25px}.comment-item .info .reply .reply-content{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all}.comment-item .info .reply .reply-time{color:#888;font-size:9px}




    </style>
</head>
<body>
<div id="app">


    <div data-v-87ffcada="" class="article" id="watermark">
        <div data-v-87ffcada="" class="main main-app">
            <h1 data-v-87ffcada="" class="article-title pd">
                42è®²grantä¹‹åè¦è·Ÿç€flushprivilegeså—
            </h1>
            <div data-v-87ffcada="" class="article-content typo common-content pd"><img data-v-87ffcada=""
                                                                                        src="https://static001.geekbang.org/resource/image/da/b2/da36874cb2adba5ac984cebc448aceb2.jpg">

                <div>
                    <audio controls="controls" height="100" width="100">
                        <source src="42è®²grantä¹‹åè¦è·Ÿç€flushprivilegeså—.mp3" type="audio/mp3" />
                        <embed height="100" width="100" src="42è®²grantä¹‹åè¦è·Ÿç€flushprivilegeså—.mp3" />
                    </audio>
                </div>
                <div data-v-87ffcada="" id="article-content" class="">
                    <div class="text">
                        <p>åœ¨MySQLé‡Œé¢ï¼Œgrantè¯­å¥æ˜¯ç”¨æ¥ç»™ç”¨æˆ·èµ‹æƒçš„ã€‚ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰è§è¿‡ä¸€äº›æ“ä½œæ–‡æ¡£é‡Œé¢æåˆ°ï¼Œgrantä¹‹åè¦é©¬ä¸Šè·Ÿç€æ‰§è¡Œä¸€ä¸ªflush privilegeså‘½ä»¤ï¼Œæ‰èƒ½ä½¿èµ‹æƒè¯­å¥ç”Ÿæ•ˆã€‚æˆ‘æœ€å¼€å§‹ä½¿ç”¨MySQLçš„æ—¶å€™ï¼Œå°±æ˜¯ç…§ç€ä¸€ä¸ªæ“ä½œæ–‡æ¡£çš„è¯´æ˜æŒ‰ç…§è¿™ä¸ªé¡ºåºæ“ä½œçš„ã€‚</p><p>é‚£ä¹ˆï¼Œgrantä¹‹åçœŸçš„éœ€è¦æ‰§è¡Œflush privilegeså—ï¼Ÿå¦‚æœæ²¡æœ‰æ‰§è¡Œè¿™ä¸ªflushå‘½ä»¤çš„è¯ï¼Œèµ‹æƒè¯­å¥çœŸçš„ä¸èƒ½ç”Ÿæ•ˆå—ï¼Ÿ</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°±å…ˆå’Œä½ ä»‹ç»ä¸€ä¸‹grantè¯­å¥å’Œflush privilegesè¯­å¥åˆ†åˆ«åšäº†ä»€ä¹ˆäº‹æƒ…ï¼Œç„¶åå†ä¸€èµ·æ¥åˆ†æè¿™ä¸ªé—®é¢˜ã€‚</p><p>ä¸ºäº†ä¾¿äºè¯´æ˜ï¼Œæˆ‘å…ˆåˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼š</p><pre><code>create user 'ua'@'%' identified by 'pa';
</code></pre><p>è¿™æ¡è¯­å¥çš„é€»è¾‘æ˜¯åˆ›å»ºä¸€ä¸ªç”¨æˆ·â€™uaâ€™@â€™%â€™ï¼Œå¯†ç æ˜¯paã€‚æ³¨æ„ï¼Œåœ¨MySQLé‡Œé¢ï¼Œç”¨æˆ·å(user)+åœ°å€(host)æ‰è¡¨ç¤ºä¸€ä¸ªç”¨æˆ·ï¼Œå› æ­¤ ua@ip1 å’Œ ua@ip2ä»£è¡¨çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„ç”¨æˆ·ã€‚</p><p>è¿™æ¡å‘½ä»¤åšäº†ä¸¤ä¸ªåŠ¨ä½œï¼š</p><ol>
<li>
<p>ç£ç›˜ä¸Šï¼Œå¾€mysql.userè¡¨é‡Œæ’å…¥ä¸€è¡Œï¼Œç”±äºæ²¡æœ‰æŒ‡å®šæƒé™ï¼Œæ‰€ä»¥è¿™è¡Œæ•°æ®ä¸Šæ‰€æœ‰è¡¨ç¤ºæƒé™çš„å­—æ®µçš„å€¼éƒ½æ˜¯Nï¼›</p>
</li>
<li>
<p>å†…å­˜é‡Œï¼Œå¾€æ•°ç»„acl_usersé‡Œæ’å…¥ä¸€ä¸ªacl_userå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„accesså­—æ®µå€¼ä¸º0ã€‚</p>
</li>
</ol><p>å›¾1å°±æ˜¯è¿™ä¸ªæ—¶åˆ»ç”¨æˆ·uaåœ¨userè¡¨ä¸­çš„çŠ¶æ€ã€‚</p><!-- [[[read_end]]] --><p><img src="https://static001.geekbang.org/resource/image/7e/35/7e75bbfbca0cb932e1256941c99d5f35.png" alt=""></p><center><span class="reference">å›¾1 mysql.user æ•°æ®è¡Œ</span></center><p>åœ¨MySQLä¸­ï¼Œç”¨æˆ·æƒé™æ˜¯æœ‰ä¸åŒçš„èŒƒå›´çš„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°±æŒ‰ç…§ç”¨æˆ·æƒé™èŒƒå›´ä»å¤§åˆ°å°çš„é¡ºåºä¾æ¬¡å’Œä½ è¯´æ˜ã€‚</p><h1>å…¨å±€æƒé™</h1><p>å…¨å±€æƒé™ï¼Œä½œç”¨äºæ•´ä¸ªMySQLå®ä¾‹ï¼Œè¿™äº›æƒé™ä¿¡æ¯ä¿å­˜åœ¨mysqlåº“çš„userè¡¨é‡Œã€‚å¦‚æœæˆ‘è¦ç»™ç”¨æˆ·uaèµ‹ä¸€ä¸ªæœ€é«˜æƒé™çš„è¯ï¼Œè¯­å¥æ˜¯è¿™ä¹ˆå†™çš„ï¼š</p><pre><code>grant all privileges on *.* to 'ua'@'%' with grant option;
</code></pre><p>è¿™ä¸ªgrantå‘½ä»¤åšäº†ä¸¤ä¸ªåŠ¨ä½œï¼š</p><ol>
<li>
<p>ç£ç›˜ä¸Šï¼Œå°†mysql.userè¡¨é‡Œï¼Œç”¨æˆ·â€™uaâ€™@â€™%'è¿™ä¸€è¡Œçš„æ‰€æœ‰è¡¨ç¤ºæƒé™çš„å­—æ®µçš„å€¼éƒ½ä¿®æ”¹ä¸ºâ€˜Yâ€™ï¼›</p>
</li>
<li>
<p>å†…å­˜é‡Œï¼Œä»æ•°ç»„acl_usersä¸­æ‰¾åˆ°è¿™ä¸ªç”¨æˆ·å¯¹åº”çš„å¯¹è±¡ï¼Œå°†accesså€¼ï¼ˆæƒé™ä½ï¼‰ä¿®æ”¹ä¸ºäºŒè¿›åˆ¶çš„â€œå…¨1â€ã€‚</p>
</li>
</ol><p>åœ¨è¿™ä¸ªgrantå‘½ä»¤æ‰§è¡Œå®Œæˆåï¼Œå¦‚æœæœ‰æ–°çš„å®¢æˆ·ç«¯ä½¿ç”¨ç”¨æˆ·åuaç™»å½•æˆåŠŸï¼ŒMySQLä¼šä¸ºæ–°è¿æ¥ç»´æŠ¤ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œç„¶åä»acl_usersæ•°ç»„é‡ŒæŸ¥åˆ°è¿™ä¸ªç”¨æˆ·çš„æƒé™ï¼Œå¹¶å°†æƒé™å€¼æ‹·è´åˆ°è¿™ä¸ªçº¿ç¨‹å¯¹è±¡ä¸­ã€‚ä¹‹ååœ¨è¿™ä¸ªè¿æ¥ä¸­æ‰§è¡Œçš„è¯­å¥ï¼Œæ‰€æœ‰å…³äºå…¨å±€æƒé™çš„åˆ¤æ–­ï¼Œéƒ½ç›´æ¥ä½¿ç”¨çº¿ç¨‹å¯¹è±¡å†…éƒ¨ä¿å­˜çš„æƒé™ä½ã€‚</p><p>åŸºäºä¸Šé¢çš„åˆ†ææˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p><ol>
<li>
<p>grant å‘½ä»¤å¯¹äºå…¨å±€æƒé™ï¼ŒåŒæ—¶æ›´æ–°äº†ç£ç›˜å’Œå†…å­˜ã€‚å‘½ä»¤å®Œæˆåå³æ—¶ç”Ÿæ•ˆï¼Œæ¥ä¸‹æ¥æ–°åˆ›å»ºçš„è¿æ¥ä¼šä½¿ç”¨æ–°çš„æƒé™ã€‚</p>
</li>
<li>
<p>å¯¹äºä¸€ä¸ªå·²ç»å­˜åœ¨çš„è¿æ¥ï¼Œå®ƒçš„å…¨å±€æƒé™ä¸å—grantå‘½ä»¤çš„å½±å“ã€‚</p>
</li>
</ol><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œ<strong>ä¸€èˆ¬åœ¨ç”Ÿäº§ç¯å¢ƒä¸Šè¦åˆç†æ§åˆ¶ç”¨æˆ·æƒé™çš„èŒƒå›´</strong>ã€‚æˆ‘ä»¬ä¸Šé¢ç”¨åˆ°çš„è¿™ä¸ªgrantè¯­å¥å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„é”™è¯¯ç¤ºèŒƒã€‚å¦‚æœä¸€ä¸ªç”¨æˆ·æœ‰æ‰€æœ‰æƒé™ï¼Œä¸€èˆ¬å°±ä¸åº”è¯¥è®¾ç½®ä¸ºæ‰€æœ‰IPåœ°å€éƒ½å¯ä»¥è®¿é—®ã€‚</p><p>å¦‚æœè¦å›æ”¶ä¸Šé¢çš„grantè¯­å¥èµ‹äºˆçš„æƒé™ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™æ¡å‘½ä»¤ï¼š</p><pre><code>revoke all privileges on *.* from 'ua'@'%';
</code></pre><p>è¿™æ¡revokeå‘½ä»¤çš„ç”¨æ³•ä¸grantç±»ä¼¼ï¼Œåšäº†å¦‚ä¸‹ä¸¤ä¸ªåŠ¨ä½œï¼š</p><ol>
<li>
<p>ç£ç›˜ä¸Šï¼Œå°†mysql.userè¡¨é‡Œï¼Œç”¨æˆ·â€™uaâ€™@â€™%'è¿™ä¸€è¡Œçš„æ‰€æœ‰è¡¨ç¤ºæƒé™çš„å­—æ®µçš„å€¼éƒ½ä¿®æ”¹ä¸ºâ€œNâ€ï¼›</p>
</li>
<li>
<p>å†…å­˜é‡Œï¼Œä»æ•°ç»„acl_usersä¸­æ‰¾åˆ°è¿™ä¸ªç”¨æˆ·å¯¹åº”çš„å¯¹è±¡ï¼Œå°†accessçš„å€¼ä¿®æ”¹ä¸º0ã€‚</p>
</li>
</ol><h1>dbæƒé™</h1><p>é™¤äº†å…¨å±€æƒé™ï¼ŒMySQLä¹Ÿæ”¯æŒåº“çº§åˆ«çš„æƒé™å®šä¹‰ã€‚å¦‚æœè¦è®©ç”¨æˆ·uaæ‹¥æœ‰åº“db1çš„æ‰€æœ‰æƒé™ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤ï¼š</p><pre><code>grant all privileges on db1.* to 'ua'@'%' with grant option;
</code></pre><p>åŸºäºåº“çš„æƒé™è®°å½•ä¿å­˜åœ¨mysql.dbè¡¨ä¸­ï¼Œåœ¨å†…å­˜é‡Œåˆ™ä¿å­˜åœ¨æ•°ç»„acl_dbsä¸­ã€‚è¿™æ¡grantå‘½ä»¤åšäº†å¦‚ä¸‹ä¸¤ä¸ªåŠ¨ä½œï¼š</p><ol>
<li>
<p>ç£ç›˜ä¸Šï¼Œå¾€mysql.dbè¡¨ä¸­æ’å…¥äº†ä¸€è¡Œè®°å½•ï¼Œæ‰€æœ‰æƒé™ä½å­—æ®µè®¾ç½®ä¸ºâ€œYâ€ï¼›</p>
</li>
<li>
<p>å†…å­˜é‡Œï¼Œå¢åŠ ä¸€ä¸ªå¯¹è±¡åˆ°æ•°ç»„acl_dbsä¸­ï¼Œè¿™ä¸ªå¯¹è±¡çš„æƒé™ä½ä¸ºâ€œå…¨1â€ã€‚</p>
</li>
</ol><p>å›¾2å°±æ˜¯è¿™ä¸ªæ—¶åˆ»ç”¨æˆ·uaåœ¨dbè¡¨ä¸­çš„çŠ¶æ€ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/32/2e/32cd61ee14ad2f370e1de0fb4e39bb2e.png" alt=""></p><center><span class="reference">å›¾2 mysql.db æ•°æ®è¡Œ</span></center><p>æ¯æ¬¡éœ€è¦åˆ¤æ–­ä¸€ä¸ªç”¨æˆ·å¯¹ä¸€ä¸ªæ•°æ®åº“è¯»å†™æƒé™çš„æ—¶å€™ï¼Œéƒ½éœ€è¦éå†ä¸€æ¬¡acl_dbsæ•°ç»„ï¼Œæ ¹æ®userã€hostå’Œdbæ‰¾åˆ°åŒ¹é…çš„å¯¹è±¡ï¼Œç„¶åæ ¹æ®å¯¹è±¡çš„æƒé™ä½æ¥åˆ¤æ–­ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œgrantä¿®æ”¹dbæƒé™çš„æ—¶å€™ï¼Œæ˜¯åŒæ—¶å¯¹ç£ç›˜å’Œå†…å­˜ç”Ÿæ•ˆçš„ã€‚</p><p>grantæ“ä½œå¯¹äºå·²ç»å­˜åœ¨çš„è¿æ¥çš„å½±å“ï¼Œåœ¨å…¨å±€æƒé™å’ŒåŸºäºdbçš„æƒé™æ•ˆæœæ˜¯ä¸åŒçš„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åšä¸€ä¸ªå¯¹ç…§è¯•éªŒæ¥åˆ†åˆ«çœ‹ä¸€ä¸‹ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/ae/c7/aea26807c8895961b666a5d96b081ac7.png" alt=""></p><center><span class="reference">å›¾3 æƒé™æ“ä½œæ•ˆæœ</span></center><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå›¾ä¸­set global sync_binlogè¿™ä¸ªæ“ä½œæ˜¯éœ€è¦superæƒé™çš„ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ç”¨æˆ·uaçš„superæƒé™åœ¨T3æ—¶åˆ»å·²ç»é€šè¿‡revokeè¯­å¥å›æ”¶äº†ï¼Œä½†æ˜¯åœ¨T4æ—¶åˆ»æ‰§è¡Œset globalçš„æ—¶å€™ï¼Œæƒé™éªŒè¯è¿˜æ˜¯é€šè¿‡äº†ã€‚è¿™æ˜¯å› ä¸ºsuperæ˜¯å…¨å±€æƒé™ï¼Œè¿™ä¸ªæƒé™ä¿¡æ¯åœ¨çº¿ç¨‹å¯¹è±¡ä¸­ï¼Œè€Œrevokeæ“ä½œå½±å“ä¸åˆ°è¿™ä¸ªçº¿ç¨‹å¯¹è±¡ã€‚</p><p>è€Œåœ¨T5æ—¶åˆ»å»æ‰uaå¯¹db1åº“çš„æ‰€æœ‰æƒé™åï¼Œåœ¨T6æ—¶åˆ»session Bå†æ“ä½œdb1åº“çš„è¡¨ï¼Œå°±ä¼šæŠ¥é”™â€œæƒé™ä¸è¶³â€ã€‚è¿™æ˜¯å› ä¸ºacl_dbsæ˜¯ä¸€ä¸ªå…¨å±€æ•°ç»„ï¼Œæ‰€æœ‰çº¿ç¨‹åˆ¤æ–­dbæƒé™éƒ½ç”¨è¿™ä¸ªæ•°ç»„ï¼Œè¿™æ ·revokeæ“ä½œé©¬ä¸Šå°±ä¼šå½±å“åˆ°session Bã€‚</p><p>è¿™é‡Œåœ¨ä»£ç å®ç°ä¸Šæœ‰ä¸€ä¸ªç‰¹åˆ«çš„é€»è¾‘ï¼Œå¦‚æœå½“å‰ä¼šè¯å·²ç»å¤„äºæŸä¸€ä¸ªdbé‡Œé¢ï¼Œä¹‹å‰useè¿™ä¸ªåº“çš„æ—¶å€™æ‹¿åˆ°çš„åº“æƒé™ä¼šä¿å­˜åœ¨ä¼šè¯å˜é‡ä¸­ã€‚</p><p>ä½ å¯ä»¥çœ‹åˆ°åœ¨T6æ—¶åˆ»ï¼Œsession Cå’Œsession Bå¯¹è¡¨tçš„æ“ä½œé€»è¾‘æ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯session BæŠ¥é”™ï¼Œè€Œsession Cå¯ä»¥æ‰§è¡ŒæˆåŠŸã€‚è¿™æ˜¯å› ä¸ºsession Cåœ¨T2 æ—¶åˆ»æ‰§è¡Œçš„use db1ï¼Œæ‹¿åˆ°äº†è¿™ä¸ªåº“çš„æƒé™ï¼Œåœ¨åˆ‡æ¢å‡ºdb1åº“ä¹‹å‰ï¼Œsession Cå¯¹è¿™ä¸ªåº“å°±ä¸€ç›´æœ‰æƒé™ã€‚</p><h1>è¡¨æƒé™å’Œåˆ—æƒé™</h1><p>é™¤äº†dbçº§åˆ«çš„æƒé™å¤–ï¼ŒMySQLæ”¯æŒæ›´ç»†ç²’åº¦çš„è¡¨æƒé™å’Œåˆ—æƒé™ã€‚å…¶ä¸­ï¼Œè¡¨æƒé™å®šä¹‰å­˜æ”¾åœ¨è¡¨mysql.tables_privä¸­ï¼Œåˆ—æƒé™å®šä¹‰å­˜æ”¾åœ¨è¡¨mysql.columns_privä¸­ã€‚è¿™ä¸¤ç±»æƒé™ï¼Œç»„åˆèµ·æ¥å­˜æ”¾åœ¨å†…å­˜çš„hashç»“æ„column_priv_hashä¸­ã€‚</p><p>è¿™ä¸¤ç±»æƒé™çš„èµ‹æƒå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre><code>create table db1.t1(id int, a int);

grant all privileges on db1.t1 to 'ua'@'%' with grant option;
GRANT SELECT(id), INSERT (id,a) ON mydb.mytbl TO 'ua'@'%' with grant option;
</code></pre><p>è·Ÿdbæƒé™ç±»ä¼¼ï¼Œè¿™ä¸¤ä¸ªæƒé™æ¯æ¬¡grantçš„æ—¶å€™éƒ½ä¼šä¿®æ”¹æ•°æ®è¡¨ï¼Œä¹Ÿä¼šåŒæ­¥ä¿®æ”¹å†…å­˜ä¸­çš„hashç»“æ„ã€‚å› æ­¤ï¼Œå¯¹è¿™ä¸¤ç±»æƒé™çš„æ“ä½œï¼Œä¹Ÿä¼šé©¬ä¸Šå½±å“åˆ°å·²ç»å­˜åœ¨çš„è¿æ¥ã€‚</p><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ ä¸€å®šä¼šé—®ï¼Œçœ‹æ¥grantè¯­å¥éƒ½æ˜¯å³æ—¶ç”Ÿæ•ˆçš„ï¼Œé‚£è¿™ä¹ˆçœ‹åº”è¯¥å°±ä¸éœ€è¦æ‰§è¡Œflush privilegesè¯­å¥äº†å‘€ã€‚</p><p>ç­”æ¡ˆä¹Ÿç¡®å®æ˜¯è¿™æ ·çš„ã€‚</p><p>flush privilegeså‘½ä»¤ä¼šæ¸…ç©ºacl_usersæ•°ç»„ï¼Œç„¶åä»mysql.userè¡¨ä¸­è¯»å–æ•°æ®é‡æ–°åŠ è½½ï¼Œé‡æ–°æ„é€ ä¸€ä¸ªacl_usersæ•°ç»„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»¥æ•°æ®è¡¨ä¸­çš„æ•°æ®ä¸ºå‡†ï¼Œä¼šå°†å…¨å±€æƒé™å†…å­˜æ•°ç»„é‡æ–°åŠ è½½ä¸€éã€‚</p><p>åŒæ ·åœ°ï¼Œå¯¹äºdbæƒé™ã€è¡¨æƒé™å’Œåˆ—æƒé™ï¼ŒMySQLä¹Ÿåšäº†è¿™æ ·çš„å¤„ç†ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå†…å­˜çš„æƒé™æ•°æ®å’Œç£ç›˜æ•°æ®è¡¨ç›¸åŒçš„è¯ï¼Œä¸éœ€è¦æ‰§è¡Œflush privilegesã€‚è€Œå¦‚æœæˆ‘ä»¬éƒ½æ˜¯ç”¨grant/revokeè¯­å¥æ¥æ‰§è¡Œçš„è¯ï¼Œå†…å­˜å’Œæ•°æ®è¡¨æœ¬æ¥å°±æ˜¯ä¿æŒåŒæ­¥æ›´æ–°çš„ã€‚</p><p><strong>å› æ­¤ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œgrantå‘½ä»¤ä¹‹åï¼Œæ²¡æœ‰å¿…è¦è·Ÿç€æ‰§è¡Œflush privilegeså‘½ä»¤ã€‚</strong></p><h1>flush privilegesä½¿ç”¨åœºæ™¯</h1><p>é‚£ä¹ˆï¼Œflush privilegesæ˜¯åœ¨ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å‘¢ï¼Ÿæ˜¾ç„¶ï¼Œå½“æ•°æ®è¡¨ä¸­çš„æƒé™æ•°æ®è·Ÿå†…å­˜ä¸­çš„æƒé™æ•°æ®ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œflush privilegesè¯­å¥å¯ä»¥ç”¨æ¥é‡å»ºå†…å­˜æ•°æ®ï¼Œè¾¾åˆ°ä¸€è‡´çŠ¶æ€ã€‚</p><p>è¿™ç§ä¸ä¸€è‡´å¾€å¾€æ˜¯ç”±ä¸è§„èŒƒçš„æ“ä½œå¯¼è‡´çš„ï¼Œæ¯”å¦‚ç›´æ¥ç”¨DMLè¯­å¥æ“ä½œç³»ç»Ÿæƒé™è¡¨ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸‹é¢è¿™ä¸ªåœºæ™¯ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/90/ec/9031814361be42b7bc084ad2ab2aa3ec.png" alt=""></p><center><span class="reference">å›¾4 ä½¿ç”¨flush privileges</span></center><p>å¯ä»¥çœ‹åˆ°ï¼ŒT3æ—¶åˆ»è™½ç„¶å·²ç»ç”¨deleteè¯­å¥åˆ é™¤äº†ç”¨æˆ·uaï¼Œä½†æ˜¯åœ¨T4æ—¶åˆ»ï¼Œä»ç„¶å¯ä»¥ç”¨uaè¿æ¥æˆåŠŸã€‚åŸå› å°±æ˜¯ï¼Œè¿™æ—¶å€™å†…å­˜ä¸­acl_usersæ•°ç»„ä¸­è¿˜æœ‰è¿™ä¸ªç”¨æˆ·ï¼Œå› æ­¤ç³»ç»Ÿåˆ¤æ–­æ—¶è®¤ä¸ºç”¨æˆ·è¿˜æ­£å¸¸å­˜åœ¨ã€‚</p><p>åœ¨T5æ—¶åˆ»æ‰§è¡Œè¿‡flushå‘½ä»¤åï¼Œå†…å­˜æ›´æ–°ï¼ŒT6æ—¶åˆ»å†è¦ç”¨uaæ¥ç™»å½•çš„è¯ï¼Œå°±ä¼šæŠ¥é”™â€œæ— æ³•è®¿é—®â€äº†ã€‚</p><p>ç›´æ¥æ“ä½œç³»ç»Ÿè¡¨æ˜¯ä¸è§„èŒƒçš„æ“ä½œï¼Œè¿™ä¸ªä¸ä¸€è‡´çŠ¶æ€ä¹Ÿä¼šå¯¼è‡´ä¸€äº›æ›´â€œè¯¡å¼‚â€çš„ç°è±¡å‘ç”Ÿã€‚æ¯”å¦‚ï¼Œå‰é¢è¿™ä¸ªé€šè¿‡deleteè¯­å¥åˆ é™¤ç”¨æˆ·çš„ä¾‹å­ï¼Œå°±ä¼šå‡ºç°ä¸‹é¢çš„æƒ…å†µï¼š</p><p><img src="https://static001.geekbang.org/resource/image/dd/f1/dd625b6b4eb2dcbdaac73648a1af50f1.png" alt=""></p><center><span class="reference">å›¾5 ä¸è§„èŒƒæƒé™æ“ä½œå¯¼è‡´çš„å¼‚å¸¸</span></center><p>å¯ä»¥çœ‹åˆ°ï¼Œç”±äºåœ¨T3æ—¶åˆ»ç›´æ¥åˆ é™¤äº†æ•°æ®è¡¨çš„è®°å½•ï¼Œè€Œå†…å­˜çš„æ•°æ®è¿˜å­˜åœ¨ã€‚è¿™å°±å¯¼è‡´äº†ï¼š</p><ol>
<li>
<p>T4æ—¶åˆ»ç»™ç”¨æˆ·uaèµ‹æƒé™å¤±è´¥ï¼Œå› ä¸ºmysql.userè¡¨ä¸­æ‰¾ä¸åˆ°è¿™è¡Œè®°å½•ï¼›</p>
</li>
<li>
<p>è€ŒT5æ—¶åˆ»è¦é‡æ–°åˆ›å»ºè¿™ä¸ªç”¨æˆ·ä¹Ÿä¸è¡Œï¼Œå› ä¸ºåœ¨åšå†…å­˜åˆ¤æ–­çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºè¿™ä¸ªç”¨æˆ·è¿˜å­˜åœ¨ã€‚</p>
</li>
</ol><h1>å°ç»“</h1><p>ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘å’Œä½ ä»‹ç»äº†MySQLç”¨æˆ·æƒé™åœ¨æ•°æ®è¡¨å’Œå†…å­˜ä¸­çš„å­˜åœ¨å½¢å¼ï¼Œä»¥åŠgrantå’Œrevokeå‘½ä»¤çš„æ‰§è¡Œé€»è¾‘ã€‚</p><p>grantè¯­å¥ä¼šåŒæ—¶ä¿®æ”¹æ•°æ®è¡¨å’Œå†…å­˜ï¼Œåˆ¤æ–­æƒé™çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯å†…å­˜æ•°æ®ã€‚å› æ­¤ï¼Œè§„èŒƒåœ°ä½¿ç”¨grantå’Œrevokeè¯­å¥ï¼Œæ˜¯ä¸éœ€è¦éšååŠ ä¸Šflush privilegesè¯­å¥çš„ã€‚</p><p>flush privilegesè¯­å¥æœ¬èº«ä¼šç”¨æ•°æ®è¡¨çš„æ•°æ®é‡å»ºä¸€ä»½å†…å­˜æƒé™æ•°æ®ï¼Œæ‰€ä»¥åœ¨æƒé™æ•°æ®å¯èƒ½å­˜åœ¨ä¸ä¸€è‡´çš„æƒ…å†µä¸‹å†ä½¿ç”¨ã€‚è€Œè¿™ç§ä¸ä¸€è‡´å¾€å¾€æ˜¯ç”±äºç›´æ¥ç”¨DMLè¯­å¥æ“ä½œç³»ç»Ÿæƒé™è¡¨å¯¼è‡´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°½é‡ä¸è¦ä½¿ç”¨è¿™ç±»è¯­å¥ã€‚</p><p>å¦å¤–ï¼Œåœ¨ä½¿ç”¨grantè¯­å¥èµ‹æƒæ—¶ï¼Œä½ å¯èƒ½è¿˜ä¼šçœ‹åˆ°è¿™æ ·çš„å†™æ³•ï¼š</p><pre><code>grant super on *.* to 'ua'@'%' identified by 'pa';
</code></pre><p>è¿™æ¡å‘½ä»¤åŠ äº†identified by â€˜å¯†ç â€™ï¼Œ è¯­å¥çš„é€»è¾‘é‡Œé¢é™¤äº†èµ‹æƒå¤–ï¼Œè¿˜åŒ…å«äº†ï¼š</p><ol>
<li>
<p>å¦‚æœç”¨æˆ·â€™uaâ€™@â€™%'ä¸å­˜åœ¨ï¼Œå°±åˆ›å»ºè¿™ä¸ªç”¨æˆ·ï¼Œå¯†ç æ˜¯paï¼›</p>
</li>
<li>
<p>å¦‚æœç”¨æˆ·uaå·²ç»å­˜åœ¨ï¼Œå°±å°†å¯†ç ä¿®æ”¹æˆpaã€‚</p>
</li>
</ol><p>è¿™ä¹Ÿæ˜¯ä¸€ç§ä¸å»ºè®®çš„å†™æ³•ï¼Œå› ä¸ºè¿™ç§å†™æ³•å¾ˆå®¹æ˜“å°±ä¼šä¸æ…æŠŠå¯†ç ç»™æ”¹äº†ã€‚</p><p>â€œgrantä¹‹åéšæ‰‹åŠ flush privilegesâ€ï¼Œæˆ‘è‡ªå·±æ˜¯è¿™ä¹ˆä½¿ç”¨äº†ä¸¤ä¸‰å¹´ä¹‹åï¼Œåœ¨çœ‹ä»£ç çš„æ—¶å€™æ‰å‘ç°å…¶å®å¹¶ä¸éœ€è¦è¿™æ ·åšï¼Œé‚£å·²ç»æ˜¯2011å¹´çš„äº‹æƒ…äº†ã€‚</p><p>å»å¹´æˆ‘çœ‹åˆ°ä¸€ä½å°ä¼™ä¼´è¿™ä¹ˆæ“ä½œçš„æ—¶å€™ï¼ŒæŒ‡å‡ºè¿™ä¸ªé—®é¢˜æ—¶ï¼Œä»–ä¹Ÿè§‰å¾—å¾ˆç¥å¥‡ã€‚å› ä¸ºï¼Œä»–å’Œæˆ‘ä¸€æ ·çœ‹çš„ç¬¬ä¸€ä»½æ–‡æ¡£å°±æ˜¯è¿™ä¹ˆå†™çš„ï¼Œè‡ªå·±ä¹Ÿä¸€ç›´æ˜¯è¿™ä¹ˆç”¨çš„ã€‚</p><p>æ‰€ä»¥ï¼Œä»Šå¤©çš„è¯¾åé—®é¢˜æ˜¯ï¼Œè¯·ä½ ä¹Ÿæ¥è¯´ä¸€è¯´ï¼Œåœ¨ä½¿ç”¨æ•°æ®åº“æˆ–è€…å†™ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰æ²¡æœ‰é‡åˆ°è¿‡ç±»ä¼¼çš„åœºæ™¯ï¼šè¯¯ç”¨äº†å¾ˆé•¿æ—¶é—´ä»¥åï¼Œç”±äºä¸€ä¸ªå¥‘æœºå‘ç°â€œå•Šï¼ŒåŸæ¥æˆ‘é”™äº†è¿™ä¹ˆä¹…â€ï¼Ÿ</p><p>ä½ å¯ä»¥æŠŠä½ çš„ç»å†å†™åœ¨ç•™è¨€åŒºï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« çš„æœ«å°¾é€‰å–æœ‰è¶£çš„è¯„è®ºå’Œä½ åˆ†äº«ã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><h1>ä¸ŠæœŸé—®é¢˜æ—¶é—´</h1><p>ä¸ŠæœŸçš„é—®é¢˜æ˜¯ï¼ŒMySQLè§£æstatementæ ¼å¼çš„binlogçš„æ—¶å€™ï¼Œå¯¹äºload dataå‘½ä»¤ï¼Œè§£æå‡ºæ¥ä¸ºä»€ä¹ˆç”¨çš„æ˜¯load data localã€‚</p><p>è¿™æ ·åšçš„ä¸€ä¸ªåŸå› æ˜¯ï¼Œä¸ºäº†ç¡®ä¿å¤‡åº“åº”ç”¨binlogæ­£å¸¸ã€‚å› ä¸ºå¤‡åº“å¯èƒ½é…ç½®äº†secure_file_priv=nullï¼Œæ‰€ä»¥å¦‚æœä¸ç”¨localçš„è¯ï¼Œå¯èƒ½ä¼šå¯¼å…¥å¤±è´¥ï¼Œé€ æˆä¸»å¤‡åŒæ­¥å»¶è¿Ÿã€‚</p><p>å¦ä¸€ç§åº”ç”¨åœºæ™¯æ˜¯ä½¿ç”¨mysqlbinlogå·¥å…·è§£æbinlogæ–‡ä»¶ï¼Œå¹¶åº”ç”¨åˆ°ç›®æ ‡åº“çš„æƒ…å†µã€‚ä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™æ¡å‘½ä»¤ ï¼š</p><pre><code>mysqlbinlog $binlog_file | mysql -h$host -P$port -u$user -p$pwd
</code></pre><p>æŠŠæ—¥å¿—ç›´æ¥è§£æå‡ºæ¥å‘ç»™ç›®æ ‡åº“æ‰§è¡Œã€‚å¢åŠ localï¼Œå°±èƒ½è®©è¿™ä¸ªæ–¹æ³•æ”¯æŒéæœ¬åœ°çš„$hostã€‚</p><p>è¯„è®ºåŒºç•™è¨€ç‚¹èµæ¿ï¼š</p><blockquote>
<p>@poppy ã€@åº“æ·˜æ·˜ ä¸¤ä½åŒå­¦æåˆ°äº†ç¬¬ä¸€ä¸ªåœºæ™¯ï¼›<br>
@ç‹æ˜¾ä¼Ÿ @lionetes ä¸¤ä½åŒå­¦å¸®å¿™å›ç­”äº† @undifined åŒå­¦çš„ç–‘é—®ï¼Œæ‹·è´å‡ºæ¥çš„æ–‡ä»¶è¦ç¡®ä¿MySQLè¿›ç¨‹å¯ä»¥è¯»ã€‚</p>
</blockquote><p><img src="https://static001.geekbang.org/resource/image/09/77/09c1073f99cf71d2fb162a716b5fa577.jpg" alt=""></p>
                    </div>
                </div>

            </div>
            <div data-v-87ffcada="" class="article-comments pd"><h2 data-v-87ffcada=""><span
                    data-v-87ffcada="">ç²¾é€‰ç•™è¨€</span></h2>
                <ul data-v-87ffcada="">
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/4f/78/c3d8ecb0.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">undifined</span>
                            </div>
                            <div class="bd">æƒé™çš„ä½œç”¨èŒƒå›´å’Œä¿®æ”¹ç­–ç•¥æ€»ç»“ï¼š<br>http:&#47;&#47;ww1.sinaimg.cn&#47;large&#47;d1885ed1ly1g0ab2twmjaj21gs0js78u.jpg <br></div>
                            <span class="time">2019-02-18 09:11</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘ï¼Œä¼˜ç§€</p>
                                <p class="reply-time">2019-02-18 11:58</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/57/6e/dd0eee5f.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¤œç©ºä¸­æœ€äº®çš„æ˜Ÿï¼ˆåä»”ï¼‰</span>
                            </div>
                            <div class="bd">é€šè¿‡è€å¸ˆçš„è®²è§£ flush privileges è¿™å›å½»åº•æ‡‚äº†ï¼Œé«˜å…´ğŸ˜ƒ <br></div>
                            <span class="time">2019-02-18 16:55</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘</p>
                                <p class="reply-time">2019-02-19 09:17</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/e0/b9/bca7ff9a.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">way</span>
                            </div>
                            <div class="bd">å†™ä¸ªæ¯”è¾ƒå°çš„ç‚¹ï¼šåœ¨å‘½ä»¤è¡ŒæŸ¥è¯¢æ•°æ®éœ€è¦è¡Œè½¬åˆ—çš„æ—¶å€™ä¹ æƒ¯åŠ ä¸ª\G ; æ¯”å¦‚slave slave stauts \G ; åæ¥å‘ç° ; æ˜¯å¤šä½™çš„ã€‚åˆ—å‡ ä¸ªå¸¸ç”¨çš„<br>\G è¡Œè½¬åˆ—å¹¶å‘é€ç»™ mysql server<br>\g ç­‰åŒäº ;<br>\! æ‰§è¡Œç³»ç»Ÿå‘½ä»¤<br>\q exit<br>\c æ¸…é™¤å½“å‰SQLï¼ˆä¸æ‰§è¡Œï¼‰<br>\s mysql status ä¿¡æ¯<br>å…¶ä»–å‚è€ƒ \h <br></div>
                            <span class="time">2019-02-20 11:55</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘<br><br>æˆ‘æœ€å¼€å§‹ä½¿ç”¨MySQLçš„æ—¶å€™ï¼Œå°±æ˜¯ä¸è‡ªç„¶çš„åœ¨\Gåé¢åŠ åˆ†å·<br>è€Œä¸”è¿˜çœ‹åˆ°æŠ¥é”™ï¼Œå¥½ç´§å¼ ğŸ˜†</p>
                                <p class="reply-time">2019-02-20 13:32</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/77/fd/c6619535.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">XD</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæˆ‘åˆšè¯´çš„æ˜¯acl_dbï¼Œæ˜¯åœ¨dbåˆ‡æ¢çš„æ—¶å€™ï¼Œä»acl_dbsæ‹·è´åˆ°çº¿ç¨‹å†…éƒ¨çš„ï¼Ÿç±»ä¼¼acl_userã€‚<br><br>session a<br>drop user &#39;test&#39;@&#39;%&#39;;<br>create user &#39;test&#39;@&#39;%&#39; identified by &#39;123456&#39;;<br>grant SELECT,UPDATE on gt.* to &#39;test&#39;@&#39;%&#39;;<br><br>session b   ä½¿ç”¨testç™»å½•<br>use gt;<br><br>session a<br>revoke SELECT,UPDATE on gt.* from &#39;test&#39;@&#39;%&#39;;<br><br>session b<br>show databases;  &#47;&#47;åªèƒ½çœ‹åˆ°information_schemaåº“<br>use gt;   &#47;&#47; Access denied for user &#39;test&#39;@&#39;%&#39; to database &#39;gt&#39;<br>show tables;   &#47;&#47;å¯ä»¥çœ‹åˆ°gtåº“ä¸­æ‰€æœ‰çš„è¡¨<br>select&#47;update  &#47;&#47;æ“ä½œéƒ½æ­£å¸¸ <br></div>
                            <span class="time">2019-02-18 23:28</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ä½ è¯´çš„å¯¹ï¼Œæˆ‘åˆšç¿»ä»£ç ç¡®è®¤äº†ä¸‹ï¼Œç¡®å®æ˜¯ç‰¹åˆ«å¯¹â€œå½“å‰dbâ€æœ‰ä¸€ä¸ªæ”¾è¿‡çš„é€»è¾‘ã€‚<br><br>å¤šè°¢æŒ‡æ­£ã€‚æˆ‘å‹˜è¯¯ä¸‹ã€‚</p>
                                <p class="reply-time">2019-02-19 21:14</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/57/96/b65bdf43.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è¤ç«è™«</span>
                            </div>
                            <div class="bd">åšæŒåˆ°æœ€å ä¸ºè€å¸ˆæ‰“call <br></div>
                            <span class="time">2019-02-20 16:52</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘<br>æ˜¯çœŸçˆ±</p>
                                <p class="reply-time">2019-02-20 18:44</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/ef/af/ba786593.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">wljs</span>
                            </div>
                            <div class="bd">è€å¸ˆæˆ‘æƒ³é—®ä¸ªé—®é¢˜ æˆ‘ä»¬å…¬å¸ä¸€ä¸ªè®¢å•è¡¨æœ‰110ä¸ªå­—æ®µ æƒ³æ‹†åˆ†æˆä¸¤ä¸ªè¡¨ ç¬¬ä¸€ä¸ªè¡¨æ”¾ç»å¸¸æŸ¥çš„å­—æ®µ ç¬¬äºŒä¸ªè¡¨æ”¾ä¸å¸¸æŸ¥çš„ ç°åœ¨ç¨‹åºç«¯ä¸æƒ³æ”¹sqlï¼Œæ•°æ®åº“ç«¯æ¥å®ç° å½“æŸ¥è¯¢å­—æ®µä¸­ ç¬¬ä¸€ä¸ªè¡¨ä¸å­˜åœ¨ å°±å»å…³è”ç¬¬äºŒä¸ªè¡¨æŸ¥å‡ºæ•°æ®  dbèƒ½å®ç°ä¸ï¼Ÿ <br></div>
                            <span class="time">2019-02-19 23:51</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/a1/a5/2100367c.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">èˆœ</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œä»‹ç»å®Œäº†order byåèƒ½ä¸èƒ½ç»§ç»­ä»‹ç»ä¸‹group byçš„åŸç†ï¼Ÿç­‰äº†å¥½ä¹…äº†ï¼Œä¸€ç›´æƒ³ç»§ç»­åœ¨order byåŸºç¡€ä¸Šç†è§£ä¸‹group byï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸¤è€…åœ¨ç´¢å¼•åˆ©ç”¨ä¸Šå¾ˆç›¸è¿‘ï¼Œæ€§èƒ½è€ƒè™‘ä¹Ÿç±»ä¼¼ <br></div>
                            <span class="time">2019-02-19 12:58</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">37ç¯‡è®²äº†group byçš„ï¼Œä½ çœ‹ä¸‹<br><br>è¿˜æœ‰é—®å†æå‡ºæ¥ğŸ˜†</p>
                                <p class="reply-time">2019-02-19 15:39</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/a1/e6/50da1b2d.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ—­ä¸œ</span>
                            </div>
                            <div class="bd">è€å¸ˆè¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼šMySQL è¡¨è®¾è®¡æ—¶åˆ—è¡¨é¡ºåºå¯¹MySQLæ€§èƒ½çš„å½±å“å¤§å—ï¼Ÿå¯¹è¡¨çš„åˆ—é¡ºåºæœ‰ä»€ä¹ˆå»ºè®®å—ï¼Ÿ <br></div>
                            <span class="time">2019-02-18 23:16</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ²¡æœ‰å½±å“<br><br>å»ºè®®å°±æ˜¯æ¯æ¬¡å¦‚æœè¦åŠ åˆ—éƒ½åŠ åˆ°æœ€åä¸€åˆ—ğŸ˜†</p>
                                <p class="reply-time">2019-02-19 09:22</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/77/fd/c6619535.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">XD</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œå®é™…æµ‹è¯•äº†ä¸‹ã€‚<br>ä¸¤ä¸ªä¼šè¯abï¼Œç™»é™†è´¦å·éƒ½ä¸ºuserã€‚aä¸­ç»™useræˆäºˆdb1çš„selectã€updateæƒé™ï¼Œbåˆ‡æ¢åˆ°db1ï¼Œå¯ä»¥æ­£å¸¸å¢æ”¹ã€‚ç„¶åaä¸­å›æ”¶è¯¥ç”¨æˆ·çš„dbæƒé™ï¼Œbä¼šè¯ä¸­çš„ç”¨æˆ·è¿˜æ˜¯å¯ä»¥è¿›è¡Œå¢æ”¹æ“ä½œçš„ã€‚<br>æˆ‘å‘ç°ç”¨æˆ·çš„dbæƒé™å¥½åƒæ˜¯åœ¨åˆ‡æ¢æ•°æ®åº“çš„æ—¶å€™åˆ·æ–°çš„ï¼Œåªè¦ä¸åˆ‡æ¢ï¼Œgrantæ“ä½œå¹¶ä¸ä¼šäº§ç”Ÿä½œç”¨ï¼Œæ‰€ä»¥acl_dbæ˜¯å¦ä¹Ÿæ˜¯ç»´æŠ¤åœ¨çº¿ç¨‹å†…éƒ¨çš„å‘¢ï¼Ÿ<br><br>ä»¥åŠï¼Œæƒé™æ£€éªŒåº”è¯¥æ˜¯åœ¨ä¼˜åŒ–å™¨çš„è¯­ä¹‰åˆ†æé‡Œè¿›è¡Œçš„å§ï¼Ÿ <br></div>
                            <span class="time">2019-02-18 22:25</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">acl_dbsæ˜¯å…¨å±€æ•°ç»„<br><br>æŠŠä½ ä½¿ç”¨sqlè¯­å¥ï¼Œå’Œè¯­å¥åºåˆ—å‘ä¸€ä¸‹å“¦<br><br>ç±»ä¼¼æŒ‰ç…§æ—¶é—´é¡ºåº<br>session aï¼š<br>  xxx<br>  xxx<br>session b:<br>   xxxx<br>session a:<br>   xxxx<br>è¿™æ ·</p>
                                <p class="reply-time">2019-02-18 22:59</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJCscgdVibmoPyRLRaicvk6rjTJxePZ6VFHvGjUQvtfhCS6kO4OZ1AVibbhNGKlWZmpEFf2yA6ptsqHw/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¤¹å¿ƒé¢åŒ…</span>
                            </div>
                            <div class="bd">æˆ‘åœ¨æ­¤åˆ†äº«ä¸€ä¸ªæˆæƒåº“çš„å°æŠ€å·§, å¦‚æœéœ€è¦æˆæƒå¤šä¸ªåº“,åº“åè¿˜æœ‰è§„å¾‹,æ¯”å¦‚ db_201701 db_201702<br>å¯ä»¥é‡‡ç”¨æ­£åˆ™åŒ¹é…å†™ä¸€æ¡ grant  on db______,æ¯ä¸€ä¸ª_ä»£è¡¨ä¸€ä¸ªå­—ç¬¦.è¿™æ ·é¿å…äº†å¤šæ¬¡æˆæƒ,ç®€åŒ–äº†è¿‡ç¨‹ã€‚æˆ‘ä»¬çº¿ä¸Šå·²ç»é‡‡ç”¨ <br></div>
                            <span class="time">2019-02-18 17:09</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ˜¯çš„ï¼ŒMySQLè¿˜æ”¯æŒ % èµ‹æƒï¼Œ%è¡¨ç¤ºåŒ¹é…ä»»æ„å­—ç¬¦ä¸²ï¼Œ<br>æ¯”å¦‚<br>grant all privileges on `db%`.* to ... è¡¨ç¤ºæ‰€æœ‰ä»¥dbä¸ºå‰ç¼€çš„åº“ã€‚<br><br>ä¸è¿‡ã€‚ã€‚ã€‚æˆ‘æ¯”è¾ƒä¸å»ºè®®è¿™ä¹ˆç”¨ğŸ˜…</p>
                                <p class="reply-time">2019-02-19 10:33</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/1c/5c/f5f24221.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å‘èŠ½çš„ç´«èœ</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œè”åˆç´¢å¼•çš„æ•°æ®ç»“æ„æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿåˆ°åº•æ˜¯æ€ä¹ˆå­˜çš„ï¼Ÿçœ‹äº†å‰é¢ç´¢å¼•ä¸¤ç« ï¼Œè¿˜æ˜¯ä¸å¤ªæ‡‚ï¼Œç•™è¨€é‡Œè€å¸ˆè¯´ä¼šåœ¨åé¢ç« èŠ‚ä¼šè®²åˆ°ï¼Œä½†æˆ‘ä¹Ÿæ²¡çœ‹åˆ°ï¼Œæ‰€ä»¥æ¥æ­¤é—®ä¸€ä¸‹ï¼Ÿè€å¸ˆèƒ½å¦ç”»å›¾è®²è§£ä¸€ä¸‹ <br></div>
                            <span class="time">2019-02-18 15:42</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è”åˆç´¢å¼•å°±æ˜¯ä¸¤ä¸ªå­—æ®µæ‹¼èµ·æ¥ä½œç´¢å¼•<br><br>æ¯”å¦‚ä¸€ä¸ªç´¢å¼•å¦‚æœå®šä¹‰ä¸º(f1,f2),<br>åœ¨æ•°æ®ä¸Šï¼Œå°±æ˜¯f1çš„å€¼ä¹‹åè·Ÿç€f2çš„å€¼ã€‚<br>æŸ¥æ‰¾çš„æ—¶å€™ï¼Œæ¯”å¦‚æ‰§è¡Œ where f1=M and f2=N, ä¹Ÿæ˜¯æŠŠM,Næ‹¼èµ·æ¥ï¼Œå»ç´¢å¼•æ ‘æŸ¥æ‰¾</p>
                                <p class="reply-time">2019-02-18 23:03</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/e9/8e/6dc15a91.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ™¨æ€æš®è¯­</span>
                            </div>
                            <div class="bd">ä¸è€å¸ˆ,æ‚¨å¥½ï¼š<br>å…³äºä¸Šä¸€ç« æˆ‘ç•™è¨€çš„ç–‘é—®,æˆ‘é‡æ–°æ•´ç†äº†ä¸‹ã€‚å°±æ˜¯ç¬¬åäº”ç« ä¸­è€å¸ˆç•™çš„æ€è€ƒé¢˜ã€‚<br>æˆ‘æ¨¡æ‹Ÿäº†è€å¸ˆçš„å®éªŒ,ç»“æœæœ‰ç‚¹å‡ºå…¥,è¯·è€å¸ˆå¸®å¿™çœ‹çœ‹ï¼Œè°¢è°¢ï¼<br>åŸºç¡€ç¯å¢ƒ:<br>mysql&gt; select version();<br>+------------+<br>| version()  |<br>+------------+<br>| 5.7.22-log |<br>+------------+<br>1 row in set (0.00 sec)<br><br>mysql&gt; show variables like &#39;%tx%&#39;;<br>+---------------+-----------------+<br>| Variable_name | Value           |<br>+---------------+-----------------+<br>| tx_isolation  | REPEATABLE-READ |<br>| tx_read_only  | OFF             |<br>+---------------+-----------------+<br>2 rows in set (0.00 sec)<br>æ¨¡æ‹Ÿå®éªŒ:<br>session A:	                                         <br>mysql&gt; begin;	<br>mysql&gt; select * from t;	<br>+----+------+	<br>| id | a    |	<br>+----+------+	<br>|  1 |    2 |	<br>+----+------+	<br>1 row in set (0.00 sec)	<br><br>session B:                                          <br>mysql&gt; update t set a=3 where id=1;      <br>Query OK, 1 row affected (0.00 sec)      <br>Rows matched: 1  Changed: 1  Warnings: 0 	                                                  <br><br>SESSION A:                                                 <br>mysql&gt;  update t set a=3 where id=1;	<br>Query OK, 0 rows affected (0.00 sec)	<br>Rows matched: 1  Changed: 0  Warnings: 0	<br>&#47;*è€å¸ˆçš„å®éªŒæ˜¾ç¤ºä¸ºï¼š1 rows affected*&#47;	<br>mysql&gt; select * from t where id=1;	<br>+----+------+	<br>| id | a    |	<br>+----+------+	<br>|  1 |    2 |	<br>+----+------+	<br>1 row in set (0.00 sec)	<br>&#47;*è€å¸ˆå®éªŒçš„æŸ¥è¯¢ç»“æœä¸ºï¼š1,3	*&#47; <br></div>
                            <span class="time">2019-02-18 10:28</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAibnPX9jW8kqLcIfibjic8GbkQkEUYyFKJkc39hZhibVlNrqwTjdLozkqibI2IwACd5YzofYickNxFnZg/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Sinyo</span>
                            </div>
                            <div class="bd">æŸ¥ä¸€å¼ å¤§è¡¨ï¼Œorder_keyå­—æ®µå€¼å¯¹åº”çš„æœ€å°createtimeï¼›<br>ä»¥å‰ä¸€ç›´ç”¨æ–¹æ³•ä¸€æŸ¥æ•°ï¼Œåæ¥åŒäº‹è¯´å¯ä»¥ä¼˜åŒ–æˆæ–¹æ³•äºŒï¼ŒæŸ¥è¯¢æ•ˆç‡æ¯”æ–¹æ³•ä¸€é«˜äº†å‡ å€ï¼›<br>mysqlç‰¹æœ‰çš„group byåŠŸèƒ½ï¼Œæ²¡æœ‰group byçš„å­—æ®µé»˜è®¤å–æŸ¥åˆ°çš„ç¬¬ä¸€æ¡è®°å½•ï¼›<br><br>æ–¹æ³•ä¸€ï¼š<br>select distinct order_key<br>      ,createtime<br>  from (select order_key<br>              ,min(createtime) createtime<br>          from aaa<br>         group by order_key) a<br>  join aaa b<br>    on a.order_key = b.order_key<br>   and a.createtime = b.createtime<br><br>æ–¹æ³•äºŒï¼š<br>select order_key<br>      ,createtime<br>  from (select order_key<br>              ,createtime<br>          FROM aaa<br>         order by createtime<br>       ) a<br> group by order_key <br></div>
                            <span class="time">2019-02-18 10:07</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘<br><br><br>è¿™ç¬¬äºŒä¸ªå†™æ³•è·Ÿï¼š<br>select order_key ,createtime FROM aaa force index(createtime) group by order_key<br> çš„é€»è¾‘è¯­ä¹‰ç›¸åŒå—ï¼Ÿ<br></p>
                                <p class="reply-time">2019-02-18 11:57</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">LeonğŸ“·</span>
                            </div>
                            <div class="bd">è€å¸ˆæˆ‘ä½¿ç”¨delteåˆ é™¤ç”¨æˆ·ï¼Œå†åˆ›å»ºç”¨æˆ·éƒ½æ˜¯å¤±è´¥ï¼Œä½†æ˜¯ä½¿ç”¨dropå°±å¯ä»¥äº†<br>mysql&gt; create user &#39;ua&#39;@&#39;%&#39; identified by &#39;L1234567890c-&#39;;<br>ERROR 1396 (HY000): Operation CREATE USER failed for &#39;ua&#39;@&#39;%&#39;<br>mysql&gt; drop user &#39;ua&#39;@&#39;%&#39;;<br>Query OK, 0 rows affected (0.00 sec)<br><br>mysql&gt; create user &#39;ua&#39;@&#39;%&#39; identified by &#39;L1234567890c-&#39;;<br>Query OK, 0 rows affected (0.01 sec)<br>æ˜¯ä¸æ˜¯dropæ‰ä¼šåŒæ—¶ä»å†…å­˜å’Œç£ç›˜åˆ é™¤ç”¨æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯deleteåªæ˜¯ä»ç£ç›˜åˆ é™¤ <br></div>
                            <span class="time">2019-02-18 09:46</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å¯¹ï¼Œdropæ˜¯åŒæ—¶æ“ä½œç£ç›˜å’Œå†…å­˜ï¼Œ<br>deleteå°±æ˜¯æˆ‘ä»¬è¯´çš„ä¸è§„èŒƒæ“ä½œ</p>
                                <p class="reply-time">2019-02-18 23:00</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">çˆ¸çˆ¸å›æ¥äº†</span>
                            </div>
                            <div class="bd">ä¼—æ‰€å‘¨çŸ¥ï¼Œsqlæ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ã€‚ç„¶è€Œï¼Œæ¶‰åŠæ’ä»¶çš„å˜é‡å´ä¸æ˜¯è¿™æ ·ï¼›ä¸Šæ¬¡åœ¨é…ç½®ä¸€ä¸ªæ’ä»¶çš„å‚æ•°çš„æ—¶å€™ï¼Œè‹¦æ€è‰¯ä¹…â€¦â€¦æœ€åå‘ç°äº†è¿™ä¸ªé—®é¢˜ã€‚éš¾å—ğŸ˜­ <br></div>
                            <span class="time">2019-02-18 08:12</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ˜†ä½ è¯´çš„æ˜¯å‚æ•°çš„åå­—ï¼Œè¿˜æ˜¯å‚æ•°çš„å€¼ï¼Ÿ<br></p>
                                <p class="reply-time">2019-02-18 09:16</p>
                            </div>
                            
                        </div>
                    </li>
                    


                </ul>
            </div>
        </div>
    </div>
</div>
</body>
</html>