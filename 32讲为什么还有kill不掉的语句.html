<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <style type="text/css">

#watermark {

  position: relative;
  overflow: hidden;
}

#watermark .x {
  position: absolute;
  top: 800;
  left: 400;
  color: #3300ff;
  font-size: 50px;
  pointer-events: none;
  opacity:0.3;
  filter:Alpha(opacity=50);
  
  
}
    </style>


    <style type="text/css">
 html{color:#333;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;text-rendering:optimizelegibility;font-family:Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif}html.borderbox *,html.borderbox :after,html.borderbox :before{box-sizing:border-box}article,aside,blockquote,body,button,code,dd,details,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hr,input,legend,li,menu,nav,ol,p,pre,section,td,textarea,th,ul{margin:0;padding:0}article,aside,details,figcaption,figure,footer,header,menu,nav,section{display:block}audio,canvas,video{display:inline-block}body,button,input,select,textarea{font:300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}table{border-collapse:collapse;border-spacing:0}fieldset,img{border:0}blockquote{position:relative;color:#999;font-weight:400;border-left:1px solid #1abc9c;padding-left:1em;margin:1em 3em 1em 2em}@media only screen and (max-width:640px){blockquote{margin:1em 0}}abbr,acronym{border-bottom:1px dotted;font-variant:normal}abbr{cursor:help}del{text-decoration:line-through}address,caption,cite,code,dfn,em,th,var{font-style:normal;font-weight:400}ol,ul{list-style:none}caption,th{text-align:left}q:after,q:before{content:""}sub,sup{font-size:75%;line-height:0;position:relative}:root sub,:root sup{vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}a{color:#1abc9c}a:hover{text-decoration:underline}.typo a{border-bottom:1px solid #1abc9c}.typo a:hover{border-bottom-color:#555;color:#555}.typo a:hover,a,ins{text-decoration:none}.typo-u,u{text-decoration:underline}mark{background:#fffdd1;border-bottom:1px solid #ffedce;padding:2px;margin:0 5px}code,pre,pre tt{font-family:Courier,Courier New,monospace}pre{background:hsla(0,0%,97%,.7);border:1px solid #ddd;padding:1em 1.5em;display:block;-webkit-overflow-scrolling:touch}hr{border:none;border-bottom:1px solid #cfcfcf;margin-bottom:.8em;height:10px}.typo-small,figcaption,small{font-size:.9em;color:#888}b,strong{font-weight:700;color:#000}[draggable]{cursor:move}.clearfix:after,.clearfix:before{content:"";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.textwrap,.textwrap td,.textwrap th{word-wrap:break-word;word-break:break-all}.textwrap-table{table-layout:fixed}.serif{font-family:Palatino,Optima,Georgia,serif}.typo-dl,.typo-form,.typo-hr,.typo-ol,.typo-p,.typo-pre,.typo-table,.typo-ul,.typo dl,.typo form,.typo hr,.typo ol,.typo p,.typo pre,.typo table,.typo ul,blockquote{margin-bottom:1rem}h1,h2,h3,h4,h5,h6{font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;line-height:1.35}.typo-h1,.typo-h2,.typo-h3,.typo-h4,.typo-h5,.typo-h6,.typo h1,.typo h2,.typo h3,.typo h4,.typo h5,.typo h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}.typo-h1,.typo h1{font-size:2em}.typo-h2,.typo h2{font-size:1.8em}.typo-h3,.typo h3{font-size:1.6em}.typo-h4,.typo h4{font-size:1.4em}.typo-h5,.typo-h6,.typo h5,.typo h6{font-size:1.2em}.typo-ul,.typo ul{margin-left:1.3em;list-style:disc}.typo-ol,.typo ol{list-style:decimal;margin-left:1.9em}.typo-ol ol,.typo-ol ul,.typo-ul ol,.typo-ul ul,.typo li ol,.typo li ul{margin-bottom:.8em;margin-left:2em}.typo-ol ul,.typo-ul ul,.typo li ul{list-style:circle}.typo-table td,.typo-table th,.typo table caption,.typo table td,.typo table th{border:1px solid #ddd;padding:.5em 1em;color:#666}.typo-table th,.typo table th{background:#fbfbfb}.typo-table thead th,.typo table thead th{background:hsla(0,0%,95%,.7)}.typo table caption{border-bottom:none}.typo-input,.typo-textarea{-webkit-appearance:none;border-radius:0}.typo-em,.typo em,caption,legend{color:#000;font-weight:inherit}.typo-em{position:relative}.typo-em:after{position:absolute;top:.65em;left:0;width:100%;overflow:hidden;white-space:nowrap;content:"\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"}.typo img{max-width:100%}.common-content{font-weight:400;color:#353535;line-height:1.75rem;white-space:normal;word-break:normal;font-size:1rem}.common-content img{display:block;max-width:100%;background-color:#eee}.common-content audio,.common-content video{width:100%;background-color:#eee}.common-content center,.common-content font{margin-top:1rem;display:inline-block}.common-content center{width:100%}.common-content pre{margin-top:1rem;padding-left:0;padding-right:0;position:relative;overflow:hidden}.common-content pre code{font-size:.8rem;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;display:block;width:100%;box-sizing:border-box;padding-left:1rem;padding-right:1rem;overflow-x:auto}.common-content hr{border:none;margin-top:1.5rem;margin-bottom:1.5rem;border-top:1px solid #f5f5f5;height:1px;background:none}.common-content b,.common-content h1,.common-content h2,.common-content h3,.common-content h4,.common-content h5,.common-content strong{font-weight:700}.common-content h1,.common-content h2{font-size:1.125rem;margin-bottom:.45rem}.common-content h3,.common-content h4,.common-content h5{font-size:1rem;margin-bottom:.45rem}.common-content p{font-weight:400;color:#353535;margin-top:.15rem}.common-content .orange{color:#ff5a05}.common-content .reference{font-size:1rem;color:#888}.custom-rich-content h1{margin-top:0;font-weight:400;font-size:15.25px;border-bottom:1px solid #eee;line-height:2.8}.custom-rich-content li,.custom-rich-content p{font-size:14px;color:#888;line-height:1.6}table.hljs-ln{margin-bottom:0;border-spacing:0;border-collapse:collapse}table.hljs-ln,table.hljs-ln tbody,table.hljs-ln td,table.hljs-ln tr{box-sizing:border-box}table.hljs-ln td{padding:0;border:0}table.hljs-ln td.hljs-ln-numbers{min-width:15px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;cursor:pointer;user-select:none}table.hljs-ln td.hljs-ln-code,table.hljs-ln td.hljs-ln-numbers{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;line-height:20px;vertical-align:top}table.hljs-ln td.hljs-ln-code{position:relative;padding-right:10px;padding-left:10px;overflow:visible;color:#24292e;word-wrap:normal;white-space:pre}video::-webkit-media-controls{overflow:hidden!important}video::-webkit-media-controls-enclosure{width:calc(100% + 32px);margin-left:auto}.button-cancel{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel,.button-primary{-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary{color:#fff;background-color:#ff5a05;border-radius:3px}@font-face{font-family:iconfont;src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot);src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.woff) format("woff"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.ttf) format("truetype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.svg#iconfont) format("svg")}@font-face{font-family:player-font;src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot);src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.woff) format("woff"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.ttf) format("truetype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.svg#player-font) format("svg")}.iconfont{font-family:iconfont!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;-moz-osx-font-smoothing:grayscale}html{background:#fff;min-height:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{width:100%}body.fixed{overflow:hidden;position:fixed;width:100vw;height:100vh}i{font-style:normal}a{word-wrap:break-word;-webkit-tap-highlight-color:rgba(0,0,0,0)}a:hover{text-decoration:none}.fade-enter-active,.fade-leave-active{transition:opacity .3s}.fade-enter,.fade-leave-to{opacity:0}.MathJax,.MathJax_CHTML,.MathJax_MathContainer,.MathJax_MathML,.MathJax_PHTML,.MathJax_PlainSource,.MathJax_SVG{outline:0}.ios-app-switch .js-audit{display:none}._loading_wrap_{position:fixed;width:100vw;height:100vh;top:50%;left:50%;transform:translate(-50%,-50%);z-index:999}._loading_div_class_,._loading_wrap_{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._loading_div_class_{word-wrap:break-word;padding:.5rem .75rem;text-align:center;z-index:9999;font-size:.6rem;max-width:60%;color:#fff;border-radius:.25rem;-ms-flex-direction:column;flex-direction:column}._loading_div_class_ .message{color:#353535;font-size:16px;line-height:3}.spinner{animation:circle-rotator 1.4s linear infinite}.spinner *{line-height:0;box-sizing:border-box}@keyframes circle-rotator{0%{transform:rotate(0deg)}to{transform:rotate(270deg)}}.path{stroke-dasharray:187;stroke-dashoffset:0;transform-origin:center;animation:circle-dash 1.4s ease-in-out infinite,circle-colors 5.6s ease-in-out infinite}@keyframes circle-colors{0%{stroke:#ff5a05}to{stroke:#ff5a05}}@keyframes circle-dash{0%{stroke-dashoffset:187}50%{stroke-dashoffset:46.75;transform:rotate(135deg)}to{stroke-dashoffset:187;transform:rotate(450deg)}}.confirm-box-wrapper,.confirm-box-wrapper .mask{position:absolute;top:0;left:0;right:0;bottom:0}.confirm-box-wrapper .mask{background:rgba(0,0,0,.6)}.confirm-box-wrapper .confirm-box{position:fixed;top:50%;left:50%;width:267px;background:#fff;transform:translate(-50%,-50%);border-radius:7px}.confirm-box-wrapper .confirm-box .head{margin:0 18px;font-size:18px;text-align:center;line-height:65px;border-bottom:1px solid #d9d9d9}.confirm-box-wrapper .confirm-box .body{padding:18px;padding-bottom:0;color:#353535;font-size:12.5px;max-height:150px;overflow:auto}.confirm-box-wrapper .confirm-box .foot{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;padding:18px}.confirm-box-wrapper .confirm-box .foot .button-cancel{border:1px solid #d9d9d9}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}




    </style>
    <style type="text/css">
        .button-cancel[data-v-87ffcada]{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel[data-v-87ffcada],.button-primary[data-v-87ffcada]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary[data-v-87ffcada]{color:#fff;background-color:#ff5a05;border-radius:3px}.pd[data-v-87ffcada]{padding-left:1.375rem;padding-right:1.375rem}.article[data-v-87ffcada]{max-width:70rem;margin:0 auto}.article .article-unavailable[data-v-87ffcada]{color:#fa8919;font-size:15px;font-weight:600;line-height:24px;border-radius:5px;padding:12px;background-color:#f6f7fb;margin-top:20px}.article .article-unavailable .iconfont[data-v-87ffcada]{font-size:12px}.article .main[data-v-87ffcada]{padding:1.25rem 0;margin-bottom:52px}.article-title[data-v-87ffcada]{color:#353535;font-weight:400;line-height:1.65rem;font-size:1.34375rem}.article-info[data-v-87ffcada]{color:#888;font-size:.9375rem;margin-top:1.0625rem}.article-content[data-v-87ffcada]{margin-top:1.0625rem}.article-content.android video[data-v-87ffcada]::-webkit-media-controls-fullscreen-button{display:none}.copyright[data-v-87ffcada]{color:#b2b2b2;padding-bottom:20px;margin-top:20px;font-size:13px}.audio-player[data-v-87ffcada]{width:100%;margin:20px 0}.to-comment[data-v-87ffcada]{overflow:hidden;padding-top:10px;margin-bottom:-30px}.to-comment a.button-primary[data-v-87ffcada]{float:right;height:20px;font-size:12px;line-height:20px;padding:4px 8px;cursor:pointer}.article-comments[data-v-87ffcada]{margin-top:2rem}.article-comments h2[data-v-87ffcada]{text-align:center;color:#888;position:relative;z-index:1;margin-bottom:1rem}.article-comments h2[data-v-87ffcada]:before{border-top:1px dotted #888;content:"";position:absolute;top:56%;left:0;width:100%;z-index:-1}.article-comments h2 span[data-v-87ffcada]{font-size:15.25px;font-weight:400;padding:0 1rem;background:#fff;display:inline-block}.article-sub-bottom[data-v-87ffcada]{z-index:10;cursor:pointer}.switch-btns[data-v-87ffcada]{height:76px;cursor:pointer;padding-top:24px;padding-bottom:24px;border-bottom:10px solid #f6f7fb;position:relative}.switch-btns[data-v-87ffcada]:before{content:" ";height:1px;background:#e8e8e8;position:absolute;top:0;left:0;-webkit-box-sizing:border-box;box-sizing:border-box;left:1.375rem;right:1.375rem}.switch-btns .btn[data-v-87ffcada]{height:38px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.switch-btns .btn .tag[data-v-87ffcada]{-webkit-box-flex:0;-ms-flex:0 0 62px;flex:0 0 62px;text-align:center;color:#888;font-size:14px;border-radius:10px;height:22px;line-height:22px;background:#f6f7fb;font-weight:400}.switch-btns .btn .txt[data-v-87ffcada]{margin-left:10px;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:#888;font-size:15px;height:22px;line-height:22px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400}@media (max-width:769px){.article .breadcrumb[data-v-87ffcada]{padding-top:10px;padding-bottom:10px}}





    </style>

    <style type="text/css">
        .comment-item{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:1rem}.comment-item a{border-bottom:none}.comment-item .avatar{width:2.625rem;height:2.625rem;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}.comment-item .info{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.comment-item .info .hd{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .username{color:#888;font-size:15.25px;font-weight:400;line-height:1.2}.comment-item .info .hd .control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .control .btn-share{color:#888;font-size:.75rem;margin-right:1rem}.comment-item .info .hd .control .btn-praise{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:15.25px;text-decoration:none}.comment-item .info .hd .control .btn-praise i{color:#888;display:inline-block;font-size:.75rem;margin-right:.3rem;margin-top:-.01rem}.comment-item .info .hd .control .btn-praise i.on,.comment-item .info .hd .control .btn-praise span{color:#ff5a05}.comment-item .info .bd{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6}.comment-item .info .time{color:#888;font-size:9px;line-height:1}.comment-item .info .reply .reply-hd{font-size:15.25px}.comment-item .info .reply .reply-hd span{margin-left:-12px;color:#888;font-weight:400}.comment-item .info .reply .reply-hd i{color:#ff5a05;font-size:15.25px}.comment-item .info .reply .reply-content{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all}.comment-item .info .reply .reply-time{color:#888;font-size:9px}




    </style>
</head>
<body>
<div id="app">


    <div data-v-87ffcada="" class="article" id="watermark">
        <div data-v-87ffcada="" class="main main-app">
            <h1 data-v-87ffcada="" class="article-title pd">
                32è®²ä¸ºä»€ä¹ˆè¿˜æœ‰killä¸æ‰çš„è¯­å¥
            </h1>
            <div data-v-87ffcada="" class="article-content typo common-content pd"><img data-v-87ffcada=""
                                                                                        src="https://static001.geekbang.org/resource/image/89/6e/89d4a1530f2b4caa956f061ade4f746e.jpg">

                <div>
                    <audio controls="controls" height="100" width="100">
                        <source src="32è®²ä¸ºä»€ä¹ˆè¿˜æœ‰killä¸æ‰çš„è¯­å¥.mp3" type="audio/mp3" />
                        <embed height="100" width="100" src="32è®²ä¸ºä»€ä¹ˆè¿˜æœ‰killä¸æ‰çš„è¯­å¥.mp3" />
                    </audio>
                </div>
                <div data-v-87ffcada="" id="article-content" class="">
                    <div class="text">
                        <p>åœ¨MySQLä¸­æœ‰ä¸¤ä¸ªkillå‘½ä»¤ï¼šä¸€ä¸ªæ˜¯kill query +çº¿ç¨‹idï¼Œè¡¨ç¤ºç»ˆæ­¢è¿™ä¸ªçº¿ç¨‹ä¸­æ­£åœ¨æ‰§è¡Œçš„è¯­å¥ï¼›ä¸€ä¸ªæ˜¯kill connection +çº¿ç¨‹idï¼Œè¿™é‡Œconnectionå¯ç¼ºçœï¼Œè¡¨ç¤ºæ–­å¼€è¿™ä¸ªçº¿ç¨‹çš„è¿æ¥ï¼Œå½“ç„¶å¦‚æœè¿™ä¸ªçº¿ç¨‹æœ‰è¯­å¥æ­£åœ¨æ‰§è¡Œï¼Œä¹Ÿæ˜¯è¦å…ˆåœæ­¢æ­£åœ¨æ‰§è¡Œçš„è¯­å¥çš„ã€‚</p><p>ä¸çŸ¥é“ä½ åœ¨ä½¿ç”¨MySQLçš„æ—¶å€™ï¼Œæœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™æ ·çš„ç°è±¡ï¼šä½¿ç”¨äº†killå‘½ä»¤ï¼Œå´æ²¡èƒ½æ–­å¼€è¿™ä¸ªè¿æ¥ã€‚å†æ‰§è¡Œshow processlistå‘½ä»¤ï¼Œçœ‹åˆ°è¿™æ¡è¯­å¥çš„Commandåˆ—æ˜¾ç¤ºçš„æ˜¯Killedã€‚</p><p>ä½ ä¸€å®šä¼šå¥‡æ€ªï¼Œæ˜¾ç¤ºä¸ºKilledæ˜¯ä»€ä¹ˆæ„æ€ï¼Œä¸æ˜¯åº”è¯¥ç›´æ¥åœ¨show processlistçš„ç»“æœé‡Œçœ‹ä¸åˆ°è¿™ä¸ªçº¿ç¨‹äº†å—ï¼Ÿ</p><p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥è®¨è®ºä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚</p><p>å…¶å®å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œkill query/connectionå‘½ä»¤æ˜¯æœ‰æ•ˆçš„ã€‚æ¯”å¦‚ï¼Œæ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°æ‰§è¡Œæ—¶é—´å¤ªä¹…ï¼Œè¦æ”¾å¼ƒç»§ç»­æŸ¥è¯¢ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥ç”¨kill queryå‘½ä»¤ï¼Œç»ˆæ­¢è¿™æ¡æŸ¥è¯¢è¯­å¥ã€‚</p><p>è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯ï¼Œè¯­å¥å¤„äºé”ç­‰å¾…çš„æ—¶å€™ï¼Œç›´æ¥ä½¿ç”¨killå‘½ä»¤ä¹Ÿæ˜¯æœ‰æ•ˆçš„ã€‚æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸‹è¿™ä¸ªä¾‹å­ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/17/d0/17f88dc70c3fbe06a7738a0ac01db4d0.png" alt=""></p><center><span class="reference">å›¾1 kill query æˆåŠŸçš„ä¾‹å­</span></center><p>å¯ä»¥çœ‹åˆ°ï¼Œsession C æ‰§è¡Œkill queryä»¥åï¼Œsession Bå‡ ä¹åŒæ—¶å°±æç¤ºäº†è¯­å¥è¢«ä¸­æ–­ã€‚è¿™ï¼Œå°±æ˜¯æˆ‘ä»¬é¢„æœŸçš„ç»“æœã€‚</p><!-- [[[read_end]]] --><h1>æ”¶åˆ°killä»¥åï¼Œçº¿ç¨‹åšä»€ä¹ˆï¼Ÿ</h1><p>ä½†æ˜¯ï¼Œè¿™é‡Œä½ è¦åœä¸‹æ¥æƒ³ä¸€ä¸‹ï¼šsession Bæ˜¯ç›´æ¥ç»ˆæ­¢æ‰çº¿ç¨‹ï¼Œä»€ä¹ˆéƒ½ä¸ç®¡å°±ç›´æ¥é€€å‡ºå—ï¼Ÿæ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸è¡Œçš„ã€‚</p><p>æˆ‘åœ¨<a href="https://time.geekbang.org/column/article/69862">ç¬¬6ç¯‡æ–‡ç« </a>ä¸­è®²è¿‡ï¼Œå½“å¯¹ä¸€ä¸ªè¡¨åšå¢åˆ æ”¹æŸ¥æ“ä½œæ—¶ï¼Œä¼šåœ¨è¡¨ä¸ŠåŠ MDLè¯»é”ã€‚æ‰€ä»¥ï¼Œsession Bè™½ç„¶å¤„äºblockedçŠ¶æ€ï¼Œä½†è¿˜æ˜¯æ‹¿ç€ä¸€ä¸ªMDLè¯»é”çš„ã€‚å¦‚æœçº¿ç¨‹è¢«killçš„æ—¶å€™ï¼Œå°±ç›´æ¥ç»ˆæ­¢ï¼Œé‚£ä¹‹åè¿™ä¸ªMDLè¯»é”å°±æ²¡æœºä¼šè¢«é‡Šæ”¾äº†ã€‚</p><p>è¿™æ ·çœ‹æ¥ï¼Œkillå¹¶ä¸æ˜¯é©¬ä¸Šåœæ­¢çš„æ„æ€ï¼Œè€Œæ˜¯å‘Šè¯‰æ‰§è¡Œçº¿ç¨‹è¯´ï¼Œè¿™æ¡è¯­å¥å·²ç»ä¸éœ€è¦ç»§ç»­æ‰§è¡Œäº†ï¼Œå¯ä»¥å¼€å§‹â€œæ‰§è¡Œåœæ­¢çš„é€»è¾‘äº†â€ã€‚</p><blockquote>
<p>å…¶å®ï¼Œè¿™è·ŸLinuxçš„killå‘½ä»¤ç±»ä¼¼ï¼Œkill -N pidå¹¶ä¸æ˜¯è®©è¿›ç¨‹ç›´æ¥åœæ­¢ï¼Œè€Œæ˜¯ç»™è¿›ç¨‹å‘ä¸€ä¸ªä¿¡å·ï¼Œç„¶åè¿›ç¨‹å¤„ç†è¿™ä¸ªä¿¡å·ï¼Œè¿›å…¥ç»ˆæ­¢é€»è¾‘ã€‚åªæ˜¯å¯¹äºMySQLçš„killå‘½ä»¤æ¥è¯´ï¼Œä¸éœ€è¦ä¼ ä¿¡å·é‡å‚æ•°ï¼Œå°±åªæœ‰â€œåœæ­¢â€è¿™ä¸ªå‘½ä»¤ã€‚</p>
</blockquote><p><strong>å®ç°ä¸Šï¼Œå½“ç”¨æˆ·æ‰§è¡Œkill query thread_id_Bæ—¶ï¼ŒMySQLé‡Œå¤„ç†killå‘½ä»¤çš„çº¿ç¨‹åšäº†ä¸¤ä»¶äº‹ï¼š</strong></p><ol>
<li>
<p>æŠŠsession Bçš„è¿è¡ŒçŠ¶æ€æ”¹æˆTHD::KILL_QUERY(å°†å˜é‡killedèµ‹å€¼ä¸ºTHD::KILL_QUERY)ï¼›</p>
</li>
<li>
<p>ç»™session Bçš„æ‰§è¡Œçº¿ç¨‹å‘ä¸€ä¸ªä¿¡å·ã€‚</p>
</li>
</ol><p>ä¸ºä»€ä¹ˆè¦å‘ä¿¡å·å‘¢ï¼Ÿ</p><p>å› ä¸ºåƒå›¾1çš„æˆ‘ä»¬ä¾‹å­é‡Œé¢ï¼Œsession Bå¤„äºé”ç­‰å¾…çŠ¶æ€ï¼Œå¦‚æœåªæ˜¯æŠŠsession Bçš„çº¿ç¨‹çŠ¶æ€è®¾ç½®THD::KILL_QUERYï¼Œçº¿ç¨‹Bå¹¶ä¸çŸ¥é“è¿™ä¸ªçŠ¶æ€å˜åŒ–ï¼Œè¿˜æ˜¯ä¼šç»§ç»­ç­‰å¾…ã€‚å‘ä¸€ä¸ªä¿¡å·çš„ç›®çš„ï¼Œå°±æ˜¯è®©session Bé€€å‡ºç­‰å¾…ï¼Œæ¥å¤„ç†è¿™ä¸ªTHD::KILL_QUERYçŠ¶æ€ã€‚</p><p>ä¸Šé¢çš„åˆ†æä¸­ï¼Œéšå«äº†è¿™ä¹ˆä¸‰å±‚æ„æ€ï¼š</p><ol>
<li>
<p>ä¸€ä¸ªè¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­æœ‰å¤šå¤„â€œåŸ‹ç‚¹â€ï¼Œåœ¨è¿™äº›â€œåŸ‹ç‚¹â€çš„åœ°æ–¹åˆ¤æ–­çº¿ç¨‹çŠ¶æ€ï¼Œå¦‚æœå‘ç°çº¿ç¨‹çŠ¶æ€æ˜¯THD::KILL_QUERYï¼Œæ‰å¼€å§‹è¿›å…¥è¯­å¥ç»ˆæ­¢é€»è¾‘ï¼›</p>
</li>
<li>
<p>å¦‚æœå¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªå¯ä»¥è¢«å”¤é†’çš„ç­‰å¾…ï¼Œå¦åˆ™æ ¹æœ¬ä¸ä¼šæ‰§è¡Œåˆ°â€œåŸ‹ç‚¹â€å¤„ï¼›</p>
</li>
<li>
<p>è¯­å¥ä»å¼€å§‹è¿›å…¥ç»ˆæ­¢é€»è¾‘ï¼Œåˆ°ç»ˆæ­¢é€»è¾‘å®Œå…¨å®Œæˆï¼Œæ˜¯æœ‰ä¸€ä¸ªè¿‡ç¨‹çš„ã€‚</p>
</li>
</ol><p>åˆ°è¿™é‡Œä½ å°±çŸ¥é“äº†ï¼ŒåŸæ¥ä¸æ˜¯â€œè¯´åœå°±åœçš„â€ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬<strong>å†çœ‹ä¸€ä¸ªkillä¸æ‰çš„ä¾‹å­</strong>ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨å‰é¢<a href="https://time.geekbang.org/column/article/78134">ç¬¬29ç¯‡æ–‡ç« </a>ä¸­æåˆ°çš„ innodb_thread_concurrency ä¸å¤Ÿç”¨çš„ä¾‹å­ã€‚</p><p>é¦–å…ˆï¼Œæ‰§è¡Œset global innodb_thread_concurrency=2ï¼Œå°†InnoDBçš„å¹¶å‘çº¿ç¨‹ä¸Šé™æ•°è®¾ç½®ä¸º2ï¼›ç„¶åï¼Œæ‰§è¡Œä¸‹é¢çš„åºåˆ—ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/32/6e/32e4341409fabfe271db3dd4c4df696e.png" alt=""></p><center><span class="reference">å›¾2 kill query æ— æ•ˆçš„ä¾‹å­</span></center><p>å¯ä»¥çœ‹åˆ°ï¼š</p><ol>
<li>
<p>sesssion Cæ‰§è¡Œçš„æ—¶å€™è¢«å µä½äº†ï¼›</p>
</li>
<li>
<p>ä½†æ˜¯session Dæ‰§è¡Œçš„kill query Cå‘½ä»¤å´æ²¡ä»€ä¹ˆæ•ˆæœï¼Œ</p>
</li>
<li>
<p>ç›´åˆ°session Eæ‰§è¡Œäº†kill connectionå‘½ä»¤ï¼Œæ‰æ–­å¼€äº†session Cçš„è¿æ¥ï¼Œæç¤ºâ€œLost connection to MySQL server during queryâ€ï¼Œ</p>
</li>
<li>
<p>ä½†æ˜¯è¿™æ—¶å€™ï¼Œå¦‚æœåœ¨session Eä¸­æ‰§è¡Œshow processlistï¼Œä½ å°±èƒ½çœ‹åˆ°ä¸‹é¢è¿™ä¸ªå›¾ã€‚</p>
</li>
</ol><p><img src="https://static001.geekbang.org/resource/image/91/53/915c20e4c11b104d7bcf9d3457304c53.png" alt=""></p><center><span class="reference">å›¾3 kill connectionä¹‹åçš„æ•ˆæœ</span></center><p>è¿™æ—¶å€™ï¼Œid=12è¿™ä¸ªçº¿ç¨‹çš„Commnadåˆ—æ˜¾ç¤ºçš„æ˜¯Killedã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®¢æˆ·ç«¯è™½ç„¶æ–­å¼€äº†è¿æ¥ï¼Œä½†å®é™…ä¸ŠæœåŠ¡ç«¯ä¸Šè¿™æ¡è¯­å¥è¿˜åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ã€‚</p><p><strong>ä¸ºä»€ä¹ˆåœ¨æ‰§è¡Œkill queryå‘½ä»¤æ—¶ï¼Œè¿™æ¡è¯­å¥ä¸åƒç¬¬ä¸€ä¸ªä¾‹å­çš„updateè¯­å¥ä¸€æ ·é€€å‡ºå‘¢ï¼Ÿ</strong></p><p>åœ¨å®ç°ä¸Šï¼Œç­‰è¡Œé”æ—¶ï¼Œä½¿ç”¨çš„æ˜¯pthread_cond_timedwaitå‡½æ•°ï¼Œè¿™ä¸ªç­‰å¾…çŠ¶æ€å¯ä»¥è¢«å”¤é†’ã€‚ä½†æ˜¯ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œ12å·çº¿ç¨‹çš„ç­‰å¾…é€»è¾‘æ˜¯è¿™æ ·çš„ï¼šæ¯10æ¯«ç§’åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦å¯ä»¥è¿›å…¥InnoDBæ‰§è¡Œï¼Œå¦‚æœä¸è¡Œï¼Œå°±è°ƒç”¨nanosleepå‡½æ•°è¿›å…¥sleepçŠ¶æ€ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶12å·çº¿ç¨‹çš„çŠ¶æ€å·²ç»è¢«è®¾ç½®æˆäº†KILL_QUERYï¼Œä½†æ˜¯åœ¨è¿™ä¸ªç­‰å¾…è¿›å…¥InnoDBçš„å¾ªç¯è¿‡ç¨‹ä¸­ï¼Œå¹¶æ²¡æœ‰å»åˆ¤æ–­çº¿ç¨‹çš„çŠ¶æ€ï¼Œå› æ­¤æ ¹æœ¬ä¸ä¼šè¿›å…¥ç»ˆæ­¢é€»è¾‘é˜¶æ®µã€‚</p><p>è€Œå½“session Eæ‰§è¡Œkill connection å‘½ä»¤æ—¶ï¼Œæ˜¯è¿™ä¹ˆåšçš„ï¼Œ</p><ol>
<li>
<p>æŠŠ12å·çº¿ç¨‹çŠ¶æ€è®¾ç½®ä¸ºKILL_CONNECTIONï¼›</p>
</li>
<li>
<p>å…³æ‰12å·çº¿ç¨‹çš„ç½‘ç»œè¿æ¥ã€‚å› ä¸ºæœ‰è¿™ä¸ªæ“ä½œï¼Œæ‰€ä»¥ä½ ä¼šçœ‹åˆ°ï¼Œè¿™æ—¶å€™session Cæ”¶åˆ°äº†æ–­å¼€è¿æ¥çš„æç¤ºã€‚</p>
</li>
</ol><p>é‚£ä¸ºä»€ä¹ˆæ‰§è¡Œshow processlistçš„æ—¶å€™ï¼Œä¼šçœ‹åˆ°Commandåˆ—æ˜¾ç¤ºä¸ºkilledå‘¢ï¼Ÿå…¶å®ï¼Œè¿™å°±æ˜¯å› ä¸ºåœ¨æ‰§è¡Œshow processlistçš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªç‰¹åˆ«çš„é€»è¾‘ï¼š</p><pre><code>å¦‚æœä¸€ä¸ªçº¿ç¨‹çš„çŠ¶æ€æ˜¯KILL_CONNECTIONï¼Œå°±æŠŠCommandåˆ—æ˜¾ç¤ºæˆKilledã€‚
</code></pre><p>æ‰€ä»¥å…¶å®ï¼Œå³ä½¿æ˜¯å®¢æˆ·ç«¯é€€å‡ºäº†ï¼Œè¿™ä¸ªçº¿ç¨‹çš„çŠ¶æ€ä»ç„¶æ˜¯åœ¨ç­‰å¾…ä¸­ã€‚é‚£è¿™ä¸ªçº¿ç¨‹ä»€ä¹ˆæ—¶å€™ä¼šé€€å‡ºå‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ï¼Œåªæœ‰ç­‰åˆ°æ»¡è¶³è¿›å…¥InnoDBçš„æ¡ä»¶åï¼Œsession Cçš„æŸ¥è¯¢è¯­å¥ç»§ç»­æ‰§è¡Œï¼Œç„¶åæ‰æœ‰å¯èƒ½åˆ¤æ–­åˆ°çº¿ç¨‹çŠ¶æ€å·²ç»å˜æˆäº†KILL_QUERYæˆ–è€…KILL_CONNECTIONï¼Œå†è¿›å…¥ç»ˆæ­¢é€»è¾‘é˜¶æ®µã€‚</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ¥å°ç»“ä¸€ä¸‹ã€‚</p><p><strong>è¿™ä¸ªä¾‹å­æ˜¯killæ— æ•ˆçš„ç¬¬ä¸€ç±»æƒ…å†µï¼Œå³ï¼šçº¿ç¨‹æ²¡æœ‰æ‰§è¡Œåˆ°åˆ¤æ–­çº¿ç¨‹çŠ¶æ€çš„é€»è¾‘ã€‚</strong>è·Ÿè¿™ç§æƒ…å†µç›¸åŒçš„ï¼Œè¿˜æœ‰ç”±äºIOå‹åŠ›è¿‡å¤§ï¼Œè¯»å†™IOçš„å‡½æ•°ä¸€ç›´æ— æ³•è¿”å›ï¼Œå¯¼è‡´ä¸èƒ½åŠæ—¶åˆ¤æ–­çº¿ç¨‹çš„çŠ¶æ€ã€‚</p><p><strong>å¦ä¸€ç±»æƒ…å†µæ˜¯ï¼Œç»ˆæ­¢é€»è¾‘è€—æ—¶è¾ƒé•¿ã€‚</strong>è¿™æ—¶å€™ï¼Œä»show processlistç»“æœä¸Šçœ‹ä¹Ÿæ˜¯Command=Killedï¼Œéœ€è¦ç­‰åˆ°ç»ˆæ­¢é€»è¾‘å®Œæˆï¼Œè¯­å¥æ‰ç®—çœŸæ­£å®Œæˆã€‚è¿™ç±»æƒ…å†µï¼Œæ¯”è¾ƒå¸¸è§çš„åœºæ™¯æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ol>
<li>
<p>è¶…å¤§äº‹åŠ¡æ‰§è¡ŒæœŸé—´è¢«killã€‚è¿™æ—¶å€™ï¼Œå›æ»šæ“ä½œéœ€è¦å¯¹äº‹åŠ¡æ‰§è¡ŒæœŸé—´ç”Ÿæˆçš„æ‰€æœ‰æ–°æ•°æ®ç‰ˆæœ¬åšå›æ”¶æ“ä½œï¼Œè€—æ—¶å¾ˆé•¿ã€‚</p>
</li>
<li>
<p>å¤§æŸ¥è¯¢å›æ»šã€‚å¦‚æœæŸ¥è¯¢è¿‡ç¨‹ä¸­ç”Ÿæˆäº†æ¯”è¾ƒå¤§çš„ä¸´æ—¶æ–‡ä»¶ï¼ŒåŠ ä¸Šæ­¤æ—¶æ–‡ä»¶ç³»ç»Ÿå‹åŠ›å¤§ï¼Œåˆ é™¤ä¸´æ—¶æ–‡ä»¶å¯èƒ½éœ€è¦ç­‰å¾…IOèµ„æºï¼Œå¯¼è‡´è€—æ—¶è¾ƒé•¿ã€‚</p>
</li>
<li>
<p>DDLå‘½ä»¤æ‰§è¡Œåˆ°æœ€åé˜¶æ®µï¼Œå¦‚æœè¢«killï¼Œéœ€è¦åˆ é™¤ä¸­é—´è¿‡ç¨‹çš„ä¸´æ—¶æ–‡ä»¶ï¼Œä¹Ÿå¯èƒ½å—IOèµ„æºå½±å“è€—æ—¶è¾ƒä¹…ã€‚</p>
</li>
</ol><p>ä¹‹å‰æœ‰äººé—®è¿‡æˆ‘ï¼Œå¦‚æœç›´æ¥åœ¨å®¢æˆ·ç«¯é€šè¿‡Ctrl+Cå‘½ä»¤ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥ç›´æ¥ç»ˆæ­¢çº¿ç¨‹å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ï¼Œä¸å¯ä»¥ã€‚</p><p>è¿™é‡Œæœ‰ä¸€ä¸ªè¯¯è§£ï¼Œå…¶å®åœ¨å®¢æˆ·ç«¯çš„æ“ä½œåªèƒ½æ“ä½œåˆ°å®¢æˆ·ç«¯çš„çº¿ç¨‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åªèƒ½é€šè¿‡ç½‘ç»œäº¤äº’ï¼Œæ˜¯ä¸å¯èƒ½ç›´æ¥æ“ä½œæœåŠ¡ç«¯çº¿ç¨‹çš„ã€‚</p><p>è€Œç”±äºMySQLæ˜¯åœç­‰åè®®ï¼Œæ‰€ä»¥è¿™ä¸ªçº¿ç¨‹æ‰§è¡Œçš„è¯­å¥è¿˜æ²¡æœ‰è¿”å›çš„æ—¶å€™ï¼Œå†å¾€è¿™ä¸ªè¿æ¥é‡Œé¢ç»§ç»­å‘å‘½ä»¤ä¹Ÿæ˜¯æ²¡æœ‰ç”¨çš„ã€‚å®é™…ä¸Šï¼Œæ‰§è¡ŒCtrl+Cçš„æ—¶å€™ï¼Œæ˜¯MySQLå®¢æˆ·ç«¯å¦å¤–å¯åŠ¨ä¸€ä¸ªè¿æ¥ï¼Œç„¶åå‘é€ä¸€ä¸ªkill query å‘½ä»¤ã€‚</p><p>æ‰€ä»¥ï¼Œä½ å¯åˆ«ä»¥ä¸ºåœ¨å®¢æˆ·ç«¯æ‰§è¡Œå®ŒCtrl+Cå°±ä¸‡äº‹å¤§å‰äº†ã€‚å› ä¸ºï¼Œè¦killæ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œè¿˜æ¶‰åŠåˆ°åç«¯çš„å¾ˆå¤šæ“ä½œã€‚</p><h1>å¦å¤–ä¸¤ä¸ªå…³äºå®¢æˆ·ç«¯çš„è¯¯è§£</h1><p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä¹Ÿç»å¸¸ä¼šç¢°åˆ°ä¸€äº›åŒå­¦å¯¹å®¢æˆ·ç«¯çš„ä½¿ç”¨æœ‰è¯¯è§£ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥çœ‹çœ‹ä¸¤ä¸ªæœ€å¸¸è§çš„è¯¯è§£ã€‚</p><p><strong>ç¬¬ä¸€ä¸ªè¯¯è§£æ˜¯ï¼šå¦‚æœåº“é‡Œé¢çš„è¡¨ç‰¹åˆ«å¤šï¼Œè¿æ¥å°±ä¼šå¾ˆæ…¢ã€‚</strong></p><p>æœ‰äº›çº¿ä¸Šçš„åº“ï¼Œä¼šåŒ…å«å¾ˆå¤šè¡¨ï¼ˆæˆ‘è§è¿‡æœ€å¤šçš„ä¸€ä¸ªåº“é‡Œæœ‰6ä¸‡ä¸ªè¡¨ï¼‰ã€‚è¿™æ—¶å€™ï¼Œä½ å°±ä¼šå‘ç°ï¼Œæ¯æ¬¡ç”¨å®¢æˆ·ç«¯è¿æ¥éƒ½ä¼šå¡åœ¨ä¸‹é¢è¿™ä¸ªç•Œé¢ä¸Šã€‚</p><p><img src="https://static001.geekbang.org/resource/image/7e/83/7e4666bfd580505180c77447d1f44c83.png" alt=""></p><center><span class="reference">å›¾4 è¿æ¥ç­‰å¾…</span></center><p>è€Œå¦‚æœdb1è¿™ä¸ªåº“é‡Œè¡¨å¾ˆå°‘çš„è¯ï¼Œè¿æ¥èµ·æ¥å°±ä¼šå¾ˆå¿«ï¼Œå¯ä»¥å¾ˆå¿«è¿›å…¥è¾“å…¥å‘½ä»¤çš„çŠ¶æ€ã€‚å› æ­¤ï¼Œæœ‰åŒå­¦ä¼šè®¤ä¸ºæ˜¯è¡¨çš„æ•°ç›®å½±å“äº†è¿æ¥æ€§èƒ½ã€‚</p><p>ä»<a href="https://time.geekbang.org/column/article/68319">ç¬¬ä¸€ç¯‡æ–‡ç« </a>ä½ å°±çŸ¥é“ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯åœ¨å’ŒæœåŠ¡ç«¯å»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œéœ€è¦åšçš„äº‹æƒ…å°±æ˜¯TCPæ¡æ‰‹ã€ç”¨æˆ·æ ¡éªŒã€è·å–æƒé™ã€‚ä½†è¿™å‡ ä¸ªæ“ä½œï¼Œæ˜¾ç„¶è·Ÿåº“é‡Œé¢è¡¨çš„ä¸ªæ•°æ— å…³ã€‚</p><p>ä½†å®é™…ä¸Šï¼Œæ­£å¦‚å›¾ä¸­çš„æ–‡å­—æç¤ºæ‰€è¯´çš„ï¼Œå½“ä½¿ç”¨é»˜è®¤å‚æ•°è¿æ¥çš„æ—¶å€™ï¼ŒMySQLå®¢æˆ·ç«¯ä¼šæä¾›ä¸€ä¸ªæœ¬åœ°åº“åå’Œè¡¨åè¡¥å…¨çš„åŠŸèƒ½ã€‚ä¸ºäº†å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥æˆåŠŸåï¼Œéœ€è¦å¤šåšä¸€äº›æ“ä½œï¼š</p><ol>
<li>
<p>æ‰§è¡Œshow databasesï¼›</p>
</li>
<li>
<p>åˆ‡åˆ°db1åº“ï¼Œæ‰§è¡Œshow tablesï¼›</p>
</li>
<li>
<p>æŠŠè¿™ä¸¤ä¸ªå‘½ä»¤çš„ç»“æœç”¨äºæ„å»ºä¸€ä¸ªæœ¬åœ°çš„å“ˆå¸Œè¡¨ã€‚</p>
</li>
</ol><p>åœ¨è¿™äº›æ“ä½œä¸­ï¼Œæœ€èŠ±æ—¶é—´çš„å°±æ˜¯ç¬¬ä¸‰æ­¥åœ¨æœ¬åœ°æ„å»ºå“ˆå¸Œè¡¨çš„æ“ä½œã€‚æ‰€ä»¥ï¼Œå½“ä¸€ä¸ªåº“ä¸­çš„è¡¨ä¸ªæ•°éå¸¸å¤šçš„æ—¶å€™ï¼Œè¿™ä¸€æ­¥å°±ä¼šèŠ±æ¯”è¾ƒé•¿çš„æ—¶é—´ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>æˆ‘ä»¬æ„ŸçŸ¥åˆ°çš„è¿æ¥è¿‡ç¨‹æ…¢ï¼Œå…¶å®å¹¶ä¸æ˜¯è¿æ¥æ…¢ï¼Œä¹Ÿä¸æ˜¯æœåŠ¡ç«¯æ…¢ï¼Œè€Œæ˜¯å®¢æˆ·ç«¯æ…¢ã€‚</strong></p><p>å›¾ä¸­çš„æç¤ºä¹Ÿè¯´äº†ï¼Œå¦‚æœåœ¨è¿æ¥å‘½ä»¤ä¸­åŠ ä¸Š-Aï¼Œå°±å¯ä»¥å…³æ‰è¿™ä¸ªè‡ªåŠ¨è¡¥å…¨çš„åŠŸèƒ½ï¼Œç„¶åå®¢æˆ·ç«¯å°±å¯ä»¥å¿«é€Ÿè¿”å›äº†ã€‚</p><p>è¿™é‡Œè‡ªåŠ¨è¡¥å…¨çš„æ•ˆæœå°±æ˜¯ï¼Œä½ åœ¨è¾“å…¥åº“åæˆ–è€…è¡¨åçš„æ—¶å€™ï¼Œè¾“å…¥å‰ç¼€ï¼Œå¯ä»¥ä½¿ç”¨Tabé”®è‡ªåŠ¨è¡¥å…¨è¡¨åæˆ–è€…æ˜¾ç¤ºæç¤ºã€‚</p><p>å®é™…ä½¿ç”¨ä¸­ï¼Œå¦‚æœä½ è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ç”¨å¾—å¹¶ä¸å¤šï¼Œæˆ‘å»ºè®®ä½ æ¯æ¬¡ä½¿ç”¨çš„æ—¶å€™éƒ½é»˜è®¤åŠ -Aã€‚</p><p>å…¶å®æç¤ºé‡Œé¢æ²¡æœ‰è¯´ï¼Œé™¤äº†åŠ -Aä»¥å¤–ï¼ŒåŠ â€“quick(æˆ–è€…ç®€å†™ä¸º-q)å‚æ•°ï¼Œä¹Ÿå¯ä»¥è·³è¿‡è¿™ä¸ªé˜¶æ®µã€‚ä½†æ˜¯ï¼Œè¿™ä¸ª<strong>â€“quickæ˜¯ä¸€ä¸ªæ›´å®¹æ˜“å¼•èµ·è¯¯ä¼šçš„å‚æ•°ï¼Œä¹Ÿæ˜¯å…³äºå®¢æˆ·ç«¯å¸¸è§çš„ä¸€ä¸ªè¯¯è§£ã€‚</strong></p><p>ä½ çœ‹åˆ°è¿™ä¸ªå‚æ•°ï¼Œæ˜¯ä¸æ˜¯è§‰å¾—è¿™åº”è¯¥æ˜¯ä¸€ä¸ªè®©æœåŠ¡ç«¯åŠ é€Ÿçš„å‚æ•°ï¼Ÿä½†å®é™…ä¸Šæ°æ°ç›¸åï¼Œè®¾ç½®äº†è¿™ä¸ªå‚æ•°å¯èƒ½ä¼šé™ä½æœåŠ¡ç«¯çš„æ€§èƒ½ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿ</p><p>MySQLå®¢æˆ·ç«¯å‘é€è¯·æ±‚åï¼Œæ¥æ”¶æœåŠ¡ç«¯è¿”å›ç»“æœçš„æ–¹å¼æœ‰ä¸¤ç§ï¼š</p><ol>
<li>
<p>ä¸€ç§æ˜¯æœ¬åœ°ç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯åœ¨æœ¬åœ°å¼€ä¸€ç‰‡å†…å­˜ï¼Œå…ˆæŠŠç»“æœå­˜èµ·æ¥ã€‚å¦‚æœä½ ç”¨APIå¼€å‘ï¼Œå¯¹åº”çš„å°±æ˜¯mysql_store_result æ–¹æ³•ã€‚</p>
</li>
<li>
<p>å¦ä¸€ç§æ˜¯ä¸ç¼“å­˜ï¼Œè¯»ä¸€ä¸ªå¤„ç†ä¸€ä¸ªã€‚å¦‚æœä½ ç”¨APIå¼€å‘ï¼Œå¯¹åº”çš„å°±æ˜¯mysql_use_resultæ–¹æ³•ã€‚</p>
</li>
</ol><p>MySQLå®¢æˆ·ç«¯é»˜è®¤é‡‡ç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼Œè€Œå¦‚æœåŠ ä¸Šâ€“quickå‚æ•°ï¼Œå°±ä¼šä½¿ç”¨ç¬¬äºŒç§ä¸ç¼“å­˜çš„æ–¹å¼ã€‚</p><p>é‡‡ç”¨ä¸ç¼“å­˜çš„æ–¹å¼æ—¶ï¼Œå¦‚æœæœ¬åœ°å¤„ç†å¾—æ…¢ï¼Œå°±ä¼šå¯¼è‡´æœåŠ¡ç«¯å‘é€ç»“æœè¢«é˜»å¡ï¼Œå› æ­¤ä¼šè®©æœåŠ¡ç«¯å˜æ…¢ã€‚å…³äºæœåŠ¡ç«¯çš„å…·ä½“è¡Œä¸ºï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« å†å’Œä½ å±•å¼€è¯´æ˜ã€‚</p><p>é‚£ä½ ä¼šè¯´ï¼Œæ—¢ç„¶è¿™æ ·ï¼Œä¸ºä»€ä¹ˆè¦ç»™è¿™ä¸ªå‚æ•°å–åå«ä½œquickå‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºä½¿ç”¨è¿™ä¸ªå‚æ•°å¯ä»¥è¾¾åˆ°ä»¥ä¸‹ä¸‰ç‚¹æ•ˆæœï¼š</p><ul>
<li>ç¬¬ä¸€ç‚¹ï¼Œå°±æ˜¯å‰é¢æåˆ°çš„ï¼Œè·³è¿‡è¡¨åè‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ã€‚</li>
<li>ç¬¬äºŒç‚¹ï¼Œmysql_store_resultéœ€è¦ç”³è¯·æœ¬åœ°å†…å­˜æ¥ç¼“å­˜æŸ¥è¯¢ç»“æœï¼Œå¦‚æœæŸ¥è¯¢ç»“æœå¤ªå¤§ï¼Œä¼šè€—è´¹è¾ƒå¤šçš„æœ¬åœ°å†…å­˜ï¼Œå¯èƒ½ä¼šå½±å“å®¢æˆ·ç«¯æœ¬åœ°æœºå™¨çš„æ€§èƒ½ï¼›</li>
<li>ç¬¬ä¸‰ç‚¹ï¼Œæ˜¯ä¸ä¼šæŠŠæ‰§è¡Œå‘½ä»¤è®°å½•åˆ°æœ¬åœ°çš„å‘½ä»¤å†å²æ–‡ä»¶ã€‚</li>
</ul><p>æ‰€ä»¥ä½ çœ‹åˆ°äº†ï¼Œâ€“quickå‚æ•°çš„æ„æ€ï¼Œæ˜¯è®©å®¢æˆ·ç«¯å˜å¾—æ›´å¿«ã€‚</p><h1>å°ç»“</h1><p>åœ¨ä»Šå¤©è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘é¦–å…ˆå’Œä½ ä»‹ç»äº†MySQLä¸­ï¼Œæœ‰äº›è¯­å¥å’Œè¿æ¥â€œkillä¸æ‰â€çš„æƒ…å†µã€‚</p><p>è¿™äº›â€œkillä¸æ‰â€çš„æƒ…å†µï¼Œå…¶å®æ˜¯å› ä¸ºå‘é€killå‘½ä»¤çš„å®¢æˆ·ç«¯ï¼Œå¹¶æ²¡æœ‰å¼ºè¡Œåœæ­¢ç›®æ ‡çº¿ç¨‹çš„æ‰§è¡Œï¼Œè€Œåªæ˜¯è®¾ç½®äº†ä¸ªçŠ¶æ€ï¼Œå¹¶å”¤é†’å¯¹åº”çš„çº¿ç¨‹ã€‚è€Œè¢«killçš„çº¿ç¨‹ï¼Œéœ€è¦æ‰§è¡Œåˆ°åˆ¤æ–­çŠ¶æ€çš„â€œåŸ‹ç‚¹â€ï¼Œæ‰ä¼šå¼€å§‹è¿›å…¥ç»ˆæ­¢é€»è¾‘é˜¶æ®µã€‚å¹¶ä¸”ï¼Œç»ˆæ­¢é€»è¾‘æœ¬èº«ä¹Ÿæ˜¯éœ€è¦è€—è´¹æ—¶é—´çš„ã€‚</p><p>æ‰€ä»¥ï¼Œå¦‚æœä½ å‘ç°ä¸€ä¸ªçº¿ç¨‹å¤„äºKilledçŠ¶æ€ï¼Œä½ å¯ä»¥åšçš„äº‹æƒ…å°±æ˜¯ï¼Œé€šè¿‡å½±å“ç³»ç»Ÿç¯å¢ƒï¼Œè®©è¿™ä¸ªKilledçŠ¶æ€å°½å¿«ç»“æŸã€‚</p><p>æ¯”å¦‚ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€ä¸ªä¾‹å­é‡ŒInnoDBå¹¶å‘åº¦çš„é—®é¢˜ï¼Œä½ å°±å¯ä»¥ä¸´æ—¶è°ƒå¤§innodb_thread_concurrencyçš„å€¼ï¼Œæˆ–è€…åœæ‰åˆ«çš„çº¿ç¨‹ï¼Œè®©å‡ºä½å­ç»™è¿™ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚</p><p>è€Œå¦‚æœæ˜¯å›æ»šé€»è¾‘ç”±äºå—åˆ°IOèµ„æºé™åˆ¶æ‰§è¡Œå¾—æ¯”è¾ƒæ…¢ï¼Œå°±é€šè¿‡å‡å°‘ç³»ç»Ÿå‹åŠ›è®©å®ƒåŠ é€Ÿã€‚</p><p>åšå®Œè¿™äº›æ“ä½œåï¼Œå…¶å®ä½ å·²ç»æ²¡æœ‰åŠæ³•å†å¯¹å®ƒåšä»€ä¹ˆäº†ï¼Œåªèƒ½ç­‰å¾…æµç¨‹è‡ªå·±å®Œæˆã€‚</p><p>æœ€åï¼Œæˆ‘ç»™ä½ ç•™ä¸‹ä¸€ä¸ªæ€è€ƒé¢˜å§ã€‚</p><p>å¦‚æœä½ ç¢°åˆ°ä¸€ä¸ªè¢«killedçš„äº‹åŠ¡ä¸€ç›´å¤„äºå›æ»šçŠ¶æ€ï¼Œä½ è®¤ä¸ºæ˜¯åº”è¯¥ç›´æ¥æŠŠMySQLè¿›ç¨‹å¼ºè¡Œé‡å¯ï¼Œè¿˜æ˜¯åº”è¯¥è®©å®ƒè‡ªå·±æ‰§è¡Œå®Œæˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ä½ å¯ä»¥æŠŠä½ çš„ç»“è®ºå’Œåˆ†æå†™åœ¨ç•™è¨€åŒºï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« çš„æœ«å°¾å’Œä½ è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><h1>ä¸ŠæœŸé—®é¢˜æ—¶é—´</h1><p>æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« æœ«å°¾ï¼Œç»™ä½ ç•™ä¸‹çš„é—®é¢˜æ˜¯ï¼Œå¸Œæœ›ä½ åˆ†äº«ä¸€ä¸‹è¯¯åˆ æ•°æ®çš„å¤„ç†ç»éªŒã€‚</p><p><strong>@è‹èŒ« åŒå­¦æåˆ°äº†ä¸€ä¸ªä¾‹å­</strong>ï¼Œæˆ‘è§‰å¾—å€¼å¾—è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹ã€‚è¿ç»´çš„åŒå­¦ç›´æ¥æ‹·è´æ–‡æœ¬å»æ‰§è¡Œï¼ŒSQLè¯­å¥æˆªæ–­ï¼Œå¯¼è‡´æ•°æ®åº“æ‰§è¡Œå‡ºé”™ã€‚</p><p>ä»æµè§ˆå™¨æ‹·è´æ–‡æœ¬æ‰§è¡Œï¼Œæ˜¯ä¸€ä¸ªéå¸¸ä¸è§„èŒƒçš„æ“ä½œã€‚é™¤äº†è¿™ä¸ªä¾‹å­é‡Œé¢è¯´çš„SQLè¯­å¥æˆªæ–­é—®é¢˜ï¼Œè¿˜å¯èƒ½å­˜åœ¨ä¹±ç é—®é¢˜ã€‚</p><p>ä¸€èˆ¬è¿™ç§æ“ä½œï¼Œå¦‚æœè„šæœ¬çš„å¼€å‘å’Œæ‰§è¡Œä¸æ˜¯åŒä¸€ä¸ªäººï¼Œéœ€è¦å¼€å‘åŒå­¦æŠŠè„šæœ¬æ”¾åˆ°gitä¸Šï¼Œç„¶åæŠŠgitåœ°å€ï¼Œä»¥åŠæ–‡ä»¶çš„md5å‘ç»™è¿ç»´åŒå­¦ã€‚</p><p>è¿™æ ·å°±è¦æ±‚è¿ç»´åŒå­¦åœ¨æ‰§è¡Œå‘½ä»¤ä¹‹å‰ï¼Œç¡®è®¤è¦æ‰§è¡Œçš„æ–‡ä»¶çš„md5ï¼Œè·Ÿä¹‹å‰å¼€å‘åŒå­¦æä¾›çš„md5ç›¸åŒæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚</p><p>å¦å¤–ï¼Œæˆ‘è¦ç‰¹åˆ«ç‚¹èµä¸€ä¸‹@è‹èŒ« åŒå­¦å¤ç°é—®é¢˜çš„æ€è·¯å’Œè¿½æŸ¥é—®é¢˜çš„æ€åº¦ã€‚</p><p><strong>@linhui0705 åŒå­¦æåˆ°çš„â€œå››ä¸ªè„šæœ¬â€çš„æ–¹æ³•ï¼Œæˆ‘éå¸¸æ¨å´‡</strong>ã€‚è¿™å››ä¸ªè„šæœ¬åˆ†åˆ«æ˜¯ï¼šå¤‡ä»½è„šæœ¬ã€æ‰§è¡Œè„šæœ¬ã€éªŒè¯è„šæœ¬å’Œå›æ»šè„šæœ¬ã€‚å¦‚æœèƒ½å¤ŸåšæŒåšåˆ°ï¼Œå³ä½¿å‡ºç°é—®é¢˜ï¼Œä¹Ÿæ˜¯å¯ä»¥å¾ˆå¿«æ¢å¤çš„ï¼Œä¸€å®šèƒ½é™ä½å‡ºç°æ•…éšœçš„æ¦‚ç‡ã€‚</p><p>ä¸è¿‡ï¼Œè¿™ä¸ªæ–¹æ¡ˆæœ€å¤§çš„æ•Œäººæ˜¯è¿™æ ·çš„æ€æƒ³ï¼šè¿™æ˜¯ä¸ªå°æ“ä½œï¼Œä¸éœ€è¦è¿™ä¹ˆä¸¥æ ¼ã€‚</p><p><strong>@KnightÂ²ÂºÂ¹â¸ ç»™äº†ä¸€ä¸ªä¿æŠ¤æ–‡ä»¶çš„æ–¹æ³•</strong>ï¼Œæˆ‘ä¹‹å‰æ²¡æœ‰ç”¨è¿‡è¿™ç§æ–¹æ³•ï¼Œä¸è¿‡è¿™ç¡®å®æ˜¯ä¸€ä¸ªä¸é”™çš„æ€è·¯ã€‚</p><p>ä¸ºäº†æ•°æ®å®‰å…¨å’ŒæœåŠ¡ç¨³å®šï¼Œå¤šåšç‚¹é¢„é˜²æ–¹æ¡ˆçš„è®¾è®¡è®¨è®ºï¼Œæ€»å¥½è¿‡æ•…éšœå¤„ç†å’Œäº‹åå¤ç›˜ã€‚æ–¹æ¡ˆè®¾è®¡è®¨è®ºä¼šå’Œæ•…éšœå¤ç›˜ä¼šï¼Œè¿™ä¸¤ç§ä¼šè®®çš„ä¼šè®®å®¤æ°”æ°›å®Œå…¨ä¸ä¸€æ ·ã€‚ç»å†è¿‡çš„åŒå­¦ä¸€å®šæ‡‚çš„ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/09/77/09c1073f99cf71d2fb162a716b5fa577.jpg" alt=""></p>
                    </div>
                </div>

            </div>
            <div data-v-87ffcada="" class="article-comments pd"><h2 data-v-87ffcada=""><span
                    data-v-87ffcada="">ç²¾é€‰ç•™è¨€</span></h2>
                <ul data-v-87ffcada="">
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJCscgdVibmoPyRLRaicvk6rjTJxePZ6VFHvGjUQvtfhCS6kO4OZ1AVibbhNGKlWZmpEFf2yA6ptsqHw/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¤¹å¿ƒé¢åŒ…</span>
                            </div>
                            <div class="bd">å¯¹äºç»“å°¾çš„é—®é¢˜,æˆ‘è§‰å¾—è‚¯å®šæ˜¯ç­‰å¾…,å³ä¾¿æ˜¯mysqlé‡å¯,ä¹Ÿæ˜¯éœ€è¦å¯¹æœªæäº¤çš„äº‹åŠ¡è¿›è¡Œå›æ»šæ“ä½œçš„,ä¿è¯æ•°æ®åº“çš„ä¸€è‡´æ€§ <br></div>
                            <span class="time">2019-01-25 10:14</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Mr.sylar</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸‹è¿™äº›åŸç†çš„&quot;æ¸”&quot;çš„æ–¹æ³•é™¤äº†çœ‹æºç ï¼Œè¿˜æœ‰åˆ«çš„å»ºè®®å— <br></div>
                            <span class="time">2019-01-25 15:04</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ä¸åŒçš„çŸ¥è¯†ç‚¹ä¸å¤ªä¸€æ ·å“ˆï¼Œ<br>æœ‰äº›å¯ä»¥çœ‹æ–‡æ¡£ï¼›<br>æœ‰äº›å¯ä»¥è‡ªå·±éªŒè¯ï¼›<br>è¿˜æœ‰å°±æ˜¯çœ‹å…¶ä»–äººæ–‡ç« ï¼ŒåŠ éªŒè¯ï¼›ï¼ˆå°±æ˜¯æˆ‘ä»¬è¿™ä¸ªä¸“æ çš„æ–¹æ³•^_^ï¼‰<br></p>
                                <p class="reply-time">2019-01-25 15:42</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/40/5e/b8fada94.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Ryoma</span>
                            </div>
                            <div class="bd">æƒ³å¾—ç®€å•ç‚¹ï¼šæ—¢ç„¶äº‹åŠ¡å¤„äºå›æ»šçŠ¶æ€äº†ï¼Œé‡å¯MySQLè¿™éƒ¨åˆ†äº‹åŠ¡è¿˜æ˜¯éœ€è¦å›æ»šã€‚ç§ä»¥ä¸ºè®©å®ƒæ‰§è¡Œå®Œæˆæ¯”è¾ƒå¥½ã€‚  <br></div>
                            <span class="time">2019-01-25 09:46</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/ea/9a/02d589f9.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ–œé¢é•œå­ Bill</span>
                            </div>
                            <div class="bd">â€œé‡‡ç”¨ä¸ç¼“å­˜çš„æ–¹å¼æ—¶ï¼Œå¦‚æœæœ¬åœ°å¤„ç†å¾—æ…¢ï¼Œå°±ä¼šå¯¼è‡´æœåŠ¡ç«¯å‘é€ç»“æœè¢«é˜»å¡ï¼Œå› æ­¤ä¼šè®©æœåŠ¡ç«¯å˜æ…¢â€ è¿™ä¸ªæ€ä¹ˆç†è§£ï¼Ÿ <br></div>
                            <span class="time">2019-01-28 18:08</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å µä½äº†ä¸å°±å˜æ…¢äº†ğŸ˜†</p>
                                <p class="reply-time">2019-01-28 21:35</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">700</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæ‚¨å¥½ã€‚å®¢æˆ·ç«¯ç‰ˆæœ¬å¦‚ä¸‹ï¼š<br>mysql  Ver 14.14 Distrib 5.7.24, for linux-glibc2.12 (x86_64) using  EditLine wrapper<br><br>è€å¸ˆï¼Œå†è¯·æ•™å¦ä¸€ä¸ªé—®é¢˜ã€‚å¹¶éæ‰€æœ‰çš„ DDL æ“ä½œéƒ½å¯ä»¥é€šè¿‡ä¸»ä»åˆ‡æ¢æ¥å®ç°å§ï¼Ÿä¸é€‚ç”¨çš„åœºæ™¯æœ‰å“ªäº›å‘¢ï¼Ÿ <br></div>
                            <span class="time">2019-01-27 22:24</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å¯¹ï¼Œå…¶å®åªæœ‰ æ”¹ç´¢å¼•ã€ åŠ æœ€åä¸€åˆ—ã€åˆ æœ€åä¸€åˆ—<br>å…¶ä»–çš„å¤§å¤šæ•°ä¸è¡Œï¼Œæ¯”å¦‚åˆ é™¤ä¸­é—´ä¸€åˆ—è¿™ç§</p>
                                <p class="reply-time">2019-01-28 01:03</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/d3/9f/36ea3be4.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">åƒå¹´å­¤ç‹¬</span>
                            </div>
                            <div class="bd">å¯èƒ½ä¸æ˜¯æœ¬ç« è®¨è®ºçš„é—®é¢˜ï¼Œæˆ‘æƒ³è¯·é—®è€å¸ˆâ€œMySQLä½¿ç”¨è‡ªå¢IDå’ŒUUIDä½œä¸ºä¸»é”®çš„ä¼˜åŠ£â€ï¼ŒåŸºäºä»€ä¹ˆæ ·çš„ä¸šåŠ¡åœºæ™¯ç”¨å“ªç§å¥½? <br></div>
                            <span class="time">2019-01-27 18:34</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">åé¢ä¼šæœ‰æ–‡ç« ä¼šæåˆ°è¿™ä¸ªé—®é¢˜å“ˆï¼šï¼‰</p>
                                <p class="reply-time">2019-01-27 20:58</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJWjvLFWEzQkszn8nicSaaYFdmE4ribeIicSGu7rfquG3EeuqJYbpHrtThKKDVfDGIib7SE7FBbfuoYDQ/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Geek_a67865</span>
                            </div>
                            <div class="bd">è€å¸ˆå¥½ï¼Œæˆ‘çŒœå‘æ¡æ©™å­çš„é—®é¢˜ å› ä¸ºå¾ˆå¤šæ—¥å¿—ç›‘æ§ä¼šç»Ÿè®¡erroræ—¥å¿—ï¼Œè¿™æ ·å¹¶ä¸å¾ˆä¼˜é›…ï¼Œè§‰å¾—ä»–æ˜¯æƒ³æœ‰ä»€ä¹ˆåŠæ³•è§„é¿è¿™ç§å¹¶å‘å¼•èµ·çš„é—®é¢˜ï¼Œ <br></div>
                            <span class="time">2019-01-26 15:14</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å—¯å—¯ ä¸è¿‡æˆ‘ä¹Ÿç¡®å®æ²¡æœ‰æƒ³åˆ°æ›´å¥½çš„æ–¹æ³•<br>æ¯•ç«Ÿä¸¤ä¸ªçº¿ç¨‹è¦åŒæ—¶å‘èµ·ä¸€ä¸ªinsertæ“ä½œï¼Œè¿™ä¸ªæœåŠ¡ç«¯ä¹Ÿæ‹¦ä¸ä½å‘€ğŸ˜†<br></p>
                                <p class="reply-time">2019-01-26 23:09</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/16/31/ae8adf82.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è·¯è¿‡</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œkillè¯­æ³•æ˜¯ï¼š<br>KILL [CONNECTION | QUERY] processlist_id<br>processlist_idæ˜¯conn_idï¼Œä¸æ˜¯thd_id.é€šè¿‡å¯¹æ¯”sys.processlistè¡¨ä¸­çš„ä¿¡æ¯å°±å¯ä»¥çŸ¥é“äº†ã€‚<br>é€šè¿‡æŸ¥è¯¢å®˜æ–¹æ–‡æ¡£ä¹Ÿè¯´æ˜äº†ï¼š<br>thd_idï¼šThe thread ID.<br>conn_idï¼šThe connection ID.<br>æ‰€ä»¥ï¼Œè¿™ç¯‡æ–‡ç« å¼€å¤´çš„ï¼š<br>åœ¨ MySQL ä¸­æœ‰ä¸¤ä¸ª kill å‘½ä»¤ï¼šä¸€ä¸ªæ˜¯ kill query + çº¿ç¨‹ id<br>æ„Ÿè§‰æœ‰ç‚¹ä¸å¯¹ã€‚è¯·è€å¸ˆæŒ‡æ­£ã€‚è°¢è°¢ï¼ <br></div>
                            <span class="time">2019-01-26 14:08</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¿™ä¸¤ä¸ªæ˜¯ä¸€æ ·çš„å§ï¼Ÿ<br>éƒ½æ˜¯å¯¹åº”show processlistè¿™ä¸ªå‘½ä»¤ç»“æœé‡Œçš„ç¬¬ä¸€åˆ—</p>
                                <p class="reply-time">2019-01-26 23:15</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/11/18/8cee35f9.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">HuaMax</span>
                            </div>
                            <div class="bd">è¯¾åé¢˜ã€‚æˆ‘è®¤ä¸ºéœ€è¦çœ‹å½“æ—¶çš„ä¸šåŠ¡åœºæ™¯ã€‚é‡å¯ä¼šå¯¼è‡´å…¶ä»–çš„è¿æ¥ä¹Ÿæ–­å¼€ï¼Œè¿”å›ç»™å…¶ä»–ä¸šåŠ¡è¿æ¥ä¸¢å¤±çš„é”™è¯¯ã€‚å¦‚æœæœ‰å¾ˆå¤šäº‹åŠ¡åœ¨ç­‰å¾…è¯¥äº‹åŠ¡çš„é”ï¼Œåˆ™åº”è¯¥é‡å¯ï¼Œè®©å…¶ä»–äº‹åŠ¡å¿«é€Ÿé‡è¯•è·å–é”ã€‚å¦å¤–å¦‚æœæ˜¯RRçš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œé•¿äº‹åŠ¡ä¼šå› ä¸ºæ•°æ®å¯è§æ€§çš„é—®é¢˜ï¼Œå¯¹äºå¤šç‰ˆæœ¬çš„æ•°æ®éœ€è¦æ‰¾åˆ°æ­£ç¡®çš„ç‰ˆæœ¬ï¼Œå¯¹è¯»æ€§èƒ½æ˜¯ä¸æ˜¯ä¹Ÿä¼šæœ‰å½±å“ï¼Œè¿™æ—¶å€™é‡å¯ä¹Ÿæ›´å¥½ã€‚ä¸ªäººç†è§£ï¼Œè¯·è€å¸ˆæŒ‡æ­£ã€‚ <br></div>
                            <span class="time">2019-01-26 12:21</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æœ‰è€ƒè™‘åˆ°å¯¹å…¶ä»–çº¿ç¨‹çš„å½±å“ï¼Œè¿™ä¸ªğŸ‘<br><br>å…¶å®è¿™ç§æ—¶å€™å¾€å¾€æ˜¯è¦å…ˆè€ƒè™‘åˆ‡æ¢ï¼ˆå½“ç„¶é‡å¯ä¹Ÿæ˜¯åˆ‡æ¢çš„ï¼‰<br>å¦‚æœåªçœ‹æ¢å¤æ—¶é—´çš„è¯ï¼Œç­‰å¾…ä¼šæ›´å¿« <br></p>
                                <p class="reply-time">2019-01-26 14:26</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJWjvLFWEzQkszn8nicSaaYFdmE4ribeIicSGu7rfquG3EeuqJYbpHrtThKKDVfDGIib7SE7FBbfuoYDQ/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Geek_a67865</span>
                            </div>
                            <div class="bd">ä¹Ÿé‡åˆ°@å‘æ¡æ©™å­ä¸€æ ·çš„é—®é¢˜ï¼Œä¾‹å¦‚é˜Ÿåˆ—ä¸¤ä¸ªæ¶ˆæ¯åŒæ—¶æŸ¥è¯¢åº“å­˜ï¼Œå‘ç°éƒ½ä¸å­˜åœ¨ï¼Œç„¶åå°±éƒ½æ‰§è¡Œæ’å…¥è¯­å¥ï¼Œä¸€æ¡æˆåŠŸï¼Œä¸€æ¡æŠ¥å”¯ä¸€ç´¢å¼•å¼‚å¸¸ï¼Œè¿™æ ·ç¨‹åºæ—¥å¿—ä¼šä¸€ç›´æ˜¾ç¤ºä¸€ä¸ªå”¯ä¸€ç´¢å¼•æŠ¥é”™ï¼Œç„¶åé‡è¯•æ‰§è¡Œæ›´æ–°ï¼Œæˆ‘æš‚æ—¶æ˜¯å¼ºåˆ¶æŸ¥ä¸»åº“ <br></div>
                            <span class="time">2019-01-26 09:46</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">â€œæˆ‘æš‚æ—¶æ˜¯å¼ºåˆ¶æŸ¥ä¸»åº“â€ ä»è¿™å°±çœ‹ä½ æ˜¯å› ä¸ºè¯»æ˜¯è¯»çš„å¤‡åº“ï¼Œæ‰å‡ºç°è¿™ä¸ªé—®é¢˜çš„æ˜¯å§ã€‚<br><br>å‘æ¡æ©™å­çš„é—®é¢˜æ˜¯ï¼Œä»–éƒ½æ˜¯æ“ä½œä¸»åº“ã€‚<br><br>å…¶å®å¦‚æœç´¢å¼•æœ‰å”¯ä¸€é”®ï¼Œå°±ç›´æ¥ä¸Šinsertã€‚<br>ç„¶åç¢°åˆ°è¿åå”¯ä¸€é”®çº¦æŸå°±æŠ¥é”™ï¼Œè¿™ä¸ªåº”è¯¥å°±æ˜¯å”¯ä¸€é”®çº¦æŸæ­£å¸¸çš„ç”¨æ³•å§ğŸ˜†</p>
                                <p class="reply-time">2019-01-26 14:28</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/69/de/5e637b01.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">gaohueric</span>
                            </div>
                            <div class="bd">è€å¸ˆæ‚¨å¥½ï¼Œä¸€ä¸ªè¡¨ä¸­ 1ä¸ªä¸»é”®ï¼Œ2ä¸ªå”¯ä¸€ç´¢å¼•ï¼Œ1ä¸ªæ™®é€šç´¢å¼• 4ä¸ªæ™®é€šå­—æ®µï¼Œå½“æ’å…¥ä¸€æ¡å…¨éƒ¨å­—æ®µä¸ä¸ºç©ºçš„æ•°æ®æ—¶ï¼Œæ­¤æ—¶å‡è®¾æœ‰4ä¸ªç´¢å¼•æ–‡ä»¶ï¼Œåˆ†åˆ«å¯¹åº” ä¸»é”® å”¯ä¸€æ€§ç´¢å¼•ï¼Œæ™®é€šç´¢å¼•ï¼Œå‡è®¾å†…å­˜ä¸­æ²¡æœ‰è¿™ä¸ªæ•°æ®é¡µï¼Œé‚£ä¹ˆserveræ˜¯ç›´æ¥è°ƒç”¨innodbçš„æ¥å£ï¼Œç„¶åä¾æ¬¡æ ¡éªŒ ï¼ˆè¯»å–ç£ç›˜æ•°æ®ï¼ŒéªŒè¯å”¯ä¸€æ€§ï¼‰ä¸»é”®ï¼Œå”¯ä¸€æ€§ç´¢å¼•ï¼Œç„¶åç¡®è®¤æ— è¯¯Aæ—¶åˆ»ä¹‹åï¼Œå§ä¸»é”®å’Œå”¯ä¸€æ€§ç´¢å¼•çš„å†™å…¥å†…å­˜ï¼Œå†æŠŠæ™®é€šç´¢å¼•å†™å…¥change bufferï¼Ÿé‚£æ™®é€šæ•°æ®å‘¢ï¼Œæ˜¯ä¸æ˜¯è·Ÿç€ä¸»é”®ä¸€å—å†™å…¥å†…å­˜äº†ï¼Ÿ <br></div>
                            <span class="time">2019-01-26 07:11</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1. æ˜¯çš„ï¼Œå¦‚æœæ™®é€šç´¢å¼•ä¸Šçš„æ•°æ®é¡µè¿™æ—¶å€™æ²¡æœ‰åœ¨å†…å­˜ä¸­ï¼Œå°±ä¼šä½¿ç”¨change buffer<br>2. â€œé‚£æ™®é€šæ•°æ®å‘¢ï¼Œæ˜¯ä¸æ˜¯è·Ÿç€ä¸»é”®ä¸€å—å†™å…¥å†…å­˜äº†ï¼Ÿâ€ ä½ è¯´çš„æ˜¯æ— ç´¢å¼•çš„å­—æ®µæ˜¯å§ï¼Œè¿™äº›æ•°æ®å°±åœ¨ä¸»é”®ç´¢å¼•ä¸Šï¼Œå…¶å®æ”¹çš„å°±æ˜¯ä¸»é”®ç´¢å¼•ã€‚</p>
                                <p class="reply-time">2019-01-26 16:41</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">700</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæ‚¨å¥½ã€‚æˆ‘ç»§ç»­æ¥ç€æˆ‘ä¸Šæ¡ç•™è¨€ã€‚<br>å…³äº2ï¼‰ï¼Œå› ä¸ºæ˜¯æµ‹è¯•æœºï¼Œæˆ‘æ˜¯ç›´æ¥ tail -0f è§‚å¯Ÿ general log è¾“å‡ºçš„ã€‚ç¡®å®æ²¡çœ‹åˆ° KILL QUERY ç­‰å­—çœ¼ã€‚æ•°æ®åº“ç‰ˆæœ¬æ˜¯ MySQL 5.7.24ã€‚<br>å…³äº4ï¼‰ï¼Œæ–‡ä¸­æ‚¨ä¸æ˜¯è¿™æ ·è¯´çš„å—ï¼Ÿ<br>2.ä½†æ˜¯ session D æ‰§è¡Œçš„ kill query C å‘½ä»¤å´æ²¡ä»€ä¹ˆæ•ˆæœï¼Œ <br>3.ç›´åˆ° session E æ‰§è¡Œäº† kill connection å‘½ä»¤ï¼Œæ‰æ–­å¼€äº† session C çš„è¿æ¥ï¼Œæç¤ºâ€œLost connection to MySQL server during queryâ€ï¼Œ <br><br>æ„Ÿè°¢æ‚¨çš„è§£ç­”ã€‚<br> <br></div>
                            <span class="time">2019-01-26 01:03</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1. ä½ çš„å®¢æˆ·ç«¯ç‰ˆæœ¬æ˜¯ä»€ä¹ˆ mysql --version çœ‹çœ‹<br>3. å—¯ï¼Œæ˜¯çš„ï¼Œè¿æ¥ä¼šæ–­å¼€ï¼Œä½†æ˜¯è¿™ä¸ªè¯­å¥åœ¨serverç«¯è¿˜æ˜¯ä¼šç»§ç»­æ‰§è¡Œ ï¼ˆå¦‚æœkill query æ— æ•ˆçš„è¯ï¼‰</p>
                                <p class="reply-time">2019-01-26 16:37</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">700</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œè¯·æ•™ã€‚<br>1ï¼‰æ–‡ä¸­å¼€å¤´è¯´â€œå½“ç„¶å¦‚æœè¿™ä¸ªçº¿ç¨‹æœ‰è¯­å¥æ­£åœ¨æ‰§è¡Œï¼Œä¹Ÿæ˜¯è¦å…ˆåœæ­¢æ­£åœ¨æ‰§è¡Œçš„è¯­å¥çš„â€ã€‚æˆ‘ä¸ªäººåœ¨å¹³æ—¶ä½¿ç”¨ä¸­å°±æ˜¯æŒ‰é»˜è®¤çš„æ‰§è¡Œï¼Œä¸ç®¡è¿™ä¸ªçº¿ç¨‹æœ‰æ— æ­£åœ¨æ‰§è¡Œè¯­å¥ã€‚ä¸çŸ¥è¿™æ ·ä¼šæœ‰ä»€ä¹ˆæ½œåœ¨é—®é¢˜ï¼Ÿ<br>2ï¼‰æ–‡ä¸­è¯´â€œå®é™…ä¸Šï¼Œæ‰§è¡Œ Ctrl+C çš„æ—¶å€™ï¼Œæ˜¯ MySQL å®¢æˆ·ç«¯å¦å¤–å¯åŠ¨ä¸€ä¸ªè¿æ¥ï¼Œç„¶åå‘é€ä¸€ä¸ª kill query å‘½ä»¤â€œã€‚è¿™ä¸ªæ€ä¹ˆè§£é‡Šå‘¢ï¼Ÿ<br>æˆ‘å¼€å¯ general log çš„æ—¶å€™æ‰§è¡Œ Ctrl+C æˆ– Ctrl+D å¹¶æ²¡æœ‰çœ‹åˆ°æœ‰å¦å¤–å¯åŠ¨ä¸€ä¸ªè¿æ¥ï¼Œä¹Ÿæ²¡æœ‰çœ‹åˆ° kill query å‘½ä»¤ã€‚general log ä¸­ä»…çœ‹åˆ°å¯¹åº”çº¿ç¨‹ id å’Œ Quitã€‚<br>3ï¼‰MySQL ä¸ºä»€ä¹ˆè¦åŒæ—¶å­˜åœ¨ kill query å’Œ kill connectionï¼Œæ—¢ç„¶ kill query æœ‰æ— æ•ˆçš„åœºæ™¯ï¼Œå¹²å˜›ä¸ç›´æ¥å­˜åœ¨ä¸€ä¸ª kill connection å‘½ä»¤å°±å¥½äº†ï¼Ÿé‚£å®ƒä¿©åˆ†åˆ«å¯¹åº”çš„é€‚ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Œä»€ä¹ˆæ—¶å€™è€ƒè™‘ kill queryï¼Œä»€ä¹ˆæ—¶å€™è€ƒè™‘ kill connectionï¼Ÿæˆ‘ä¸ªäººè§‰å¾—è¿æ¥å¦‚æœç›´æ¥è¢« kill æ‰å¤§ä¸äº†å†é‡è¿ä¸€æ¬¡å¥½äº†ã€‚ä¹Ÿæ²¡å•¥æŸå¤±ã€‚<br>4ï¼‰å°å°ä¸€ä¸ªæ€»ç»“ï¼Œä¸çŸ¥å¯¹å¦ï¼Ÿ<br>kill query - ä¼šå‡ºç°æ— æ³• kill æ‰çš„æƒ…å†µï¼Œåªèƒ½å†æ¬¡æ‰§è¡Œ kill connectionã€‚<br>kill connection - ä¼šå‡ºç° Command åˆ—æ˜¾ç¤ºæˆ Killed çš„æƒ…å†µã€‚ <br></div>
                            <span class="time">2019-01-25 23:04</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1. ä¸€èˆ¬ä½ æ‰§è¡Œkillå°±æ˜¯è¦åœæ­¢æ­£åœ¨æ‰§è¡Œçš„è¯­å¥ï¼Œæ‰€ä»¥é—®é¢˜ä¸å¤§ğŸ˜‹<br>2. ä¸åº”è¯¥å‘€ï¼Œ KILL QUERY æ˜¯å¤§å†™å“¦ï¼Œä½ å†grepä¸€ä¸‹æ—¥å¿—ï¼›<br>3. å¤šæä¾›ä¸€ç§æ–¹æ³•å˜›ã€‚kill queryæ˜¯æŒ‡ä½ åªæ˜¯æƒ³åœæ­¢è¿™ä¸ªè¯­å¥ï¼Œä½†æ˜¯äº‹åŠ¡ä¸ä¼šå›æ»šã€‚ä¸€èˆ¬kill queryæ˜¯å‘ç”Ÿåœ¨å®¢æˆ·ç«¯æ‰§è¡Œctrl+cçš„æ—¶å€™å•¦ã€‚å¹³æ—¶ç´§æ€¥å¤„ç†ç¡®å®ç›´æ¥ç”¨kill + thread_idã€‚ å¥½é—®é¢˜<br>4. å¯¹ï¼Œå¦å¤–ï¼Œåœ¨kill queryæ— æ•ˆçš„æ—¶å€™ï¼Œå…¶å®kill connectionä¹Ÿæ˜¯æ— æ•ˆçš„</p>
                                <p class="reply-time">2019-01-26 00:30</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/ec/01/978d54af.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Justin</span>
                            </div>
                            <div class="bd">æƒ³å’¨è¯¢ä¸€ä¸ªé—®é¢˜ å¦‚æœèµ°ç´¢å¼•æ‰¾å¯»æ¯”å¦‚age=11çš„äººçš„æ—¶å€™æ˜¯åªä¼šé”age=10åˆ°age=12å— å¦‚æœé‚£ä¸ªç´¢å¼•é¡µåŒ…å«äº†ä»5åˆ°13çš„æ•°æ® æ˜¯åªä¼šé”ç¦»11æœ€è¿‘çš„è¿˜æ˜¯è¯´äºŒåˆ†æŸ¥æ‰¾æ—¶å€™æ¯ä¸€ä¸ªè®¿é—®åˆ°çš„éƒ½ä¼šé”å‘¢ <br></div>
                            <span class="time">2019-01-25 21:54</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">åªä¼šé”å·¦å³ã€‚</p>
                                <p class="reply-time">2019-01-26 00:31</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶</span>
                            </div>
                            <div class="bd">12 å·çº¿ç¨‹çš„ç­‰å¾…é€»è¾‘æ˜¯è¿™æ ·çš„ï¼šæ¯ 10 æ¯«ç§’åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦å¯ä»¥è¿›å…¥ InnoDB æ‰§è¡Œï¼Œå¦‚æœä¸è¡Œï¼Œå¦‚æœä¸è¡Œï¼Œå°±è°ƒç”¨ nanosleep å‡½æ•°è¿›å…¥ sleepçŠ¶æ€ã€‚è¿™é‡Œä¸ºä»€ä¹ˆæ˜¯10æ¯«ç§’åˆ¤æ–­ä¸€ä¸‹ï¼Ÿæ€ä¹ˆæŸ¥çœ‹å’Œè®¾ç½®è¿™ä¸ªå‚æ•°ï¼Ÿ <br></div>
                            <span class="time">2019-01-25 20:24</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å‘æ¡æ©™å­ ã€‚</span>
                            </div>
                            <div class="bd">è€å¸ˆæˆ‘è¿™é‡Œé—®ä¸€ä¸‹å”¯ä¸€ç´¢å¼•çš„é—®é¢˜ ï¼Œå¸Œæœ›è€å¸ˆèƒ½ç»™ç‚¹æ€è·¯<br><br>èƒŒæ™¯ ï¼š ä¸€å¼ å•†å“åº“å­˜è¡¨ ï¼Œ å¦‚æœè¡¨é‡Œæ²¡è¿™ä¸ªå•†å“åˆ™æ’å…¥ ï¼Œå¦‚æœå·²ç»å­˜åœ¨å°±æ›´æ–°åº“å­˜ ã€‚åŒæ­¥è¿™ä¸ªåº“å­˜è¡¨æ˜¯å¼‚æ­¥çš„ ï¼Œæ¯æ¬¡æ·»åŠ å•†å“åº“å­˜æˆåŠŸåä¼šå‘æ¶ˆæ¯ ï¼Œ æ”¶åˆ°æ¶ˆæ¯åä¼šå»è¡¨é‡Œæ–°å¢&#47;æ›´æ–°åº“å­˜<br><br>é—®é¢˜ ï¼š <br>å•†å“åº“å­˜è¡¨ä¼šæœ‰ä¸€ä¸ª å•†å“çš„å”¯ä¸€ç´¢å¼•ã€‚<br>å½“æˆ‘ä»¬æ‰¹é‡æ·»åŠ åŒä¸€å•†å“åº“å­˜åä¼šæ‰¹é‡å‘æ¶ˆæ¯ ï¼Œæ¶ˆæ¯åŒæ—¶ç”Ÿæ•ˆåå»å¤„ç†å°±æœ‰äº†å¹¶å‘çš„é—®é¢˜ ã€‚è¿™æ—¶å€™ä¸¤ä¸ªæ¶ˆæ¯éƒ½åˆ¤æ–­è¡¨é‡Œæ²¡æœ‰è¯¥å•†å“è®°å½•ï¼Œ ä½†æ˜¯æ’å…¥çš„æ—¶å€™å°±ä¼šæœ‰ä¸€ä¸ªæ¶ˆæ¯æ’å…¥æˆåŠŸï¼Œå¦ä¸€ä¸ªæ¶ˆæ¯æ‰§è¡Œå¤±è´¥æŠ¥å”¯ä¸€ç´¢å¼•çš„é”™è¯¯ï¼Œ ä¹‹åæ¶ˆæ¯é‡è¯•èµ°æ›´æ–°çš„é€»è¾‘ã€‚<br><br>è¿™ä¸ªè¿™æ ·åšå¯¹ä¸šåŠ¡æ²¡æœ‰å½±å“ ï¼Œä½†æ˜¯ç°åœ¨æ‰¹é‡æ·»åŠ çš„éœ€æ±‚é‡ä¸Šæ¥äº† ï¼Œçº¿ä¸Šä¸€ç›´æŠ¥è¿™ç§é”™è¯¯æ—¥å¿—ä¹Ÿä¸æ˜¯ä¸ªåŠæ³•ï¼Œ æˆ‘èƒ½æƒ³åˆ°çš„é™¤äº† catch æ‰è¿™ä¸ªå¼‚å¸¸å°±æ²¡ä»€ä¹ˆå…¶ä»–æ€è·¯äº†ã€‚ <br><br>è€å¸ˆèƒ½ç»™ä¸€äº›å…¶ä»–çš„æ€è·¯ä¹ˆ <br></div>
                            <span class="time">2019-01-25 16:09</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æœ‰å”¯ä¸€ç´¢å¼•äº†ï¼Œå°±ç›´æ¥æ’å…¥ï¼Œç„¶åå‡ºç°å”¯ä¸€æ€§çº¦æŸå°±æ”¾å¼ƒï¼Œè¿™ä¸ªé€»è¾‘çš„é—®é¢˜æ˜¯å•¥ï¼Œæˆ‘æ„Ÿè§‰æŒºå¥½çš„å‘€ğŸ˜…<br>æ˜¯ä¸æ˜¯æˆ‘æ²¡æœ‰getåˆ°é—®é¢˜çš„ç‚¹</p>
                                <p class="reply-time">2019-01-25 17:29</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/ef/3e/9c3a8abc.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">AIæœå˜‰å˜‰</span>
                            </div>
                            <div class="bd">æˆ‘æƒ³è¯·é—®ä¸‹è€å¸ˆï¼Œä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œå¾ˆé•¿æ—¶é—´ï¼Œæˆ‘å»killã€‚é‚£ä¹ˆï¼Œæ‰§è¡Œè¿™ä¸ªäº‹åŠ¡è¿‡ç¨‹ä¸­çš„æ•°æ®ä¼šä¸ä¼šå›æ»šï¼Ÿ <br></div>
                            <span class="time">2019-01-25 15:41</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¿™ä¸ªäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­æ–°ç”Ÿæˆçš„æ•°æ®å—ï¼Ÿ ä¼šå›æ»šçš„</p>
                                <p class="reply-time">2019-01-25 16:58</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/e9/5a/a6f2ec4b.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ›¾å‰‘</span>
                            </div>
                            <div class="bd">ä»Šå¤©çš„é—®é¢˜ï¼Œæˆ‘è§‰å¾—å¾—è®©ä»–è‡ªå·±æ‰§è¡Œå®Œæˆåè‡ªåŠ¨æ¢å¤ã€‚å› ä¸ºå¼ºåˆ¶é‡å¯åè¯¥åšçš„å›æ»šè¿˜æ˜¯ä¼šç»§ç»­åšã€‚ <br></div>
                            <span class="time">2019-01-25 10:12</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/46/56/5e83f44b.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Dkey</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸ª ç¬¬å…«ç«  çš„é—®é¢˜ã€‚å…³äºå¯è§æ€§åˆ¤æ–­ï¼Œæ–‡ä¸­éƒ½æ˜¯è¯´äº‹åŠ¡idå¤§äºé«˜æ°´ä½éƒ½ä¸å¯è§ã€‚å¦‚æœç­‰äºæ˜¯ä¸æ˜¯ä¹Ÿä¸å¯è§ã€‚è¿˜æœ‰ä¸€ä¸ªï¼Œreadviewä¸­æ˜¯å¦ä¸åŒ…å«å½“å‰äº‹åŠ¡idã€‚è°¢è°¢è€å¸ˆ <br></div>
                            <span class="time">2019-01-25 09:48</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ä»£ç å®ç°ä¸Šï¼Œäº‹åŠ¡ç”Ÿæˆtrxidåï¼Œtrxidçš„åˆ†é…å™¨ä¼š+1ï¼Œä»¥è¿™ä¸ªåŠ 1ä»¥åçš„æ•°ä½œä¸ºé«˜æ°´ä½ï¼Œæ‰€ä»¥â€œç­‰äºâ€æ˜¯ä¸ç®—çš„ã€‚<br><br>å…¶å®æœ‰æ²¡æœ‰åŒ…å«æ˜¯ä¸€æ ·çš„ï¼Œå®ç°ä¸Šæ²¡æœ‰åŒ…å«ã€‚</p>
                                <p class="reply-time">2019-01-25 15:05</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/ef/af/ba786593.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">wljs</span>
                            </div>
                            <div class="bd">è€å¸ˆåˆ†åº“åˆ†è¡¨ç”¨shardingsphereæ€ä¹ˆæ ·ï¼Ÿ <br></div>
                            <span class="time">2019-01-25 09:11</span>
                            
                        </div>
                    </li>
                    


                </ul>
            </div>
        </div>
    </div>
</div>
</body>
</html>