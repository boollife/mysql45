<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <style type="text/css">

#watermark {

  position: relative;
  overflow: hidden;
}

#watermark .x {
  position: absolute;
  top: 800;
  left: 400;
  color: #3300ff;
  font-size: 50px;
  pointer-events: none;
  opacity:0.3;
  filter:Alpha(opacity=50);
  
  
}
    </style>


    <style type="text/css">
 html{color:#333;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;text-rendering:optimizelegibility;font-family:Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif}html.borderbox *,html.borderbox :after,html.borderbox :before{box-sizing:border-box}article,aside,blockquote,body,button,code,dd,details,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hr,input,legend,li,menu,nav,ol,p,pre,section,td,textarea,th,ul{margin:0;padding:0}article,aside,details,figcaption,figure,footer,header,menu,nav,section{display:block}audio,canvas,video{display:inline-block}body,button,input,select,textarea{font:300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}table{border-collapse:collapse;border-spacing:0}fieldset,img{border:0}blockquote{position:relative;color:#999;font-weight:400;border-left:1px solid #1abc9c;padding-left:1em;margin:1em 3em 1em 2em}@media only screen and (max-width:640px){blockquote{margin:1em 0}}abbr,acronym{border-bottom:1px dotted;font-variant:normal}abbr{cursor:help}del{text-decoration:line-through}address,caption,cite,code,dfn,em,th,var{font-style:normal;font-weight:400}ol,ul{list-style:none}caption,th{text-align:left}q:after,q:before{content:""}sub,sup{font-size:75%;line-height:0;position:relative}:root sub,:root sup{vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}a{color:#1abc9c}a:hover{text-decoration:underline}.typo a{border-bottom:1px solid #1abc9c}.typo a:hover{border-bottom-color:#555;color:#555}.typo a:hover,a,ins{text-decoration:none}.typo-u,u{text-decoration:underline}mark{background:#fffdd1;border-bottom:1px solid #ffedce;padding:2px;margin:0 5px}code,pre,pre tt{font-family:Courier,Courier New,monospace}pre{background:hsla(0,0%,97%,.7);border:1px solid #ddd;padding:1em 1.5em;display:block;-webkit-overflow-scrolling:touch}hr{border:none;border-bottom:1px solid #cfcfcf;margin-bottom:.8em;height:10px}.typo-small,figcaption,small{font-size:.9em;color:#888}b,strong{font-weight:700;color:#000}[draggable]{cursor:move}.clearfix:after,.clearfix:before{content:"";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.textwrap,.textwrap td,.textwrap th{word-wrap:break-word;word-break:break-all}.textwrap-table{table-layout:fixed}.serif{font-family:Palatino,Optima,Georgia,serif}.typo-dl,.typo-form,.typo-hr,.typo-ol,.typo-p,.typo-pre,.typo-table,.typo-ul,.typo dl,.typo form,.typo hr,.typo ol,.typo p,.typo pre,.typo table,.typo ul,blockquote{margin-bottom:1rem}h1,h2,h3,h4,h5,h6{font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;line-height:1.35}.typo-h1,.typo-h2,.typo-h3,.typo-h4,.typo-h5,.typo-h6,.typo h1,.typo h2,.typo h3,.typo h4,.typo h5,.typo h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}.typo-h1,.typo h1{font-size:2em}.typo-h2,.typo h2{font-size:1.8em}.typo-h3,.typo h3{font-size:1.6em}.typo-h4,.typo h4{font-size:1.4em}.typo-h5,.typo-h6,.typo h5,.typo h6{font-size:1.2em}.typo-ul,.typo ul{margin-left:1.3em;list-style:disc}.typo-ol,.typo ol{list-style:decimal;margin-left:1.9em}.typo-ol ol,.typo-ol ul,.typo-ul ol,.typo-ul ul,.typo li ol,.typo li ul{margin-bottom:.8em;margin-left:2em}.typo-ol ul,.typo-ul ul,.typo li ul{list-style:circle}.typo-table td,.typo-table th,.typo table caption,.typo table td,.typo table th{border:1px solid #ddd;padding:.5em 1em;color:#666}.typo-table th,.typo table th{background:#fbfbfb}.typo-table thead th,.typo table thead th{background:hsla(0,0%,95%,.7)}.typo table caption{border-bottom:none}.typo-input,.typo-textarea{-webkit-appearance:none;border-radius:0}.typo-em,.typo em,caption,legend{color:#000;font-weight:inherit}.typo-em{position:relative}.typo-em:after{position:absolute;top:.65em;left:0;width:100%;overflow:hidden;white-space:nowrap;content:"\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"}.typo img{max-width:100%}.common-content{font-weight:400;color:#353535;line-height:1.75rem;white-space:normal;word-break:normal;font-size:1rem}.common-content img{display:block;max-width:100%;background-color:#eee}.common-content audio,.common-content video{width:100%;background-color:#eee}.common-content center,.common-content font{margin-top:1rem;display:inline-block}.common-content center{width:100%}.common-content pre{margin-top:1rem;padding-left:0;padding-right:0;position:relative;overflow:hidden}.common-content pre code{font-size:.8rem;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;display:block;width:100%;box-sizing:border-box;padding-left:1rem;padding-right:1rem;overflow-x:auto}.common-content hr{border:none;margin-top:1.5rem;margin-bottom:1.5rem;border-top:1px solid #f5f5f5;height:1px;background:none}.common-content b,.common-content h1,.common-content h2,.common-content h3,.common-content h4,.common-content h5,.common-content strong{font-weight:700}.common-content h1,.common-content h2{font-size:1.125rem;margin-bottom:.45rem}.common-content h3,.common-content h4,.common-content h5{font-size:1rem;margin-bottom:.45rem}.common-content p{font-weight:400;color:#353535;margin-top:.15rem}.common-content .orange{color:#ff5a05}.common-content .reference{font-size:1rem;color:#888}.custom-rich-content h1{margin-top:0;font-weight:400;font-size:15.25px;border-bottom:1px solid #eee;line-height:2.8}.custom-rich-content li,.custom-rich-content p{font-size:14px;color:#888;line-height:1.6}table.hljs-ln{margin-bottom:0;border-spacing:0;border-collapse:collapse}table.hljs-ln,table.hljs-ln tbody,table.hljs-ln td,table.hljs-ln tr{box-sizing:border-box}table.hljs-ln td{padding:0;border:0}table.hljs-ln td.hljs-ln-numbers{min-width:15px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;cursor:pointer;user-select:none}table.hljs-ln td.hljs-ln-code,table.hljs-ln td.hljs-ln-numbers{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;line-height:20px;vertical-align:top}table.hljs-ln td.hljs-ln-code{position:relative;padding-right:10px;padding-left:10px;overflow:visible;color:#24292e;word-wrap:normal;white-space:pre}video::-webkit-media-controls{overflow:hidden!important}video::-webkit-media-controls-enclosure{width:calc(100% + 32px);margin-left:auto}.button-cancel{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel,.button-primary{-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary{color:#fff;background-color:#ff5a05;border-radius:3px}@font-face{font-family:iconfont;src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot);src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.woff) format("woff"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.ttf) format("truetype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.svg#iconfont) format("svg")}@font-face{font-family:player-font;src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot);src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.woff) format("woff"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.ttf) format("truetype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.svg#player-font) format("svg")}.iconfont{font-family:iconfont!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;-moz-osx-font-smoothing:grayscale}html{background:#fff;min-height:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{width:100%}body.fixed{overflow:hidden;position:fixed;width:100vw;height:100vh}i{font-style:normal}a{word-wrap:break-word;-webkit-tap-highlight-color:rgba(0,0,0,0)}a:hover{text-decoration:none}.fade-enter-active,.fade-leave-active{transition:opacity .3s}.fade-enter,.fade-leave-to{opacity:0}.MathJax,.MathJax_CHTML,.MathJax_MathContainer,.MathJax_MathML,.MathJax_PHTML,.MathJax_PlainSource,.MathJax_SVG{outline:0}.ios-app-switch .js-audit{display:none}._loading_wrap_{position:fixed;width:100vw;height:100vh;top:50%;left:50%;transform:translate(-50%,-50%);z-index:999}._loading_div_class_,._loading_wrap_{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._loading_div_class_{word-wrap:break-word;padding:.5rem .75rem;text-align:center;z-index:9999;font-size:.6rem;max-width:60%;color:#fff;border-radius:.25rem;-ms-flex-direction:column;flex-direction:column}._loading_div_class_ .message{color:#353535;font-size:16px;line-height:3}.spinner{animation:circle-rotator 1.4s linear infinite}.spinner *{line-height:0;box-sizing:border-box}@keyframes circle-rotator{0%{transform:rotate(0deg)}to{transform:rotate(270deg)}}.path{stroke-dasharray:187;stroke-dashoffset:0;transform-origin:center;animation:circle-dash 1.4s ease-in-out infinite,circle-colors 5.6s ease-in-out infinite}@keyframes circle-colors{0%{stroke:#ff5a05}to{stroke:#ff5a05}}@keyframes circle-dash{0%{stroke-dashoffset:187}50%{stroke-dashoffset:46.75;transform:rotate(135deg)}to{stroke-dashoffset:187;transform:rotate(450deg)}}.confirm-box-wrapper,.confirm-box-wrapper .mask{position:absolute;top:0;left:0;right:0;bottom:0}.confirm-box-wrapper .mask{background:rgba(0,0,0,.6)}.confirm-box-wrapper .confirm-box{position:fixed;top:50%;left:50%;width:267px;background:#fff;transform:translate(-50%,-50%);border-radius:7px}.confirm-box-wrapper .confirm-box .head{margin:0 18px;font-size:18px;text-align:center;line-height:65px;border-bottom:1px solid #d9d9d9}.confirm-box-wrapper .confirm-box .body{padding:18px;padding-bottom:0;color:#353535;font-size:12.5px;max-height:150px;overflow:auto}.confirm-box-wrapper .confirm-box .foot{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;padding:18px}.confirm-box-wrapper .confirm-box .foot .button-cancel{border:1px solid #d9d9d9}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}




    </style>
    <style type="text/css">
        .button-cancel[data-v-87ffcada]{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel[data-v-87ffcada],.button-primary[data-v-87ffcada]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary[data-v-87ffcada]{color:#fff;background-color:#ff5a05;border-radius:3px}.pd[data-v-87ffcada]{padding-left:1.375rem;padding-right:1.375rem}.article[data-v-87ffcada]{max-width:70rem;margin:0 auto}.article .article-unavailable[data-v-87ffcada]{color:#fa8919;font-size:15px;font-weight:600;line-height:24px;border-radius:5px;padding:12px;background-color:#f6f7fb;margin-top:20px}.article .article-unavailable .iconfont[data-v-87ffcada]{font-size:12px}.article .main[data-v-87ffcada]{padding:1.25rem 0;margin-bottom:52px}.article-title[data-v-87ffcada]{color:#353535;font-weight:400;line-height:1.65rem;font-size:1.34375rem}.article-info[data-v-87ffcada]{color:#888;font-size:.9375rem;margin-top:1.0625rem}.article-content[data-v-87ffcada]{margin-top:1.0625rem}.article-content.android video[data-v-87ffcada]::-webkit-media-controls-fullscreen-button{display:none}.copyright[data-v-87ffcada]{color:#b2b2b2;padding-bottom:20px;margin-top:20px;font-size:13px}.audio-player[data-v-87ffcada]{width:100%;margin:20px 0}.to-comment[data-v-87ffcada]{overflow:hidden;padding-top:10px;margin-bottom:-30px}.to-comment a.button-primary[data-v-87ffcada]{float:right;height:20px;font-size:12px;line-height:20px;padding:4px 8px;cursor:pointer}.article-comments[data-v-87ffcada]{margin-top:2rem}.article-comments h2[data-v-87ffcada]{text-align:center;color:#888;position:relative;z-index:1;margin-bottom:1rem}.article-comments h2[data-v-87ffcada]:before{border-top:1px dotted #888;content:"";position:absolute;top:56%;left:0;width:100%;z-index:-1}.article-comments h2 span[data-v-87ffcada]{font-size:15.25px;font-weight:400;padding:0 1rem;background:#fff;display:inline-block}.article-sub-bottom[data-v-87ffcada]{z-index:10;cursor:pointer}.switch-btns[data-v-87ffcada]{height:76px;cursor:pointer;padding-top:24px;padding-bottom:24px;border-bottom:10px solid #f6f7fb;position:relative}.switch-btns[data-v-87ffcada]:before{content:" ";height:1px;background:#e8e8e8;position:absolute;top:0;left:0;-webkit-box-sizing:border-box;box-sizing:border-box;left:1.375rem;right:1.375rem}.switch-btns .btn[data-v-87ffcada]{height:38px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.switch-btns .btn .tag[data-v-87ffcada]{-webkit-box-flex:0;-ms-flex:0 0 62px;flex:0 0 62px;text-align:center;color:#888;font-size:14px;border-radius:10px;height:22px;line-height:22px;background:#f6f7fb;font-weight:400}.switch-btns .btn .txt[data-v-87ffcada]{margin-left:10px;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:#888;font-size:15px;height:22px;line-height:22px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400}@media (max-width:769px){.article .breadcrumb[data-v-87ffcada]{padding-top:10px;padding-bottom:10px}}





    </style>

    <style type="text/css">
        .comment-item{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:1rem}.comment-item a{border-bottom:none}.comment-item .avatar{width:2.625rem;height:2.625rem;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}.comment-item .info{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.comment-item .info .hd{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .username{color:#888;font-size:15.25px;font-weight:400;line-height:1.2}.comment-item .info .hd .control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .control .btn-share{color:#888;font-size:.75rem;margin-right:1rem}.comment-item .info .hd .control .btn-praise{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:15.25px;text-decoration:none}.comment-item .info .hd .control .btn-praise i{color:#888;display:inline-block;font-size:.75rem;margin-right:.3rem;margin-top:-.01rem}.comment-item .info .hd .control .btn-praise i.on,.comment-item .info .hd .control .btn-praise span{color:#ff5a05}.comment-item .info .bd{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6}.comment-item .info .time{color:#888;font-size:9px;line-height:1}.comment-item .info .reply .reply-hd{font-size:15.25px}.comment-item .info .reply .reply-hd span{margin-left:-12px;color:#888;font-weight:400}.comment-item .info .reply .reply-hd i{color:#ff5a05;font-size:15.25px}.comment-item .info .reply .reply-content{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all}.comment-item .info .reply .reply-time{color:#888;font-size:9px}




    </style>
</head>
<body>
<div id="app">


    <div data-v-87ffcada="" class="article" id="watermark">
        <div data-v-87ffcada="" class="main main-app">
            <h1 data-v-87ffcada="" class="article-title pd">
                14è®²count(*)è¿™ä¹ˆæ…¢ï¼Œæˆ‘è¯¥æ€ä¹ˆåŠ
            </h1>
            <div data-v-87ffcada="" class="article-content typo common-content pd"><img data-v-87ffcada=""
                                                                                        src="https://static001.geekbang.org/resource/image/ee/03/ee2882d95e26abb309a926c67e509a03.jpg">

                <div>
                    <audio controls="controls" height="100" width="100">
                        <source src="14è®²countè¿™ä¹ˆæ…¢ï¼Œæˆ‘è¯¥æ€ä¹ˆåŠ.mp3" type="audio/mp3" />
                        <embed height="100" width="100" src="14è®²countè¿™ä¹ˆæ…¢ï¼Œæˆ‘è¯¥æ€ä¹ˆåŠ.mp3" />
                    </audio>
                </div>
                <div data-v-87ffcada="" id="article-content" class="">
                    <div class="text">
                        <p>åœ¨å¼€å‘ç³»ç»Ÿçš„æ—¶å€™ï¼Œä½ å¯èƒ½ç»å¸¸éœ€è¦è®¡ç®—ä¸€ä¸ªè¡¨çš„è¡Œæ•°ï¼Œæ¯”å¦‚ä¸€ä¸ªäº¤æ˜“ç³»ç»Ÿçš„æ‰€æœ‰å˜æ›´è®°å½•æ€»æ•°ã€‚è¿™æ—¶å€™ä½ å¯èƒ½ä¼šæƒ³ï¼Œä¸€æ¡select count(*) from t è¯­å¥ä¸å°±è§£å†³äº†å—ï¼Ÿ</p><p>ä½†æ˜¯ï¼Œä½ ä¼šå‘ç°éšç€ç³»ç»Ÿä¸­è®°å½•æ•°è¶Šæ¥è¶Šå¤šï¼Œè¿™æ¡è¯­å¥æ‰§è¡Œå¾—ä¹Ÿä¼šè¶Šæ¥è¶Šæ…¢ã€‚ç„¶åä½ å¯èƒ½å°±æƒ³äº†ï¼ŒMySQLæ€ä¹ˆè¿™ä¹ˆç¬¨å•Šï¼Œè®°ä¸ªæ€»æ•°ï¼Œæ¯æ¬¡è¦æŸ¥çš„æ—¶å€™ç›´æ¥è¯»å‡ºæ¥ï¼Œä¸å°±å¥½äº†å—ã€‚</p><p>é‚£ä¹ˆä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥èŠèŠcount(*)è¯­å¥åˆ°åº•æ˜¯æ€æ ·å®ç°çš„ï¼Œä»¥åŠMySQLä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆå®ç°ã€‚ç„¶åï¼Œæˆ‘ä¼šå†å’Œä½ è¯´è¯´ï¼Œå¦‚æœåº”ç”¨ä¸­æœ‰è¿™ç§é¢‘ç¹å˜æ›´å¹¶éœ€è¦ç»Ÿè®¡è¡¨è¡Œæ•°çš„éœ€æ±‚ï¼Œä¸šåŠ¡è®¾è®¡ä¸Šå¯ä»¥æ€ä¹ˆåšã€‚</p><h1>count(*)çš„å®ç°æ–¹å¼</h1><p>ä½ é¦–å…ˆè¦æ˜ç¡®çš„æ˜¯ï¼Œåœ¨ä¸åŒçš„MySQLå¼•æ“ä¸­ï¼Œcount(*)æœ‰ä¸åŒçš„å®ç°æ–¹å¼ã€‚</p><ul>
<li>MyISAMå¼•æ“æŠŠä¸€ä¸ªè¡¨çš„æ€»è¡Œæ•°å­˜åœ¨äº†ç£ç›˜ä¸Šï¼Œå› æ­¤æ‰§è¡Œcount(*)çš„æ—¶å€™ä¼šç›´æ¥è¿”å›è¿™ä¸ªæ•°ï¼Œæ•ˆç‡å¾ˆé«˜ï¼›</li>
<li>è€ŒInnoDBå¼•æ“å°±éº»çƒ¦äº†ï¼Œå®ƒæ‰§è¡Œcount(*)çš„æ—¶å€™ï¼Œéœ€è¦æŠŠæ•°æ®ä¸€è¡Œä¸€è¡Œåœ°ä»å¼•æ“é‡Œé¢è¯»å‡ºæ¥ï¼Œç„¶åç´¯ç§¯è®¡æ•°ã€‚</li>
</ul><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨è¿™ç¯‡æ–‡ç« é‡Œè®¨è®ºçš„æ˜¯æ²¡æœ‰è¿‡æ»¤æ¡ä»¶çš„count(*)ï¼Œå¦‚æœåŠ äº†where æ¡ä»¶çš„è¯ï¼ŒMyISAMè¡¨ä¹Ÿæ˜¯ä¸èƒ½è¿”å›å¾—è¿™ä¹ˆå¿«çš„ã€‚</p><p>åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¸€èµ·åˆ†æäº†ä¸ºä»€ä¹ˆè¦ä½¿ç”¨InnoDBï¼Œå› ä¸ºä¸è®ºæ˜¯åœ¨äº‹åŠ¡æ”¯æŒã€å¹¶å‘èƒ½åŠ›è¿˜æ˜¯åœ¨æ•°æ®å®‰å…¨æ–¹é¢ï¼ŒInnoDBéƒ½ä¼˜äºMyISAMã€‚æˆ‘çŒœä½ çš„è¡¨ä¹Ÿä¸€å®šæ˜¯ç”¨äº†InnoDBå¼•æ“ã€‚è¿™å°±æ˜¯å½“ä½ çš„è®°å½•æ•°è¶Šæ¥è¶Šå¤šçš„æ—¶å€™ï¼Œè®¡ç®—ä¸€ä¸ªè¡¨çš„æ€»è¡Œæ•°ä¼šè¶Šæ¥è¶Šæ…¢çš„åŸå› ã€‚</p><!-- [[[read_end]]] --><p>é‚£<strong>ä¸ºä»€ä¹ˆInnoDBä¸è·ŸMyISAMä¸€æ ·ï¼Œä¹ŸæŠŠæ•°å­—å­˜èµ·æ¥å‘¢ï¼Ÿ</strong></p><p>è¿™æ˜¯å› ä¸ºå³ä½¿æ˜¯åœ¨åŒä¸€ä¸ªæ—¶åˆ»çš„å¤šä¸ªæŸ¥è¯¢ï¼Œç”±äºå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰çš„åŸå› ï¼ŒInnoDBè¡¨â€œåº”è¯¥è¿”å›å¤šå°‘è¡Œâ€ä¹Ÿæ˜¯ä¸ç¡®å®šçš„ã€‚è¿™é‡Œï¼Œæˆ‘ç”¨ä¸€ä¸ªç®—count(*)çš„ä¾‹å­æ¥ä¸ºä½ è§£é‡Šä¸€ä¸‹ã€‚</p><p>å‡è®¾è¡¨tä¸­ç°åœ¨æœ‰10000æ¡è®°å½•ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸‰ä¸ªç”¨æˆ·å¹¶è¡Œçš„ä¼šè¯ã€‚</p><ul>
<li>ä¼šè¯Aå…ˆå¯åŠ¨äº‹åŠ¡å¹¶æŸ¥è¯¢ä¸€æ¬¡è¡¨çš„æ€»è¡Œæ•°ï¼›</li>
<li>ä¼šè¯Bå¯åŠ¨äº‹åŠ¡ï¼Œæ’å…¥ä¸€è¡Œåè®°å½•åï¼ŒæŸ¥è¯¢è¡¨çš„æ€»è¡Œæ•°ï¼›</li>
<li>ä¼šè¯Cå…ˆå¯åŠ¨ä¸€ä¸ªå•ç‹¬çš„è¯­å¥ï¼Œæ’å…¥ä¸€è¡Œè®°å½•åï¼ŒæŸ¥è¯¢è¡¨çš„æ€»è¡Œæ•°ã€‚</li>
</ul><p>æˆ‘ä»¬å‡è®¾ä»ä¸Šåˆ°ä¸‹æ˜¯æŒ‰ç…§æ—¶é—´é¡ºåºæ‰§è¡Œçš„ï¼ŒåŒä¸€è¡Œè¯­å¥æ˜¯åœ¨åŒä¸€æ—¶åˆ»æ‰§è¡Œçš„ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/5e/97/5e716ba1d464c8224c1c1f36135d0e97.png" alt=""></p><center><span class="reference">å›¾1 ä¼šè¯Aã€Bã€Cçš„æ‰§è¡Œæµç¨‹</span></center><p>ä½ ä¼šçœ‹åˆ°ï¼Œåœ¨æœ€åä¸€ä¸ªæ—¶åˆ»ï¼Œä¸‰ä¸ªä¼šè¯Aã€Bã€Cä¼šåŒæ—¶æŸ¥è¯¢è¡¨tçš„æ€»è¡Œæ•°ï¼Œä½†æ‹¿åˆ°çš„ç»“æœå´ä¸åŒã€‚</p><p>è¿™å’ŒInnoDBçš„äº‹åŠ¡è®¾è®¡æœ‰å…³ç³»ï¼Œå¯é‡å¤è¯»æ˜¯å®ƒé»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Œåœ¨ä»£ç ä¸Šå°±æ˜¯é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼Œä¹Ÿå°±æ˜¯MVCCæ¥å®ç°çš„ã€‚æ¯ä¸€è¡Œè®°å½•éƒ½è¦åˆ¤æ–­è‡ªå·±æ˜¯å¦å¯¹è¿™ä¸ªä¼šè¯å¯è§ï¼Œå› æ­¤å¯¹äºcount(*)è¯·æ±‚æ¥è¯´ï¼ŒInnoDBåªå¥½æŠŠæ•°æ®ä¸€è¡Œä¸€è¡Œåœ°è¯»å‡ºä¾æ¬¡åˆ¤æ–­ï¼Œå¯è§çš„è¡Œæ‰èƒ½å¤Ÿç”¨äºè®¡ç®—â€œåŸºäºè¿™ä¸ªæŸ¥è¯¢â€çš„è¡¨çš„æ€»è¡Œæ•°ã€‚</p><blockquote>
<p>å¤‡æ³¨ï¼šå¦‚æœä½ å¯¹MVCCè®°å¿†æ¨¡ç³Šäº†ï¼Œå¯ä»¥å†å›é¡¾ä¸‹ç¬¬3ç¯‡æ–‡ç« <a href="https://time.geekbang.org/column/article/68963">ã€Šäº‹åŠ¡éš”ç¦»ï¼šä¸ºä»€ä¹ˆä½ æ”¹äº†æˆ‘è¿˜çœ‹ä¸è§ï¼Ÿã€‹</a>å’Œç¬¬8ç¯‡æ–‡ç« <a href="https://time.geekbang.org/column/article/70562">ã€Šäº‹åŠ¡åˆ°åº•æ˜¯éš”ç¦»çš„è¿˜æ˜¯ä¸éš”ç¦»çš„ï¼Ÿã€‹</a>ä¸­çš„ç›¸å…³å†…å®¹ã€‚</p>
</blockquote><p>å½“ç„¶ï¼Œç°åœ¨è¿™ä¸ªçœ‹ä¸Šå»ç¬¨ç¬¨çš„MySQLï¼Œåœ¨æ‰§è¡Œcount(*)æ“ä½œçš„æ—¶å€™è¿˜æ˜¯åšäº†ä¼˜åŒ–çš„ã€‚</p><p>ä½ çŸ¥é“çš„ï¼ŒInnoDBæ˜¯ç´¢å¼•ç»„ç»‡è¡¨ï¼Œä¸»é”®ç´¢å¼•æ ‘çš„å¶å­èŠ‚ç‚¹æ˜¯æ•°æ®ï¼Œè€Œæ™®é€šç´¢å¼•æ ‘çš„å¶å­èŠ‚ç‚¹æ˜¯ä¸»é”®å€¼ã€‚æ‰€ä»¥ï¼Œæ™®é€šç´¢å¼•æ ‘æ¯”ä¸»é”®ç´¢å¼•æ ‘å°å¾ˆå¤šã€‚å¯¹äºcount(*)è¿™æ ·çš„æ“ä½œï¼Œéå†å“ªä¸ªç´¢å¼•æ ‘å¾—åˆ°çš„ç»“æœé€»è¾‘ä¸Šéƒ½æ˜¯ä¸€æ ·çš„ã€‚å› æ­¤ï¼ŒMySQLä¼˜åŒ–å™¨ä¼šæ‰¾åˆ°æœ€å°çš„é‚£æ£µæ ‘æ¥éå†ã€‚<strong>åœ¨ä¿è¯é€»è¾‘æ­£ç¡®çš„å‰æä¸‹ï¼Œå°½é‡å‡å°‘æ‰«æçš„æ•°æ®é‡ï¼Œæ˜¯æ•°æ®åº“ç³»ç»Ÿè®¾è®¡çš„é€šç”¨æ³•åˆ™ä¹‹ä¸€ã€‚</strong></p><p>å¦‚æœä½ ç”¨è¿‡show table status å‘½ä»¤çš„è¯ï¼Œå°±ä¼šå‘ç°è¿™ä¸ªå‘½ä»¤çš„è¾“å‡ºç»“æœé‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ªTABLE_ROWSç”¨äºæ˜¾ç¤ºè¿™ä¸ªè¡¨å½“å‰æœ‰å¤šå°‘è¡Œï¼Œè¿™ä¸ªå‘½ä»¤æ‰§è¡ŒæŒºå¿«çš„ï¼Œé‚£è¿™ä¸ªTABLE_ROWSèƒ½ä»£æ›¿count(*)å—ï¼Ÿ</p><p>ä½ å¯èƒ½è¿˜è®°å¾—åœ¨ç¬¬10ç¯‡æ–‡ç« <a href="https://time.geekbang.org/column/article/71173">ã€Š MySQLä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šé€‰é”™ç´¢å¼•ï¼Ÿã€‹</a>ä¸­æˆ‘æåˆ°è¿‡ï¼Œç´¢å¼•ç»Ÿè®¡çš„å€¼æ˜¯é€šè¿‡é‡‡æ ·æ¥ä¼°ç®—çš„ã€‚å®é™…ä¸Šï¼ŒTABLE_ROWSå°±æ˜¯ä»è¿™ä¸ªé‡‡æ ·ä¼°ç®—å¾—æ¥çš„ï¼Œå› æ­¤å®ƒä¹Ÿå¾ˆä¸å‡†ã€‚æœ‰å¤šä¸å‡†å‘¢ï¼Œå®˜æ–¹æ–‡æ¡£è¯´è¯¯å·®å¯èƒ½è¾¾åˆ°40%åˆ°50%ã€‚<strong>æ‰€ä»¥ï¼Œshow table statuså‘½ä»¤æ˜¾ç¤ºçš„è¡Œæ•°ä¹Ÿä¸èƒ½ç›´æ¥ä½¿ç”¨ã€‚</strong></p><p>åˆ°è¿™é‡Œæˆ‘ä»¬å°ç»“ä¸€ä¸‹ï¼š</p><ul>
<li>MyISAMè¡¨è™½ç„¶count(*)å¾ˆå¿«ï¼Œä½†æ˜¯ä¸æ”¯æŒäº‹åŠ¡ï¼›</li>
<li>show table statuså‘½ä»¤è™½ç„¶è¿”å›å¾ˆå¿«ï¼Œä½†æ˜¯ä¸å‡†ç¡®ï¼›</li>
<li>InnoDBè¡¨ç›´æ¥count(*)ä¼šéå†å…¨è¡¨ï¼Œè™½ç„¶ç»“æœå‡†ç¡®ï¼Œä½†ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚</li>
</ul><p>é‚£ä¹ˆï¼Œå›åˆ°æ–‡ç« å¼€å¤´çš„é—®é¢˜ï¼Œå¦‚æœä½ ç°åœ¨æœ‰ä¸€ä¸ªé¡µé¢ç»å¸¸è¦æ˜¾ç¤ºäº¤æ˜“ç³»ç»Ÿçš„æ“ä½œè®°å½•æ€»æ•°ï¼Œåˆ°åº•åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œæˆ‘ä»¬åªèƒ½è‡ªå·±è®¡æ•°ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¨è®ºä¸€ä¸‹ï¼Œçœ‹çœ‹è‡ªå·±è®¡æ•°æœ‰å“ªäº›æ–¹æ³•ï¼Œä»¥åŠæ¯ç§æ–¹æ³•çš„ä¼˜ç¼ºç‚¹æœ‰å“ªäº›ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘å…ˆå’Œä½ è¯´ä¸€ä¸‹è¿™äº›æ–¹æ³•çš„åŸºæœ¬æ€è·¯ï¼šä½ éœ€è¦è‡ªå·±æ‰¾ä¸€ä¸ªåœ°æ–¹ï¼ŒæŠŠæ“ä½œè®°å½•è¡¨çš„è¡Œæ•°å­˜èµ·æ¥ã€‚</p><h1>ç”¨ç¼“å­˜ç³»ç»Ÿä¿å­˜è®¡æ•°</h1><p>å¯¹äºæ›´æ–°å¾ˆé¢‘ç¹çš„åº“æ¥è¯´ï¼Œä½ å¯èƒ½ä¼šç¬¬ä¸€æ—¶é—´æƒ³åˆ°ï¼Œç”¨ç¼“å­˜ç³»ç»Ÿæ¥æ”¯æŒã€‚</p><p>ä½ å¯ä»¥ç”¨ä¸€ä¸ªRedisæœåŠ¡æ¥ä¿å­˜è¿™ä¸ªè¡¨çš„æ€»è¡Œæ•°ã€‚è¿™ä¸ªè¡¨æ¯è¢«æ’å…¥ä¸€è¡ŒRedisè®¡æ•°å°±åŠ 1ï¼Œæ¯è¢«åˆ é™¤ä¸€è¡ŒRedisè®¡æ•°å°±å‡1ã€‚è¿™ç§æ–¹å¼ä¸‹ï¼Œè¯»å’Œæ›´æ–°æ“ä½œéƒ½å¾ˆå¿«ï¼Œä½†ä½ å†æƒ³ä¸€ä¸‹è¿™ç§æ–¹å¼å­˜åœ¨ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ</p><p>æ²¡é”™ï¼Œç¼“å­˜ç³»ç»Ÿå¯èƒ½ä¼šä¸¢å¤±æ›´æ–°ã€‚</p><p>Redisçš„æ•°æ®ä¸èƒ½æ°¸ä¹…åœ°ç•™åœ¨å†…å­˜é‡Œï¼Œæ‰€ä»¥ä½ ä¼šæ‰¾ä¸€ä¸ªåœ°æ–¹æŠŠè¿™ä¸ªå€¼å®šæœŸåœ°æŒä¹…åŒ–å­˜å‚¨èµ·æ¥ã€‚ä½†å³ä½¿è¿™æ ·ï¼Œä»ç„¶å¯èƒ½ä¸¢å¤±æ›´æ–°ã€‚è¯•æƒ³å¦‚æœåˆšåˆšåœ¨æ•°æ®è¡¨ä¸­æ’å…¥äº†ä¸€è¡Œï¼ŒRedisä¸­ä¿å­˜çš„å€¼ä¹ŸåŠ äº†1ï¼Œç„¶åRediså¼‚å¸¸é‡å¯äº†ï¼Œé‡å¯åä½ è¦ä»å­˜å‚¨redisæ•°æ®çš„åœ°æ–¹æŠŠè¿™ä¸ªå€¼è¯»å›æ¥ï¼Œè€ŒåˆšåˆšåŠ 1çš„è¿™ä¸ªè®¡æ•°æ“ä½œå´ä¸¢å¤±äº†ã€‚</p><p>å½“ç„¶äº†ï¼Œè¿™è¿˜æ˜¯æœ‰è§£çš„ã€‚æ¯”å¦‚ï¼ŒRediså¼‚å¸¸é‡å¯ä»¥åï¼Œåˆ°æ•°æ®åº“é‡Œé¢å•ç‹¬æ‰§è¡Œä¸€æ¬¡count(*)è·å–çœŸå®çš„è¡Œæ•°ï¼Œå†æŠŠè¿™ä¸ªå€¼å†™å›åˆ°Redisé‡Œå°±å¯ä»¥äº†ã€‚å¼‚å¸¸é‡å¯æ¯•ç«Ÿä¸æ˜¯ç»å¸¸å‡ºç°çš„æƒ…å†µï¼Œè¿™ä¸€æ¬¡å…¨è¡¨æ‰«æçš„æˆæœ¬ï¼Œè¿˜æ˜¯å¯ä»¥æ¥å—çš„ã€‚</p><p>ä½†å®é™…ä¸Šï¼Œ<strong>å°†è®¡æ•°ä¿å­˜åœ¨ç¼“å­˜ç³»ç»Ÿä¸­çš„æ–¹å¼ï¼Œè¿˜ä¸åªæ˜¯ä¸¢å¤±æ›´æ–°çš„é—®é¢˜ã€‚å³ä½¿Redisæ­£å¸¸å·¥ä½œï¼Œè¿™ä¸ªå€¼è¿˜æ˜¯é€»è¾‘ä¸Šä¸ç²¾ç¡®çš„ã€‚</strong></p><p>ä½ å¯ä»¥è®¾æƒ³ä¸€ä¸‹æœ‰è¿™ä¹ˆä¸€ä¸ªé¡µé¢ï¼Œè¦æ˜¾ç¤ºæ“ä½œè®°å½•çš„æ€»æ•°ï¼ŒåŒæ—¶è¿˜è¦æ˜¾ç¤ºæœ€è¿‘æ“ä½œçš„100æ¡è®°å½•ã€‚é‚£ä¹ˆï¼Œè¿™ä¸ªé¡µé¢çš„é€»è¾‘å°±éœ€è¦å…ˆåˆ°Redisé‡Œé¢å–å‡ºè®¡æ•°ï¼Œå†åˆ°æ•°æ®è¡¨é‡Œé¢å–æ•°æ®è®°å½•ã€‚</p><p>æˆ‘ä»¬æ˜¯è¿™ä¹ˆå®šä¹‰ä¸ç²¾ç¡®çš„ï¼š</p><ol>
<li>
<p>ä¸€ç§æ˜¯ï¼ŒæŸ¥åˆ°çš„100è¡Œç»“æœé‡Œé¢æœ‰æœ€æ–°æ’å…¥è®°å½•ï¼Œè€ŒRedisçš„è®¡æ•°é‡Œè¿˜æ²¡åŠ 1ï¼›</p>
</li>
<li>
<p>å¦ä¸€ç§æ˜¯ï¼ŒæŸ¥åˆ°çš„100è¡Œç»“æœé‡Œæ²¡æœ‰æœ€æ–°æ’å…¥çš„è®°å½•ï¼Œè€ŒRedisçš„è®¡æ•°é‡Œå·²ç»åŠ äº†1ã€‚</p>
</li>
</ol><p>è¿™ä¸¤ç§æƒ…å†µï¼Œéƒ½æ˜¯é€»è¾‘ä¸ä¸€è‡´çš„ã€‚</p><p>æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹è¿™ä¸ªæ—¶åºå›¾ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/39/33/39898af053695dad37227d71ae288e33.png" alt=""></p><center><span class="reference">å›¾2 ä¼šè¯Aã€Bæ‰§è¡Œæ—¶åºå›¾</span></center><p>å›¾2ä¸­ï¼Œä¼šè¯Aæ˜¯ä¸€ä¸ªæ’å…¥äº¤æ˜“è®°å½•çš„é€»è¾‘ï¼Œå¾€æ•°æ®è¡¨é‡Œæ’å…¥ä¸€è¡ŒRï¼Œç„¶åRedisè®¡æ•°åŠ 1ï¼›ä¼šè¯Bå°±æ˜¯æŸ¥è¯¢é¡µé¢æ˜¾ç¤ºæ—¶éœ€è¦çš„æ•°æ®ã€‚</p><p>åœ¨å›¾2çš„è¿™ä¸ªæ—¶åºé‡Œï¼Œåœ¨T3æ—¶åˆ»ä¼šè¯Bæ¥æŸ¥è¯¢çš„æ—¶å€™ï¼Œä¼šæ˜¾ç¤ºå‡ºæ–°æ’å…¥çš„Rè¿™ä¸ªè®°å½•ï¼Œä½†æ˜¯Redisçš„è®¡æ•°è¿˜æ²¡åŠ 1ã€‚è¿™æ—¶å€™ï¼Œå°±ä¼šå‡ºç°æˆ‘ä»¬è¯´çš„æ•°æ®ä¸ä¸€è‡´ã€‚</p><p>ä½ ä¸€å®šä¼šè¯´ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ‰§è¡Œæ–°å¢è®°å½•é€»è¾‘æ—¶å€™ï¼Œæ˜¯å…ˆå†™æ•°æ®è¡¨ï¼Œå†æ”¹Redisè®¡æ•°ã€‚è€Œè¯»çš„æ—¶å€™æ˜¯å…ˆè¯»Redisï¼Œå†è¯»æ•°æ®è¡¨ï¼Œè¿™ä¸ªé¡ºåºæ˜¯ç›¸åçš„ã€‚é‚£ä¹ˆï¼Œå¦‚æœä¿æŒé¡ºåºä¸€æ ·çš„è¯ï¼Œæ˜¯ä¸æ˜¯å°±æ²¡é—®é¢˜äº†ï¼Ÿæˆ‘ä»¬ç°åœ¨æŠŠä¼šè¯Açš„æ›´æ–°é¡ºåºæ¢ä¸€ä¸‹ï¼Œå†çœ‹çœ‹æ‰§è¡Œç»“æœã€‚</p><p><img src="https://static001.geekbang.org/resource/image/5c/db/5c2f786beae1d8917cdc5033b7bf0bdb.png" alt=""></p><center><span class="reference">å›¾3 è°ƒæ•´é¡ºåºåï¼Œä¼šè¯Aã€Bçš„æ‰§è¡Œæ—¶åºå›¾</span></center><p>ä½ ä¼šå‘ç°ï¼Œè¿™æ—¶å€™åè¿‡æ¥äº†ï¼Œä¼šè¯Båœ¨T3æ—¶åˆ»æŸ¥è¯¢çš„æ—¶å€™ï¼ŒRedisè®¡æ•°åŠ äº†1äº†ï¼Œä½†è¿˜æŸ¥ä¸åˆ°æ–°æ’å…¥çš„Rè¿™ä¸€è¡Œï¼Œä¹Ÿæ˜¯æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚</p><p>åœ¨å¹¶å‘ç³»ç»Ÿé‡Œé¢ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•ç²¾ç¡®æ§åˆ¶ä¸åŒçº¿ç¨‹çš„æ‰§è¡Œæ—¶åˆ»çš„ï¼Œå› ä¸ºå­˜åœ¨å›¾ä¸­çš„è¿™ç§æ“ä½œåºåˆ—ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è¯´å³ä½¿Redisæ­£å¸¸å·¥ä½œï¼Œè¿™ä¸ªè®¡æ•°å€¼è¿˜æ˜¯é€»è¾‘ä¸Šä¸ç²¾ç¡®çš„ã€‚</p><h1>åœ¨æ•°æ®åº“ä¿å­˜è®¡æ•°</h1><p>æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œç”¨ç¼“å­˜ç³»ç»Ÿä¿å­˜è®¡æ•°æœ‰ä¸¢å¤±æ•°æ®å’Œè®¡æ•°ä¸ç²¾ç¡®çš„é—®é¢˜ã€‚é‚£ä¹ˆï¼Œ<strong>å¦‚æœæˆ‘ä»¬æŠŠè¿™ä¸ªè®¡æ•°ç›´æ¥æ”¾åˆ°æ•°æ®åº“é‡Œå•ç‹¬çš„ä¸€å¼ è®¡æ•°è¡¨Cä¸­ï¼Œåˆä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ</strong></p><p>é¦–å…ˆï¼Œè¿™è§£å†³äº†å´©æºƒä¸¢å¤±çš„é—®é¢˜ï¼ŒInnoDBæ˜¯æ”¯æŒå´©æºƒæ¢å¤ä¸ä¸¢æ•°æ®çš„ã€‚</p><blockquote>
<p>å¤‡æ³¨ï¼šå…³äºInnoDBçš„å´©æºƒæ¢å¤ï¼Œä½ å¯ä»¥å†å›é¡¾ä¸€ä¸‹ç¬¬2ç¯‡æ–‡ç« <a href="https://time.geekbang.org/column/article/68633">ã€Šæ—¥å¿—ç³»ç»Ÿï¼šä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿã€‹</a>ä¸­çš„ç›¸å…³å†…å®¹ã€‚</p>
</blockquote><p>ç„¶åï¼Œæˆ‘ä»¬å†çœ‹çœ‹èƒ½ä¸èƒ½è§£å†³è®¡æ•°ä¸ç²¾ç¡®çš„é—®é¢˜ã€‚</p><p>ä½ ä¼šè¯´ï¼Œè¿™ä¸ä¸€æ ·å—ï¼Ÿæ— éå°±æ˜¯æŠŠå›¾3ä¸­å¯¹Redisçš„æ“ä½œï¼Œæ”¹æˆäº†å¯¹è®¡æ•°è¡¨Cçš„æ“ä½œã€‚åªè¦å‡ºç°å›¾3çš„è¿™ç§æ‰§è¡Œåºåˆ—ï¼Œè¿™ä¸ªé—®é¢˜è¿˜æ˜¯æ— è§£çš„å§ï¼Ÿ</p><p>è¿™ä¸ªé—®é¢˜è¿˜çœŸä¸æ˜¯æ— è§£çš„ã€‚</p><p>æˆ‘ä»¬è¿™ç¯‡æ–‡ç« è¦è§£å†³çš„é—®é¢˜ï¼Œéƒ½æ˜¯ç”±äºInnoDBè¦æ”¯æŒäº‹åŠ¡ï¼Œä»è€Œå¯¼è‡´InnoDBè¡¨ä¸èƒ½æŠŠcount(*)ç›´æ¥å­˜èµ·æ¥ï¼Œç„¶åæŸ¥è¯¢çš„æ—¶å€™ç›´æ¥è¿”å›å½¢æˆçš„ã€‚</p><p>æ‰€è°“ä»¥å­ä¹‹çŸ›æ”»å­ä¹‹ç›¾ï¼Œç°åœ¨æˆ‘ä»¬å°±åˆ©ç”¨â€œäº‹åŠ¡â€è¿™ä¸ªç‰¹æ€§ï¼ŒæŠŠé—®é¢˜è§£å†³æ‰ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/9e/e3/9e4170e2dfca3524eb5e92adb8647de3.png" alt=""></p><center><span class="reference">å›¾4 ä¼šè¯Aã€Bçš„æ‰§è¡Œæ—¶åºå›¾</span></center><p>æˆ‘ä»¬æ¥çœ‹ä¸‹ç°åœ¨çš„æ‰§è¡Œç»“æœã€‚è™½ç„¶ä¼šè¯Bçš„è¯»æ“ä½œä»ç„¶æ˜¯åœ¨T3æ‰§è¡Œçš„ï¼Œä½†æ˜¯å› ä¸ºè¿™æ—¶å€™æ›´æ–°äº‹åŠ¡è¿˜æ²¡æœ‰æäº¤ï¼Œæ‰€ä»¥è®¡æ•°å€¼åŠ 1è¿™ä¸ªæ“ä½œå¯¹ä¼šè¯Bè¿˜ä¸å¯è§ã€‚</p><p>å› æ­¤ï¼Œä¼šè¯Bçœ‹åˆ°çš„ç»“æœé‡Œï¼Œ æŸ¥è®¡æ•°å€¼å’Œâ€œæœ€è¿‘100æ¡è®°å½•â€çœ‹åˆ°çš„ç»“æœï¼Œé€»è¾‘ä¸Šå°±æ˜¯ä¸€è‡´çš„ã€‚</p><h1>ä¸åŒçš„countç”¨æ³•</h1><p>åœ¨å‰é¢æ–‡ç« çš„è¯„è®ºåŒºï¼Œæœ‰åŒå­¦ç•™è¨€é—®åˆ°ï¼šåœ¨select count(?) from tè¿™æ ·çš„æŸ¥è¯¢è¯­å¥é‡Œé¢ï¼Œcount(*)ã€count(ä¸»é”®id)ã€count(å­—æ®µ)å’Œcount(1)ç­‰ä¸åŒç”¨æ³•çš„æ€§èƒ½ï¼Œæœ‰å“ªäº›å·®åˆ«ã€‚ä»Šå¤©è°ˆåˆ°äº†count(*)çš„æ€§èƒ½é—®é¢˜ï¼Œæˆ‘å°±å€Ÿæ­¤æœºä¼šå’Œä½ è¯¦ç»†è¯´æ˜ä¸€ä¸‹è¿™å‡ ç§ç”¨æ³•çš„æ€§èƒ½å·®åˆ«ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸‹é¢çš„è®¨è®ºè¿˜æ˜¯åŸºäºInnoDBå¼•æ“çš„ã€‚</p><p>è¿™é‡Œï¼Œé¦–å…ˆä½ è¦å¼„æ¸…æ¥šcount()çš„è¯­ä¹‰ã€‚count()æ˜¯ä¸€ä¸ªèšåˆå‡½æ•°ï¼Œå¯¹äºè¿”å›çš„ç»“æœé›†ï¼Œä¸€è¡Œè¡Œåœ°åˆ¤æ–­ï¼Œå¦‚æœcountå‡½æ•°çš„å‚æ•°ä¸æ˜¯NULLï¼Œç´¯è®¡å€¼å°±åŠ 1ï¼Œå¦åˆ™ä¸åŠ ã€‚æœ€åè¿”å›ç´¯è®¡å€¼ã€‚</p><p>æ‰€ä»¥ï¼Œcount(*)ã€count(ä¸»é”®id)å’Œcount(1) éƒ½è¡¨ç¤ºè¿”å›æ»¡è¶³æ¡ä»¶çš„ç»“æœé›†çš„æ€»è¡Œæ•°ï¼›è€Œcount(å­—æ®µï¼‰ï¼Œåˆ™è¡¨ç¤ºè¿”å›æ»¡è¶³æ¡ä»¶çš„æ•°æ®è¡Œé‡Œé¢ï¼Œå‚æ•°â€œå­—æ®µâ€ä¸ä¸ºNULLçš„æ€»ä¸ªæ•°ã€‚</p><p>è‡³äºåˆ†ææ€§èƒ½å·®åˆ«çš„æ—¶å€™ï¼Œä½ å¯ä»¥è®°ä½è¿™ä¹ˆå‡ ä¸ªåŸåˆ™ï¼š</p><ol>
<li>
<p>serverå±‚è¦ä»€ä¹ˆå°±ç»™ä»€ä¹ˆï¼›</p>
</li>
<li>
<p>InnoDBåªç»™å¿…è¦çš„å€¼ï¼›</p>
</li>
<li>
<p>ç°åœ¨çš„ä¼˜åŒ–å™¨åªä¼˜åŒ–äº†count(*)çš„è¯­ä¹‰ä¸ºâ€œå–è¡Œæ•°â€ï¼Œå…¶ä»–â€œæ˜¾è€Œæ˜“è§â€çš„ä¼˜åŒ–å¹¶æ²¡æœ‰åšã€‚</p>
</li>
</ol><p>è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¸€ä¸ªä¸ªåœ°æ¥çœ‹çœ‹ã€‚</p><p><strong>å¯¹äºcount(ä¸»é”®id)æ¥è¯´</strong>ï¼ŒInnoDBå¼•æ“ä¼šéå†æ•´å¼ è¡¨ï¼ŒæŠŠæ¯ä¸€è¡Œçš„idå€¼éƒ½å–å‡ºæ¥ï¼Œè¿”å›ç»™serverå±‚ã€‚serverå±‚æ‹¿åˆ°idåï¼Œåˆ¤æ–­æ˜¯ä¸å¯èƒ½ä¸ºç©ºçš„ï¼Œå°±æŒ‰è¡Œç´¯åŠ ã€‚</p><p><strong>å¯¹äºcount(1)æ¥è¯´</strong>ï¼ŒInnoDBå¼•æ“éå†æ•´å¼ è¡¨ï¼Œä½†ä¸å–å€¼ã€‚serverå±‚å¯¹äºè¿”å›çš„æ¯ä¸€è¡Œï¼Œæ”¾ä¸€ä¸ªæ•°å­—â€œ1â€è¿›å»ï¼Œåˆ¤æ–­æ˜¯ä¸å¯èƒ½ä¸ºç©ºçš„ï¼ŒæŒ‰è¡Œç´¯åŠ ã€‚</p><p>å•çœ‹è¿™ä¸¤ä¸ªç”¨æ³•çš„å·®åˆ«çš„è¯ï¼Œä½ èƒ½å¯¹æ¯”å‡ºæ¥ï¼Œcount(1)æ‰§è¡Œå¾—è¦æ¯”count(ä¸»é”®id)å¿«ã€‚å› ä¸ºä»å¼•æ“è¿”å›idä¼šæ¶‰åŠåˆ°è§£ææ•°æ®è¡Œï¼Œä»¥åŠæ‹·è´å­—æ®µå€¼çš„æ“ä½œã€‚</p><p><strong>å¯¹äºcount(å­—æ®µ)æ¥è¯´</strong>ï¼š</p><ol>
<li>
<p>å¦‚æœè¿™ä¸ªâ€œå­—æ®µâ€æ˜¯å®šä¹‰ä¸ºnot nullçš„è¯ï¼Œä¸€è¡Œè¡Œåœ°ä»è®°å½•é‡Œé¢è¯»å‡ºè¿™ä¸ªå­—æ®µï¼Œåˆ¤æ–­ä¸èƒ½ä¸ºnullï¼ŒæŒ‰è¡Œç´¯åŠ ï¼›</p>
</li>
<li>
<p>å¦‚æœè¿™ä¸ªâ€œå­—æ®µâ€å®šä¹‰å…è®¸ä¸ºnullï¼Œé‚£ä¹ˆæ‰§è¡Œçš„æ—¶å€™ï¼Œåˆ¤æ–­åˆ°æœ‰å¯èƒ½æ˜¯nullï¼Œè¿˜è¦æŠŠå€¼å–å‡ºæ¥å†åˆ¤æ–­ä¸€ä¸‹ï¼Œä¸æ˜¯nullæ‰ç´¯åŠ ã€‚</p>
</li>
</ol><p>ä¹Ÿå°±æ˜¯å‰é¢çš„ç¬¬ä¸€æ¡åŸåˆ™ï¼Œserverå±‚è¦ä»€ä¹ˆå­—æ®µï¼ŒInnoDBå°±è¿”å›ä»€ä¹ˆå­—æ®µã€‚</p><p><strong>ä½†æ˜¯count(*)æ˜¯ä¾‹å¤–</strong>ï¼Œå¹¶ä¸ä¼šæŠŠå…¨éƒ¨å­—æ®µå–å‡ºæ¥ï¼Œè€Œæ˜¯ä¸“é—¨åšäº†ä¼˜åŒ–ï¼Œä¸å–å€¼ã€‚count(*)è‚¯å®šä¸æ˜¯nullï¼ŒæŒ‰è¡Œç´¯åŠ ã€‚</p><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ ä¸€å®šä¼šè¯´ï¼Œä¼˜åŒ–å™¨å°±ä¸èƒ½è‡ªå·±åˆ¤æ–­ä¸€ä¸‹å—ï¼Œä¸»é”®idè‚¯å®šéç©ºå•Šï¼Œä¸ºä»€ä¹ˆä¸èƒ½æŒ‰ç…§count(*)æ¥å¤„ç†ï¼Œå¤šä¹ˆç®€å•çš„ä¼˜åŒ–å•Šã€‚</p><p>å½“ç„¶ï¼ŒMySQLä¸“é—¨é’ˆå¯¹è¿™ä¸ªè¯­å¥è¿›è¡Œä¼˜åŒ–ï¼Œä¹Ÿä¸æ˜¯ä¸å¯ä»¥ã€‚ä½†æ˜¯è¿™ç§éœ€è¦ä¸“é—¨ä¼˜åŒ–çš„æƒ…å†µå¤ªå¤šäº†ï¼Œè€Œä¸”MySQLå·²ç»ä¼˜åŒ–è¿‡count(*)äº†ï¼Œä½ ç›´æ¥ä½¿ç”¨è¿™ç§ç”¨æ³•å°±å¯ä»¥äº†ã€‚</p><p>æ‰€ä»¥ç»“è®ºæ˜¯ï¼šæŒ‰ç…§æ•ˆç‡æ’åºçš„è¯ï¼Œcount(å­—æ®µ)&lt;count(ä¸»é”®id)&lt;count(1)â‰ˆcount(*)ï¼Œæ‰€ä»¥æˆ‘å»ºè®®ä½ ï¼Œå°½é‡ä½¿ç”¨count(*)ã€‚</p><h1>å°ç»“</h1><p>ä»Šå¤©ï¼Œæˆ‘å’Œä½ èŠäº†èŠMySQLä¸­è·å¾—è¡¨è¡Œæ•°çš„ä¸¤ç§æ–¹æ³•ã€‚æˆ‘ä»¬æåˆ°äº†åœ¨ä¸åŒå¼•æ“ä¸­count(*)çš„å®ç°æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¹Ÿåˆ†æäº†ç”¨ç¼“å­˜ç³»ç»Ÿæ¥å­˜å‚¨è®¡æ•°å€¼å­˜åœ¨çš„é—®é¢˜ã€‚</p><p>å…¶å®ï¼ŒæŠŠè®¡æ•°æ”¾åœ¨Redisé‡Œé¢ï¼Œä¸èƒ½å¤Ÿä¿è¯è®¡æ•°å’ŒMySQLè¡¨é‡Œçš„æ•°æ®ç²¾ç¡®ä¸€è‡´çš„åŸå› ï¼Œæ˜¯<strong>è¿™ä¸¤ä¸ªä¸åŒçš„å­˜å‚¨æ„æˆçš„ç³»ç»Ÿï¼Œä¸æ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œæ— æ³•æ‹¿åˆ°ç²¾ç¡®ä¸€è‡´çš„è§†å›¾ã€‚</strong>è€ŒæŠŠè®¡æ•°å€¼ä¹Ÿæ”¾åœ¨MySQLä¸­ï¼Œå°±è§£å†³äº†ä¸€è‡´æ€§è§†å›¾çš„é—®é¢˜ã€‚</p><p>InnoDBå¼•æ“æ”¯æŒäº‹åŠ¡ï¼Œæˆ‘ä»¬åˆ©ç”¨å¥½äº‹åŠ¡çš„åŸå­æ€§å’Œéš”ç¦»æ€§ï¼Œå°±å¯ä»¥ç®€åŒ–åœ¨ä¸šåŠ¡å¼€å‘æ—¶çš„é€»è¾‘ã€‚è¿™ä¹Ÿæ˜¯InnoDBå¼•æ“å¤‡å—é’ççš„åŸå› ä¹‹ä¸€ã€‚</p><p>æœ€åï¼Œåˆåˆ°äº†ä»Šå¤©çš„æ€è€ƒé¢˜æ—¶é—´äº†ã€‚</p><p>åœ¨åˆšåˆšè®¨è®ºçš„æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬ç”¨äº†äº‹åŠ¡æ¥ç¡®ä¿è®¡æ•°å‡†ç¡®ã€‚ç”±äºäº‹åŠ¡å¯ä»¥ä¿è¯ä¸­é—´ç»“æœä¸è¢«åˆ«çš„äº‹åŠ¡è¯»åˆ°ï¼Œå› æ­¤ä¿®æ”¹è®¡æ•°å€¼å’Œæ’å…¥æ–°è®°å½•çš„é¡ºåºæ˜¯ä¸å½±å“é€»è¾‘ç»“æœçš„ã€‚ä½†æ˜¯ï¼Œä»å¹¶å‘ç³»ç»Ÿæ€§èƒ½çš„è§’åº¦è€ƒè™‘ï¼Œä½ è§‰å¾—åœ¨è¿™ä¸ªäº‹åŠ¡åºåˆ—é‡Œï¼Œåº”è¯¥å…ˆæ’å…¥æ“ä½œè®°å½•ï¼Œè¿˜æ˜¯åº”è¯¥å…ˆæ›´æ–°è®¡æ•°è¡¨å‘¢ï¼Ÿ</p><p>ä½ å¯ä»¥æŠŠä½ çš„æ€è€ƒå’Œè§‚ç‚¹å†™åœ¨ç•™è¨€åŒºé‡Œï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« çš„æœ«å°¾ç»™å‡ºæˆ‘çš„å‚è€ƒç­”æ¡ˆã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><h1>ä¸ŠæœŸé—®é¢˜æ—¶é—´</h1><p>ä¸ŠæœŸæˆ‘ç»™ä½ ç•™çš„é—®é¢˜æ˜¯ï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨alter table t engine=InnoDBä¼šè®©ä¸€ä¸ªè¡¨å ç”¨çš„ç©ºé—´åè€Œå˜å¤§ã€‚</p><p>åœ¨è¿™ç¯‡æ–‡ç« çš„è¯„è®ºåŒºé‡Œé¢ï¼Œå¤§å®¶éƒ½æåˆ°äº†ä¸€ä¸ªç‚¹ï¼Œå°±æ˜¯è¿™ä¸ªè¡¨ï¼Œæœ¬èº«å°±å·²ç»æ²¡æœ‰ç©ºæ´çš„äº†ï¼Œæ¯”å¦‚è¯´åˆšåˆšåšè¿‡ä¸€æ¬¡é‡å»ºè¡¨æ“ä½œã€‚</p><p>åœ¨DDLæœŸé—´ï¼Œå¦‚æœåˆšå¥½æœ‰å¤–éƒ¨çš„DMLåœ¨æ‰§è¡Œï¼Œè¿™æœŸé—´å¯èƒ½ä¼šå¼•å…¥ä¸€äº›æ–°çš„ç©ºæ´ã€‚</p><p>@é£ç¿” æåˆ°äº†ä¸€ä¸ªæ›´æ·±åˆ»çš„æœºåˆ¶ï¼Œæ˜¯æˆ‘ä»¬åœ¨æ–‡ç« ä¸­æ²¡è¯´çš„ã€‚åœ¨é‡å»ºè¡¨çš„æ—¶å€™ï¼ŒInnoDBä¸ä¼šæŠŠæ•´å¼ è¡¨å æ»¡ï¼Œæ¯ä¸ªé¡µç•™äº†1/16ç»™åç»­çš„æ›´æ–°ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶å®é‡å»ºè¡¨ä¹‹åä¸æ˜¯â€œæœ€â€ç´§å‡‘çš„ã€‚</p><p>å‡å¦‚æ˜¯è¿™ä¹ˆä¸€ä¸ªè¿‡ç¨‹ï¼š</p><ol>
<li>
<p>å°†è¡¨té‡å»ºä¸€æ¬¡ï¼›</p>
</li>
<li>
<p>æ’å…¥ä¸€éƒ¨åˆ†æ•°æ®ï¼Œä½†æ˜¯æ’å…¥çš„è¿™äº›æ•°æ®ï¼Œç”¨æ‰äº†ä¸€éƒ¨åˆ†çš„é¢„ç•™ç©ºé—´ï¼›</p>
</li>
<li>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œå†é‡å»ºä¸€æ¬¡è¡¨tï¼Œå°±å¯èƒ½ä¼šå‡ºç°é—®é¢˜ä¸­çš„ç°è±¡ã€‚</p>
</li>
</ol><p>è¯„è®ºåŒºç•™è¨€ç‚¹èµæ¿ï¼š</p><blockquote>
<p>@W_T ç­‰åŒå­¦æåˆ°äº†æ•°æ®è¡¨æœ¬èº«ç´§å‡‘çš„æƒ…å†µï¼›<br>
@undifined æäº†ä¸€ä¸ªå¥½é—®é¢˜ï¼Œ @å¸†å¸†å¸†å¸†å¸†å¸†å¸†å¸† åŒå­¦å›ç­”äº†è¿™ä¸ªé—®é¢˜ï¼›<br>
@é™ˆé£ @éƒœ @wang chen wen éƒ½æäº†å¾ˆä¸é”™çš„é—®é¢˜ï¼Œå¤§å®¶å¯ä»¥å»çœ‹çœ‹ã€‚</p>
</blockquote><p><img src="https://static001.geekbang.org/resource/image/09/77/09c1073f99cf71d2fb162a716b5fa577.jpg" alt=""></p>
                    </div>
                </div>

            </div>
            <div data-v-87ffcada="" class="article-comments pd"><h2 data-v-87ffcada=""><span
                    data-v-87ffcada="">ç²¾é€‰ç•™è¨€</span></h2>
                <ul data-v-87ffcada="">
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/61/57/6f3c81dd.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">é˜¿å»º</span>
                            </div>
                            <div class="bd">ä»å¹¶å‘ç³»ç»Ÿæ€§èƒ½çš„è§’åº¦è€ƒè™‘ï¼Œåº”è¯¥å…ˆæ’å…¥æ“ä½œè®°å½•ï¼Œå†æ›´æ–°è®¡æ•°è¡¨ã€‚<br><br>çŸ¥è¯†ç‚¹åœ¨ã€Šè¡Œé”åŠŸè¿‡ï¼šæ€ä¹ˆå‡å°‘è¡Œé”å¯¹æ€§èƒ½çš„å½±å“ï¼Ÿã€‹<br>å› ä¸ºæ›´æ–°è®¡æ•°è¡¨æ¶‰åŠåˆ°è¡Œé”çš„ç«äº‰ï¼Œå…ˆæ’å…¥å†æ›´æ–°èƒ½æœ€å¤§ç¨‹åº¦åœ°å‡å°‘äº†äº‹åŠ¡ä¹‹é—´çš„é”ç­‰å¾…ï¼Œæå‡äº†å¹¶å‘åº¦ã€‚ <br></div>
                            <span class="time">2018-12-14 01:44</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å¥½å‡ ä¸ªåŒå­¦è¯´å¯¹ï¼Œä½ ç¬¬ä¸€ä¸ªæ ‡æ˜å‡ºå¤„ğŸ‘ğŸ¿</p>
                                <p class="reply-time">2018-12-14 09:20</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å‘æ¡æ©™å­ ã€‚</span>
                            </div>
                            <div class="bd">è€å¸ˆ ï¼Œæˆ‘è¿™è¾¹æœ‰å‡ ä¸ªé—®é¢˜  ï¼š<br><br>1. çœ‹åˆ°è€å¸ˆå›å¤è¯„è®ºè¯´ count(id) ä¹Ÿæ˜¯èµ°æ™®é€šç´¢å¼• ï¼Œé‚£æ˜¯ä¸æ˜¯ä¹Ÿç®—æ˜¯ä¼˜åŒ–äº† ï¼Œ æˆ‘ä»¥ä¸º count(å­—æ®µ) æ˜¯èµ°çš„èšé›†ç´¢å¼• ã€‚è€å¸ˆçš„æ„æ€æ˜¯ count(å­—æ®µ) æ˜¯èµ°äºŒçº§ç´¢å¼•ï¼Œä½†æ˜¯ä¸ä¸€å®šæ˜¯æ•°æ®æœ€å°‘çš„ç´¢å¼•æ ‘çš„æ„æ€æ˜¯ä¹ˆ <br><br>2. count(*) çš„è¯ï¼Œ innodb è¿˜ä¼šæœ‰å–æ•°åˆ¤ç©ºè¿™æ ·çš„åˆ¤æ–­é€»è¾‘ä¹ˆ ï¼Œè¿˜æ˜¯ç›´æ¥å–è¡Œæ•° +1 äº† ï¼Œ è¿˜æ˜¯æŒ‰æ‰€å–ç´¢å¼•ç±»å‹åˆ†æƒ…å†µã€‚ å…è®¸ä¸º null çš„ç´¢å¼•æ˜¯ä¸æ˜¯è¡Œæ•°æ¯”è¾ƒå°‘ï¼Œ å–çš„æ€»æ•°ä¼šä¸ä¼šæœ‰é—®é¢˜å‘¢<br><br>3.  æˆ‘è¿™è¾¹è¯•äº†ä¸€ä¸‹ ï¼Œ åº“é‡Œæ€»å…± 30w æ•°æ® ã€‚ ç¬¬ä¸€æ¬¡ç”¨ count(*) æ˜¯ 120å¤šms , ç¬¬äºŒæ¬¡å°±æ˜¯ 60å¤š ms ã€‚ ç¬¬ä¸‰æ¬¡ç”¨äº† count(1) ï¼Œä¹Ÿæ˜¯60å¤šms ã€‚ è¯·é—® count(*) è¿™ä¸¤æ¬¡çš„å‰åæ—¶é—´å·®æ˜¯ä»€ä¹ˆåŸå› ï¼Œä¹Ÿä¼šèµ°ç¼“å­˜ ï¼Ÿ<br><br>4. å¦ä¸€ä¸ªé—®é¢˜æ˜¯ä¸€ä¸ªé¢˜å¤–è¯ ï¼Œæˆ‘çœ‹è€å¸ˆçš„ä¾‹å­äº‹åŠ¡çº§åˆ«åº”è¯¥éƒ½æ˜¯ rr ã€‚ æˆ‘å¶ç„¶çœ‹åˆ°æˆ‘ä»¬å…¬å¸äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯  rc ã€‚ æˆ‘æ¯”è¾ƒæƒŠè®¶ï¼Œå°±å»é—® DBA ä¸ºä»€ä¹ˆæ˜¯ rc è€Œä¸æ˜¯é»˜è®¤çš„ rr ã€‚ å¥¹è¯´ä¸€èˆ¬éƒ½æ˜¯ç”¨çš„ rc  ï¼Œæˆ‘æƒ³é—®ç°åœ¨å…¬å¸ä¸€èˆ¬éƒ½æ˜¯ rc ä¹ˆï¼Œ è¯·é—®è€å¸ˆç°åœ¨ç”¨çš„éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆ ï¼Ÿï¼Ÿ åœ¨æˆ‘çš„å°è±¡é‡Œ ï¼Œrr ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§ä¼šæ›´å¥½ä¸€äº›å§ ã€‚ æˆ‘google äº†ä¸€ä¸‹ï¼Œ rc ä¼šä¸ä¼šåœ¨æŸäº›åœºæ™¯ä¸‹å‡ºç°ä¸€äº›é—®é¢˜ï¼Œä½†æ˜¯æ²¡æœ‰æŸ¥å‡ºæ¥ç›¸å…³ç»“æœã€‚è€å¸ˆèƒ½ä¸èƒ½è®²è§£ä¸€ä¸‹ï¼Œrc çš„è¯ä¼šåœ¨å“ªäº›åœºæ™¯ä¸‹ä¼šè¸©å‘ä¹ˆ ã€‚ ï¼ˆæˆ‘ä¹‹å‰ç ä»£ç éƒ½æ˜¯æŒ‰ç…§ rr çº§åˆ«ä¸‹çš„æ€ç»´ç çš„ä»£ç ï¼‰ <br></div>
                            <span class="time">2018-12-15 15:32</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1. å¦‚æœæœ‰ç´¢å¼•ç”¨åˆ°è¿™ä¸ªå­—æ®µçš„è¯ï¼Œæ¯”è¾ƒå¤§å¯èƒ½ä¼šç”¨åˆ°è¿™ä¸ªç´¢å¼•ï¼Œæ¯”ä¸»é”®ç´¢å¼•å°<br><br>2. ç´¢å¼•å­—æ®µå°±ç®—æ˜¯NULLï¼Œä¸Šé¢çš„idä¹Ÿä¸æ˜¯çš„<br><br>3.  è¿›äº†Buffer pool çš„åŸå› å§<br><br>4. å—¯ï¼Œrcç”¨å¾—æŒºå¤šçš„ï¼Œä½†æ˜¯åŸå› å¯èƒ½åªæ˜¯å› ä¸ºâ€œä»¥å‰æ˜¯è¿™ä¹ˆç”¨çš„â€ã€‚ ä½¿ç”¨rcå¯èƒ½æœ‰é—®é¢˜ï¼Œä¹Ÿå¯èƒ½æ²¡é—®é¢˜ã€‚ä½†æ˜¯æˆ‘è§‰å¾—DBAä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™ä¹ˆé€‰ï¼Œè¿™ä¸ªæ˜¯é—®é¢˜ã€‚<br><br>rcæœ¬èº«çš„é—®é¢˜å…¶å®å‰é¢æˆ‘ä»¬è¯´è¿‡ä¸€äº›ï¼Œæ¯”å¦‚ä¸æ˜¯ä¸€è‡´æ€§è¯»ã€‚åé¢ä¹Ÿä¼šæœ‰æ–‡ç« è¯´åˆ°ã€‚</p>
                                <p class="reply-time">2018-12-15 18:20</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/34/5c/6b4757a0.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å€ªå¤§äºº</span>
                            </div>
                            <div class="bd">çœ‹åˆ°æœ‰åŒå­¦è¯´ä¼šè¯Aæ˜¯å¹»è¯»ï¼Œå…¶å®å›¾ä¸€çš„ä¼šè¯Bæ‰æ˜¯å¹»è¯»å§ï¼Ÿ <br></div>
                            <span class="time">2018-12-15 14:49</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¿™äº›éƒ½ä¸å«å¹»è¯»ï¼Œå¹»è¯»çš„æ„æ€æ˜¯â€œç”¨ä¸€ä¸ªäº‹åŠ¡é‡Œé¢ï¼Œåä¸€ä¸ªè¯·æ±‚çœ‹åˆ°çš„æ¯”ä¹‹å‰ç›¸åŒè¯·æ±‚çœ‹åˆ°çš„ï¼Œå¤šäº†è®°å½•å‡ºæ¥â€ã€‚<br>æ”¹äº†ä¸ç®—<br><br>å¤§å®¶å…³æ³¨ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚<br>å¥½é—®é¢˜<br></p>
                                <p class="reply-time">2018-12-15 18:24</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/76/93/c78a132a.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æœç„¶å¦‚æ­¤</span>
                            </div>
                            <div class="bd">ä¸€ã€è¯·é—®è®¡æ•°ç”¨è¿™ä¸ªMySQL+redisæ–¹æ¡ˆå¦‚ä½•ï¼š<br>1.å¼€å¯äº‹åŠ¡ï¼ˆç¨‹åºä¸­çš„äº‹åŠ¡ï¼‰<br>2.MySQLæ’å…¥æ•°æ®<br>3.åŸå­æ›´æ–°redisè®¡æ•°<br>4.å¦‚æœredisæ›´æ–°æˆåŠŸæäº¤äº‹åŠ¡ï¼Œå¦‚æœredisæ›´æ–°å¤±è´¥å›æ»šäº‹åŠ¡ã€‚<br><br>äºŒã€.netå’Œjavaç¨‹åºä»£ç çš„äº‹åŠ¡å’ŒMySQLäº‹åŠ¡æ˜¯ä»€ä¹ˆå…³ç³»ï¼Œæœ‰ä»€ä¹ˆç›¸å…³æ€§ï¼Ÿ <br></div>
                            <span class="time">2018-12-14 20:19</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1. å¥½é—®é¢˜ï¼Œä¸ä¼šè¿˜æ˜¯æ²¡è§£å†³æˆ‘ä»¬è¯´çš„ä¸€è‡´æ€§é—®é¢˜ã€‚å¦‚æœåœ¨3ã€4ä¹‹é—´æ’å…¥äº† Session Bçš„é€»è¾‘å‘¢<br><br>2. æˆ‘ä¼°è®¡å°±æ˜¯å¯åŠ¨äº‹åŠ¡ï¼ˆæ‰§è¡Œbegin),ç»“æŸæ—¶æäº¤ï¼ˆæ‰§è¡Œcommit)å§ï¼Œæ²¡æœ‰äº†è§£è¿‡æ‰€æœ‰æ¡†æ¶ï¼Œä¸ç¡®å®šå“ˆ</p>
                                <p class="reply-time">2018-12-15 20:19</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/21/30/8ecce1e1.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">åŒ—å¤©é­”ç‹¼</span>
                            </div>
                            <div class="bd">è€å¸ˆè¯´è¿‡ï¼šäº‹åŠ¡å¼€å¯åï¼Œæ›´æ–°æ“ä½œæ”¾åˆ°æœ€åã€‚è¾ƒå°‘é”ç­‰å¾…æ—¶é—´çš„å½±å“ <br></div>
                            <span class="time">2018-12-14 06:50</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/ba/48/c892a35b.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å´”æ ¹ç¦„</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼š<br>1.count(*) ä¸å–å€¼ï¼Œ<br>         InnoDBè¿˜åšéå†è¡¨çš„æ“ä½œå—ï¼Œä¹Ÿä¸ç”¨ç»™serverå±‚è¿”å›å€¼å—ï¼Ÿ<br>2.count(1) ä¸å–å€¼ï¼Œ<br>        ä½†æ˜¯è¦éå†è¡¨ã€‚åŸæ–‡ä¸­ï¼š<br>        â€œserver å±‚å¯¹äºè¿”å›çš„æ¯ä¸€è¡Œï¼Œæ”¾ä¸€ä¸ªæ•°å­—â€œ1â€è¿›å»â€<br>        è¿™ä¸ªâ€œè¿”å›çš„æ¯ä¸€è¡Œâ€ ï¼šåˆ°åº•è¿”å›çš„å•¥ï¼Ÿæ˜¯æ¯ä¸€è¡Œè®°å½•å—ï¼Ÿè¿˜æ˜¯å½¢å¼çš„è¿”å›ç©ºè¡Œï¼Œç„¶åç”¨1å¡«å……ï¼Ÿ<br><br>3. count(1),count(*),count(ä¸»é”®id)<br>       è¿™ä¸‰ä¸ªåšæ¯”è¾ƒï¼Œå“ªä¸ªä¼šå¿«ï¼Ÿæ—¶é—´æ¶ˆè€—åœ¨å“ªä¸ªç¯èŠ‚ï¼Ÿ<br>      æ˜¯å¦éå†è¡¨ï¼›æ˜¯å¦å–å€¼ï¼›è¿”å›ç»™serverå±‚å†…å®¹    ç»†èŠ‚ä¸Šä»å“ªä¸ªè§’åº¦è€ƒè™‘ï¼Ÿ<br>          <br></div>
                            <span class="time">2018-12-14 18:19</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æŸã€äºº</span>
                            </div>
                            <div class="bd">è€å¸ˆæˆ‘å…ˆé—®ä¸ªæœ¬ç« ä¹‹å¤–çš„é—®é¢˜:<br>1.rræ¨¡å¼ä¸‹,ä¸€å¼ è¡¨ä¸Šæ²¡æœ‰ä¸»é”®å’Œå”¯ä¸€é”®,æœ‰äºŒçº§ç´¢å¼•c.å¦‚æœæ˜¯ä¸€å¼ å¤§è¡¨,åˆ é™¤ä¸€æ¡æ•°æ®delete t where c=1.<br>åœ¨ä¸»åº“ä¸Šåˆ©ç”¨äºŒçº§ç´¢å¼•,åœ¨æ ¹æ®è™šæ‹Ÿçš„ä¸»é”®åˆ—å›è¡¨åˆ é™¤è¿˜æŒºå¿«.ä½†æ˜¯åœ¨å¤‡åº“ä¸Šå›æ”¾ç‰¹åˆ«æ…¢,è€Œä¸”çŠ¶æ€æ˜¯system lock,æ˜¯å› ä¸ºbinlog eventé‡Œæ²¡æœ‰åŒ…å«è™šæ‹Ÿä¸»é”®åˆ—.å¯¼è‡´åœ¨å¤‡åº“å›æ”¾çš„æ—¶å€™,å¿…é¡»å…¨è¡¨æ‰«æ,è€—æ—¶ç‰¹åˆ«ä¹…?è¿˜æ˜¯å…¶ä»–åŸå› <br><br>2.å›æ”¾è¿‡ç¨‹ä¸­,åœ¨å¤‡åº“deleteä¸€æ¡è¯­å¥æ˜¯è¢«é˜»å¡çš„,insertåˆæ˜¯å¯ä»¥çš„,è¯´æ˜åªåœ¨è®°å½•ä¸Šçš„Xé”æ²¡æœ‰gapé”ã€‚<br>ä½†æ˜¯å¦‚æœåœ¨ä¸»åº“session A begin,delete where c=1.åœ¨å¼€å¯ä¸€ä¸ªsession B,åœ¨ä¸»åº“ä¸Šæ“ä½œä¹Ÿæ˜¯deleteé˜»å¡,insertæ­£å¸¸.ä¸è¿‡ç­‰session Aæ‰§è¡Œå®Œæˆ,ä¸æäº¤.insertéƒ½é˜»å¡äº†,è¯´æ˜æœ€åä¸Šäº†gapé”ã€‚æœ‰ç‚¹æ²¡æ˜ç™½è¿™å„¿çš„ä¸Šé”é€»è¾‘æ˜¯ä»€ä¹ˆï¼Ÿ<br><br>3.è¿˜æœ‰å°±æ˜¯å¤‡åº“å›æ”¾binlog,ç›¸å¯¹äºä¸»åº“çš„ä¸€æ¡updateè¯­å¥æµç¨‹æ¥è¯´,ä»åº“å›æ”¾å“ªäº›æµç¨‹æ˜¯çœç•¥äº†çš„å•Š,<br>serverå±‚çš„åº”è¯¥éƒ½çœç•¥äº†,åº”è¯¥ä¸»è¦æ˜¯å¼•æ“å±‚çš„å›æ”¾,è¿™é‡Œæœ‰ç‚¹æ¨¡ç³Šä»åº“æ˜¯æ€ä¹ˆå›æ”¾çš„binlog event?<br>å› ä¸ºç¬¬ä¸€ä¸ªé—®é¢˜ä»åº“å›æ”¾çš„æ—¶å€™,ä»åº“ä¸Šçš„äºŒçº§ç´¢å¼•è²Œä¼¼æ²¡èµ·ä½œç”¨,ç›´æ¥å°±åœ¨èšç°‡ç´¢å¼•ä¸Šåšçš„æ›´æ–°ã€‚<br><br>æ„Ÿè°¢è€å¸ˆ <br></div>
                            <span class="time">2018-12-14 15:10</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1. å¯¹ï¼Œè¿™ä¸ªæ˜¯ä¸ªbug, ä»åº“ä¸Šä¼šå…¨è¡¨æ‰«æã€‚MariaDB çš„ç‰ˆæœ¬æœ‰è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç”Ÿäº§ä¸Šæˆ‘ä»¬æœ€å¥½ä¸å…è®¸æ²¡æœ‰ä¸»é”®çš„è¡¨<br><br>2. æŒ‰ç…§ä½ é—®çš„,gapé”æ²¡é—®é¢˜äº†ã€‚delete è¢«é”æ˜¯å› ä¸ºè¡Œé”å§ã€‚ä»åº“é‡æ”¾å°±æ˜¯å› ä¸ºèµ°å…¨è¡¨æ‰«ææŒ‰è¡Œé”ä¸‹æ¥è§¦å‘çš„<br><br>3. å‡ºç°è¿™ä¸ªé—®é¢˜è‚¯å®šæ˜¯binlogè®¾ç½®äº†rowæ ¼å¼ã€‚<br>è¿™æ ·binlogé‡Œé¢æœ‰æ‰€æœ‰å€¼ã€‚å¦‚æœä½ æœ‰ä¸»é”®çš„è¯ï¼Œå°±æ˜¯ä¸»é”®æŸ¥ï¼Œæ²¡æœ‰çš„è¯â€¦å°±æ˜¯å…¨è¡¨äº†</p>
                                <p class="reply-time">2018-12-14 15:28</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/ea/9a/02d589f9.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æ–œé¢é•œå­ Bill</span>
                            </div>
                            <div class="bd">å…ˆæ’å…¥æ“ä½œçºªå½•ï¼Œå†æ›´æ–°è®¡æ•°è¡¨ï¼Œå› ä¸ºè®¡æ•°è¡¨ç›¸å½“äºçƒ­ç‚¹è¡Œï¼ŒåŠ é”æ—¶é—´éœ€è¦è€ƒè™‘è¶³å¤ŸçŸ­ï¼ <br></div>
                            <span class="time">2018-12-14 13:08</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æŸã€äºº</span>
                            </div>
                            <div class="bd">è°ˆè°ˆè‡ªå·±çš„ç†è§£,æœ‰ä¸å¯¹ä¹‹å¤„è¿˜è¯·è€å¸ˆæŒ‡å‡º:<br>æ•°æ®ä¸€è‡´æ€§é—®é¢˜ç›®å‰æ¥è¯´ä¸»è¦åˆ†ä¸ºä¸‰ç±»<br>1.ä¸»ä»ä¸ä¸€è‡´<br>è§£å†³åŠæ³•:åŠåŒæ­¥å¤åˆ¶after_commit,after_sync,MGR(after_prepare)ã€‚ä½†æ˜¯éƒ½ä¸èƒ½å®Œæˆæ»¡è¶³å®Œå…¨å®æ—¶ä¸€è‡´,ç”±äºç­‰å¾…çš„ackç‚¹ä¸åŒ,ç›¸å¯¹æ¥è¯´ä¸€è‡´æ€§çš„å¼ºåº¦æ˜¯é€’å¢.<br>2.æ•°æ®åº“ä¸ç¼“å­˜çš„ä¸ä¸€è‡´<br>è§£å†³åŠæ³•:è¯»æ“ä½œç›´æ¥è¯»ç¼“å­˜,å†™æ“ä½œå…ˆæ›´æ–°åˆ°æ•°æ®åº“,æ·˜æ±°ç¼“å­˜(ç¨‹åºéœ€è¦ä¿è¯ä¸¤ä¸ªæ“ä½œçš„åŸå­æ€§).ç”±äºè¯¥keyçš„ç¼“å­˜å·²ç»æ¸…ç†æ‰,é‚£ä¹ˆä¸‹æ¬¡è¯»çš„æ—¶å€™éœ€è¦å…ˆè¯»æ•°æ®åº“,åœ¨é‡å»ºç¼“å­˜.<br>ç”±äºredisæ˜¯å•çº¿ç¨‹,ä¿è¯äº†ä¸€ä¸ªæ“ä½œçš„åŸå­æ€§.å¯ä»¥é€šè¿‡è®¾ç½®appendfsync alwaysæ¥ä¿è¯æ¯æ¬¡æ“ä½œéƒ½æŠŠè¯¥æ“ä½œè®°å½•å¹¶è½ç›˜åˆ°aofæ–‡ä»¶é‡Œ(ä¸è¿‡ä¸€èˆ¬redisè¯¥å€¼ä¸ºeverysec),æ¯•ç«Ÿä½¿ç”¨redisçš„ç›®çš„ä¸æ˜¯ä¸ºäº†ä¿è¯acid.è¿˜æ˜¯è¦æ ¹æ®ä¸šåŠ¡æ¥é€‰æ‹©<br>3.ä¸€ä¸ªäº‹åŠ¡è·¨å¤šä¸ªèŠ‚ç‚¹æˆ–è€…å¤šç§æ•°æ®åº“(åˆ†åº“åˆ†è¡¨å’Œé“¶è¡Œè½¬è´¦è¿™ç§ä¾‹å­)<br>ç›®å‰å¥½åƒéƒ½æ˜¯é€šè¿‡2pc,3pcæ¥ä¿è¯çš„ã€‚<br><br>count(å­—æ®µå€¼):å¦‚æœè¯¥å­—æ®µä¸Šæœ‰nullå€¼.æ¯è¡Œçš„è¡Œå¤´æœ‰ä¸€ä¸ªæ ‡è®°ä½,æ ‡è®°è¯¥è¡Œæ˜¯å¦ä¸ºnull.æ‰€ä»¥å¤šäº†ä¸€å±‚åˆ¤æ–­ã€‚ç›¸å¯¹æ›´è€—æ—¶<br>count(ä¸»é”®id):å³ä¾¿æ˜¯é€‰æ‹©çš„æœ‰nullå€¼çš„äºŒçº§ç´¢å¼•,ä½†æ˜¯ä¹Ÿå¯ä»¥æŒºå¿«çš„æ­£ç¡®è®¡æ•°ã€‚å› ä¸ºnullçš„è¯å­—æ®µå€¼è™½ç„¶ä¸ºnull,ä½†æ˜¯è¯¥è¡Œä¸Šä¸»é”®idä»¥åŠæŒ‡å‘èšç°‡ç´¢å¼•è¯¥idçš„æŒ‡é’ˆè¿˜æ˜¯å­˜åœ¨çš„,æ‰€ä»¥ä¸å½±å“è®¡æ•°,ä¹Ÿä¸ç”¨åšåˆ¤æ–­,ç›´æ¥éå†è¯¥äºŒçº§ç´¢å¼•,å–å‡ºidå€¼,æŒ‰è¡Œç´¯åŠ å°±è¡Œã€‚<br>count(1)å’Œcount(*):çœ‹å®˜æ–¹æ–‡æ¡£ä¸Šè¯´æ˜¯5.7.18ç‰ˆæœ¬ä¹‹å‰æ˜¯æ‰«æèšç°‡ç´¢å¼•,ä¹‹åæ˜¯äºŒçº§ç´¢å¼•ã€‚è™½ç„¶ä¸å–å€¼,åªè®¡æ•°ã€‚ä½†æ˜¯äºŒçº§ç´¢å¼•æ¯”èšç°‡ç´¢å¼•éœ€è¦æ‰«æçš„é¡µæ•°ç›¸å¯¹æ¥è¯´æ›´å°‘,è¿™åº”è¯¥ä¹Ÿæ˜¯ä¸€ç§ä¼˜åŒ–,ä¸è¿‡æˆ‘åšæµ‹è¯•perconaç‰ˆæœ¬çš„5.6éƒ½æ˜¯é€‰æ‹©äº†äºŒçº§ç´¢å¼•<br>è¿™æœŸå¹²è´§æŒºå¤šçš„,å­¦ä¼šäº†å¦‚æœæŸè¡¨ä¸Šæœ‰countæ¯”è¾ƒå¤šçš„æ“ä½œ,æœ€å¥½æ˜¯ç”¨count(1)æˆ–è€…count(*),ç„¶åé€‰æ‹©ä¸€åˆ—å ç”¨å­—èŠ‚æ•°æœ€å°‘çš„å»ºç«‹ç´¢å¼•(æ¯”å¦‚tinyintç±»å‹)<br><br>è¿˜æœ‰ä¸ªé—®é¢˜è¯·æ•™ä¸‹è€å¸ˆ:<br>1.å¦‚æœæŸåˆ—è®¾ç½®ä¸ºnot nullå»ºç«‹ç´¢å¼•.é‚£ä¹ˆæ˜¯ä¸æ˜¯count(id)èµ°è¯¥ç´¢å¼•å’Œcount(è¯¥åˆ—)æ•ˆç‡æ˜¯ä¸æ˜¯ä¸€æ ·çš„ï¼Ÿéƒ½ä¸ç”¨åšåˆ¤æ–­,ä¸¤è€…éƒ½æ˜¯éœ€è¦æŠŠæ•´ä¸ªäºŒçº§ç´¢å¼•ä¼ ç»™serverå±‚è®¡æ•°?è¿˜æ˜¯è¯´count(id)åªéœ€è¦ä¼ id,è€Œcount(å­—æ®µ)åªéœ€è¦ä¼ å­—æ®µå€¼ç»™serverå±‚åšè®¡æ•°ï¼Ÿ <br></div>
                            <span class="time">2018-12-16 14:32</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/d4/f3/b73d8abf.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">ä¸‰æœ¨å­</span>
                            </div>
                            <div class="bd">ä¸€ç›´ä»¥ä¸ºå¸¦*æŸ¥è¯¢æ•ˆç‡æ˜¯æœ€å·®çš„ï¼Œå¹³æ—¶æŸ¥è¯¢ç‰¹æ„åŠ äº† count(ID) æŸ¥è¯¢ã€‚ç½ªè¿‡å•Šã€‚ <br></div>
                            <span class="time">2018-12-15 15:26</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ˜„ æ¥å¾—åŠæ¥å¾—åŠ</p>
                                <p class="reply-time">2018-12-15 18:21</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è§è§æœ¨å¶</span>
                            </div>
                            <div class="bd">æ­ªä¸ªæ¥¼è¯·æ•™ä¸ªä¸šåŠ¡ä¸­é‡åˆ°çš„é—®é¢˜ï¼š<br>è¡¨ç»“æ„å¦‚ä¸‹ï¼š<br> CREATE TABLE `tablename` (<br>  `id` int(10) NOT NULL AUTO_INCREMENT,<br>  `uid` bigint(20) NOT NULL DEFAULT &#39;0&#39;,<br>  `status` tinyint(1) NOT NULL DEFAULT &#39;1&#39; ,<br>  `date` varchar(8) NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;æ—¥æœŸ&#39;,<br>  `source` varchar(20) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;æ¥æº&#39;,<br>  `ctime` datetime NOT NULL DEFAULT &#39;0000-00-00 00:00:00&#39; COMMENT &#39;åˆ›å»ºæ—¶é—´&#39;,<br>  `etime` datetime NOT NULL DEFAULT &#39;0000-00-00 00:00:00&#39; COMMENT &#39;æ›´æ–°æ—¶é—´&#39;,<br>  PRIMARY KEY (`id`),<br>  UNIQUE KEY `idx_uid_date` (`uid`,`date`),<br>  KEY `idx_ctime` (`ctime`)<br>) ENGINE=InnoDB AUTO_INCREMENT=685725 DEFAULT CHARSET=utf8<br><br>å…¶ä¸­ UNIQUE KEY `idx_uid_date` (`uid`,`date`)<br><br>æŸ¥è¯¢æŒ‡å®šdateä¸‹uidä¸ªæ•°ï¼š<br>æ–¹å¼ä¸€ï¼šselect count(uid) from tablename where date = &#39;20181201&#39;;<br>+------------+<br>| count(uid) |<br>+------------+<br>|       8330 |<br>+------------+<br>æ–¹å¼äºŒï¼šselect count(distinct uid) from tablename where date = &#39;20181201&#39;;<br>+---------------------+<br>| count(distinct uid) |<br>+---------------------+<br>|                8243         <br>+---------------------+<br>æ–¹å¼ä¸‰ï¼š<br>select count(*) from (select distinct uid from tablename where date = &#39;20181201&#39;) as t;<br>+----------+<br>| count(*) |<br>+----------+<br>|     8330 |<br>+----------+<br>ä¸æ–¹å¼ä¸€æŸ¥è¯¢ç»“æœä¸€è‡´<br><br>é—®é¢˜ï¼šä¸ºä½•æ–¹å¼äºŒå’Œæ–¹å¼ä¸€ã€ä¸‰çš„ç»“æœä¸ä¸€æ ·å‘¢ï¼Ÿ <br></div>
                            <span class="time">2018-12-26 14:54</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/e7/56/87f45704.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Bin</span>
                            </div>
                            <div class="bd">ç­”ï¼šå…ˆæ’å…¥æ“ä½œè®°å½•ï¼Œå†æ›´æ–°è®¡æ•°è¡¨ã€‚<br>       åœ¨InnoDBäº‹åŠ¡ä¸­ï¼Œè¡Œé”æ˜¯åœ¨éœ€è¦çš„æ—¶å€™æ‰åŠ ä¸Š, ç­‰åˆ°äº‹åŠ¡ç»“æŸ(commit)çš„æ—¶å€™æ‰é‡Šæ”¾ã€‚<br>       æ¡ˆä¾‹ä¸­çš„æ›´æ–°æ“ä½œå¾ˆå¤šæ—¶å€™éƒ½æ˜¯æ›´æ–°åŒä¸€ä¸ªæ•°æ®å¯¹è±¡, å¦‚æœæ˜¯å…ˆæ›´æ–°è®¡æ•°è¡¨ï¼Œé‚£ä¹ˆæŒæœ‰çš„é”æ—¶é—´ä¼šæ›´é•¿. <br></div>
                            <span class="time">2018-12-14 18:34</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/e8/45/c58cb283.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¸†å¸†å¸†å¸†å¸†å¸†å¸†å¸†</span>
                            </div>
                            <div class="bd">å¦‚æœå­—æ®µä¸Šæœ‰ç´¢å¼•ï¼Œä¸”å­—æ®µéç©ºï¼Œcount(å­—æ®µ)çš„æ•ˆç‡å°±ä¸æ˜¯æœ€å·®çš„äº†å§ã€‚ <br></div>
                            <span class="time">2018-12-14 09:31</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¿˜æ˜¯çš„ã€‚<br><br>æ³¨æ„ï¼šcount(id)ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨æ™®é€šç´¢å¼•çš„</p>
                                <p class="reply-time">2018-12-14 12:46</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/cb/f8/f4adadcb.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">é™ˆå¤©å¢ƒ</span>
                            </div>
                            <div class="bd">ç¢°åˆ°å¤§éƒ¨åˆ†æƒ…å½¢éƒ½æ˜¯å¸¦æ¡ä»¶æŸ¥è¯¢çš„count,ï¼Œè¿™ä¸ªæ€ä¹ˆè§£ï¼Ÿ <br></div>
                            <span class="time">2018-12-14 08:54</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ç´¢å¼•æ¡ä»¶è¿‡æ»¤å®Œåè¿˜å¤šå°‘è¡Œï¼Ÿå¦‚æœè¡Œæ•°å°‘ï¼ˆå‡ ç™¾è¡Œï¼Ÿï¼‰å°±æ²¡å…³ç³»ç›´æ¥æ‰§è¡Œäº†</p>
                                <p class="reply-time">2018-12-14 09:05</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://thirdwx.qlogo.cn/mmopen/vi_32/77Dr13EtDbXyBcuvvJ1BNR41nIhT8BxHMk2y1qrKRghoRKSSt0icrT0Hko0SUnlJkzcQcGqZSlSavuZNazYogGg/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Ivy</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæ–‡ç« ä¸­åå¤å¼ºè°ƒä¸å–å€¼ï¼Œè¿™æ˜¯ä»€ä¹ˆæ¦‚å¿µå‘¢ï¼Ÿå¼•æ“ä¸å–å€¼serveræ€ä¹ˆæ‹¿åˆ°æ•°æ®åˆæ€ä¹ˆè®¡æ•°å‘¢ï¼Ÿèƒ½ä¸èƒ½å¤§æ¦‚è§£é‡Šä¸€ä¸‹å¼•æ“è¯»å–æ•°æ®è¿”å›ç»™serverçš„è¿‡ç¨‹å‘€ï¼Ÿ <br></div>
                            <span class="time">2019-01-04 10:42</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å°±æ˜¯è¿”å›ä¸€ä¸ªç©ºè¡Œï¼Œä½†æ˜¯é«˜åº¦serverå±‚â€œä¸æ˜¯ç©ºå€¼ï¼Œå¯ä»¥è®¡æ•°â€<br><br>è¿‡ç¨‹ä¸Šï¼Œå…¶å®æ˜¯serverå±‚è°ƒç”¨å¼•æ“æ¥å£ï¼Œä¸€è¡Œä¸€è¡Œå–</p>
                                <p class="reply-time">2019-01-04 11:06</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://thirdwx.qlogo.cn/mmopen/vi_32/77Dr13EtDbXyBcuvvJ1BNR41nIhT8BxHMk2y1qrKRghoRKSSt0icrT0Hko0SUnlJkzcQcGqZSlSavuZNazYogGg/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Ivy</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œä½ å¥½ï¼Œ<br>å¦‚æœè¿™ä¸ªâ€œå­—æ®µâ€æ˜¯å®šä¹‰ä¸º not null çš„è¯ï¼Œä¸€è¡Œè¡Œåœ°ä»è®°å½•é‡Œé¢è¯»å‡ºè¿™ä¸ªå­—æ®µï¼Œåˆ¤æ–­ä¸èƒ½ä¸º nullï¼ŒæŒ‰è¡Œç´¯åŠ ï¼›<br>è¿™æ®µè¯æ²¡è¯»æ‡‚ï¼Œæ—¢ç„¶å·²ç»çŸ¥é“not nullä¸ºä½•è¿˜è¦å†æ¬¡åˆ¤æ–­ä¸èƒ½ä¸º nullï¼Ÿç›´æ¥è¯»å‡ºæ¥ç´¯åŠ ä¸å°±å¯ä»¥äº†å—ï¼Ÿå¦å¤–æ˜¯å¦æˆ‘å¯¹å¼•æ“å±‚é¢çš„æ•°æ®è¯»å–æœ‰è¯¯è§£ï¼Œæ˜¯å¦è¯´æ— è®ºä½¿ç”¨å“ªç§ count æ–¹å¼ï¼Œå¼•æ“éƒ½ä¸€å®šè¦é€è¡Œå»è¯»åªæ˜¯åœ¨æ˜¯å¦ä½¿ç”¨ç´¢å¼•å’Œæ˜¯å¦è¿”å›ç»™serverå±‚å…·ä½“æ•°æ®çš„åŒºåˆ«ï¼Ÿ <br></div>
                            <span class="time">2019-01-04 10:33</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å—¯ï¼Œæˆ‘çš„çœ‹æ³•è·Ÿä½ ä¸€æ ·ï¼Œä¸è¿‡MySQL ç°åœ¨å°±æ˜¯è¿™ä¹ˆåšçš„ğŸ˜“</p>
                                <p class="reply-time">2019-01-04 11:42</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/7e/36/7c5503d9.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¯‚å¯çº¢å°˜</span>
                            </div>
                            <div class="bd">æ’å…¥æ•°æ®çš„æ—¶å€™åŠ å…¥åˆ†å¸ƒå¼é”ï¼Œäº‹åŠ¡å®Œæˆåä¸”redisåŠ ä¸€åå†é‡Šæ”¾é”ï¼›è·å–è®¡æ•°çš„æ—¶å€™ä¹ŸåŒæ ·è·å–ç›¸åŒçš„åˆ†å¸ƒå¼é”ã€‚è¿™æ ·æ˜¯ä¸æ˜¯èƒ½è§£å†³redisè®¡æ•°ä¸å‡†ç¡®çš„é—®é¢˜ã€‚ <br></div>
                            <span class="time">2018-12-30 10:53</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¿˜æ˜¯ä¸è¡Œå“¦ã€‚ä½ çœ‹ä¸€ä¸‹æˆ‘ä»¬ä¾‹å­ä¸­çš„åœºæ™¯</p>
                                <p class="reply-time">2018-12-30 20:03</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Ruian</span>
                            </div>
                            <div class="bd">è€å¸ˆæ‚¨å¥½ï¼Œä¸Šæ¬¡æˆ‘è¿™è¾¹é—®äº†æ‚¨ä¸€ä¸ªé—®é¢˜ï¼Œæ‚¨è¿™è¾¹åšäº†å›å¤ï¼Œæˆ‘è¿™è¾¹åšäº†è¡¥å……å’Œå›ç­”ï¼Œå¹¶æœ‰æ–°çš„ç–‘æƒ‘ï¼Œå†æ¬¡è¯·æ•™ä¸‹è€å¸ˆã€‚ã€‚<br><br>è€å¸ˆï¼Œæˆ‘æœ‰ä¸€ä¸ªé—®é¢˜è¯·æ•™ä¸‹æ‚¨ã€‚æˆ‘çš„mysqlæ•°æ®åº“ æœ‰ä¸€å¼ è¡¨project_des (850ä¸‡æ•°æ®) count(1) åªè¦0.05s å’Œä»è¡¨projectï¼ˆ6500æ¡æ•°æ®ï¼‰å…³è”åéœ€è¦15s æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’å‘ç°éƒ½èµ°ç´¢å¼•äº†ã€‚ä¸çŸ¥é“ä¸ºå•¥è¿™ä¹ˆæ…¢ï¼Ÿ<br>æŸ¥è¯¢è¯­å¥ select count(1) from project_des a,project b where a.project_id=b.id æˆ‘æ¢exists å’Œin ä¹Ÿè¿™ä¹ˆæ…¢<br>2018-12-28<br>î˜ˆ ä½œè€…å›å¤<br>ä½ è¿™ä¸ªæ˜¯ç¬›å¡å°”ç§¯è‚¯å®šæ…¢çš„â€¦ä½ çš„ä¸šåŠ¡éœ€æ±‚æ˜¯å•¥ï¼Œè¿™ä¸ªè¯­å¥çš„ä¸šåŠ¡æ„ä¹‰æ˜¯ä»€ä¹ˆ<br><br>ç­”ï¼šä¸šåŠ¡éœ€æ±‚æ˜¯è¿™æ ·çš„ï¼Œé¡µé¢éœ€è¦æ˜¾ç¤ºå‡ºä¸¤å¼ è¡¨å…³è”åçš„æŸäº›å­—æ®µï¼Œè¿˜éœ€è¦æ˜¾ç¤ºå…³è”åçš„æ€»æ•°ã€‚<br>      è€å¸ˆä¸Šé¢è¯´ç¬›å¡å°”ç§¯è‚¯å®šæ˜¯æ…¢çš„ï¼Œæˆ‘è¿™è¾¹æŠŠæ•°æ®å¯¼å…¥oracleæ•°æ®åº“åšäº†æ¯”è¾ƒã€‚ç»“æœå¦‚ä¸‹ï¼š<br>       è¯·æ•™è€å¸ˆmysqlä¸ºå•¥ä¼šæ¯”è¾ƒæ…¢ï¼Œè·Ÿå“ªäº›å› ç´ æœ‰å…³ï¼Ÿ<br><br><br><br>mysql ç¯å¢ƒä¸‹<br>select count(*) from project; --11616æ¡è®°å½•  0.045s<br>select count(*) from project_des; --3712995æ¡è®°å½•  0.045s<br>select count(*) from project_des a, project b where a.project_id=b.id  --3152651æ¡è®°å½•  17.71s<br>select count(*) from project_des a where a.project_id in (select b.id from project b where a.project_id=b.id) --3152651æ¡è®°å½•  17.66s<br>select count(*) from project_des a where  exists(select 1 from project b where a.project_id=b.id)  --3152651æ¡è®°å½•  42.06s<br><br><br>oracle ç¯å¢ƒä¸‹<br>select count(*) from project; --11616æ¡è®°å½•  0.04s<br>select count(*) from project_des; --3712995æ¡è®°å½•  0.16s<br>select count(*) from project_des a, project b where a.project_id=b.id  --3152651æ¡è®°å½•  0.82s<br>select count(*) from project_des a where a.project_id in (select b.id from project b where a.project_id=b.id) --3152651æ¡è®°å½•  0.93s<br>select count(*) from project_des a where  exists(select 1 from project b where a.project_id=b.id)  --3152651æ¡è®°å½•  0.91s <br></div>
                            <span class="time">2018-12-29 14:50</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/1d/b5/971261fd.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">alias cd=rm -rf</span>
                            </div>
                            <div class="bd">å…ˆæ’å…¥ï¼Œåœ¨æ›´æ–°ã€‚å› ä¸ºæ›´æ–°ä¼šé”æ•°æ®å½±å“æ€§èƒ½ <br></div>
                            <span class="time">2018-12-29 08:58</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å¯¹çš„</p>
                                <p class="reply-time">2018-12-29 09:13</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Ruian</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæˆ‘æœ‰ä¸€ä¸ªé—®é¢˜è¯·æ•™ä¸‹æ‚¨ã€‚æˆ‘çš„mysqlæ•°æ®åº“ æœ‰ä¸€å¼ è¡¨project_des (850ä¸‡æ•°æ®) count(1) åªè¦0.05s   å’Œä»è¡¨projectï¼ˆ6500æ¡æ•°æ®ï¼‰å…³è”åéœ€è¦15s       æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’å‘ç°éƒ½èµ°ç´¢å¼•äº†ã€‚ä¸çŸ¥é“ä¸ºå•¥è¿™ä¹ˆæ…¢ï¼Ÿ<br>æŸ¥è¯¢è¯­å¥ select count(1) from project_des a,project b where a.project_id=b.id æˆ‘æ¢exists å’Œin ä¹Ÿè¿™ä¹ˆæ…¢ <br></div>
                            <span class="time">2018-12-28 15:19</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ä½ è¿™ä¸ªæ˜¯ç¬›å¡å°”ç§¯è‚¯å®šæ…¢çš„â€¦ä½ çš„ä¸šåŠ¡éœ€æ±‚æ˜¯å•¥ï¼Œè¿™ä¸ªè¯­å¥çš„ä¸šåŠ¡æ„ä¹‰æ˜¯ä»€ä¹ˆ</p>
                                <p class="reply-time">2018-12-28 18:58</p>
                            </div>
                            
                        </div>
                    </li>
                    


                </ul>
            </div>
        </div>
    </div>
</div>
</body>
</html>