<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <style type="text/css">

#watermark {

  position: relative;
  overflow: hidden;
}

#watermark .x {
  position: absolute;
  top: 800;
  left: 400;
  color: #3300ff;
  font-size: 50px;
  pointer-events: none;
  opacity:0.3;
  filter:Alpha(opacity=50);
  
  
}
    </style>


    <style type="text/css">
 html{color:#333;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;text-rendering:optimizelegibility;font-family:Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif}html.borderbox *,html.borderbox :after,html.borderbox :before{box-sizing:border-box}article,aside,blockquote,body,button,code,dd,details,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hr,input,legend,li,menu,nav,ol,p,pre,section,td,textarea,th,ul{margin:0;padding:0}article,aside,details,figcaption,figure,footer,header,menu,nav,section{display:block}audio,canvas,video{display:inline-block}body,button,input,select,textarea{font:300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}table{border-collapse:collapse;border-spacing:0}fieldset,img{border:0}blockquote{position:relative;color:#999;font-weight:400;border-left:1px solid #1abc9c;padding-left:1em;margin:1em 3em 1em 2em}@media only screen and (max-width:640px){blockquote{margin:1em 0}}abbr,acronym{border-bottom:1px dotted;font-variant:normal}abbr{cursor:help}del{text-decoration:line-through}address,caption,cite,code,dfn,em,th,var{font-style:normal;font-weight:400}ol,ul{list-style:none}caption,th{text-align:left}q:after,q:before{content:""}sub,sup{font-size:75%;line-height:0;position:relative}:root sub,:root sup{vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}a{color:#1abc9c}a:hover{text-decoration:underline}.typo a{border-bottom:1px solid #1abc9c}.typo a:hover{border-bottom-color:#555;color:#555}.typo a:hover,a,ins{text-decoration:none}.typo-u,u{text-decoration:underline}mark{background:#fffdd1;border-bottom:1px solid #ffedce;padding:2px;margin:0 5px}code,pre,pre tt{font-family:Courier,Courier New,monospace}pre{background:hsla(0,0%,97%,.7);border:1px solid #ddd;padding:1em 1.5em;display:block;-webkit-overflow-scrolling:touch}hr{border:none;border-bottom:1px solid #cfcfcf;margin-bottom:.8em;height:10px}.typo-small,figcaption,small{font-size:.9em;color:#888}b,strong{font-weight:700;color:#000}[draggable]{cursor:move}.clearfix:after,.clearfix:before{content:"";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.textwrap,.textwrap td,.textwrap th{word-wrap:break-word;word-break:break-all}.textwrap-table{table-layout:fixed}.serif{font-family:Palatino,Optima,Georgia,serif}.typo-dl,.typo-form,.typo-hr,.typo-ol,.typo-p,.typo-pre,.typo-table,.typo-ul,.typo dl,.typo form,.typo hr,.typo ol,.typo p,.typo pre,.typo table,.typo ul,blockquote{margin-bottom:1rem}h1,h2,h3,h4,h5,h6{font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;line-height:1.35}.typo-h1,.typo-h2,.typo-h3,.typo-h4,.typo-h5,.typo-h6,.typo h1,.typo h2,.typo h3,.typo h4,.typo h5,.typo h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}.typo-h1,.typo h1{font-size:2em}.typo-h2,.typo h2{font-size:1.8em}.typo-h3,.typo h3{font-size:1.6em}.typo-h4,.typo h4{font-size:1.4em}.typo-h5,.typo-h6,.typo h5,.typo h6{font-size:1.2em}.typo-ul,.typo ul{margin-left:1.3em;list-style:disc}.typo-ol,.typo ol{list-style:decimal;margin-left:1.9em}.typo-ol ol,.typo-ol ul,.typo-ul ol,.typo-ul ul,.typo li ol,.typo li ul{margin-bottom:.8em;margin-left:2em}.typo-ol ul,.typo-ul ul,.typo li ul{list-style:circle}.typo-table td,.typo-table th,.typo table caption,.typo table td,.typo table th{border:1px solid #ddd;padding:.5em 1em;color:#666}.typo-table th,.typo table th{background:#fbfbfb}.typo-table thead th,.typo table thead th{background:hsla(0,0%,95%,.7)}.typo table caption{border-bottom:none}.typo-input,.typo-textarea{-webkit-appearance:none;border-radius:0}.typo-em,.typo em,caption,legend{color:#000;font-weight:inherit}.typo-em{position:relative}.typo-em:after{position:absolute;top:.65em;left:0;width:100%;overflow:hidden;white-space:nowrap;content:"\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"}.typo img{max-width:100%}.common-content{font-weight:400;color:#353535;line-height:1.75rem;white-space:normal;word-break:normal;font-size:1rem}.common-content img{display:block;max-width:100%;background-color:#eee}.common-content audio,.common-content video{width:100%;background-color:#eee}.common-content center,.common-content font{margin-top:1rem;display:inline-block}.common-content center{width:100%}.common-content pre{margin-top:1rem;padding-left:0;padding-right:0;position:relative;overflow:hidden}.common-content pre code{font-size:.8rem;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;display:block;width:100%;box-sizing:border-box;padding-left:1rem;padding-right:1rem;overflow-x:auto}.common-content hr{border:none;margin-top:1.5rem;margin-bottom:1.5rem;border-top:1px solid #f5f5f5;height:1px;background:none}.common-content b,.common-content h1,.common-content h2,.common-content h3,.common-content h4,.common-content h5,.common-content strong{font-weight:700}.common-content h1,.common-content h2{font-size:1.125rem;margin-bottom:.45rem}.common-content h3,.common-content h4,.common-content h5{font-size:1rem;margin-bottom:.45rem}.common-content p{font-weight:400;color:#353535;margin-top:.15rem}.common-content .orange{color:#ff5a05}.common-content .reference{font-size:1rem;color:#888}.custom-rich-content h1{margin-top:0;font-weight:400;font-size:15.25px;border-bottom:1px solid #eee;line-height:2.8}.custom-rich-content li,.custom-rich-content p{font-size:14px;color:#888;line-height:1.6}table.hljs-ln{margin-bottom:0;border-spacing:0;border-collapse:collapse}table.hljs-ln,table.hljs-ln tbody,table.hljs-ln td,table.hljs-ln tr{box-sizing:border-box}table.hljs-ln td{padding:0;border:0}table.hljs-ln td.hljs-ln-numbers{min-width:15px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;cursor:pointer;user-select:none}table.hljs-ln td.hljs-ln-code,table.hljs-ln td.hljs-ln-numbers{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;line-height:20px;vertical-align:top}table.hljs-ln td.hljs-ln-code{position:relative;padding-right:10px;padding-left:10px;overflow:visible;color:#24292e;word-wrap:normal;white-space:pre}video::-webkit-media-controls{overflow:hidden!important}video::-webkit-media-controls-enclosure{width:calc(100% + 32px);margin-left:auto}.button-cancel{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel,.button-primary{-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary{color:#fff;background-color:#ff5a05;border-radius:3px}@font-face{font-family:iconfont;src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot);src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.woff) format("woff"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.ttf) format("truetype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.svg#iconfont) format("svg")}@font-face{font-family:player-font;src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot);src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.woff) format("woff"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.ttf) format("truetype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.svg#player-font) format("svg")}.iconfont{font-family:iconfont!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;-moz-osx-font-smoothing:grayscale}html{background:#fff;min-height:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{width:100%}body.fixed{overflow:hidden;position:fixed;width:100vw;height:100vh}i{font-style:normal}a{word-wrap:break-word;-webkit-tap-highlight-color:rgba(0,0,0,0)}a:hover{text-decoration:none}.fade-enter-active,.fade-leave-active{transition:opacity .3s}.fade-enter,.fade-leave-to{opacity:0}.MathJax,.MathJax_CHTML,.MathJax_MathContainer,.MathJax_MathML,.MathJax_PHTML,.MathJax_PlainSource,.MathJax_SVG{outline:0}.ios-app-switch .js-audit{display:none}._loading_wrap_{position:fixed;width:100vw;height:100vh;top:50%;left:50%;transform:translate(-50%,-50%);z-index:999}._loading_div_class_,._loading_wrap_{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._loading_div_class_{word-wrap:break-word;padding:.5rem .75rem;text-align:center;z-index:9999;font-size:.6rem;max-width:60%;color:#fff;border-radius:.25rem;-ms-flex-direction:column;flex-direction:column}._loading_div_class_ .message{color:#353535;font-size:16px;line-height:3}.spinner{animation:circle-rotator 1.4s linear infinite}.spinner *{line-height:0;box-sizing:border-box}@keyframes circle-rotator{0%{transform:rotate(0deg)}to{transform:rotate(270deg)}}.path{stroke-dasharray:187;stroke-dashoffset:0;transform-origin:center;animation:circle-dash 1.4s ease-in-out infinite,circle-colors 5.6s ease-in-out infinite}@keyframes circle-colors{0%{stroke:#ff5a05}to{stroke:#ff5a05}}@keyframes circle-dash{0%{stroke-dashoffset:187}50%{stroke-dashoffset:46.75;transform:rotate(135deg)}to{stroke-dashoffset:187;transform:rotate(450deg)}}.confirm-box-wrapper,.confirm-box-wrapper .mask{position:absolute;top:0;left:0;right:0;bottom:0}.confirm-box-wrapper .mask{background:rgba(0,0,0,.6)}.confirm-box-wrapper .confirm-box{position:fixed;top:50%;left:50%;width:267px;background:#fff;transform:translate(-50%,-50%);border-radius:7px}.confirm-box-wrapper .confirm-box .head{margin:0 18px;font-size:18px;text-align:center;line-height:65px;border-bottom:1px solid #d9d9d9}.confirm-box-wrapper .confirm-box .body{padding:18px;padding-bottom:0;color:#353535;font-size:12.5px;max-height:150px;overflow:auto}.confirm-box-wrapper .confirm-box .foot{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;padding:18px}.confirm-box-wrapper .confirm-box .foot .button-cancel{border:1px solid #d9d9d9}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}




    </style>
    <style type="text/css">
        .button-cancel[data-v-87ffcada]{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel[data-v-87ffcada],.button-primary[data-v-87ffcada]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary[data-v-87ffcada]{color:#fff;background-color:#ff5a05;border-radius:3px}.pd[data-v-87ffcada]{padding-left:1.375rem;padding-right:1.375rem}.article[data-v-87ffcada]{max-width:70rem;margin:0 auto}.article .article-unavailable[data-v-87ffcada]{color:#fa8919;font-size:15px;font-weight:600;line-height:24px;border-radius:5px;padding:12px;background-color:#f6f7fb;margin-top:20px}.article .article-unavailable .iconfont[data-v-87ffcada]{font-size:12px}.article .main[data-v-87ffcada]{padding:1.25rem 0;margin-bottom:52px}.article-title[data-v-87ffcada]{color:#353535;font-weight:400;line-height:1.65rem;font-size:1.34375rem}.article-info[data-v-87ffcada]{color:#888;font-size:.9375rem;margin-top:1.0625rem}.article-content[data-v-87ffcada]{margin-top:1.0625rem}.article-content.android video[data-v-87ffcada]::-webkit-media-controls-fullscreen-button{display:none}.copyright[data-v-87ffcada]{color:#b2b2b2;padding-bottom:20px;margin-top:20px;font-size:13px}.audio-player[data-v-87ffcada]{width:100%;margin:20px 0}.to-comment[data-v-87ffcada]{overflow:hidden;padding-top:10px;margin-bottom:-30px}.to-comment a.button-primary[data-v-87ffcada]{float:right;height:20px;font-size:12px;line-height:20px;padding:4px 8px;cursor:pointer}.article-comments[data-v-87ffcada]{margin-top:2rem}.article-comments h2[data-v-87ffcada]{text-align:center;color:#888;position:relative;z-index:1;margin-bottom:1rem}.article-comments h2[data-v-87ffcada]:before{border-top:1px dotted #888;content:"";position:absolute;top:56%;left:0;width:100%;z-index:-1}.article-comments h2 span[data-v-87ffcada]{font-size:15.25px;font-weight:400;padding:0 1rem;background:#fff;display:inline-block}.article-sub-bottom[data-v-87ffcada]{z-index:10;cursor:pointer}.switch-btns[data-v-87ffcada]{height:76px;cursor:pointer;padding-top:24px;padding-bottom:24px;border-bottom:10px solid #f6f7fb;position:relative}.switch-btns[data-v-87ffcada]:before{content:" ";height:1px;background:#e8e8e8;position:absolute;top:0;left:0;-webkit-box-sizing:border-box;box-sizing:border-box;left:1.375rem;right:1.375rem}.switch-btns .btn[data-v-87ffcada]{height:38px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.switch-btns .btn .tag[data-v-87ffcada]{-webkit-box-flex:0;-ms-flex:0 0 62px;flex:0 0 62px;text-align:center;color:#888;font-size:14px;border-radius:10px;height:22px;line-height:22px;background:#f6f7fb;font-weight:400}.switch-btns .btn .txt[data-v-87ffcada]{margin-left:10px;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:#888;font-size:15px;height:22px;line-height:22px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400}@media (max-width:769px){.article .breadcrumb[data-v-87ffcada]{padding-top:10px;padding-bottom:10px}}





    </style>

    <style type="text/css">
        .comment-item{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:1rem}.comment-item a{border-bottom:none}.comment-item .avatar{width:2.625rem;height:2.625rem;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}.comment-item .info{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.comment-item .info .hd{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .username{color:#888;font-size:15.25px;font-weight:400;line-height:1.2}.comment-item .info .hd .control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .control .btn-share{color:#888;font-size:.75rem;margin-right:1rem}.comment-item .info .hd .control .btn-praise{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:15.25px;text-decoration:none}.comment-item .info .hd .control .btn-praise i{color:#888;display:inline-block;font-size:.75rem;margin-right:.3rem;margin-top:-.01rem}.comment-item .info .hd .control .btn-praise i.on,.comment-item .info .hd .control .btn-praise span{color:#ff5a05}.comment-item .info .bd{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6}.comment-item .info .time{color:#888;font-size:9px;line-height:1}.comment-item .info .reply .reply-hd{font-size:15.25px}.comment-item .info .reply .reply-hd span{margin-left:-12px;color:#888;font-weight:400}.comment-item .info .reply .reply-hd i{color:#ff5a05;font-size:15.25px}.comment-item .info .reply .reply-content{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all}.comment-item .info .reply .reply-time{color:#888;font-size:9px}




    </style>
</head>
<body>
<div id="app">


    <div data-v-87ffcada="" class="article" id="watermark">
        <div data-v-87ffcada="" class="main main-app">
            <h1 data-v-87ffcada="" class="article-title pd">
                12è®²ä¸ºä»€ä¹ˆæˆ‘çš„MySQLä¼šâ€œæŠ–â€ä¸€ä¸‹
            </h1>
            <div data-v-87ffcada="" class="article-content typo common-content pd"><img data-v-87ffcada=""
                                                                                        src="https://static001.geekbang.org/resource/image/cb/b5/cbca9c8c9a3b46ea297863f4ac9d20b5.jpg">

                <div>
                    <audio controls="controls" height="100" width="100">
                        <source src="12è®²ä¸ºä»€ä¹ˆæˆ‘çš„MySQLä¼šâ€œæŠ–â€ä¸€ä¸‹.mp3" type="audio/mp3" />
                        <embed height="100" width="100" src="12è®²ä¸ºä»€ä¹ˆæˆ‘çš„MySQLä¼šâ€œæŠ–â€ä¸€ä¸‹.mp3" />
                    </audio>
                </div>
                <div data-v-87ffcada="" id="article-content" class="">
                    <div class="text">
                        <p>å¹³æ—¶çš„å·¥ä½œä¸­ï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™æ ·çš„åœºæ™¯ï¼Œä¸€æ¡SQLè¯­å¥ï¼Œæ­£å¸¸æ‰§è¡Œçš„æ—¶å€™ç‰¹åˆ«å¿«ï¼Œä½†æ˜¯æœ‰æ—¶ä¹Ÿä¸çŸ¥é“æ€ä¹ˆå›äº‹ï¼Œå®ƒå°±ä¼šå˜å¾—ç‰¹åˆ«æ…¢ï¼Œå¹¶ä¸”è¿™æ ·çš„åœºæ™¯å¾ˆéš¾å¤ç°ï¼Œå®ƒä¸åªéšæœºï¼Œè€Œä¸”æŒç»­æ—¶é—´è¿˜å¾ˆçŸ­ã€‚</p><p>çœ‹ä¸Šå»ï¼Œè¿™å°±åƒæ˜¯æ•°æ®åº“â€œæŠ–â€äº†ä¸€ä¸‹ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ä¸€èµ·æ¥çœ‹ä¸€çœ‹è¿™æ˜¯ä»€ä¹ˆåŸå› ã€‚</p><h1>ä½ çš„SQLè¯­å¥ä¸ºä»€ä¹ˆå˜â€œæ…¢â€äº†</h1><p>åœ¨å‰é¢ç¬¬2ç¯‡æ–‡ç« <a href="https://time.geekbang.org/column/article/68633">ã€Šæ—¥å¿—ç³»ç»Ÿï¼šä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿã€‹</a>ä¸­ï¼Œæˆ‘ä¸ºä½ ä»‹ç»äº†WALæœºåˆ¶ã€‚ç°åœ¨ä½ çŸ¥é“äº†ï¼ŒInnoDBåœ¨å¤„ç†æ›´æ–°è¯­å¥çš„æ—¶å€™ï¼Œåªåšäº†å†™æ—¥å¿—è¿™ä¸€ä¸ªç£ç›˜æ“ä½œã€‚è¿™ä¸ªæ—¥å¿—å«ä½œredo logï¼ˆé‡åšæ—¥å¿—ï¼‰ï¼Œä¹Ÿå°±æ˜¯ã€Šå­”ä¹™å·±ã€‹é‡Œå’¸äº¨é…’åº—æŒæŸœç”¨æ¥è®°è´¦çš„ç²‰æ¿ï¼Œåœ¨æ›´æ–°å†…å­˜å†™å®Œredo logåï¼Œå°±è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæœ¬æ¬¡æ›´æ–°æˆåŠŸã€‚</p><p>åšä¸‹ç±»æ¯”çš„è¯ï¼ŒæŒæŸœè®°è´¦çš„è´¦æœ¬æ˜¯æ•°æ®æ–‡ä»¶ï¼Œè®°è´¦ç”¨çš„ç²‰æ¿æ˜¯æ—¥å¿—æ–‡ä»¶ï¼ˆredo logï¼‰ï¼ŒæŒæŸœçš„è®°å¿†å°±æ˜¯å†…å­˜ã€‚</p><p>æŒæŸœæ€»è¦æ‰¾æ—¶é—´æŠŠè´¦æœ¬æ›´æ–°ä¸€ä¸‹ï¼Œè¿™å¯¹åº”çš„å°±æ˜¯æŠŠå†…å­˜é‡Œçš„æ•°æ®å†™å…¥ç£ç›˜çš„è¿‡ç¨‹ï¼Œæœ¯è¯­å°±æ˜¯flushã€‚åœ¨è¿™ä¸ªflushæ“ä½œæ‰§è¡Œä¹‹å‰ï¼Œå­”ä¹™å·±çš„èµŠè´¦æ€»é¢ï¼Œå…¶å®è·ŸæŒæŸœæ‰‹ä¸­è´¦æœ¬é‡Œé¢çš„è®°å½•æ˜¯ä¸ä¸€è‡´çš„ã€‚å› ä¸ºå­”ä¹™å·±ä»Šå¤©çš„èµŠè´¦é‡‘é¢è¿˜åªåœ¨ç²‰æ¿ä¸Šï¼Œè€Œè´¦æœ¬é‡Œçš„è®°å½•æ˜¯è€çš„ï¼Œè¿˜æ²¡æŠŠä»Šå¤©çš„èµŠè´¦ç®—è¿›å»ã€‚</p><p><strong>å½“å†…å­˜æ•°æ®é¡µè·Ÿç£ç›˜æ•°æ®é¡µå†…å®¹ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªå†…å­˜é¡µä¸ºâ€œè„é¡µâ€ã€‚å†…å­˜æ•°æ®å†™å…¥åˆ°ç£ç›˜åï¼Œå†…å­˜å’Œç£ç›˜ä¸Šçš„æ•°æ®é¡µçš„å†…å®¹å°±ä¸€è‡´äº†ï¼Œç§°ä¸ºâ€œå¹²å‡€é¡µâ€</strong>ã€‚</p><!-- [[[read_end]]] --><p>ä¸è®ºæ˜¯è„é¡µè¿˜æ˜¯å¹²å‡€é¡µï¼Œéƒ½åœ¨å†…å­˜ä¸­ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œå†…å­˜å¯¹åº”çš„å°±æ˜¯æŒæŸœçš„è®°å¿†ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªç¤ºæ„å›¾æ¥å±•ç¤ºä¸€ä¸‹â€œå­”ä¹™å·±èµŠè´¦â€çš„æ•´ä¸ªæ“ä½œè¿‡ç¨‹ã€‚å‡è®¾åŸæ¥å­”ä¹™å·±æ¬ è´¦10æ–‡ï¼Œè¿™æ¬¡åˆè¦èµŠ9æ–‡ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/34/da/349cfab9e4f5d2a75e07b2132a301fda.jpeg" alt=""></p><center><span class="reference">å›¾1 â€œå­”ä¹™å·±èµŠè´¦â€æ›´æ–°å’Œflushè¿‡ç¨‹</span></center><p>å›åˆ°æ–‡ç« å¼€å¤´çš„é—®é¢˜ï¼Œä½ ä¸éš¾æƒ³è±¡ï¼Œå¹³æ—¶æ‰§è¡Œå¾ˆå¿«çš„æ›´æ–°æ“ä½œï¼Œå…¶å®å°±æ˜¯åœ¨å†™å†…å­˜å’Œæ—¥å¿—ï¼Œè€ŒMySQLå¶å°”â€œæŠ–â€ä¸€ä¸‹çš„é‚£ä¸ªç¬é—´ï¼Œå¯èƒ½å°±æ˜¯åœ¨åˆ·è„é¡µï¼ˆflushï¼‰ã€‚</p><p>é‚£ä¹ˆï¼Œä»€ä¹ˆæƒ…å†µä¼šå¼•å‘æ•°æ®åº“çš„flushè¿‡ç¨‹å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬è¿˜æ˜¯ç»§ç»­ç”¨å’¸äº¨é…’åº—æŒæŸœçš„è¿™ä¸ªä¾‹å­ï¼Œæƒ³ä¸€æƒ³ï¼šæŒæŸœåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šæŠŠç²‰æ¿ä¸Šçš„èµŠè´¦è®°å½•æ”¹åˆ°è´¦æœ¬ä¸Šï¼Ÿ</p><ul>
<li>ç¬¬ä¸€ç§åœºæ™¯æ˜¯ï¼Œç²‰æ¿æ»¡äº†ï¼Œè®°ä¸ä¸‹äº†ã€‚è¿™æ—¶å€™å¦‚æœå†æœ‰äººæ¥èµŠè´¦ï¼ŒæŒæŸœå°±åªå¾—æ”¾ä¸‹æ‰‹é‡Œçš„æ´»å„¿ï¼Œå°†ç²‰æ¿ä¸Šçš„è®°å½•æ“¦æ‰ä¸€äº›ï¼Œç•™å‡ºç©ºä½ä»¥ä¾¿ç»§ç»­è®°è´¦ã€‚å½“ç„¶åœ¨æ“¦æ‰ä¹‹å‰ï¼Œä»–å¿…é¡»å…ˆå°†æ­£ç¡®çš„è´¦ç›®è®°å½•åˆ°è´¦æœ¬ä¸­æ‰è¡Œã€‚<br>
è¿™ä¸ªåœºæ™¯ï¼Œå¯¹åº”çš„å°±æ˜¯InnoDBçš„redo logå†™æ»¡äº†ã€‚è¿™æ—¶å€™ç³»ç»Ÿä¼šåœæ­¢æ‰€æœ‰æ›´æ–°æ“ä½œï¼ŒæŠŠcheckpointå¾€å‰æ¨è¿›ï¼Œredo logç•™å‡ºç©ºé—´å¯ä»¥ç»§ç»­å†™ã€‚æˆ‘åœ¨ç¬¬äºŒè®²ç”»äº†ä¸€ä¸ªredo logçš„ç¤ºæ„å›¾ï¼Œè¿™é‡Œæˆ‘æ”¹æˆç¯å½¢ï¼Œä¾¿äºå¤§å®¶ç†è§£ã€‚</li>
</ul><p><img src="https://static001.geekbang.org/resource/image/a2/e5/a25bdbbfc2cfc5d5e20690547fe7f2e5.jpg" alt=""></p><center><span class="reference">å›¾2 redo logçŠ¶æ€å›¾</span></center><p>checkpointå¯ä¸æ˜¯éšä¾¿å¾€å‰ä¿®æ”¹ä¸€ä¸‹ä½ç½®å°±å¯ä»¥çš„ã€‚æ¯”å¦‚å›¾2ä¸­ï¼ŒæŠŠcheckpointä½ç½®ä»CPæ¨è¿›åˆ°CPâ€™ï¼Œå°±éœ€è¦å°†ä¸¤ä¸ªç‚¹ä¹‹é—´çš„æ—¥å¿—ï¼ˆæµ…ç»¿è‰²éƒ¨åˆ†ï¼‰ï¼Œå¯¹åº”çš„æ‰€æœ‰è„é¡µéƒ½flushåˆ°ç£ç›˜ä¸Šã€‚ä¹‹åï¼Œå›¾ä¸­ä»write posåˆ°CPâ€™ä¹‹é—´å°±æ˜¯å¯ä»¥å†å†™å…¥çš„redo logçš„åŒºåŸŸã€‚</p><ul>
<li>
<p>ç¬¬äºŒç§åœºæ™¯æ˜¯ï¼Œè¿™ä¸€å¤©ç”Ÿæ„å¤ªå¥½ï¼Œè¦è®°ä½çš„äº‹æƒ…å¤ªå¤šï¼ŒæŒæŸœå‘ç°è‡ªå·±å¿«è®°ä¸ä½äº†ï¼Œèµ¶ç´§æ‰¾å‡ºè´¦æœ¬æŠŠå­”ä¹™å·±è¿™ç¬”è´¦å…ˆåŠ è¿›å»ã€‚<br>
è¿™ç§åœºæ™¯ï¼Œå¯¹åº”çš„å°±æ˜¯ç³»ç»Ÿå†…å­˜ä¸è¶³ã€‚å½“éœ€è¦æ–°çš„å†…å­˜é¡µï¼Œè€Œå†…å­˜ä¸å¤Ÿç”¨çš„æ—¶å€™ï¼Œå°±è¦æ·˜æ±°ä¸€äº›æ•°æ®é¡µï¼Œç©ºå‡ºå†…å­˜ç»™åˆ«çš„æ•°æ®é¡µä½¿ç”¨ã€‚å¦‚æœæ·˜æ±°çš„æ˜¯â€œè„é¡µâ€ï¼Œå°±è¦å…ˆå°†è„é¡µå†™åˆ°ç£ç›˜ã€‚<br>
ä½ ä¸€å®šä¼šè¯´ï¼Œè¿™æ—¶å€™éš¾é“ä¸èƒ½ç›´æ¥æŠŠå†…å­˜æ·˜æ±°æ‰ï¼Œä¸‹æ¬¡éœ€è¦è¯·æ±‚çš„æ—¶å€™ï¼Œä»ç£ç›˜è¯»å…¥æ•°æ®é¡µï¼Œç„¶åæ‹¿redo logå‡ºæ¥åº”ç”¨ä¸å°±è¡Œäº†ï¼Ÿè¿™é‡Œå…¶å®æ˜¯ä»æ€§èƒ½è€ƒè™‘çš„ã€‚å¦‚æœåˆ·è„é¡µä¸€å®šä¼šå†™ç›˜ï¼Œå°±ä¿è¯äº†æ¯ä¸ªæ•°æ®é¡µæœ‰ä¸¤ç§çŠ¶æ€ï¼š</p>
<ul>
<li>ä¸€ç§æ˜¯å†…å­˜é‡Œå­˜åœ¨ï¼Œå†…å­˜é‡Œå°±è‚¯å®šæ˜¯æ­£ç¡®çš„ç»“æœï¼Œç›´æ¥è¿”å›ï¼›</li>
<li>å¦ä¸€ç§æ˜¯å†…å­˜é‡Œæ²¡æœ‰æ•°æ®ï¼Œå°±å¯ä»¥è‚¯å®šæ•°æ®æ–‡ä»¶ä¸Šæ˜¯æ­£ç¡®çš„ç»“æœï¼Œè¯»å…¥å†…å­˜åè¿”å›ã€‚<br>
è¿™æ ·çš„æ•ˆç‡æœ€é«˜ã€‚</li>
</ul>
</li>
<li>
<p>ç¬¬ä¸‰ç§åœºæ™¯æ˜¯ï¼Œç”Ÿæ„ä¸å¿™çš„æ—¶å€™ï¼Œæˆ–è€…æ‰“çƒŠä¹‹åã€‚è¿™æ—¶å€™æŸœå°æ²¡äº‹ï¼ŒæŒæŸœé—²ç€ä¹Ÿæ˜¯é—²ç€ï¼Œä¸å¦‚æ›´æ–°è´¦æœ¬ã€‚<br>
è¿™ç§åœºæ™¯ï¼Œå¯¹åº”çš„å°±æ˜¯MySQLè®¤ä¸ºç³»ç»Ÿâ€œç©ºé—²â€çš„æ—¶å€™ã€‚å½“ç„¶ï¼ŒMySQLâ€œè¿™å®¶é…’åº—â€çš„ç”Ÿæ„å¥½èµ·æ¥å¯æ˜¯ä¼šå¾ˆå¿«å°±èƒ½æŠŠç²‰æ¿è®°æ»¡çš„ï¼Œæ‰€ä»¥â€œæŒæŸœâ€è¦åˆç†åœ°å®‰æ’æ—¶é—´ï¼Œå³ä½¿æ˜¯â€œç”Ÿæ„å¥½â€çš„æ—¶å€™ï¼Œä¹Ÿè¦è§ç¼æ’é’ˆåœ°æ‰¾æ—¶é—´ï¼Œåªè¦æœ‰æœºä¼šå°±åˆ·ä¸€ç‚¹â€œè„é¡µâ€ã€‚</p>
</li>
<li>
<p>ç¬¬å››ç§åœºæ™¯æ˜¯ï¼Œå¹´åº•äº†å’¸äº¨é…’åº—è¦å…³é—¨å‡ å¤©ï¼Œéœ€è¦æŠŠè´¦ç»“æ¸…ä¸€ä¸‹ã€‚è¿™æ—¶å€™æŒæŸœè¦æŠŠæ‰€æœ‰è´¦éƒ½è®°åˆ°è´¦æœ¬ä¸Šï¼Œè¿™æ ·è¿‡å®Œå¹´é‡æ–°å¼€å¼ çš„æ—¶å€™ï¼Œå°±èƒ½å°±ç€è´¦æœ¬æ˜ç¡®è´¦ç›®æƒ…å†µäº†ã€‚<br>
è¿™ç§åœºæ™¯ï¼Œå¯¹åº”çš„å°±æ˜¯MySQLæ­£å¸¸å…³é—­çš„æƒ…å†µã€‚è¿™æ—¶å€™ï¼ŒMySQLä¼šæŠŠå†…å­˜çš„è„é¡µéƒ½flushåˆ°ç£ç›˜ä¸Šï¼Œè¿™æ ·ä¸‹æ¬¡MySQLå¯åŠ¨çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥ä»ç£ç›˜ä¸Šè¯»æ•°æ®ï¼Œå¯åŠ¨é€Ÿåº¦ä¼šå¾ˆå¿«ã€‚</p>
</li>
</ul><p>æ¥ä¸‹æ¥ï¼Œ<strong>ä½ å¯ä»¥åˆ†æä¸€ä¸‹ä¸Šé¢å››ç§åœºæ™¯å¯¹æ€§èƒ½çš„å½±å“ã€‚</strong></p><p>å…¶ä¸­ï¼Œç¬¬ä¸‰ç§æƒ…å†µæ˜¯å±äºMySQLç©ºé—²æ—¶çš„æ“ä½œï¼Œè¿™æ—¶ç³»ç»Ÿæ²¡ä»€ä¹ˆå‹åŠ›ï¼Œè€Œç¬¬å››ç§åœºæ™¯æ˜¯æ•°æ®åº“æœ¬æ¥å°±è¦å…³é—­äº†ã€‚è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œä½ ä¸ä¼šå¤ªå…³æ³¨â€œæ€§èƒ½â€é—®é¢˜ã€‚æ‰€ä»¥è¿™é‡Œï¼Œæˆ‘ä»¬ä¸»è¦æ¥åˆ†æä¸€ä¸‹å‰ä¸¤ç§åœºæ™¯ä¸‹çš„æ€§èƒ½é—®é¢˜ã€‚</p><p>ç¬¬ä¸€ç§æ˜¯â€œredo logå†™æ»¡äº†ï¼Œè¦flushè„é¡µâ€ï¼Œè¿™ç§æƒ…å†µæ˜¯InnoDBè¦å°½é‡é¿å…çš„ã€‚å› ä¸ºå‡ºç°è¿™ç§æƒ…å†µçš„æ—¶å€™ï¼Œæ•´ä¸ªç³»ç»Ÿå°±ä¸èƒ½å†æ¥å—æ›´æ–°äº†ï¼Œæ‰€æœ‰çš„æ›´æ–°éƒ½å¿…é¡»å µä½ã€‚å¦‚æœä½ ä»ç›‘æ§ä¸Šçœ‹ï¼Œè¿™æ—¶å€™æ›´æ–°æ•°ä¼šè·Œä¸º0ã€‚</p><p>ç¬¬äºŒç§æ˜¯â€œå†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œè¦å…ˆå°†è„é¡µå†™åˆ°ç£ç›˜â€ï¼Œè¿™ç§æƒ…å†µå…¶å®æ˜¯å¸¸æ€ã€‚<strong>InnoDBç”¨ç¼“å†²æ± ï¼ˆbuffer poolï¼‰ç®¡ç†å†…å­˜ï¼Œç¼“å†²æ± ä¸­çš„å†…å­˜é¡µæœ‰ä¸‰ç§çŠ¶æ€ï¼š</strong></p><ul>
<li>ç¬¬ä¸€ç§æ˜¯ï¼Œè¿˜æ²¡æœ‰ä½¿ç”¨çš„ï¼›</li>
<li>ç¬¬äºŒç§æ˜¯ï¼Œä½¿ç”¨äº†å¹¶ä¸”æ˜¯å¹²å‡€é¡µï¼›</li>
<li>ç¬¬ä¸‰ç§æ˜¯ï¼Œä½¿ç”¨äº†å¹¶ä¸”æ˜¯è„é¡µã€‚</li>
</ul><p>InnoDBçš„ç­–ç•¥æ˜¯å°½é‡ä½¿ç”¨å†…å­˜ï¼Œå› æ­¤å¯¹äºä¸€ä¸ªé•¿æ—¶é—´è¿è¡Œçš„åº“æ¥è¯´ï¼Œæœªè¢«ä½¿ç”¨çš„é¡µé¢å¾ˆå°‘ã€‚</p><p>è€Œå½“è¦è¯»å…¥çš„æ•°æ®é¡µæ²¡æœ‰åœ¨å†…å­˜çš„æ—¶å€™ï¼Œå°±å¿…é¡»åˆ°ç¼“å†²æ± ä¸­ç”³è¯·ä¸€ä¸ªæ•°æ®é¡µã€‚è¿™æ—¶å€™åªèƒ½æŠŠæœ€ä¹…ä¸ä½¿ç”¨çš„æ•°æ®é¡µä»å†…å­˜ä¸­æ·˜æ±°æ‰ï¼šå¦‚æœè¦æ·˜æ±°çš„æ˜¯ä¸€ä¸ªå¹²å‡€é¡µï¼Œå°±ç›´æ¥é‡Šæ”¾å‡ºæ¥å¤ç”¨ï¼›ä½†å¦‚æœæ˜¯è„é¡µå‘¢ï¼Œå°±å¿…é¡»å°†è„é¡µå…ˆåˆ·åˆ°ç£ç›˜ï¼Œå˜æˆå¹²å‡€é¡µåæ‰èƒ½å¤ç”¨ã€‚</p><p>æ‰€ä»¥ï¼Œåˆ·è„é¡µè™½ç„¶æ˜¯å¸¸æ€ï¼Œä½†æ˜¯å‡ºç°ä»¥ä¸‹è¿™ä¸¤ç§æƒ…å†µï¼Œéƒ½æ˜¯ä¼šæ˜æ˜¾å½±å“æ€§èƒ½çš„ï¼š</p><ol>
<li>
<p>ä¸€ä¸ªæŸ¥è¯¢è¦æ·˜æ±°çš„è„é¡µä¸ªæ•°å¤ªå¤šï¼Œä¼šå¯¼è‡´æŸ¥è¯¢çš„å“åº”æ—¶é—´æ˜æ˜¾å˜é•¿ï¼›</p>
</li>
<li>
<p>æ—¥å¿—å†™æ»¡ï¼Œæ›´æ–°å…¨éƒ¨å µä½ï¼Œå†™æ€§èƒ½è·Œä¸º0ï¼Œè¿™ç§æƒ…å†µå¯¹æ•æ„Ÿä¸šåŠ¡æ¥è¯´ï¼Œæ˜¯ä¸èƒ½æ¥å—çš„ã€‚</p>
</li>
</ol><p>æ‰€ä»¥ï¼ŒInnoDBéœ€è¦æœ‰æ§åˆ¶è„é¡µæ¯”ä¾‹çš„æœºåˆ¶ï¼Œæ¥å°½é‡é¿å…ä¸Šé¢çš„è¿™ä¸¤ç§æƒ…å†µã€‚</p><h1>InnoDBåˆ·è„é¡µçš„æ§åˆ¶ç­–ç•¥</h1><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°±æ¥å’Œä½ è¯´è¯´InnoDBè„é¡µçš„æ§åˆ¶ç­–ç•¥ï¼Œä»¥åŠå’Œè¿™äº›ç­–ç•¥ç›¸å…³çš„å‚æ•°ã€‚</p><p>é¦–å…ˆï¼Œä½ è¦æ­£ç¡®åœ°å‘Šè¯‰InnoDBæ‰€åœ¨ä¸»æœºçš„IOèƒ½åŠ›ï¼Œè¿™æ ·InnoDBæ‰èƒ½çŸ¥é“éœ€è¦å…¨åŠ›åˆ·è„é¡µçš„æ—¶å€™ï¼Œå¯ä»¥åˆ·å¤šå¿«ã€‚</p><p>è¿™å°±è¦ç”¨åˆ°innodb_io_capacityè¿™ä¸ªå‚æ•°äº†ï¼Œå®ƒä¼šå‘Šè¯‰InnoDBä½ çš„ç£ç›˜èƒ½åŠ›ã€‚è¿™ä¸ªå€¼æˆ‘å»ºè®®ä½ è®¾ç½®æˆç£ç›˜çš„IOPSã€‚ç£ç›˜çš„IOPSå¯ä»¥é€šè¿‡fioè¿™ä¸ªå·¥å…·æ¥æµ‹è¯•ï¼Œä¸‹é¢çš„è¯­å¥æ˜¯æˆ‘ç”¨æ¥æµ‹è¯•ç£ç›˜éšæœºè¯»å†™çš„å‘½ä»¤ï¼š</p><pre><code> fio -filename=$filename -direct=1 -iodepth 1 -thread -rw=randrw -ioengine=psync -bs=16k -size=500M -numjobs=10 -runtime=10 -group_reporting -name=mytest 
</code></pre><p>å…¶å®ï¼Œå› ä¸ºæ²¡èƒ½æ­£ç¡®åœ°è®¾ç½®innodb_io_capacityå‚æ•°ï¼Œè€Œå¯¼è‡´çš„æ€§èƒ½é—®é¢˜ä¹Ÿæ¯”æ¯”çš†æ˜¯ã€‚ä¹‹å‰ï¼Œå°±æ›¾æœ‰å…¶ä»–å…¬å¸çš„å¼€å‘è´Ÿè´£äººæ‰¾æˆ‘çœ‹ä¸€ä¸ªåº“çš„æ€§èƒ½é—®é¢˜ï¼Œè¯´MySQLçš„å†™å…¥é€Ÿåº¦å¾ˆæ…¢ï¼ŒTPSå¾ˆä½ï¼Œä½†æ˜¯æ•°æ®åº“ä¸»æœºçš„IOå‹åŠ›å¹¶ä¸å¤§ã€‚ç»è¿‡ä¸€ç•ªæ’æŸ¥ï¼Œå‘ç°ç½ªé­ç¥¸é¦–å°±æ˜¯è¿™ä¸ªå‚æ•°çš„è®¾ç½®å‡ºäº†é—®é¢˜ã€‚</p><p>ä»–çš„ä¸»æœºç£ç›˜ç”¨çš„æ˜¯SSDï¼Œä½†æ˜¯innodb_io_capacityçš„å€¼è®¾ç½®çš„æ˜¯300ã€‚äºæ˜¯ï¼ŒInnoDBè®¤ä¸ºè¿™ä¸ªç³»ç»Ÿçš„èƒ½åŠ›å°±è¿™ä¹ˆå·®ï¼Œæ‰€ä»¥åˆ·è„é¡µåˆ·å¾—ç‰¹åˆ«æ…¢ï¼Œç”šè‡³æ¯”è„é¡µç”Ÿæˆçš„é€Ÿåº¦è¿˜æ…¢ï¼Œè¿™æ ·å°±é€ æˆäº†è„é¡µç´¯ç§¯ï¼Œå½±å“äº†æŸ¥è¯¢å’Œæ›´æ–°æ€§èƒ½ã€‚</p><p>è™½ç„¶æˆ‘ä»¬ç°åœ¨å·²ç»å®šä¹‰äº†â€œå…¨åŠ›åˆ·è„é¡µâ€çš„è¡Œä¸ºï¼Œä½†å¹³æ—¶æ€»ä¸èƒ½ä¸€ç›´æ˜¯å…¨åŠ›åˆ·å§ï¼Ÿæ¯•ç«Ÿç£ç›˜èƒ½åŠ›ä¸èƒ½åªç”¨æ¥åˆ·è„é¡µï¼Œè¿˜éœ€è¦æœåŠ¡ç”¨æˆ·è¯·æ±‚ã€‚æ‰€ä»¥æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¸€èµ·çœ‹çœ‹InnoDBæ€ä¹ˆæ§åˆ¶å¼•æ“æŒ‰ç…§â€œå…¨åŠ›â€çš„ç™¾åˆ†æ¯”æ¥åˆ·è„é¡µã€‚</p><p>æ ¹æ®æˆ‘å‰é¢æåˆ°çš„çŸ¥è¯†ç‚¹ï¼Œè¯•æƒ³ä¸€ä¸‹ï¼Œ<strong>å¦‚æœä½ æ¥è®¾è®¡ç­–ç•¥æ§åˆ¶åˆ·è„é¡µçš„é€Ÿåº¦ï¼Œä¼šå‚è€ƒå“ªäº›å› ç´ å‘¢ï¼Ÿ</strong></p><p>è¿™ä¸ªé—®é¢˜å¯ä»¥è¿™ä¹ˆæƒ³ï¼Œå¦‚æœåˆ·å¤ªæ…¢ï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿé¦–å…ˆæ˜¯å†…å­˜è„é¡µå¤ªå¤šï¼Œå…¶æ¬¡æ˜¯redo logå†™æ»¡ã€‚</p><p>æ‰€ä»¥ï¼ŒInnoDBçš„åˆ·ç›˜é€Ÿåº¦å°±æ˜¯è¦å‚è€ƒè¿™ä¸¤ä¸ªå› ç´ ï¼šä¸€ä¸ªæ˜¯è„é¡µæ¯”ä¾‹ï¼Œä¸€ä¸ªæ˜¯redo logå†™ç›˜é€Ÿåº¦ã€‚</p><p>InnoDBä¼šæ ¹æ®è¿™ä¸¤ä¸ªå› ç´ å…ˆå•ç‹¬ç®—å‡ºä¸¤ä¸ªæ•°å­—ã€‚</p><p>å‚æ•°innodb_max_dirty_pages_pctæ˜¯è„é¡µæ¯”ä¾‹ä¸Šé™ï¼Œé»˜è®¤å€¼æ˜¯75%ã€‚InnoDBä¼šæ ¹æ®å½“å‰çš„è„é¡µæ¯”ä¾‹ï¼ˆå‡è®¾ä¸ºMï¼‰ï¼Œç®—å‡ºä¸€ä¸ªèŒƒå›´åœ¨0åˆ°100ä¹‹é—´çš„æ•°å­—ï¼Œè®¡ç®—è¿™ä¸ªæ•°å­—çš„ä¼ªä»£ç ç±»ä¼¼è¿™æ ·ï¼š</p><pre><code>F1(M)
{
  if M&gt;=innodb_max_dirty_pages_pct then
      return 100;
  return 100*M/innodb_max_dirty_pages_pct;
}
</code></pre><p>InnoDBæ¯æ¬¡å†™å…¥çš„æ—¥å¿—éƒ½æœ‰ä¸€ä¸ªåºå·ï¼Œå½“å‰å†™å…¥çš„åºå·è·Ÿcheckpointå¯¹åº”çš„åºå·ä¹‹é—´çš„å·®å€¼ï¼Œæˆ‘ä»¬å‡è®¾ä¸ºNã€‚InnoDBä¼šæ ¹æ®è¿™ä¸ªNç®—å‡ºä¸€ä¸ªèŒƒå›´åœ¨0åˆ°100ä¹‹é—´çš„æ•°å­—ï¼Œè¿™ä¸ªè®¡ç®—å…¬å¼å¯ä»¥è®°ä¸ºF2(N)ã€‚F2(N)ç®—æ³•æ¯”è¾ƒå¤æ‚ï¼Œä½ åªè¦çŸ¥é“Nè¶Šå¤§ï¼Œç®—å‡ºæ¥çš„å€¼è¶Šå¤§å°±å¥½äº†ã€‚</p><p>ç„¶åï¼Œ<strong>æ ¹æ®ä¸Šè¿°ç®—å¾—çš„F1(M)å’ŒF2(N)ä¸¤ä¸ªå€¼ï¼Œå–å…¶ä¸­è¾ƒå¤§çš„å€¼è®°ä¸ºRï¼Œä¹‹åå¼•æ“å°±å¯ä»¥æŒ‰ç…§innodb_io_capacityå®šä¹‰çš„èƒ½åŠ›ä¹˜ä»¥R%æ¥æ§åˆ¶åˆ·è„é¡µçš„é€Ÿåº¦ã€‚</strong></p><p>ä¸Šè¿°çš„è®¡ç®—æµç¨‹æ¯”è¾ƒæŠ½è±¡ï¼Œä¸å®¹æ˜“ç†è§£ï¼Œæ‰€ä»¥æˆ‘ç”»äº†ä¸€ä¸ªç®€å•çš„æµç¨‹å›¾ã€‚å›¾ä¸­çš„F1ã€F2å°±æ˜¯ä¸Šé¢æˆ‘ä»¬é€šè¿‡è„é¡µæ¯”ä¾‹å’Œredo logå†™å…¥é€Ÿåº¦ç®—å‡ºæ¥çš„ä¸¤ä¸ªå€¼ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/cc/74/cc44c1d080141aa50df6a91067475374.png" alt=""></p><center><span class="reference">å›¾3 InnoDBåˆ·è„é¡µé€Ÿåº¦ç­–ç•¥</span></center><p>ç°åœ¨ä½ çŸ¥é“äº†ï¼ŒInnoDBä¼šåœ¨åå°åˆ·è„é¡µï¼Œè€Œåˆ·è„é¡µçš„è¿‡ç¨‹æ˜¯è¦å°†å†…å­˜é¡µå†™å…¥ç£ç›˜ã€‚æ‰€ä»¥ï¼Œæ— è®ºæ˜¯ä½ çš„æŸ¥è¯¢è¯­å¥åœ¨éœ€è¦å†…å­˜çš„æ—¶å€™å¯èƒ½è¦æ±‚æ·˜æ±°ä¸€ä¸ªè„é¡µï¼Œè¿˜æ˜¯ç”±äºåˆ·è„é¡µçš„é€»è¾‘ä¼šå ç”¨IOèµ„æºå¹¶å¯èƒ½å½±å“åˆ°äº†ä½ çš„æ›´æ–°è¯­å¥ï¼Œéƒ½å¯èƒ½æ˜¯é€ æˆä½ ä»ä¸šåŠ¡ç«¯æ„ŸçŸ¥åˆ°MySQLâ€œæŠ–â€äº†ä¸€ä¸‹çš„åŸå› ã€‚</p><p>è¦å°½é‡é¿å…è¿™ç§æƒ…å†µï¼Œä½ å°±è¦åˆç†åœ°è®¾ç½®innodb_io_capacityçš„å€¼ï¼Œå¹¶ä¸”<strong>å¹³æ—¶è¦å¤šå…³æ³¨è„é¡µæ¯”ä¾‹ï¼Œä¸è¦è®©å®ƒç»å¸¸æ¥è¿‘75%</strong>ã€‚</p><p>å…¶ä¸­ï¼Œè„é¡µæ¯”ä¾‹æ˜¯é€šè¿‡Innodb_buffer_pool_pages_dirty/Innodb_buffer_pool_pages_totalå¾—åˆ°çš„ï¼Œå…·ä½“çš„å‘½ä»¤å‚è€ƒä¸‹é¢çš„ä»£ç ï¼š</p><pre><code>mysql&gt; select VARIABLE_VALUE into @a from global_status where VARIABLE_NAME = 'Innodb_buffer_pool_pages_dirty';
select VARIABLE_VALUE into @b from global_status where VARIABLE_NAME = 'Innodb_buffer_pool_pages_total';
select @a/@b;
</code></pre><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†çœ‹ä¸€ä¸ªæœ‰è¶£çš„ç­–ç•¥ã€‚</p><p>ä¸€æ—¦ä¸€ä¸ªæŸ¥è¯¢è¯·æ±‚éœ€è¦åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å…ˆflushæ‰ä¸€ä¸ªè„é¡µæ—¶ï¼Œè¿™ä¸ªæŸ¥è¯¢å°±å¯èƒ½è¦æ¯”å¹³æ—¶æ…¢äº†ã€‚è€ŒMySQLä¸­çš„ä¸€ä¸ªæœºåˆ¶ï¼Œå¯èƒ½è®©ä½ çš„æŸ¥è¯¢ä¼šæ›´æ…¢ï¼šåœ¨å‡†å¤‡åˆ·ä¸€ä¸ªè„é¡µçš„æ—¶å€™ï¼Œå¦‚æœè¿™ä¸ªæ•°æ®é¡µæ—è¾¹çš„æ•°æ®é¡µåˆšå¥½æ˜¯è„é¡µï¼Œå°±ä¼šæŠŠè¿™ä¸ªâ€œé‚»å±…â€ä¹Ÿå¸¦ç€ä¸€èµ·åˆ·æ‰ï¼›è€Œä¸”è¿™ä¸ªæŠŠâ€œé‚»å±…â€æ‹–ä¸‹æ°´çš„é€»è¾‘è¿˜å¯ä»¥ç»§ç»­è”“å»¶ï¼Œä¹Ÿå°±æ˜¯å¯¹äºæ¯ä¸ªé‚»å±…æ•°æ®é¡µï¼Œå¦‚æœè·Ÿå®ƒç›¸é‚»çš„æ•°æ®é¡µä¹Ÿè¿˜æ˜¯è„é¡µçš„è¯ï¼Œä¹Ÿä¼šè¢«æ”¾åˆ°ä¸€èµ·åˆ·ã€‚</p><p>åœ¨InnoDBä¸­ï¼Œinnodb_flush_neighbors å‚æ•°å°±æ˜¯ç”¨æ¥æ§åˆ¶è¿™ä¸ªè¡Œä¸ºçš„ï¼Œå€¼ä¸º1çš„æ—¶å€™ä¼šæœ‰ä¸Šè¿°çš„â€œè¿åâ€æœºåˆ¶ï¼Œå€¼ä¸º0æ—¶è¡¨ç¤ºä¸æ‰¾é‚»å±…ï¼Œè‡ªå·±åˆ·è‡ªå·±çš„ã€‚</p><p>æ‰¾â€œé‚»å±…â€è¿™ä¸ªä¼˜åŒ–åœ¨æœºæ¢°ç¡¬ç›˜æ—¶ä»£æ˜¯å¾ˆæœ‰æ„ä¹‰çš„ï¼Œå¯ä»¥å‡å°‘å¾ˆå¤šéšæœºIOã€‚æœºæ¢°ç¡¬ç›˜çš„éšæœºIOPSä¸€èˆ¬åªæœ‰å‡ ç™¾ï¼Œç›¸åŒçš„é€»è¾‘æ“ä½œå‡å°‘éšæœºIOå°±æ„å‘³ç€ç³»ç»Ÿæ€§èƒ½çš„å¤§å¹…åº¦æå‡ã€‚</p><p>è€Œå¦‚æœä½¿ç”¨çš„æ˜¯SSDè¿™ç±»IOPSæ¯”è¾ƒé«˜çš„è®¾å¤‡çš„è¯ï¼Œæˆ‘å°±å»ºè®®ä½ æŠŠinnodb_flush_neighborsçš„å€¼è®¾ç½®æˆ0ã€‚å› ä¸ºè¿™æ—¶å€™IOPSå¾€å¾€ä¸æ˜¯ç“¶é¢ˆï¼Œè€Œâ€œåªåˆ·è‡ªå·±â€ï¼Œå°±èƒ½æ›´å¿«åœ°æ‰§è¡Œå®Œå¿…è¦çš„åˆ·è„é¡µæ“ä½œï¼Œå‡å°‘SQLè¯­å¥å“åº”æ—¶é—´ã€‚</p><p>åœ¨MySQL 8.0ä¸­ï¼Œinnodb_flush_neighborså‚æ•°çš„é»˜è®¤å€¼å·²ç»æ˜¯0äº†ã€‚</p><h1>å°ç»“</h1><p>ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘å»¶ç»­ç¬¬2ç¯‡ä¸­ä»‹ç»çš„WALçš„æ¦‚å¿µï¼Œå’Œä½ è§£é‡Šäº†è¿™ä¸ªæœºåˆ¶åç»­éœ€è¦çš„åˆ·è„é¡µæ“ä½œå’Œæ‰§è¡Œæ—¶æœºã€‚åˆ©ç”¨WALæŠ€æœ¯ï¼Œæ•°æ®åº“å°†éšæœºå†™è½¬æ¢æˆäº†é¡ºåºå†™ï¼Œå¤§å¤§æå‡äº†æ•°æ®åº“çš„æ€§èƒ½ã€‚</p><p>ä½†æ˜¯ï¼Œç”±æ­¤ä¹Ÿå¸¦æ¥äº†å†…å­˜è„é¡µçš„é—®é¢˜ã€‚è„é¡µä¼šè¢«åå°çº¿ç¨‹è‡ªåŠ¨flushï¼Œä¹Ÿä¼šç”±äºæ•°æ®é¡µæ·˜æ±°è€Œè§¦å‘flushï¼Œè€Œåˆ·è„é¡µçš„è¿‡ç¨‹ç”±äºä¼šå ç”¨èµ„æºï¼Œå¯èƒ½ä¼šè®©ä½ çš„æ›´æ–°å’ŒæŸ¥è¯¢è¯­å¥çš„å“åº”æ—¶é—´é•¿ä¸€äº›ã€‚åœ¨æ–‡ç« é‡Œï¼Œæˆ‘ä¹Ÿç»™ä½ ä»‹ç»äº†æ§åˆ¶åˆ·è„é¡µçš„æ–¹æ³•å’Œå¯¹åº”çš„ç›‘æ§æ–¹å¼ã€‚</p><p>æ–‡ç« æœ€åï¼Œæˆ‘ç»™ä½ ç•™ä¸‹ä¸€ä¸ªæ€è€ƒé¢˜å§ã€‚</p><p>ä¸€ä¸ªå†…å­˜é…ç½®ä¸º128GBã€innodb_io_capacityè®¾ç½®ä¸º20000çš„å¤§è§„æ ¼å®ä¾‹ï¼Œæ­£å¸¸ä¼šå»ºè®®ä½ å°†redo logè®¾ç½®æˆ4ä¸ª1GBçš„æ–‡ä»¶ã€‚</p><p>ä½†å¦‚æœä½ åœ¨é…ç½®çš„æ—¶å€™ä¸æ…å°†redo logè®¾ç½®æˆäº†1ä¸ª100Mçš„æ–‡ä»¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿåˆä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µå‘¢ï¼Ÿ</p><p>ä½ å¯ä»¥æŠŠä½ çš„åˆ†æç»“è®ºå†™åœ¨ç•™è¨€åŒºé‡Œï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« çš„æœ«å°¾å’Œä½ è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><h1>ä¸ŠæœŸé—®é¢˜æ—¶é—´</h1><p>ä¸ŠæœŸæˆ‘ç•™ç»™ä½ çš„é—®é¢˜æ˜¯ï¼Œç»™ä¸€ä¸ªå­¦å·å­—æ®µåˆ›å»ºç´¢å¼•ï¼Œæœ‰å“ªäº›æ–¹æ³•ã€‚</p><p>ç”±äºè¿™ä¸ªå­¦å·çš„è§„åˆ™ï¼Œæ— è®ºæ˜¯æ­£å‘è¿˜æ˜¯åå‘çš„å‰ç¼€ç´¢å¼•ï¼Œé‡å¤åº¦éƒ½æ¯”è¾ƒé«˜ã€‚å› ä¸ºç»´æŠ¤çš„åªæ˜¯ä¸€ä¸ªå­¦æ ¡çš„ï¼Œå› æ­¤å‰é¢6ä½ï¼ˆå…¶ä¸­ï¼Œå‰ä¸‰ä½æ˜¯æ‰€åœ¨åŸå¸‚ç¼–å·ã€ç¬¬å››åˆ°ç¬¬å…­ä½æ˜¯å­¦æ ¡ç¼–å·ï¼‰å…¶å®æ˜¯å›ºå®šçš„ï¼Œé‚®ç®±åç¼€éƒ½æ˜¯@gamil.comï¼Œå› æ­¤å¯ä»¥åªå­˜å…¥å­¦å¹´ä»½åŠ é¡ºåºç¼–å·ï¼Œå®ƒä»¬çš„é•¿åº¦æ˜¯9ä½ã€‚</p><p>è€Œå…¶å®åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå¯ä»¥ç”¨æ•°å­—ç±»å‹æ¥å­˜è¿™9ä½æ•°å­—ã€‚æ¯”å¦‚201100001ï¼Œè¿™æ ·åªéœ€è¦å 4ä¸ªå­—èŠ‚ã€‚å…¶å®è¿™ä¸ªå°±æ˜¯ä¸€ç§hashï¼Œåªæ˜¯å®ƒç”¨äº†æœ€ç®€å•çš„è½¬æ¢è§„åˆ™ï¼šå­—ç¬¦ä¸²è½¬æ•°å­—çš„è§„åˆ™ï¼Œè€Œåˆšå¥½æˆ‘ä»¬è®¾å®šçš„è¿™ä¸ªèƒŒæ™¯ï¼Œå¯ä»¥ä¿è¯è¿™ä¸ªè½¬æ¢åç»“æœçš„å”¯ä¸€æ€§ã€‚</p><p>è¯„è®ºåŒºä¸­ï¼Œä¹Ÿæœ‰å…¶ä»–ä¸€äº›å¾ˆä¸é”™çš„è§è§£ã€‚</p><p>è¯„è®ºç”¨æˆ·@å°å»ºçš„é£ è¯´ï¼Œä¸€ä¸ªå­¦æ ¡çš„æ€»äººæ•°è¿™ç§æ•°æ®é‡ï¼Œ50å¹´æ‰100ä¸‡å­¦ç”Ÿï¼Œè¿™ä¸ªè¡¨è‚¯å®šæ˜¯å°è¡¨ã€‚ä¸ºäº†ä¸šåŠ¡ç®€å•ï¼Œç›´æ¥å­˜åŸæ¥çš„å­—ç¬¦ä¸²ã€‚è¿™ä¸ªç­”å¤é‡Œé¢åŒ…å«äº†â€œä¼˜åŒ–æˆæœ¬å’Œæ”¶ç›Šâ€çš„æ€æƒ³ï¼Œæˆ‘è§‰å¾—å€¼å¾—atå‡ºæ¥ã€‚</p><p>@å°æ½˜ åŒå­¦æäº†å¦å¤–ä¸€ä¸ªæè‡´çš„æ–¹å‘ã€‚å¦‚æœç¢°åˆ°è¡¨æ•°æ®é‡ç‰¹åˆ«å¤§çš„åœºæ™¯ï¼Œé€šè¿‡è¿™ç§æ–¹å¼çš„æ”¶ç›Šæ˜¯å¾ˆä¸é”™çš„ã€‚</p><p><strong>è¯„è®ºåŒºç•™è¨€ç‚¹èµæ¿ï¼š</strong></p><blockquote>
<p>@lttzzlll ï¼Œæåˆ°äº†ç”¨æ•´å‹å­˜â€œå››ä½å¹´ä»½+äº”ä½ç¼–å·â€çš„æ–¹æ³•ï¼›<br>
ç”±äºæ•´ä¸ªå­¦å·çš„å€¼è¶…è¿‡äº†intä¸Šé™ï¼Œ@è€æ¨åŒå¿— ä¹Ÿæåˆ°äº†ç”¨8ä¸ªå­—èŠ‚çš„bigintæ¥å­˜çš„æ–¹æ³•ã€‚</p>
</blockquote><p><img src="https://static001.geekbang.org/resource/image/ce/d9/ce7f4e35916ed1aa49206a53a0547bd9.jpg" alt=""></p>
                    </div>
                </div>

            </div>
            <div data-v-87ffcada="" class="article-comments pd"><h2 data-v-87ffcada=""><span
                    data-v-87ffcada="">ç²¾é€‰ç•™è¨€</span></h2>
                <ul data-v-87ffcada="">
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/48/bd/6c7d4230.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Tony Du</span>
                            </div>
                            <div class="bd">å½“å†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œè¦å°†è„é¡µå†™åˆ°ç£ç›˜ï¼Œä¼šæœ‰ä¸€ä¸ªæ•°æ®é¡µæ·˜æ±°æœºåˆ¶ï¼ˆæœ€ä¹…ä¸ä½¿ç”¨ï¼‰ï¼Œå‡è®¾æ·˜æ±°çš„æ˜¯è„é¡µï¼Œåˆ™æ­¤æ—¶è„é¡µæ‰€å¯¹åº”çš„redo logçš„ä½ç½®æ˜¯éšæœºçš„ï¼Œå½“æœ‰å¤šä¸ªä¸åŒçš„è„é¡µéœ€è¦åˆ·ï¼Œåˆ™å¯¹åº”çš„redo logå¯èƒ½åœ¨ä¸åŒçš„ä½ç½®ï¼Œè¿™æ ·å°±éœ€è¦æŠŠredo logçš„å¤šä¸ªä¸åŒä½ç½®åˆ·æ‰ï¼Œè¿™æ ·å¯¹äºredo logçš„å¤„ç†ä¸æ˜¯å°±ä¼šå¾ˆéº»çƒ¦å—ï¼Ÿï¼ˆåˆå¹¶é—´éš™ï¼Œç§»åŠ¨ä½ç½®ï¼Ÿï¼‰<br>å¦å¤–ï¼Œredo logçš„ä¼˜åŠ¿åœ¨äºå°†ç£ç›˜éšæœºå†™è½¬æ¢æˆäº†é¡ºåºå†™ï¼Œå¦‚æœéœ€è¦å°†redo logçš„ä¸åŒéƒ¨åˆ†åˆ·æ‰ï¼ˆåˆ·è„é¡µï¼‰ï¼Œä¸æ˜¯å°±åœ¨redo logé‡Œéšæœºè¯»å†™äº†ä¹ˆï¼Ÿ <br></div>
                            <span class="time">2018-12-10 13:16</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å¥½é—®é¢˜ã€‚ <br><br>å…¶å®ç”±äºæ·˜æ±°çš„æ—¶å€™ï¼Œåˆ·è„é¡µè¿‡ç¨‹ä¸ç”¨åŠ¨redo logæ–‡ä»¶çš„ã€‚<br><br>è¿™ä¸ªæœ‰ä¸ªé¢å¤–çš„ä¿è¯ï¼Œæ˜¯redo logåœ¨â€œé‡æ”¾â€çš„æ—¶å€™ï¼Œå¦‚æœä¸€ä¸ªæ•°æ®é¡µå·²ç»æ˜¯åˆ·è¿‡çš„ï¼Œä¼šè¯†åˆ«å‡ºæ¥å¹¶è·³è¿‡ã€‚<br><br></p>
                                <p class="reply-time">2018-12-10 15:00</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æŸã€äºº</span>
                            </div>
                            <div class="bd">redo logæ˜¯å…³ç³»å‹æ•°æ®åº“çš„æ ¸å¿ƒå•Š,ä¿è¯äº†ACIDé‡Œçš„Dã€‚æ‰€ä»¥redo logæ˜¯ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«çš„æ“ä½œ<br>æŒ‰ç…§è€å¸ˆè¯´çš„å½“å†…å­˜æ•°æ®é¡µè·Ÿç£ç›˜æ•°æ®é¡µä¸ä¸€è‡´çš„æ—¶å€™,æŠŠå†…å­˜é¡µç§°ä¸º&#39;è„é¡µ&#39;ã€‚å¦‚æœredo log<br>è®¾ç½®å¾—å¤ªå°,redo logå†™æ»¡.é‚£ä¹ˆä¼šæ¶‰åŠåˆ°å“ªäº›æ“ä½œå‘¢,æˆ‘è®¤ä¸ºæ˜¯ä»¥ä¸‹å‡ ç‚¹:<br>1.æŠŠç›¸å¯¹åº”çš„æ•°æ®é¡µä¸­çš„è„é¡µæŒä¹…åŒ–åˆ°ç£ç›˜,checkpointå¾€å‰æ¨<br>2.ç”±äºredo logè¿˜è®°å½•äº†undoçš„å˜åŒ–,undo log bufferä¹Ÿè¦æŒä¹…åŒ–è¿›undo log<br>3.å½“innodb_flush_log_at_trx_commitè®¾ç½®ä¸ºé1,è¿˜è¦æŠŠå†…å­˜é‡Œçš„redo logæŒä¹…åŒ–åˆ°ç£ç›˜ä¸Š<br>4.redo logè¿˜è®°å½•äº†change bufferçš„æ”¹å˜,é‚£ä¹ˆè¿˜è¦æŠŠchange buffer purgeåˆ°idb<br>ä»¥åŠmerge change buffer.mergeç”Ÿæˆçš„æ•°æ®é¡µä¹Ÿæ˜¯è„é¡µ,ä¹Ÿè¦æŒä¹…åŒ–åˆ°ç£ç›˜<br>ä¸Šè¿°4ç§æ“ä½œ,éƒ½æ˜¯å ç”¨ç³»ç»ŸI&#47;O,å½±å“DML,å¦‚æœæ“ä½œé¢‘ç¹,ä¼šå¯¼è‡´&#39;æŠ–&#39;å¾—å‘ç°åœ¨æˆ‘ä»¬è¿‡å†¬ä¸€æ ·ã€‚<br>ä½†æ˜¯å¯¹äºselectæ“ä½œæ¥è¯´,æŸ¥è¯¢æ—¶é—´ç›¸å¯¹ä¼šæ›´å¿«ã€‚å› ä¸ºç³»ç»Ÿè„é¡µå˜å°‘äº†,ä¸ç”¨å»æ·˜æ±°è„é¡µ,ç›´æ¥å¤ç”¨<br>å¹²å‡€é¡µå³å¯ã€‚è¿˜æœ‰å°±æ˜¯å¯¹äºå®•æœºæ¢å¤,é€Ÿåº¦ä¹Ÿæ›´å¿«,å› ä¸ºcheckpointå¾ˆæ¥è¿‘LSN,æ¢å¤çš„æ•°æ®é¡µç›¸å¯¹è¾ƒå°‘<br>æ‰€ä»¥è¦æ§åˆ¶åˆ·è„çš„é¢‘ç‡,é¢‘ç‡å¿«äº†,å½±å“DML I&#47;O,é¢‘ç‡æ…¢äº†,ä¼šå¯¼è‡´è¯»æ“ä½œè€—æ—¶é•¿ã€‚<br>æˆ‘æ˜¯è¿™æ ·æƒ³çš„è¿™ä¸ªé—®é¢˜,æœ‰å¯èƒ½ä¸å¤ªå¯¹,ç‰¹åˆ«æ˜¯å¯¹äºç¬¬4ç‚¹æ˜¯å¦ä¼šmergeä»¥åŠpurge,è¿˜éœ€è¦è€å¸ˆçš„è§£ç­” <br></div>
                            <span class="time">2018-12-10 23:16</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æŠ–å¾—åƒè¿‡å†¬ä¸€æ ·ï¼ŒğŸ˜„ğŸ‘ğŸ¿<br><br>ä½ è¯´å¾—å¾ˆå¯¹ï¼Œç¬¬4ç‚¹æ²¡é”™çš„ï¼Œå‡ºç°è¿™ç§æƒ…å†µçš„æ—¶å€™ï¼Œè¿change bufferçš„ä¼˜åŒ–ä¹Ÿæ²¡æ„ä¹‰äº†</p>
                                <p class="reply-time">2018-12-11 12:10</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/87/59/b457f370.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">yesir</span>
                            </div>
                            <div class="bd">æˆ‘è§‚å¯Ÿäº†ä¸‹å…¬å¸çš„æ•°æ®åº“ç¡®å®å‘ç°äº†æŠ–åŠ¨ç°è±¡ï¼Œæœ‰å‡ ä¸ªé—®é¢˜ï¼Œ<br>1ï¼‰Innodb_buffer_pool_pages_totalè¿™ä¸ªå€¼å¾ˆå¤§ï¼Œç™¾ä¸‡çº§åˆ«çš„ï¼Œè€Œä¸”æ•°å€¼ä¸åƒæ˜¯äººä¸ºè®¾ç½®ä¸Šå»çš„ï¼Œæ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿ<br>2ï¼‰Innodb_buffer_pool_pages_dirtyè¾¾åˆ°4ä¸‡å¤šçš„æ—¶å€™å°±å¼€å§‹flushäº†ï¼Œè„é¡µæ¯”ä¾‹æ˜¯75ï¼Œè¿™è‚¯å®šæ˜¯è¿œè¾¾ä¸åˆ°çš„ï¼Œssdç£ç›˜ï¼Œinnodb_io_capacityæ˜¯200ï¼Œè‚¯å®šå¯ä»¥æé«˜ã€‚æ–‡ç« ä¸­è¯´flushçš„è§¦å‘æ¡ä»¶æœ‰2ä¸ªï¼Œä¸€ä¸ªæ˜¯å†…å­˜ä¸å¤Ÿäº†ï¼Œä¸€ä¸ªæ˜¯redo log æ»¡äº†ï¼Œé‚£ä¹ˆæˆ‘è¿™ä¸ªåœºæ™¯æ˜¯å“ªç§æƒ…å†µå‘¢  <br></div>
                            <span class="time">2018-12-11 23:02</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1ï¼‰ è¿™ä¸ªæ˜¯innodb æ•°æ®é¡µæ€»æ˜¯ï¼Œè¿‡ç™¾ä¸‡æ˜¯æ­£å¸¸çš„ï¼Œ16Kä¸€ä¸ªï¼ŒBufree pool size 16G å°±æ˜¯100ä¸‡äº†<br><br>2ï¼‰ä½ è¿™ä¸ªä¾‹å­å°±æ˜¯io_capacityè®¾å¤ªå°äº†â€¦</p>
                                <p class="reply-time">2018-12-12 00:40</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/40/5e/b8fada94.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Ryoma</span>
                            </div>
                            <div class="bd">å…³äºç²‰æ¿å’Œredo logçš„ç±»æ¯”æˆ‘è§‰å¾—æœ‰ä¸€ç‚¹ä¸å¤ªåˆé€‚ï¼šredo logè®°å½•çš„æ˜¯å®æ—¶æ¬ æ¬¾ï¼Œæ¯”å¦‚è´¦æœ¬ä¸­æ˜¯10æ–‡ï¼Œåˆæ¬ äº†9æ–‡ï¼Œæ­¤æ—¶redo log è®°å½•çš„æ˜¯19ï¼›è€Œç²‰æ¿çš„è¯ï¼Œåªä¼šè¿½åŠ æŸäººæ¬ æ¬¾+9æ–‡ï¼Œä¸ä¼šå…³æ³¨åŸæ¥å·²æ¬ æ¬¾å¤šå°‘ï¼ˆä¸ç„¶æŸäººèµŠè´¦æ—¶ï¼Œæˆ‘è¿˜éœ€è¦æ‰¾åˆ°è´¦æœ¬ä¸­çš„è¿™ä¸ªäººï¼Œæ‰çŸ¥é“ä»–ä¹‹å‰æ¬ æ¬¾å¤šå°‘ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªåœºæ™¯è·ŸMySQLä¸­çš„åœºæ™¯è¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼‰<br> <br></div>
                            <span class="time">2018-12-12 10:19</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">Redo logé‡Œä¹Ÿæ˜¯è®°çš„+9å“¦ğŸ˜„</p>
                                <p class="reply-time">2018-12-12 11:19</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/34/3d/041f831f.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å²æœˆå®‰ç„¶</span>
                            </div>
                            <div class="bd">â€œå†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œè¦å…ˆå°†è„é¡µå†™åˆ°ç£ç›˜â€œå’Œâ€œredo log å†™æ»¡äº†ï¼Œè¦ flush è„é¡µâ€å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªè„é¡µæœ¬èº«å ç”¨å†…å­˜ï¼Œé‡Šæ”¾å†…å­˜éœ€è¦å°†è„é¡µå†™å…¥åˆ°ç£ç›˜æ‰èƒ½é‡Šæ”¾ã€‚è€Œredo logå†™æ»¡åªæœ‰å½“redo logå¯¹åº”çš„è„é¡µflushåˆ°ç£ç›˜ä¸Šæ‰èƒ½é‡Šæ”¾å¯¹åº”ç©ºé—´ã€‚æœ‰å‡ ä¸ªé—®é¢˜ï¼š<br>1ã€â€œå†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œè¦å…ˆå°†è„é¡µå†™åˆ°ç£ç›˜â€œredo logå¯¹åº”çš„ç©ºé—´ä¼šé‡Šæ”¾å˜›ï¼Ÿâ€œredo log å†™æ»¡äº†ï¼Œè¦ flush è„é¡µâ€å¯¹åº”çš„å†…å­˜é¡µä¼šé‡Šæ”¾å˜›ï¼Ÿ<br>2ã€å°†è„é¡µflushåˆ°ç£ç›˜ä¸Šæ˜¯ç›´æ¥å°†è„é¡µæ•°æ®è¦†ç›–åˆ°å¯¹åº”ç£ç›˜ä¸Šçš„æ•°æ®ï¼Ÿè¿˜æ˜¯ä»ç£ç›˜ä¸Šå–åˆ°æ•°æ®åå–æ ¹æ®redo logè®°å½•è¿›è¡Œæ›´æ–°åå†å†™å…¥åˆ°ç£ç›˜ï¼Ÿ<br>3ã€redo logæ˜¯æ€ä¹ˆè®°å½•å¯¹åº”è„é¡µæ˜¯å¦å·²ç»flushäº†ï¼Ÿå¦‚æœæ–­ç”µäº†é‡å¯å¯¼è‡´å†…å­˜ä¸¢å¤±ï¼Œå‰é¢å‡ ç« è¯´é€šè¿‡redo logè¿›è¡Œæ•°æ®æ¢å¤é‚£redo logåˆæ€ä¹ˆå»é‡Šæ”¾ç©ºé—´ï¼Ÿ <br></div>
                            <span class="time">2018-12-10 11:14</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">1. Redolog çš„ç©ºé—´æ˜¯å¾ªç¯ä½¿ç”¨çš„ï¼Œæ— æ‰€è°“é‡Šæ”¾ã€‚ å¯¹åº”çš„å†…å­˜é¡µä¼šå˜æˆå¹²å‡€é¡µã€‚ä½†æ˜¯ç­‰æ·˜æ±°çš„æ—¶å€™æ‰ä¼šé€å‡ºå†…å­˜<br><br>2. å¥½é—®é¢˜ï¼Œå‰è€…<br><br>3. ä¸ç”¨è®°ï¼Œé‡å¯äº†å°±ä»checkpoint çš„ä½ç½®å¾€åæ‰«ã€‚ å¦‚æœå·²ç»ä¹‹å‰åˆ·è¿‡ç›˜çš„, ä¸ä¼šé‡å¤åº”ç”¨redi logã€‚ å¥½é—®é¢˜</p>
                                <p class="reply-time">2018-12-10 13:12</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/9f/1d/ec173090.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">melon</span>
                            </div>
                            <div class="bd">åˆæ€è€ƒäº†ä¸€ä¸‹ï¼Œè¯·è€å¸ˆå¸®å¿™çœ‹ä¸€ä¸‹ç†è§£çš„å¯¹ä¸å¯¹ï¼šbuffer poolé‡Œç»´æŠ¤ç€ä¸€ä¸ªè„é¡µåˆ—è¡¨ï¼Œå‡è®¾ç°åœ¨redo log çš„ checkpoint è®°å½•çš„ LSN ä¸º 10ï¼Œç°åœ¨å†…å­˜ä¸­çš„ä¸€å¹²å‡€é¡µæœ‰ä¿®æ”¹ï¼Œä¿®æ”¹åè¯¥é¡µçš„LSNä¸º12ï¼Œå¤§äº checkpoint çš„LSNï¼Œåˆ™åœ¨å†™redo logçš„åŒæ—¶è¯¥é¡µä¹Ÿä¼šè¢«æ ‡è®°ä¸ºè„é¡µè®°å½•åˆ°è„é¡µåˆ—è¡¨ä¸­ï¼Œç°åœ¨å†…å­˜ä¸è¶³ï¼Œè¯¥é¡µéœ€è¦è¢«æ·˜æ±°æ‰ï¼Œè¯¥é¡µä¼šè¢«åˆ·åˆ°ç£ç›˜ï¼Œç£ç›˜ä¸­è¯¥é¡µçš„LSNä¸º12ï¼Œè¯¥é¡µä¹Ÿä»è„é¡µåˆ—è¡¨ä¸­ç§»é™¤ï¼Œç°åœ¨redo log éœ€è¦å¾€å‰æ¨è¿›checkpointï¼Œåˆ°LSNä¸º12çš„è¿™æ¡logæ—¶ï¼Œå‘ç°å†…å­˜ä¸­çš„è„é¡µåˆ—è¡¨é‡Œæ²¡æœ‰è¯¥é¡µï¼Œä¸”ç£ç›˜ä¸Šè¯¥é¡µçš„LSNä¹Ÿå·²ç»ä¸º12ï¼Œåˆ™è¯¥é¡µå·²åˆ·è„ï¼Œå·²ä¸ºå¹²å‡€é¡µï¼Œè·³è¿‡ã€‚ <br></div>
                            <span class="time">2018-12-11 14:41</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å¯¹çš„ã€‚ğŸ‘ğŸ¿</p>
                                <p class="reply-time">2018-12-11 18:20</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/de/2b/2702fcbe.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">jimmy</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹ï¼Œinnodbæ˜¯å¦‚ä½•çŸ¥é“ä¸€ä¸ªé¡µæ˜¯ä¸æ˜¯è„é¡µçš„ï¼Œæ˜¯æœ‰æ ‡è®°ä½è¿˜æ˜¯é€šè¿‡redologçš„ckeckpointæ¥ç¡®å®šçš„ï¼Ÿ <br></div>
                            <span class="time">2018-12-10 18:29</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ¯ä¸ªæ•°æ®é¡µå¤´éƒ¨æœ‰LSNï¼Œ8å­—èŠ‚ï¼Œæ¯æ¬¡ä¿®æ”¹éƒ½ä¼šå˜å¤§ã€‚<br><br>å¯¹æ¯”è¿™ä¸ªLSNè·Ÿcheckpoint çš„LSNï¼Œæ¯”checkpointå°çš„ä¸€å®šæ˜¯å¹²å‡€é¡µ</p>
                                <p class="reply-time">2018-12-10 19:13</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/f3/4a/b6a46894.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Ying</span>
                            </div>
                            <div class="bd">redolog è®¾ç½®è¿‡å°ï¼Œä¼šå¯¼è‡´é¢‘ç¹åˆ·è„é¡µï¼Œè¿˜å¯èƒ½å¼•å‘è¿åï¼Œè¿™æ ·æŠ–çš„é¢‘ç‡å¯èƒ½ä¼šæ˜æ˜¾å˜é«˜ï¼Œç³»ç»Ÿä¼šä¸æ–­å¡æ­»çš„ <br></div>
                            <span class="time">2018-12-10 02:10</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/48/bd/6c7d4230.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Tony Du</span>
                            </div>
                            <div class="bd">å½“å†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œè¦å°†è„é¡µå†™åˆ°ç£ç›˜ï¼Œä¼šæœ‰ä¸€ä¸ªæ•°æ®é¡µæ·˜æ±°æœºåˆ¶ï¼ˆæœ€ä¹…ä¸ä½¿ç”¨ï¼‰ï¼Œå‡è®¾æ·˜æ±°çš„æ˜¯è„é¡µï¼Œåˆ™æ­¤æ—¶è„é¡µæ‰€å¯¹åº”çš„redo logçš„ä½ç½®æ˜¯éšæœºçš„ï¼Œå½“æœ‰å¤šä¸ªä¸åŒçš„è„é¡µéœ€è¦åˆ·ï¼Œåˆ™å¯¹åº”çš„redo logå¯èƒ½åœ¨ä¸åŒçš„ä½ç½®ï¼Œè¿™æ ·å°±éœ€è¦æŠŠredo logçš„å¤šä¸ªä¸åŒä½ç½®åˆ·æ‰ï¼Œè¿™æ ·å¯¹äºredo logçš„å¤„ç†ä¸æ˜¯å°±ä¼šå¾ˆéº»çƒ¦å—ï¼Ÿï¼ˆåˆå¹¶é—´éš™ï¼Œç§»åŠ¨ä½ç½®ï¼Ÿï¼‰<br>å¦å¤–ï¼Œredo logçš„ä¼˜åŠ¿åœ¨äºå°†ç£ç›˜éšæœºå†™è½¬æ¢æˆäº†é¡ºåºå†™ï¼Œå¦‚æœéœ€è¦å°†redo logçš„ä¸åŒéƒ¨åˆ†åˆ·æ‰ï¼ˆåˆ·è„é¡µï¼‰ï¼Œä¸æ˜¯å°±åœ¨redo logé‡Œéšæœºè¯»å†™äº†ä¹ˆï¼Ÿ<br><br>ä½œè€…å›å¤<br>å¥½é—®é¢˜ã€‚ <br><br>å…¶å®ç”±äºæ·˜æ±°çš„æ—¶å€™ï¼Œåˆ·è„é¡µè¿‡ç¨‹ä¸ç”¨åŠ¨redo logæ–‡ä»¶çš„ã€‚<br><br>è¿™ä¸ªæœ‰ä¸ªé¢å¤–çš„ä¿è¯ï¼Œæ˜¯redo logåœ¨â€œé‡æ”¾â€çš„æ—¶å€™ï¼Œå¦‚æœä¸€ä¸ªæ•°æ®é¡µå·²ç»æ˜¯åˆ·è¿‡çš„ï¼Œä¼šè¯†åˆ«å‡ºæ¥å¹¶è·³è¿‡ã€‚<br><br>æˆ‘çš„å›å¤<br>è¿™ä¸ªé¢å¤–ä¿è¯æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Ÿèƒ½ä¸èƒ½ç¨å¾®è§£é‡Šä¸‹<br>é€šè¿‡åˆ·è„é¡µæ—¶æ•°æ®é¡µæ›´æ–°çš„timestampæ¥å¯¹æ¯”redo logçš„timestampï¼Ÿ <br></div>
                            <span class="time">2018-12-11 09:11</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">LSNï¼Œæ¯æ¬¡å†™redo logéƒ½å¸¦çš„ä¸€ä¸ªæ•°å­—ï¼Œ æ•°æ®é¡µä¸Šä¹Ÿæœ‰ï¼Œå¯¹æ¯”å¤§å°çš„ï¼Œå› ä¸ºå¤ªç»†èŠ‚æ²¡æœ‰å†™åˆ°æ–‡ç« ä¸­ã€‚</p>
                                <p class="reply-time">2018-12-11 12:06</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/bd/da/abb7bfe3.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è¿›å‡»çš„èœé¸¡</span>
                            </div>
                            <div class="bd">çœ‹å®Œè¿™ä¸€ç« æ˜ç™½äº†åŸæ¥æ•°æ®è½ç›˜ä¸ä»…ä»…åªæ˜¯å®šæ—¶åˆ·redo logåŠå¿«å†™æ»¡æ˜¯æ‰ä¼šè¿›è¡Œã€‚å½“å†…å­˜ä¸è¶³è¦æ·˜æ±°æ‰çš„æ•°æ®é¡µä¸ºè„é¡µæ—¶ä¼šç›´æ¥å°†å†…å­˜ä¸­è„é¡µçš„æ•°æ®åˆ·å…¥ç£ç›˜ã€‚ä¸è¿‡æ­¤æ—¶äº§ç”Ÿäº†å‡ ä¸ªç–‘é—®ã€‚<br>1ã€å¦‚æœç›´æ¥å°†å†…å­˜ä¸­çš„æ•°æ®é¡µåˆ·å…¥ç£ç›˜ï¼Œé‚£redo logä¸­çš„æ•°æ®æ€ä¹ˆåŠï¼Œä¼šå»åˆ é™¤å—ï¼Ÿå¦‚æœæ˜¯é‚£redo logå²‚ä¸å°±ä¸è¿ç»­äº†ã€‚å¦‚æœä¸æ˜¯çš„è¯å½“åˆ·redo logæ—¶åˆè¯¥æ€ä¹ˆåˆ¤æ–­æ­¤æ—¶ç¡¬ç›˜ä¸­çš„æ•°æ®å·²ç»æ˜¯æœ€æ–°çš„æ•°æ®äº†å‘¢ã€‚<br>2ã€åœ¨æ‰§è¡ŒDMLæ“ä½œæ—¶åº”è¯¥æ˜¯æ€»å…±æœ‰ä¸¤å¤„å†™ç£ç›˜æ˜¯å—ï¼Ÿå…ˆæ˜¯innodbå±‚çš„redo logè½ç›˜ï¼Œç´§æ¥ç€MySQL serverå±‚çš„bin logè½ç›˜ã€‚è¿™ä¸¤å¤„å†™ç£ç›˜éƒ½æ˜¯åŒæ­¥å†™æ“ä½œå—ï¼Ÿ<br>è¿˜æœ›è€å¸ˆå¯ä»¥åœ¨ç™¾å¿™ä¹‹ä¸­ä¸åèµæ•™ï¼Œæ„Ÿæ¿€ä¸å°½*^o^* <br></div>
                            <span class="time">2019-01-06 16:41</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/e2/cb/6bc95e09.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å–”ï½</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œè¯·é—®ä¸‹è®¿é—®æŸæ¡è®°å½•æ—¶ï¼Œå­˜å‚¨å¼•æ“æ˜¯å¦‚ä½•åˆ¤æ–­è¿™æ¡è®°å½•æ‰€åœ¨çš„æ•°æ®é¡µæ˜¯å¦åœ¨å†…å­˜å½“ä¸­ï¼Œè¿™ä¸ªæŸ¥å†…å­˜æœºåˆ¶æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ <br></div>
                            <span class="time">2018-12-20 13:29</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ¯ä¸ªé¡µé¢æœ‰ç¼–å·çš„ã€‚æ‹¿ç€ç¼–å·å»å†…å­˜çœ‹ï¼Œæ²¡æœ‰ï¼Œå°±å»ç£ç›˜</p>
                                <p class="reply-time">2018-12-20 16:08</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eq46o2L7ibj1L7Uh44pLTgJrsnRezptClG1HD1PdGImspBLvFcsp0l1Wp8WDVt6sN7NUKC8aqKXnJA/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">è€é±¼å¤´</span>
                            </div>
                            <div class="bd">é‚£ä¸ªè¯´fioå‘½ä»¤ä¼šç ´åç¡¬ç›˜çš„å…„å¼Ÿï¼Œæ˜¯æ²¡ç”¨å¯¹å‘½ä»¤ã€‚ä¼°è®¡æŠŠ-filename=&#47;dev&#47;sdb1 ã€‚ã€‚ã€‚è¿™ä¸ªçš„æ„æ€æ˜¯ä» åˆ†åŒº sdb1 çš„ç¬¬ä¸€ä¸ªæ‰‡åŒºå¼€å§‹å†™å…¥éšæœºæ•°æ®ï¼Œå»åˆ¤æ–­è¿™ä¸ªç£ç›˜çš„å†™å…¥é€Ÿåº¦ã€‚å¦‚æœæŒ‡å®šè·¯å¾„+æ–‡ä»¶åå°±ä¸ä¼šå‡ºè¿™äº‹äº†~æ¯”å¦‚è€å¸ˆç»™çš„ä¾‹å­~ <br></div>
                            <span class="time">2018-12-12 08:24</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å—¯å—¯ï¼Œä½ è¯´çš„å¯¹<br><br>å†™æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘è¿˜æ•…æ„ç”¨å˜é‡ï¼Œè¿™æ ·ç›´æ¥æ‹·è´ä¼šå‡ºé”™ï¼Œç„¶åè‡ªå·±å†å†™ä¸ªè·¯å¾„ï¼Œå·²ç»è€ƒè™‘äº†å®‰å…¨äº†ğŸ˜“</p>
                                <p class="reply-time">2018-12-12 10:45</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/df/e7/e3c450c2.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">lionetes</span>
                            </div>
                            <div class="bd">å¾ˆå¤šæµ‹è¯•äººå‘˜å†åšå‹åŠ›æµ‹è¯•çš„æ—¶å€™ å‡ºç°åˆšå¼€å§‹ insert update å¾ˆå¿« ä¸€ä¼š å°±å‡ºç°å¾ˆæ…¢,å¹¶ä¸”å»¶è¿Ÿå¾ˆå¤§ï¼Œå¤§éƒ¨åˆ†æ˜¯å› ä¸ºredo log è®¾ç½®å¤ªå° å¼•èµ·çš„,å®Œç¾è¯ é‡Š <br></div>
                            <span class="time">2018-12-11 16:23</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘ğŸ¿ å¸¸è§çš„è¯¯ç”¨åœºæ™¯</p>
                                <p class="reply-time">2018-12-11 18:19</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/fa/61/691e2936.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">ç®—ä¸å‡ºæµæº</span>
                            </div>
                            <div class="bd">æ€è€ƒé¢˜:redo logè¾ƒå°ï¼Œæ­¤æ—¶F2(N)å°±å®¹æ˜“è¾ƒå¤§ï¼Œåå°åˆ·è„é¡µçš„é€Ÿåº¦å°±ä¼šè¾ƒå¿«ï¼Œä½†æ˜¯æœºå™¨iopså¾ˆé«˜ï¼Œæ‰€ä»¥å³ä½¿åœ¨mysqlè´Ÿè½½è¾ƒé«˜çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¸ä¼šé€ æˆredo logå†™æ»¡ï¼Œå› ä¸ºinnodbä¼šç…§ç€æœ€å¤§iopsçš„ç›®æ ‡å»è¯·æ±‚ioï¼Œè€Œè¯»å†™æ•°æ®åº“çš„ä¸šåŠ¡è¯·æ±‚ä¹Ÿæœºå™¨æœæœ€å¤§iopsèƒ½åŠ›å»æŒ¤ï¼Œæœ€ç»ˆä¸¤ç±»ioéœ€æ±‚ç›¸äº’ç«äº‰è¾¾åˆ°ä¸€ä¸ªåŠ¨æ€å¹³è¡¡ï¼Œredo logä¸ä¼šè¢«çŒæ»¡ï¼Œä½†ä¸šåŠ¡è¯·æ±‚ä¹Ÿæ²¡æœ‰ç©ºé—²çš„æ—¶å€™æ‰§è¡Œé€Ÿåº¦å¿«ã€‚<br>    æ‰€ä»¥æˆ‘è®¤ä¸ºåº”è¯¥ä¸æ˜¯é€ æˆæŠ–åŠ¨ï¼Œè€Œæ˜¯ä¸šåŠ¡è´Ÿè½½è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œå®Œæˆä¸šåŠ¡è¯·æ±‚çš„å¹³å‡æ—¶é—´ä¼šè¾ƒç³»ç»Ÿç©ºé—²æ—¶åŠ å€ã€‚ä¸çŸ¥é“ç†è§£æœ‰æ²¡æœ‰é—®é¢˜ï¼Œè¯·è€å¸ˆæŒ‡æ­£ <br></div>
                            <span class="time">2018-12-11 13:22</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¿™ä¸ªâ€œåŠ¨æ€å¹³è¡¡â€ç¡®å®æ˜¯ç”¨â€œé—´æ­‡æ€§åœ°å¡ä½ä¸šåŠ¡è¯·æ±‚â€ä½œä¸ºä»£ä»·çš„</p>
                                <p class="reply-time">2018-12-11 18:23</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/7c/b7/3b3cbc38.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Inon</span>
                            </div>
                            <div class="bd">è€å¸ˆæ‚¨å¥½ï¼Œä¸€ç›´æœ‰ä¸ªé—®é¢˜ï¼Œæƒ³è¯·æ•™ä¸‹ï¼šå°±æ˜¯è¿œç¨‹é€šè¿‡JDBCä¸€æ¬¡æŸ¥è¯¢å¯èƒ½æŸ¥è¯¢å‡ºä¸Šä¸‡æ¡æ•°æ®ã€‚ä½†æˆ‘åœ¨å®¢æˆ·ç«¯è¿­ä»£è¯»å‡ºæ¥çš„æ—¶å€™éƒ½æ˜¯ä¸€æ¡ä¸€æ¡å–çš„ã€‚æˆ‘æƒ³é—®ï¼Œæ•°æ®åº“ç«¯ä¸€æ¬¡æŸ¥è¯¢ï¼Œä¼šå°†æŸ¥è¯¢çš„ä¸Šä¸‡æ¡çœŸå®æ•°æ®ç»“æœä¸€æ¬¡æ€§æ”¾åœ¨ä¸€ä¸ªç¼“å†²ä¸­ï¼Œç­‰å®¢æˆ·ç«¯æ¥å–ã€‚è¿˜æ˜¯æ„å»ºä¸€ä¸ªæŸ¥è¯¢æ•°æ®ç»“æ„ï¼Œåªæ˜¯å®šä½æŸ¥è¯¢ç»“æœä½ç½®çš„ï¼Œæ¯æ¬¡å®¢æˆ·ç«¯é€šè¿‡æ¸¸æ ‡é€šè¿‡æŸ¥è¯¢ç»“æœä½ç½®å®æ—¶è¯»ç£ç›˜å–æ•°æ®çš„ï¼Ÿ <br></div>
                            <span class="time">2018-12-10 22:09</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKWBSfZTcUiaJ0Rxibe9VSDSBDEhM8lNjrTiahUrDibboxW1M8JQc7M9QevUZdVXI8N10BWpEsKc2bPKQ/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å…‹å·±è¿‡</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼ï¼ï¼fioè¿™æ¡å‘½ä»¤æ˜¯ä¼šç ´åç¡¬ç›˜çš„ï¼è€Œä¸”ç™¾åº¦æœå‡ºæ¥ä¸åŠ ç¡¬ç›˜åå…³é”®è¯å»æœï¼Œæœå‡ºæ¥çš„æ–‡ç« æ²¡æœ‰ä¸€ç¯‡ä¼šå‘Šè¯‰ä½ è¿™ä¸ªäº‹æƒ…ï¼ï¼ï¼ä¸è¯´äº†ï¼Œæˆ‘å»æ¢å¤æ•°æ®äº†ğŸ˜­ <br></div>
                            <span class="time">2018-12-10 22:03</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ²¡æœ‰å§ï¼Œæ€ä¹ˆä¼šç ´åç¡¬ç›˜ï¼Ÿæˆ‘å’Œä»¥å‰åŒäº‹ä¸€ç›´è¿™ä¹ˆç”¨çš„å‘€â€¦<br><br>ä½ ç¡®å®šæ˜¯è¿™ä¸ªå‘½ä»¤å¯¼è‡´çš„å—ğŸ˜“</p>
                                <p class="reply-time">2018-12-12 03:26</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/e5/39/951f89c8.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">ä¿¡ä¿¡</span>
                            </div>
                            <div class="bd">è€å¸ˆï¼Œä½ å¥½ï¼Œé’ˆå¯¹ä¸Šä¸€æœŸé—®é¢˜çš„è§£ç­”ä¸­æœ‰ä¸ªç–‘é—®ï¼šä¸ºå•¥201100001è¦ä»å­—ç¬¦ä¸²è½¬æ•°å­—ï¼Œæœ¬æ¥åªéœ€è¦2å­—èŠ‚ï¼Œè½¬æˆæ•°å­—éœ€è¦4å­—èŠ‚ã€‚æ˜¯å› ä¸ºç›¸åŒçš„å†…å®¹ï¼Œæ•°å­—æŸ¥æ‰¾æ¯”å­—ç¬¦ä¸²æŸ¥æ‰¾æœ‰ä¼˜åŠ¿å—ï¼Ÿ <br></div>
                            <span class="time">2018-12-10 20:06</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ä¸ºä»€ä¹ˆè¯´è¿™æ˜¯ä¸¤ä¸ªå­—èŠ‚ï¼ŸæŒ‰å­—ç¬¦ä¸€ä¸ªä¸ªç®—æ˜¯9ä¸ª</p>
                                <p class="reply-time">2018-12-10 22:08</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/61/57/6f3c81dd.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">é˜¿å»º</span>
                            </div>
                            <div class="bd">redo-logå†…å­˜æ»¡äº†ï¼Œä¸åœçš„è¦åˆ·è„é¡µå›ç£ç›˜ã€‚ç°è±¡å°±ä¼šæ˜¯å‘ç°æœºå™¨ioä¸é«˜ï¼Œä½†æ˜¯mysqlæ˜æ˜¾çš„å¡é¡¿ã€‚ <br></div>
                            <span class="time">2018-12-10 16:28</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/1d/13/31ea1b0b.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å³°</span>
                            </div>
                            <div class="bd">redoæ—¥å¿—è®¾ç½®å¤ªå°ï¼Œå†…å­˜åˆæ¯”è¾ƒå¤§ï¼Œå¯¼è‡´innodbç¼“å­˜çš„è„é¡µè¿˜æ²¡å¤šå°‘å°±å¼€å§‹å¤§é‡flushï¼Œåˆ·å†™é¢‘ç‡å¢å¤§ã€‚æ„Ÿè§‰æœ‰ç‚¹åƒjvmä¸­ï¼Œå¹´è½»ä»£å†…å­˜è®¾ç½®å°ç‚¹ï¼Œå¯¼è‡´é¢‘ç¹younggcã€‚å½“ç„¶è¿™å°±æ˜¯ä¸ªæƒè¡¡ï¼Œæ¯•ç«Ÿredoå’Œå†…å­˜ä¸èƒ½æ— é™å¤§ã€‚ <br></div>
                            <span class="time">2018-12-10 11:43</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ğŸ‘ğŸ¿å¼•ç”³ä¸é”™</p>
                                <p class="reply-time">2018-12-10 13:07</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJCscgdVibmoPyRLRaicvk6rjTJxePZ6VFHvGjUQvtfhCS6kO4OZ1AVibbhNGKlWZmpEFf2yA6ptsqHw/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¤¹å¿ƒé¢åŒ…</span>
                            </div>
                            <div class="bd"><br>è€å¸ˆè¯·é—®ä¸‹ innodb_io_capacityæˆ‘ä»¬é»˜è®¤æ˜¯200,åœ¨é«˜å¹¶å‘æ’å…¥åœºæ™¯ä¸‹,cpuä½¿ç”¨ç‡å¾ˆä½,ä½†æ˜¯cpu iowaité«˜,è¿™ç§æƒ…å†µä¸‹ è°ƒå¤§  innodb_io_capacity æ˜¯å¦æœ‰ç”¨å‘¢,æˆ‘ç”¨äº†æ‚¨çš„æµ‹è¯•æ–¹æ³•,iopséšæœºè¯»å†™éƒ½ä¸º1K<br> <br></div>
                            <span class="time">2018-12-10 11:10</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">é‚£è¯´æ˜ä½ ä»¬ç£ç›˜ä¸å¤ªå¥½â€¦</p>
                                <p class="reply-time">2018-12-10 13:13</p>
                            </div>
                            
                        </div>
                    </li>
                    


                </ul>
            </div>
        </div>
    </div>
</div>
</body>
</html>